/****************************************************************************
*
*    Copyright (c) 2005 - 2019 by Vivante Corp.  All rights reserved.
*
*    The material in this file is confidential and contains trade secrets
*    of Vivante Corporation. This is proprietary information owned by
*    Vivante Corporation. No part of this work may be disclosed,
*    reproduced, copied, transmitted, or used in any way for any purpose,
*    without the express written permission of Vivante Corporation.
*
*****************************************************************************/


/*
**
*/

#include "gc_hal_user_hardware_precomp.h"
#include "gc_hal_user.h"

#if gcdENABLE_3D && gcdUSE_VX
#include <stdio.h>
#include <assert.h>

/* Zone used for header/footer. */
#define _GC_OBJ_ZONE    gcvZONE_HARDWARE
#define GCREG_SH_INSTRUCTION_TYPE_INVALID ~0U

#define GETBIT(data, position) (((data) >> (position)) & 0x1)

#define SETBIT(data, position, value)   (\
            ((data) & (~((1ULL) << position)))   \
             |  \
             (((value) << position) & ((1ULL) << position))   \
             )

#define _START(reg_field)       (0 ? reg_field)
#define _END(reg_field)         (1 ? reg_field)
#define _GETSIZE(reg_field)     (_END(reg_field) - _START(reg_field) + 1)
#define _ALIGN(data, reg_field) ((gctUINT32)(data) << _START(reg_field))
#define _MASK(reg_field)        ((_GETSIZE(reg_field) == 32) \
                                    ?  ~0 \
                                    : (gctUINT32)(~((gctUINT64)(~0) << _GETSIZE(reg_field))))

#define AQSETFIELD(data, reg, field, value) \
(\
    ((gctUINT32)(data) & ~_ALIGN(_MASK(reg##_##field), reg##_##field)) \
        | \
    _ALIGN((gctUINT32)(value) & _MASK(reg##_##field), reg##_##field) \
)

#define AQSETFIELDVALUE(data, reg, field, value) \
(\
    ((gctUINT32)(data) & ~_ALIGN(_MASK(reg##_##field), reg##_##field)) \
        | \
    _ALIGN(reg##_##field##_##value & _MASK(reg##_##field), reg##_##field) \
)

#define gcdVX_ENABLE ((1 << 0) | (1 << 1) | (1 << 2) | (1 << 3))
#define gcdVX_ENABLE4(X, Y, Z, W) ((1 << (X)) | (1 << (Y)) | (1 << (Z)) | (1 << (W)))
#define gcdVX_ENABLE1(X) (1 << (X))
#define gcdVX_ENABLE2(X, Y) ((1 << (X)) | (1 << (Y)))
#define gcdVX_ENABLE3(X, Y, Z) ((1 << (X)) | (1 << (Y)) | (1 << (Z)))
#define gcdVX_SWIZZLE (0 | (1 << 2) | (2 << 4) | (3 << 6))
#define gcdVX_SWIZZLE1(X) ((X) | ((X) << 2) | ((X) << 4) | ((X) << 6))
#define gcdVX_SWIZZLE2(X, Y) ((X) | ((Y) << 2) | ((Y) << 4) | ((Y) << 6))
#define gcdVX_SWIZZLE4(X, Y, Z, W) ((X) | ((Y) << 2) | ((Z) << 4) | ((W) << 6))

#define VX_DF_IMAGE(a,b,c,d)                  ((a) | (b << 8) | (c << 16) | (d << 24))

/* Copy definition of cl_channel_odrder and cl_channel_data_type here to use OCL C language in OVX*/
/* cl_channel_order */
#define CLK_R         0x10B0
#define CLK_A         0x10B1
#define CLK_RG        0x10B2
#define CLK_RA        0x10B3
#define CLK_RGB       0x10B4
#define CLK_RGBA      0x10B5
#define CLK_BGRA      0x10B6
#define CLK_ARGB      0x10B7
#define CLK_INTENSITY 0x10B8
#define CLK_LUMINANCE 0x10B9
#define CLK_Rx        0x10BA
#define CLK_RGx       0x10BB
#define CLK_RGBx      0x10BC
/* CL_channel_type */
#define CLK_SNORM_INT8       0x10D0
#define CLK_SNORM_INT16      0x10D1
#define CLK_UNORM_INT8       0x10D2
#define CLK_UNORM_INT16      0x10D3
#define CLK_UNORM_SHORT_565  0x10D4
#define CLK_UNORM_SHORT_555  0x10D5
#define CLK_UNORM_INT_101010 0x10D6
#define CLK_SIGNED_INT8      0x10D7
#define CLK_SIGNED_INT16     0x10D8
#define CLK_SIGNED_INT32     0x10D9
#define CLK_UNSIGNED_INT8    0x10DA
#define CLK_UNSIGNED_INT16   0x10DB
#define CLK_UNSIGNED_INT32   0x10DC
#define CLK_HALF_FLOAT       0x10DD
#define CLK_FLOAT            0x10DE

static gctUINT32 gcoHardwareVX_GetPixel(gctUINT32 format)
{
    gctUINT32 pixel = 0;
    switch(format)
    {
    case 0x7:
        pixel = 15;
        break;
    case 0x3:
    case 0x6:
        pixel = 7;
        break;
    default:
        pixel = 15;
        break;
    }

    return pixel;
}


gctUINT32 SETBITS(
    IN gctUINT32 Data,
    IN const unsigned int Start,
    IN const unsigned int End,
    IN const gctUINT32 Value
    )
{
    gctUINT32 data = Data;
    if (End >= Start)
    {
        gctUINT32 _Mask =  ((~0ULL >> (63 - End + Start)) << Start);
        data &= ~_Mask;
        data |= ((Value) << Start) & _Mask;
        return data;
    }
    else
    {
        gctUINT32 _Mask =  ((~0ULL >> (63 - Start + End)) << End);
        data &= ~_Mask;
        data |= ((Value) << End) & _Mask;
        return data;
    }
}

gctUINT32 GETBITS(
    IN gctUINT32 Data,
    IN const unsigned int Start,
    IN const unsigned int End
    )
{
    gctUINT32 data = Data;
    if (End >= Start)
    {
        gctUINT32 _Mask = (~0ULL >> (63 - (End - Start)));
        return (data >> Start) & _Mask;
    }
    else
    {
        gctUINT32 _Mask = (~0ULL >> (63 - (Start - End)));
        return (data >> End) & _Mask;;
    }
}

typedef union _RelOffset {
    struct {
        gctUINT16 x : 5;
        gctUINT16 y : 5;
    }u;
    gctUINT32 raw;
}RelOffset;

void
_UpdateDelta(
    IN gcoHARDWARE Hardware,
    IN gctUINT32 Core
    );

gceSTATUS
gcoHARDWAREVX_CommitCmd(
    IN gcoHARDWARE          Hardware,
    OUT gctPOINTER*         pCmdLogical,
    OUT gctUINT32*          pCmdBytes
    )
{

#if gcdENABLE_3D
    gctUINT32 coreIndex;
#endif
    gceSTATUS status = gcvSTATUS_NOT_SUPPORTED;

#if (gcdENABLE_3D)
    gctUINT i;
    gctPOINTER dumpCommandLogical;
    gctUINT32 dumpCommandBytes = 0;
    gctPOINTER dumpAsyncCommandLogical = gcvNULL;
    gctUINT32 dumpAsyncCommandBytes = 0;

    gcmHEADER_ARG("Hardware=0x%x", Hardware);

    gcmGETHARDWARE(Hardware);

    /* Verify the arguments. */
    gcmVERIFY_OBJECT(Hardware, gcvOBJ_HARDWARE);

#if gcdENABLE_3D
    if (Hardware->deltas)
    {
        for (i = 1; i < Hardware->config->gpuCoreCount; i++)
        {
            gcoHARDWARE_QueryCoreIndex(Hardware, i, &coreIndex);

            gcoHARDWARE_CopyDelta(Hardware->deltas[coreIndex], Hardware->delta);
        }
    }
#endif

    for (i = 0; i < gcvENGINE_GPU_ENGINE_COUNT; i++)
    {
        if (Hardware->engine[i].buffer
        &&  !gcoBUFFER_IsEmpty(Hardware->engine[i].buffer))
        {
            /* Becomes not idle because new command buffer comes. */
            Hardware->engine[i].idle = gcvFALSE;
        }
    }

    /* Commit command buffer and return status. */
    if (gcoHAL_GetOption(gcvNULL, gcvOPTION_KERNEL_FENCE) &&
        Hardware->features[gcvFEATURE_ASYNC_BLIT])
    {
        gcmVERIFY_OK(gcoBUFFER_Commit(
            Hardware->engine[gcvENGINE_BLT].buffer,
            gcvPIPE_INVALID,
            gcvNULL,
            gcvNULL,
            0,
            gcvNULL,
            Hardware->engine[gcvENGINE_BLT].queue,
            &dumpAsyncCommandLogical,
            &dumpAsyncCommandBytes
            ));
    }

    status = gcoBUFFER_Commit(
        Hardware->engine[gcvENGINE_RENDER].buffer,
        Hardware->currentPipe,
        Hardware->delta,
        Hardware->deltas,
        Hardware->context,
        Hardware->contexts,
        Hardware->engine[gcvENGINE_RENDER].queue,
        &dumpCommandLogical,
        &dumpCommandBytes
        );

#if gcdENABLE_3D
    if (Hardware->deltas)
    {
        for (i = 0; i < Hardware->config->gpuCoreCount; i++)
        {
            /* Update deltas for all GPUs bound to this hardware. */
            gcoHARDWARE_QueryCoreIndex(Hardware, i, &coreIndex);

            _UpdateDelta(Hardware, coreIndex);
        }

        /* Delta list for the first GPU is updated in _UpdateDelta,
        *  update Hardware->delta to the current one. */
        gcoHARDWARE_QueryCoreIndex(Hardware, 0, &coreIndex);

        Hardware->delta = Hardware->deltas[coreIndex];
    }
#endif

#if gcdDUMP && !gcdDUMP_IN_KERNEL
    if (dumpCommandBytes)
    {
        /* Dump current command buffer. */
        gcmDUMP_BUFFER(gcvNULL,
                       gcvDUMP_BUFFER_COMMAND,
                       Hardware->context,
                       dumpCommandLogical,
                       0,
                       dumpCommandBytes);
    }

    if (dumpAsyncCommandBytes)
    {
        gcmASSERT(dumpAsyncCommandLogical);
        /* Dump async command buffer. */
        gcmDUMP_BUFFER(gcvNULL,
                       gcvDUMP_BUFFER_ASYNC_COMMAND,
                       Hardware->context,
                       dumpAsyncCommandLogical,
                       0,
                       dumpAsyncCommandBytes);
    }

    /* Dump the commit. */
    gcmDUMP(gcvNULL, "@[commit]");
#endif

#if gcdSYNC
    if (!gcmIS_ERROR(status))
    {
        if (Hardware->fence[gcvENGINE_RENDER])
        {
            Hardware->fence[gcvENGINE_RENDER]->commitID = Hardware->fence[gcvENGINE_RENDER]->fenceIDSend;
        }
    }
#endif


    if (pCmdLogical != NULL)
    {
        *pCmdLogical = dumpCommandLogical;
    }

    if (pCmdBytes != NULL)
    {
        *pCmdBytes = dumpCommandBytes;
    }

OnError:
    /* Return the status. */
    gcmFOOTER();
#endif  /* (gcdENABLE_3D || gcdENABLE_2D) */
    return status;
}

gceSTATUS
gcoHARDWAREVX_ReplayCmd(
    IN gcoHARDWARE          Hardware,
    OUT gctPOINTER          CmdLogical,
    OUT gctUINT32           CmdBytes
    )
{
    gceSTATUS   status = gcvSTATUS_OK;

    gcmHEADER_ARG("Hardware=0x%x ", Hardware);

    gcmGETHARDWARE(Hardware);

    /* Call hardware. */
    status = gcoHARDWARE_WriteBuffer(Hardware, CmdLogical, CmdBytes, gcvFALSE);

OnError:
    gcmFOOTER_ARG("%d", status);
    return status;
}

gceSTATUS _getCLFormatFromInternalFormat(gcsVX_IMAGE_INFO_PTR info, gctUINT32_PTR channelOrder, gctUINT32_PTR channelDataType)
{
    gceSTATUS status = gcvSTATUS_OK;

    switch(info->internalFormat)
    {
    case gcvSURF_R8G8B8:
        *channelOrder = CLK_RGB;
        *channelDataType = CLK_UNSIGNED_INT8;
        break;

    case gcvSURF_X8R8G8B8:
        *channelOrder = CLK_RGBx;
        *channelDataType = CLK_UNSIGNED_INT8;
        break;

    case gcvSURF_R8:
        *channelOrder = CLK_R;
        *channelDataType = CLK_UNSIGNED_INT8;
        break;

    case gcvSURF_R16:
        if(info->format == 0x3)
        {
            *channelOrder = CLK_R;
            *channelDataType = CLK_SIGNED_INT16;
        }
        else if(info->format == 0x6)
        {
            *channelOrder = CLK_R;
            *channelDataType = CLK_UNSIGNED_INT16;
        }
        else
        {
            status = gcvSTATUS_INVALID_ARGUMENT;
        }
        break;

    case gcvSURF_R32:
        /*if((info->format == 0x2) && (info->componentCount == 2))
        {
            *channelOrder = CLK_Rx;
            *channelDataType = CLK_UNSIGNED_INT32;
        }
        else */
        if(info->format == 0x2)
        {
            *channelOrder = CLK_R;
            *channelDataType = CLK_SIGNED_INT32;
        }
        else if(info->format == 0x5)
        {
            *channelOrder = CLK_R;
            *channelDataType = CLK_UNSIGNED_INT32;
        }
        else
        {
            status = gcvSTATUS_INVALID_ARGUMENT;
        }
        break;

    case gcvSURF_R16F:
        *channelOrder = CLK_R;
        *channelDataType = CLK_HALF_FLOAT;
        break;

    case gcvSURF_R32F:
        *channelOrder = CLK_R;
        *channelDataType = CLK_FLOAT;
        break;

    default:
        status = gcvSTATUS_INVALID_ARGUMENT;
        break;
    }

    return status;
}

gceSTATUS
gcoHARDWAREVX_SetImageInfo(
    IN gcoHARDWARE          Hardware,
    IN gctUINT32            RegAddress,
    IN gctUINT32            Physical,
    IN gcsVX_IMAGE_INFO_PTR Info
    )
{
    gceSTATUS   status = gcvSTATUS_OK;
    gctUINT32   shift, multiply, shImage, plane;
    gctUINT32   width = Info->width;
    gctUINT32   conversion = 0x7;
    gctUINT32   border = 0x1;
    gctUINT32   componentCount = 0x3;
    gctUINT32   swizzleR, swizzleG, swizzleB, swizzleA;
    gctUINT32   imageChannelDataType = 0, imageChannelOrder = 0;

    gcmHEADER_ARG("Hardware=0x%x Info=%p", Hardware, Info);

    gcmGETHARDWARE(Hardware);

    /* EVIS Image load/store doesn't need swizzle. keep the old code here */
    /* Currently 32-bit formats have to use Normal Image load/store  */
    swizzleR = 0x0;
    swizzleG = (Info->componentCount < 2) ? 0x4 : 0x1;
    swizzleB = (Info->componentCount < 3) ? 0x4 : 0x2;
    swizzleA = (Info->componentCount < 4) ? 0x4 : 0x3;

    componentCount = ((Info->componentCount == 1) ? 0x1
                        : (Info->componentCount == 2) ? 0x2
                        : (Info->componentCount == 3) ? 0x3
                        : 0x0
                        );

    conversion = Info->isFloat ? 0x0 : 0x7;

    /* Convert bits per pixel into shift/multiply pair.*/
    switch (Info->bpp)
    {
        case 8:
            /* 8 bits per pixel.*/
            shift = 0;
            multiply = 0x0;
            if (Info->format == 0x7)
            {
                conversion = 0x7;
            }
            else if (Info->format == 0x4)
            {
                conversion = 0x4;
            }

            break;

        case 16:
            /* 16 bits per pixel.*/
            shift = 1;

            if (Info->format == 0x1)
            {
                conversion = 0x1;
            }
            else if (Info->format == 0x6)
            {
                conversion = 0x6;
            }
            else if (Info->format == 0x3)
            {
                conversion = 0x3;
            }

            multiply = 0x0;
            break;

        case 24:
            /* 24 bits per pixel.*/
            shift = 0;
            multiply = 0x1;
            conversion = 0x5;
            break;

        case 32:
            if(Info->isVXC)
            {
                /* Evis image load/store cannot support 32-bit yet. Use normal image load/store. */
                shift = 2; /* Always use 4x32-bit. bpp = 16 */
                multiply = 0x0;
                conversion = Info->isFloat ? 0x0 : 0x5;
                swizzleR = 0x0;
                swizzleG = 0x1;
                swizzleB = 0x2;
                swizzleA = 0x3;
                componentCount = 0x0;
            }
            else
            {
                shift = (unsigned int)gcoMATH_Log2(4.0);
                multiply = 0x0;
                conversion = Info->format;
            }
            break;
        case 64:
            /* 64 bits per pixel.*/
            /* ToDo: Evis should not use 64 bit. Fix here */
            shift = 3;
            multiply = 0x0;
            break;

        default:
            shift = 0;
            multiply = 0x0;
            gcmONERROR(gcvSTATUS_NOT_SUPPORTED);
    }


    if (Info->isVXC)
    {
        switch(Info->format)
        {
        case 0x7:
            conversion = 0x7;
            break;
        case 0x4:
            conversion = 0x4;
            break;
        case 0x6:
            conversion = 0x6;
            break;
        case 0x3:
            conversion = 0x3;
            break;
        case 0x5:
            conversion = 0x5;
            break;
        case 0x2:
            conversion = 0x2;
            break;
        case 0x0:
            conversion = 0x0;
            break;
        case 0x1:
            conversion = 0x1;
            break;
        default:
            break;
        }
        gcmONERROR(_getCLFormatFromInternalFormat(Info, &imageChannelOrder, &imageChannelDataType));
    }

    if (Info->isVXC)
    {
        switch(Info->border)
        {
        case gcvVX_BORDER_MODE_UNDEFINED:
        case gcvVX_BORDER_MODE_CONSTANT:
            border = 0x0;
            break;
        case gcvVX_BORDER_MODE_REPLACEMENT:
            border = 0x3;
            break;
        default:
            border = 0x1;
            break;
        }
    }
    else
    {
        switch(Info->border)
        {
        case gcvVX_BORDER_MODE_UNDEFINED:
        case gcvVX_BORDER_MODE_CONSTANT:
            border = 0x0;
            break;
        case gcvVX_BORDER_MODE_REPLACEMENT:
            border = 0x3;
            break;
        default:
            border = 0x1;
            break;
        }
    }

    shImage = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 2:0) - (0 ?
 2:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 2:0) - (0 ?
 2:0) + 1))))))) << (0 ?
 2:0))) | (((gctUINT32) ((gctUINT32) (shift) & ((gctUINT32) ((((1 ?
 2:0) - (0 ?
 2:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 2:0) - (0 ? 2:0) + 1))))))) << (0 ? 2:0)))
              | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 3:3) - (0 ?
 3:3) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 3:3) - (0 ?
 3:3) + 1))))))) << (0 ?
 3:3))) | (((gctUINT32) ((gctUINT32) (multiply) & ((gctUINT32) ((((1 ?
 3:3) - (0 ?
 3:3) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 3:3) - (0 ? 3:3) + 1))))))) << (0 ? 3:3)))
              | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 5:4) - (0 ?
 5:4) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 5:4) - (0 ?
 5:4) + 1))))))) << (0 ?
 5:4))) | (((gctUINT32) ((gctUINT32) (border) & ((gctUINT32) ((((1 ?
 5:4) - (0 ?
 5:4) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 5:4) - (0 ? 5:4) + 1))))))) << (0 ? 5:4)))
              | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 9:6) - (0 ?
 9:6) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 9:6) - (0 ?
 9:6) + 1))))))) << (0 ?
 9:6))) | (((gctUINT32) ((gctUINT32) (conversion) & ((gctUINT32) ((((1 ?
 9:6) - (0 ?
 9:6) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 9:6) - (0 ? 9:6) + 1))))))) << (0 ? 9:6)))
              | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 11:10) - (0 ?
 11:10) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 11:10) - (0 ?
 11:10) + 1))))))) << (0 ?
 11:10))) | (((gctUINT32) (0x0 & ((gctUINT32) ((((1 ?
 11:10) - (0 ?
 11:10) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 11:10) - (0 ? 11:10) + 1))))))) << (0 ? 11:10)))
              | ((Info->height <= 1) ?
 ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 12:12) - (0 ?
 12:12) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 12:12) - (0 ?
 12:12) + 1))))))) << (0 ?
 12:12))) | (((gctUINT32) (0x0 & ((gctUINT32) ((((1 ?
 12:12) - (0 ?
 12:12) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 12:12) - (0 ?
 12:12) + 1))))))) << (0 ?
 12:12))) : ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 12:12) - (0 ?
 12:12) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 12:12) - (0 ?
 12:12) + 1))))))) << (0 ?
 12:12))) | (((gctUINT32) (0x1 & ((gctUINT32) ((((1 ?
 12:12) - (0 ?
 12:12) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 12:12) - (0 ? 12:12) + 1))))))) << (0 ? 12:12))))
              | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:14) - (0 ?
 15:14) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:14) - (0 ?
 15:14) + 1))))))) << (0 ?
 15:14))) | (((gctUINT32) ((gctUINT32) (componentCount) & ((gctUINT32) ((((1 ?
 15:14) - (0 ?
 15:14) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:14) - (0 ? 15:14) + 1))))))) << (0 ? 15:14)))
              | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 18:16) - (0 ?
 18:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 18:16) - (0 ?
 18:16) + 1))))))) << (0 ?
 18:16))) | (((gctUINT32) ((gctUINT32) (swizzleR) & ((gctUINT32) ((((1 ?
 18:16) - (0 ?
 18:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 18:16) - (0 ? 18:16) + 1))))))) << (0 ? 18:16)))
              | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 22:20) - (0 ?
 22:20) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 22:20) - (0 ?
 22:20) + 1))))))) << (0 ?
 22:20))) | (((gctUINT32) ((gctUINT32) (swizzleG) & ((gctUINT32) ((((1 ?
 22:20) - (0 ?
 22:20) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 22:20) - (0 ? 22:20) + 1))))))) << (0 ? 22:20)))
              | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:24) - (0 ?
 26:24) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:24) - (0 ?
 26:24) + 1))))))) << (0 ?
 26:24))) | (((gctUINT32) ((gctUINT32) (swizzleB) & ((gctUINT32) ((((1 ?
 26:24) - (0 ?
 26:24) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 26:24) - (0 ? 26:24) + 1))))))) << (0 ? 26:24)))
              | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 30:28) - (0 ?
 30:28) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 30:28) - (0 ?
 30:28) + 1))))))) << (0 ?
 30:28))) | (((gctUINT32) ((gctUINT32) (swizzleA) & ((gctUINT32) ((((1 ?
 30:28) - (0 ?
 30:28) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 30:28) - (0 ? 30:28) + 1))))))) << (0 ? 30:28)));


    if ((Info->planes == 1) && (Info->arraySize >= 1))
    {
        gctUINT32   data[8];
        gctPOINTER  dataPtr[1];

        data[0] = Info->physicals[0];
        data[1] = Info->stride[0];
        data[2] = (Info->width) | (Info->height << 16);
        data[3] = shImage;
        /* sliceSize for image2DArray/image3D*/
        data[4] = Info->sliceSize;
        /* depth/arraySize */
        data[5] = Info->arraySize;
        data[6] = (((imageChannelDataType & 0xffff) << 16) | (imageChannelOrder & 0xffff));
        data[7] = 0;
        dataPtr[0] = (gctPOINTER) data;

        /* Program the specified uniform with the descriptor. */
        gcmONERROR(gcoHARDWARE_BindUniformEx(Hardware, RegAddress,
            Physical, 4, 2, 1, gcvFALSE, 16, 0, (gctPOINTER)dataPtr, gcvUNIFORMCVT_NONE, gcSHADER_TYPE_CL, gcvFALSE));

        /* verify the input */
        gcmDUMP_BUFFER(gcvNULL,
                       gcvDUMP_BUFFER_MEMORY,
                       Info->physicals[0],
                       (gctPOINTER)(size_t)Info->logicals[0],
                       0,
                       Info->bytes * Info->arraySize);

    }
    else
    {
        for(plane = 0; plane < Info->planes; plane++)
        {
            gctUINT w, h;
            w = (plane > 0 && Info->planes == 3) ? width / Info->uPixels : width;
            h = (plane > 0 && ((Info->planes == 3) || (Info->planes == 2))) ? Info->height / Info->vPixels : Info->height;

#if gcdVX_OPTIMIZER
            Info->uniformData[plane][0] = Info->physicals[plane];
            Info->uniformData[plane][1] = Info->stride[plane];
            Info->uniformData[plane][2] = w | (h << 16);
            Info->uniformData[plane][3] = shImage;
#else
            {
                gctUINT32   data[8];
                gctPOINTER  dataPtr[1];

                data[0] = Info->physicals[plane];
                data[1] = Info->stride[plane];
                data[2] = w | (h << 16);
                data[3] = shImage;
                /* sliceSize for image2DArray/image3D*/
                data[4] = Info->sliceSize;
                /* depth/arraySize */
                data[5] = Info->arraySize;
                data[6] = (((imageChannelDataType & 0xffff) << 16) | (imageChannelOrder & 0xffff));
                data[7] = 0;
                dataPtr[0] = (gctPOINTER) data;

                /* Program the specified uniform with the descriptor. */
                gcmONERROR(gcoHARDWARE_BindUniformEx(Hardware, RegAddress,
                    Physical, 4, 2, 1, gcvFALSE, 16, 0, (gctPOINTER) dataPtr, gcvUNIFORMCVT_NONE, gcSHADER_TYPE_CL, gcvFALSE));
            }
#endif

            /* verify the input */
            gcmDUMP_BUFFER(gcvNULL,
                           gcvDUMP_BUFFER_MEMORY,
                           Info->physicals[plane],
                           (gctPOINTER)(size_t)Info->logicals[plane],
                           0,
                           Info->bytes);
        }
    }

    /* Success. */
    status = gcvSTATUS_OK;

OnError:
    gcmFOOTER_ARG("%d", status);
    return status;
}

gceSTATUS
gcoHARDWAREVX_BindImage(
    IN gcoHARDWARE          Hardware,
    IN gctUINT32            Index,
    IN gcsVX_IMAGE_INFO_PTR Info
    )
{
    gceSTATUS   status = gcvSTATUS_OK;
    gctUINT32   shift, multiply, shImage, plane;
    gctUINT32   width = Info->width;
    gctUINT32   conversion = 0x7;
    gctUINT32   border = 0x1;
    gctUINT32   componentCount = 0x3;
    gctUINT32   swizzleR, swizzleG, swizzleB, swizzleA;
    gctUINT32   imageChannelDataType = 0, imageChannelOrder = 0;

    gcmHEADER_ARG("Hardware=0x%x Info=%p", Hardware, Info);

    gcmGETHARDWARE(Hardware);

    /* EVIS Image load/store doesn't need swizzle. keep the old code here */
    /* Currently 32-bit formats have to use Normal Image load/store  */
    swizzleR = 0x0;
    swizzleG = (Info->componentCount < 2) ? 0x4 : 0x1;
    swizzleB = (Info->componentCount < 3) ? 0x4 : 0x2;
    swizzleA = (Info->componentCount < 4) ? 0x4 : 0x3;

    componentCount = ((Info->componentCount == 1) ? 0x1
                        : (Info->componentCount == 2) ? 0x2
                        : (Info->componentCount == 3) ? 0x3
                        : 0x0
                        );

    conversion = Info->isFloat ? 0x0 : 0x7;

    /* Convert bits per pixel into shift/multiply pair.*/
    switch (Info->bpp)
    {
        case 8:
            /* 8 bits per pixel.*/
            shift = 0;
            multiply = 0x0;
            break;

        case 16:
            /* 16 bits per pixel.*/
            shift = 1;
            conversion = Info->isFloat ? 0x1 : 0x6;
            multiply = 0x0;
            break;

        case 24:
            /* 24 bits per pixel.*/
            shift = 0;
            multiply = 0x1;
            conversion = 0x5;
            break;

        case 32:
            /* Evis image load/store cannot support 32-bit yet. Use normal image load/store. */
            shift = 2; /* Always use 4x32-bit. bpp = 16 */
            multiply = 0x0;
            conversion = Info->isFloat ? 0x0 : 0x5;
            swizzleR = 0x0;
            swizzleG = 0x1;
            swizzleB = 0x2;
            swizzleA = 0x3;
            componentCount = 0x0;
            break;
        case 64:
            /* 64 bits per pixel.*/
            /* ToDo: Evis should not use 64 bit. Fix here */
            shift = 3;
            multiply = 0x0;
            break;

        default:
            shift = 0;
            multiply = 0x0;
            gcmONERROR(gcvSTATUS_NOT_SUPPORTED);
    }


    if (Info->isVXC)
    {
        switch(Info->format)
        {
        case 0x7:
            conversion = 0x7;
            break;
        case 0x4:
            conversion = 0x4;
            break;
        case 0x6:
            conversion = 0x6;
            break;
        case 0x3:
            conversion = 0x3;
            break;
        case 0x5:
            conversion = 0x5;
            break;
        case 0x2:
            conversion = 0x2;
            break;
        case 0x0:
            conversion = 0x0;
            break;
        case 0x1:
            conversion = 0x1;
            break;
        default:
            break;
        }

        gcmONERROR(_getCLFormatFromInternalFormat(Info, &imageChannelOrder, &imageChannelDataType));
    }

    switch(Info->border)
    {
    case gcvVX_BORDER_MODE_UNDEFINED:
    case gcvVX_BORDER_MODE_CONSTANT:
        border = 0x0;
        break;
    case gcvVX_BORDER_MODE_REPLACEMENT:
        border = 0x3;
        break;
    default:
        border = 0x1;
        break;
    }

    shImage = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 2:0) - (0 ?
 2:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 2:0) - (0 ?
 2:0) + 1))))))) << (0 ?
 2:0))) | (((gctUINT32) ((gctUINT32) (shift) & ((gctUINT32) ((((1 ?
 2:0) - (0 ?
 2:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 2:0) - (0 ? 2:0) + 1))))))) << (0 ? 2:0)))
              | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 3:3) - (0 ?
 3:3) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 3:3) - (0 ?
 3:3) + 1))))))) << (0 ?
 3:3))) | (((gctUINT32) ((gctUINT32) (multiply) & ((gctUINT32) ((((1 ?
 3:3) - (0 ?
 3:3) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 3:3) - (0 ? 3:3) + 1))))))) << (0 ? 3:3)))
              | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 5:4) - (0 ?
 5:4) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 5:4) - (0 ?
 5:4) + 1))))))) << (0 ?
 5:4))) | (((gctUINT32) ((gctUINT32) (border) & ((gctUINT32) ((((1 ?
 5:4) - (0 ?
 5:4) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 5:4) - (0 ? 5:4) + 1))))))) << (0 ? 5:4)))
              | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 9:6) - (0 ?
 9:6) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 9:6) - (0 ?
 9:6) + 1))))))) << (0 ?
 9:6))) | (((gctUINT32) ((gctUINT32) (conversion) & ((gctUINT32) ((((1 ?
 9:6) - (0 ?
 9:6) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 9:6) - (0 ? 9:6) + 1))))))) << (0 ? 9:6)))
              | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 11:10) - (0 ?
 11:10) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 11:10) - (0 ?
 11:10) + 1))))))) << (0 ?
 11:10))) | (((gctUINT32) (0x0 & ((gctUINT32) ((((1 ?
 11:10) - (0 ?
 11:10) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 11:10) - (0 ? 11:10) + 1))))))) << (0 ? 11:10)))
              | ((Info->height <= 1) ?
 ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 12:12) - (0 ?
 12:12) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 12:12) - (0 ?
 12:12) + 1))))))) << (0 ?
 12:12))) | (((gctUINT32) (0x0 & ((gctUINT32) ((((1 ?
 12:12) - (0 ?
 12:12) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 12:12) - (0 ?
 12:12) + 1))))))) << (0 ?
 12:12))) : ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 12:12) - (0 ?
 12:12) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 12:12) - (0 ?
 12:12) + 1))))))) << (0 ?
 12:12))) | (((gctUINT32) (0x1 & ((gctUINT32) ((((1 ?
 12:12) - (0 ?
 12:12) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 12:12) - (0 ? 12:12) + 1))))))) << (0 ? 12:12))))
              | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:14) - (0 ?
 15:14) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:14) - (0 ?
 15:14) + 1))))))) << (0 ?
 15:14))) | (((gctUINT32) ((gctUINT32) (componentCount) & ((gctUINT32) ((((1 ?
 15:14) - (0 ?
 15:14) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:14) - (0 ? 15:14) + 1))))))) << (0 ? 15:14)))
              | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 18:16) - (0 ?
 18:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 18:16) - (0 ?
 18:16) + 1))))))) << (0 ?
 18:16))) | (((gctUINT32) ((gctUINT32) (swizzleR) & ((gctUINT32) ((((1 ?
 18:16) - (0 ?
 18:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 18:16) - (0 ? 18:16) + 1))))))) << (0 ? 18:16)))
              | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 22:20) - (0 ?
 22:20) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 22:20) - (0 ?
 22:20) + 1))))))) << (0 ?
 22:20))) | (((gctUINT32) ((gctUINT32) (swizzleG) & ((gctUINT32) ((((1 ?
 22:20) - (0 ?
 22:20) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 22:20) - (0 ? 22:20) + 1))))))) << (0 ? 22:20)))
              | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:24) - (0 ?
 26:24) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:24) - (0 ?
 26:24) + 1))))))) << (0 ?
 26:24))) | (((gctUINT32) ((gctUINT32) (swizzleB) & ((gctUINT32) ((((1 ?
 26:24) - (0 ?
 26:24) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 26:24) - (0 ? 26:24) + 1))))))) << (0 ? 26:24)))
              | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 30:28) - (0 ?
 30:28) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 30:28) - (0 ?
 30:28) + 1))))))) << (0 ?
 30:28))) | (((gctUINT32) ((gctUINT32) (swizzleA) & ((gctUINT32) ((((1 ?
 30:28) - (0 ?
 30:28) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 30:28) - (0 ? 30:28) + 1))))))) << (0 ? 30:28)));


    if ((Info->planes == 1) && (Info->arraySize >= 1))
    {
        gctUINT32   data[8];
        data[0] = Info->physicals[0];
        data[1] = Info->stride[0];
        data[2] = (Info->width) | (Info->height << 16);
        data[3] = shImage;

        /* sliceSize for image2DArray/image3D*/
        data[4] = Info->sliceSize;
        /* depth/arraySize */
        data[5] = Info->arraySize;
        data[6] = (((imageChannelDataType & 0xffff) << 16) | (imageChannelOrder & 0xffff));
        data[7] = 0;

        /* Program the specified uniform with the descriptor. */
        gcmONERROR(gcoHARDWARE_LoadState(Hardware,
                                        0x36000 + Index * 4 * 4, 8, data));

        /* verify the input */
        gcmDUMP_BUFFER(gcvNULL,
                       gcvDUMP_BUFFER_MEMORY,
                       Info->physicals[0],
                       (gctPOINTER)(size_t)Info->logicals[0],
                       0,
                       Info->bytes);

    }
    else
    {
        for(plane = 0; plane < Info->planes; plane++)
        {
            gctUINT w, h;
            w = (plane > 0 && Info->planes == 3) ? width / Info->uPixels : width;
            h = (plane > 0 && ((Info->planes == 3) || (Info->planes == 2))) ? Info->height / Info->vPixels : Info->height;

#if gcdVX_OPTIMIZER
            Info->uniformData[plane][0] = Info->physicals[plane];
            Info->uniformData[plane][1] = Info->stride[plane];
            Info->uniformData[plane][2] = w | (h << 16);
            Info->uniformData[plane][3] = shImage;
#else
            {
                gctUINT32   data[8];
                data[0] = Info->physicals[plane];
                data[1] = Info->stride[plane];
                data[2] = w | (h << 16);
                data[3] = shImage;
                /* sliceSize for image2DArray/image3D*/
                data[4] = Info->sliceSize;
                /* depth/arraySize */
                data[5] = Info->arraySize;
                data[6] = (((imageChannelDataType & 0xffff) << 16) | (imageChannelOrder & 0xffff));
                data[7] = 0;

                /* Program the specified uniform with the descriptor. */
                gcmONERROR(gcoHARDWARE_LoadState(Hardware,
                                                 0x36000 + (Index + plane) * 4 * 4, 8, data));
            }
#endif

            /* verify the input */
            gcmDUMP_BUFFER(gcvNULL,
                           gcvDUMP_BUFFER_MEMORY,
                           Info->physicals[plane],
                           (gctPOINTER)(size_t)Info->logicals[plane],
                           0,
                           Info->bytes);
        }
    }

    /* Success. */
    status = gcvSTATUS_OK;

OnError:
    gcmFOOTER_ARG("%d", status);
    return status;
}

gceSTATUS
gcoHARDWAREVX_BindUniform(
    IN gcoHARDWARE          Hardware,
    IN gctUINT32            RegAddress,
    IN gctUINT32            Index,
    IN gctUINT32*           Value,
    IN gctUINT32            Num
    )
{
    gceSTATUS   status = gcvSTATUS_OK;

    gcmHEADER_ARG("Hardware=0x%x Value=%p", Hardware, Value);

    gcmGETHARDWARE(Hardware);
    /* 0x34000 : 0x34000
     * 0x30000    : 0x30000
     * 0x36000 : 0x36000
     */

    gcmONERROR(gcoHARDWARE_LoadState(Hardware,
                                 RegAddress + Index * 4 * 4, Num, Value));

OnError:
    gcmFOOTER_ARG("%d", status);
    return status;
}

gceSTATUS
gcoHARDWAREVX_InvokeThreadWalker(
    IN gcoHARDWARE                          Hardware,
    IN gcsVX_THREAD_WALKER_PARAMETERS_PTR   Parameters
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gctPOINTER *cmdBuffer = gcvNULL;
    gctUINT localMemSizeInByte = 0;

    /* Define state buffer variables. */
    gcmDEFINESTATEBUFFER_NEW(reserve, stateDelta, memory);

    gcmHEADER_ARG("Hardware=0x%x Parameters=0x%x", Hardware, Parameters);

    gcmGETHARDWARE(Hardware);

    gcmBEGINSTATEBUFFER_NEW(Hardware, reserve, stateDelta, memory, cmdBuffer);

    cmdBuffer = (gctPOINTER *)&memory;

    /* Switch to the 3D pipe. */
    gcmONERROR(gcoHARDWARE_SelectPipe(gcvNULL, gcvPIPE_3D, cmdBuffer));

    if (Hardware->SHDirty->shaderDirty)
    {
        /* Flush shader states. */
        gcmONERROR(gcoHARDWARE_FlushShaders(Hardware, gcvPRIMITIVE_TRIANGLE_LIST, cmdBuffer));
    }

    if (Hardware->features[gcvFEATURE_SH_INSTRUCTION_PREFETCH])
    {
        gcmONERROR(gcoHARDWARE_FlushPrefetchInst(Hardware, cmdBuffer));
    }

    cmdBuffer = gcvNULL;

    /*if (Hardware->features[gcvFEATURE_SHADER_ENHANCEMENTS2])*/
    {
        {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x0240) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x0240, ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 1:0) - (0 ?
 1:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 1:0) - (0 ?
 1:0) + 1))))))) << (0 ?
 1:0))) | (((gctUINT32) ((gctUINT32) (Parameters->workDim) & ((gctUINT32) ((((1 ?
 1:0) - (0 ?
 1:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 1:0) - (0 ?
 1:0) + 1))))))) << (0 ?
 1:0))) | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 6:4) - (0 ?
 6:4) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 6:4) - (0 ?
 6:4) + 1))))))) << (0 ?
 6:4))) | (((gctUINT32) (0x0 & ((gctUINT32) ((((1 ?
 6:4) - (0 ?
 6:4) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 6:4) - (0 ?
 6:4) + 1))))))) << (0 ?
 6:4))) | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:24) - (0 ?
 26:24) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:24) - (0 ?
 26:24) + 1))))))) << (0 ?
 26:24))) | (((gctUINT32) ((gctUINT32) (Parameters->valueOrder) & ((gctUINT32) ((((1 ?
 26:24) - (0 ?
 26:24) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 26:24) - (0 ? 26:24) + 1))))))) << (0 ? 26:24))) );    gcmENDSTATEBATCH_NEW(reserve, memory);
};


        if (Hardware->features[gcvFEATURE_PSCS_THROTTLE] && Hardware->SHStates->programState.hints)
        {
            localMemSizeInByte = gcmCEIL((gctFLOAT)Hardware->SHStates->programState.hints->localMemSizeInByte  / 16.0);
        }

        {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x0249) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x0249, ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (localMemSizeInByte) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0))) );    gcmENDSTATEBATCH_NEW(reserve, memory);
};


        {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x0247) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x0247, gcmCEIL((gctFLOAT)(Parameters->workGroupSizeX * Parameters->workGroupSizeY) / (Hardware->config->shaderCoreCount * 4)) );
    gcmENDSTATEBATCH_NEW(reserve, memory);
};


        {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)2  <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (2 ) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x0250) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};


        gcmSETSTATEDATA_NEW(
            stateDelta, reserve, memory, gcvFALSE, 0x0250,
              /*gcmSETFIELD(0, GCREG_TW_WORK_GROUP_COUNT_X, COUNT, Parameters->workGroupCountX - 1)*/
              Parameters->workGroupCountX - 1
            );

        gcmSETSTATEDATA_NEW(
            stateDelta, reserve, memory, gcvFALSE, 0x0251,
              /*gcmSETFIELD(0, GCREG_TW_WORK_GROUP_COUNT_X, COUNT, Parameters->workGroupCountY - 1)*/
              Parameters->workGroupCountY - 1
            );

        gcmSETFILLER_NEW(
            reserve, memory
            );

        gcmENDSTATEBATCH_NEW(
            reserve, memory
            );

        {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x0253) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x0253, ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 9:0) - (0 ?
 9:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 9:0) - (0 ?
 9:0) + 1))))))) << (0 ?
 9:0))) | (((gctUINT32) ((gctUINT32) (Parameters->workGroupSizeX - 1) & ((gctUINT32) ((((1 ?
 9:0) - (0 ?
 9:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 9:0) - (0 ? 9:0) + 1))))))) << (0 ? 9:0))) );    gcmENDSTATEBATCH_NEW(reserve, memory);
};


        {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x0254) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x0254, ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 9:0) - (0 ?
 9:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 9:0) - (0 ?
 9:0) + 1))))))) << (0 ?
 9:0))) | (((gctUINT32) ((gctUINT32) (Parameters->workGroupSizeY - 1) & ((gctUINT32) ((((1 ?
 9:0) - (0 ?
 9:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 9:0) - (0 ? 9:0) + 1))))))) << (0 ? 9:0))) );    gcmENDSTATEBATCH_NEW(reserve, memory);
};


        {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x024B) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x024B, Parameters->globalOffsetX );
    gcmENDSTATEBATCH_NEW(reserve, memory);
};


        {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x024D) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x024D, Parameters->globalOffsetY );
    gcmENDSTATEBATCH_NEW(reserve, memory);
};


        {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x0256) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x0256, ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 7:0) - (0 ?
 7:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 7:0) - (0 ?
 7:0) + 1))))))) << (0 ?
 7:0))) | (((gctUINT32) ((gctUINT32) (Parameters->globalScaleX) & ((gctUINT32) ((((1 ?
 7:0) - (0 ?
 7:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 7:0) - (0 ? 7:0) + 1))))))) << (0 ? 7:0))) );    gcmENDSTATEBATCH_NEW(reserve, memory);
};


        {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x0257) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x0257, ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 7:0) - (0 ?
 7:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 7:0) - (0 ?
 7:0) + 1))))))) << (0 ?
 7:0))) | (((gctUINT32) ((gctUINT32) (Parameters->globalScaleY) & ((gctUINT32) ((((1 ?
 7:0) - (0 ?
 7:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 7:0) - (0 ? 7:0) + 1))))))) << (0 ? 7:0))) );    gcmENDSTATEBATCH_NEW(reserve, memory);
};

    }

    {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x0248) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x0248, 0xBADABEEB );
    gcmENDSTATEBATCH_NEW(reserve, memory);
};


    if (Hardware->features[gcvFEATURE_MCFE])
    {
        /* SubmitJob. */
        *memory++ = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x16 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 31:27) - (0 ? 31:27) + 1))))))) << (0 ? 31:27)))
                  | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) (0x001 & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 25:16) - (0 ? 25:16) + 1))))))) << (0 ? 25:16)));

        *memory++ = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x03 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 31:27) - (0 ? 31:27) + 1))))))) << (0 ? 31:27)));
    }

    /* Validate the state buffer. */
    gcmENDSTATEBUFFER_NEW(Hardware, reserve, memory, cmdBuffer);

#if gcdVX_OPTIMIZER > 1
    if (! Parameters->tileMode)
    {
        /* Flush Pixel Shader L1 cache only, and no semaphore stall. */
        gcmONERROR(gcoHARDWARE_LoadCtrlState(
            Hardware,
            0x0380C,
            ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 11:11) - (0 ?
 11:11) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 11:11) - (0 ?
 11:11) + 1))))))) << (0 ?
 11:11))) | (((gctUINT32) (0x1 & ((gctUINT32) ((((1 ?
 11:11) - (0 ?
 11:11) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 11:11) - (0 ? 11:11) + 1))))))) << (0 ? 11:11)))
            ));

        if (Hardware->features[gcvFEATURE_MCFE])
        {
            /* SubmitJob is pared with the complete signal from FlushCache. */
            gcoHARDWARE_McfeSubmitJob(Hardware, gcvNULL);
        }
    }
#else
    /* Flush the Shader L1 cache. */
    if (!Hardware->config->parallelNoFix || !Hardware->options.enableNNTPParallel || Hardware->options.enableSwtilingPhase1)
    {
        gcmONERROR(gcoHARDWARE_LoadCtrlState(
            Hardware,
            0x0380C,
                ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 5:5) - (0 ?
 5:5) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 5:5) - (0 ?
 5:5) + 1))))))) << (0 ?
 5:5))) | (((gctUINT32) (0x1 & ((gctUINT32) ((((1 ?
 5:5) - (0 ?
 5:5) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 5:5) - (0 ? 5:5) + 1))))))) << (0 ? 5:5)))
            ));
    }
    else
    {
        gcmONERROR(gcoHARDWARE_LoadCtrlState(
            Hardware,
            0x0380C,
                ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 5:5) - (0 ?
 5:5) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 5:5) - (0 ?
 5:5) + 1))))))) << (0 ?
 5:5))) | (((gctUINT32) (0x0 & ((gctUINT32) ((((1 ?
 5:5) - (0 ?
 5:5) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 5:5) - (0 ? 5:5) + 1))))))) << (0 ? 5:5)))
            ));
    }

    if (Hardware->features[gcvFEATURE_MCFE])
    {
        /* SubmitJob is pared with the complete signal from FlushCache. */
        gcoHARDWARE_McfeSubmitJob(Hardware, gcvNULL);
    }

    /* Add FE - PE samaphore stall to prevent unwanted SHL1_CACHE flush. */
    gcmONERROR(gcoHARDWARE_Semaphore(
        Hardware, gcvWHERE_COMMAND, gcvWHERE_PIXEL, gcvHOW_SEMAPHORE_STALL, gcvNULL));
#endif

OnError:
    /* Return the status. */
    gcmFOOTER();
    return status;
}


gceSTATUS
gcoHARDWAREVX_SetImmediate(
    IN gctUINT32                            Where,
    IN gctUINT32                            Value,
    IN gctUINT32                            Type,
    OUT gcoVX_Instruction                   *Instruction
    )
{
    gceSTATUS status = gcvSTATUS_OK;

    gcmHEADER_ARG("Where=0x%x", Where);

    switch (Where)
    {
        case 0:
            Instruction->binary[1] = (((gctUINT32)(Instruction->binary[1]) & ~((gctUINT32)(((((1 ?
 20:12) - (0 ?
 20:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 20:12) - (0 ?
 20:12) + 1))))) << (0 ?
 20:12))) | ((gctUINT32)((gctUINT32)(GETBITS(Value, 8, 0)) & ((((1 ?
 20:12) - (0 ?
 20:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 20:12) - (0 ? 20:12) + 1))))) << (0 ? 20:12)));
            Instruction->binary[1] = (((gctUINT32)(Instruction->binary[1]) & ~((gctUINT32)(((((1 ?
 29:22) - (0 ?
 29:22) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 29:22) - (0 ?
 29:22) + 1))))) << (0 ?
 29:22))) | ((gctUINT32)((gctUINT32)(GETBITS(Value, 16, 9)) & ((((1 ?
 29:22) - (0 ?
 29:22) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 29:22) - (0 ? 29:22) + 1))))) << (0 ? 29:22)));
            Instruction->binary[1] = (((gctUINT32)(Instruction->binary[1]) & ~((gctUINT32)(((((1 ?
 30:30) - (0 ?
 30:30) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 30:30) - (0 ?
 30:30) + 1))))) << (0 ?
 30:30))) | ((gctUINT32)((gctUINT32)(GETBIT(Value, 17)) & ((((1 ?
 30:30) - (0 ?
 30:30) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 30:30) - (0 ? 30:30) + 1))))) << (0 ? 30:30)));
            Instruction->binary[1] = (((gctUINT32)(Instruction->binary[1]) & ~((gctUINT32)(((((1 ?
 31:31) - (0 ?
 31:31) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:31) - (0 ?
 31:31) + 1))))) << (0 ?
 31:31))) | ((gctUINT32)((gctUINT32)(GETBIT(Value, 18)) & ((((1 ?
 31:31) - (0 ?
 31:31) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:31) - (0 ? 31:31) + 1))))) << (0 ? 31:31)));
            Instruction->binary[2] = (((gctUINT32)(Instruction->binary[2]) & ~((gctUINT32)(((((1 ?
 2:0) - (0 ?
 2:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 2:0) - (0 ?
 2:0) + 1))))) << (0 ?
 2:0))) | ((gctUINT32)((gctUINT32)(GETBIT(Value, 19) | (Type << 1)) & ((((1 ?
 2:0) - (0 ?
 2:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 2:0) - (0 ? 2:0) + 1))))) << (0 ? 2:0)));
            Instruction->binary[2] = (((gctUINT32)(Instruction->binary[2]) & ~((gctUINT32)(((((1 ?
 5:3) - (0 ?
 5:3) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 5:3) - (0 ?
 5:3) + 1))))) << (0 ?
 5:3))) | ((gctUINT32)((gctUINT32)(0x7) & ((((1 ?
 5:3) - (0 ?
 5:3) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 5:3) - (0 ? 5:3) + 1))))) << (0 ? 5:3)));
            break;

        case 1:
            Instruction->binary[2] = (((gctUINT32)(Instruction->binary[2]) & ~((gctUINT32)(((((1 ?
 15:7) - (0 ?
 15:7) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:7) - (0 ?
 15:7) + 1))))) << (0 ?
 15:7))) | ((gctUINT32)((gctUINT32)(GETBITS(Value, 8, 0)) & ((((1 ?
 15:7) - (0 ?
 15:7) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:7) - (0 ? 15:7) + 1))))) << (0 ? 15:7)));
            Instruction->binary[2] = (((gctUINT32)(Instruction->binary[2]) & ~((gctUINT32)(((((1 ?
 24:17) - (0 ?
 24:17) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 24:17) - (0 ?
 24:17) + 1))))) << (0 ?
 24:17))) | ((gctUINT32)((gctUINT32)(GETBITS(Value, 16, 9)) & ((((1 ?
 24:17) - (0 ?
 24:17) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 24:17) - (0 ? 24:17) + 1))))) << (0 ? 24:17)));
            Instruction->binary[2] = (((gctUINT32)(Instruction->binary[2]) & ~((gctUINT32)(((((1 ?
 25:25) - (0 ?
 25:25) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 25:25) - (0 ?
 25:25) + 1))))) << (0 ?
 25:25))) | ((gctUINT32)((gctUINT32)(GETBIT(Value, 17)) & ((((1 ?
 25:25) - (0 ?
 25:25) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 25:25) - (0 ? 25:25) + 1))))) << (0 ? 25:25)));
            Instruction->binary[2] = (((gctUINT32)(Instruction->binary[2]) & ~((gctUINT32)(((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))) << (0 ?
 26:26))) | ((gctUINT32)((gctUINT32)(GETBIT(Value, 18)) & ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 26:26) - (0 ? 26:26) + 1))))) << (0 ? 26:26)));
            Instruction->binary[2] = (((gctUINT32)(Instruction->binary[2]) & ~((gctUINT32)(((((1 ?
 29:27) - (0 ?
 29:27) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 29:27) - (0 ?
 29:27) + 1))))) << (0 ?
 29:27))) | ((gctUINT32)((gctUINT32)(GETBIT(Value, 19) | (Type << 1)) & ((((1 ?
 29:27) - (0 ?
 29:27) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 29:27) - (0 ? 29:27) + 1))))) << (0 ? 29:27)));
            Instruction->binary[3] = (((gctUINT32)(Instruction->binary[3]) & ~((gctUINT32)(((((1 ?
 2:0) - (0 ?
 2:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 2:0) - (0 ?
 2:0) + 1))))) << (0 ?
 2:0))) | ((gctUINT32)((gctUINT32)(0x7) & ((((1 ?
 2:0) - (0 ?
 2:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 2:0) - (0 ? 2:0) + 1))))) << (0 ? 2:0)));
            break;

        case 2:
            Instruction->binary[3] = (((gctUINT32)(Instruction->binary[3]) & ~((gctUINT32)(((((1 ?
 12:4) - (0 ?
 12:4) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 12:4) - (0 ?
 12:4) + 1))))) << (0 ?
 12:4))) | ((gctUINT32)((gctUINT32)(GETBITS(Value, 8, 0)) & ((((1 ?
 12:4) - (0 ?
 12:4) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 12:4) - (0 ? 12:4) + 1))))) << (0 ? 12:4)));
            Instruction->binary[3] = (((gctUINT32)(Instruction->binary[3]) & ~((gctUINT32)(((((1 ?
 21:14) - (0 ?
 21:14) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 21:14) - (0 ?
 21:14) + 1))))) << (0 ?
 21:14))) | ((gctUINT32)((gctUINT32)(GETBITS(Value, 16, 9)) & ((((1 ?
 21:14) - (0 ?
 21:14) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 21:14) - (0 ? 21:14) + 1))))) << (0 ? 21:14)));
            Instruction->binary[3] = (((gctUINT32)(Instruction->binary[3]) & ~((gctUINT32)(((((1 ?
 22:22) - (0 ?
 22:22) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 22:22) - (0 ?
 22:22) + 1))))) << (0 ?
 22:22))) | ((gctUINT32)((gctUINT32)(GETBIT(Value, 17)) & ((((1 ?
 22:22) - (0 ?
 22:22) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 22:22) - (0 ? 22:22) + 1))))) << (0 ? 22:22)));
            Instruction->binary[3] = (((gctUINT32)(Instruction->binary[3]) & ~((gctUINT32)(((((1 ?
 23:23) - (0 ?
 23:23) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 23:23) - (0 ?
 23:23) + 1))))) << (0 ?
 23:23))) | ((gctUINT32)((gctUINT32)(GETBIT(Value, 18)) & ((((1 ?
 23:23) - (0 ?
 23:23) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 23:23) - (0 ? 23:23) + 1))))) << (0 ? 23:23)));
            Instruction->binary[3] = (((gctUINT32)(Instruction->binary[3]) & ~((gctUINT32)(((((1 ?
 27:25) - (0 ?
 27:25) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 27:25) - (0 ?
 27:25) + 1))))) << (0 ?
 27:25))) | ((gctUINT32)((gctUINT32)(GETBIT(Value, 19) | (Type << 1)) & ((((1 ?
 27:25) - (0 ?
 27:25) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 27:25) - (0 ? 27:25) + 1))))) << (0 ? 27:25)));
            Instruction->binary[3] = (((gctUINT32)(Instruction->binary[3]) & ~((gctUINT32)(((((1 ?
 30:28) - (0 ?
 30:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 30:28) - (0 ?
 30:28) + 1))))) << (0 ?
 30:28))) | ((gctUINT32)((gctUINT32)(0x7) & ((((1 ?
 30:28) - (0 ?
 30:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 30:28) - (0 ? 30:28) + 1))))) << (0 ? 30:28)));
            break;
    }

    gcmFOOTER();
    return status;
}

gceSTATUS
gcoHARDWAREVX_SetSource(
    IN gctUINT32                            Where,
    IN gctUINT32                            Address,
    IN gctUINT32                            Swizzle,
    IN gctUINT32                            Type,
    IN gctBOOL                              Negate,
    IN gctBOOL                              Absolute,
    IN gctUINT32                            Relative,
    OUT gcoVX_Instruction                   *Instruction
    )
{
    gceSTATUS status = gcvSTATUS_OK;

    gcmHEADER_ARG("Where=0x%x", Where);

    switch (Where)
    {
        case 0:
            Instruction->binary[1] = (((gctUINT32)(Instruction->binary[1]) & ~((gctUINT32)(((((1 ?
 11:11) - (0 ?
 11:11) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 11:11) - (0 ?
 11:11) + 1))))) << (0 ?
 11:11))) | ((gctUINT32)((gctUINT32)(1) & ((((1 ?
 11:11) - (0 ?
 11:11) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 11:11) - (0 ? 11:11) + 1))))) << (0 ? 11:11)));
            Instruction->binary[1] = (((gctUINT32)(Instruction->binary[1]) & ~((gctUINT32)(((((1 ?
 20:12) - (0 ?
 20:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 20:12) - (0 ?
 20:12) + 1))))) << (0 ?
 20:12))) | ((gctUINT32)((gctUINT32)(Address) & ((((1 ?
 20:12) - (0 ?
 20:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 20:12) - (0 ? 20:12) + 1))))) << (0 ? 20:12)));
            Instruction->binary[1] = (((gctUINT32)(Instruction->binary[1]) & ~((gctUINT32)(((((1 ?
 29:22) - (0 ?
 29:22) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 29:22) - (0 ?
 29:22) + 1))))) << (0 ?
 29:22))) | ((gctUINT32)((gctUINT32)(Swizzle) & ((((1 ?
 29:22) - (0 ?
 29:22) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 29:22) - (0 ? 29:22) + 1))))) << (0 ? 29:22)));
            Instruction->binary[1] = (((gctUINT32)(Instruction->binary[1]) & ~((gctUINT32)(((((1 ?
 30:30) - (0 ?
 30:30) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 30:30) - (0 ?
 30:30) + 1))))) << (0 ?
 30:30))) | ((gctUINT32)((gctUINT32)(Negate) & ((((1 ?
 30:30) - (0 ?
 30:30) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 30:30) - (0 ? 30:30) + 1))))) << (0 ? 30:30)));
            Instruction->binary[1] = (((gctUINT32)(Instruction->binary[1]) & ~((gctUINT32)(((((1 ?
 31:31) - (0 ?
 31:31) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:31) - (0 ?
 31:31) + 1))))) << (0 ?
 31:31))) | ((gctUINT32)((gctUINT32)(Absolute) & ((((1 ?
 31:31) - (0 ?
 31:31) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:31) - (0 ? 31:31) + 1))))) << (0 ? 31:31)));
            Instruction->binary[2] = (((gctUINT32)(Instruction->binary[2]) & ~((gctUINT32)(((((1 ?
 2:0) - (0 ?
 2:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 2:0) - (0 ?
 2:0) + 1))))) << (0 ?
 2:0))) | ((gctUINT32)((gctUINT32)(Relative) & ((((1 ?
 2:0) - (0 ?
 2:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 2:0) - (0 ? 2:0) + 1))))) << (0 ? 2:0)));
            Instruction->binary[2] = (((gctUINT32)(Instruction->binary[2]) & ~((gctUINT32)(((((1 ?
 5:3) - (0 ?
 5:3) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 5:3) - (0 ?
 5:3) + 1))))) << (0 ?
 5:3))) | ((gctUINT32)((gctUINT32)(Type) & ((((1 ?
 5:3) - (0 ?
 5:3) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 5:3) - (0 ? 5:3) + 1))))) << (0 ? 5:3)));
            break;

        case 1:
            Instruction->binary[2] = (((gctUINT32)(Instruction->binary[2]) & ~((gctUINT32)(((((1 ?
 6:6) - (0 ?
 6:6) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 6:6) - (0 ?
 6:6) + 1))))) << (0 ?
 6:6))) | ((gctUINT32)((gctUINT32)(1) & ((((1 ?
 6:6) - (0 ?
 6:6) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 6:6) - (0 ? 6:6) + 1))))) << (0 ? 6:6)));
            Instruction->binary[2] = (((gctUINT32)(Instruction->binary[2]) & ~((gctUINT32)(((((1 ?
 15:7) - (0 ?
 15:7) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:7) - (0 ?
 15:7) + 1))))) << (0 ?
 15:7))) | ((gctUINT32)((gctUINT32)(Address) & ((((1 ?
 15:7) - (0 ?
 15:7) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:7) - (0 ? 15:7) + 1))))) << (0 ? 15:7)));
            Instruction->binary[2] = (((gctUINT32)(Instruction->binary[2]) & ~((gctUINT32)(((((1 ?
 24:17) - (0 ?
 24:17) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 24:17) - (0 ?
 24:17) + 1))))) << (0 ?
 24:17))) | ((gctUINT32)((gctUINT32)(Swizzle) & ((((1 ?
 24:17) - (0 ?
 24:17) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 24:17) - (0 ? 24:17) + 1))))) << (0 ? 24:17)));
            Instruction->binary[2] = (((gctUINT32)(Instruction->binary[2]) & ~((gctUINT32)(((((1 ?
 25:25) - (0 ?
 25:25) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 25:25) - (0 ?
 25:25) + 1))))) << (0 ?
 25:25))) | ((gctUINT32)((gctUINT32)(Negate) & ((((1 ?
 25:25) - (0 ?
 25:25) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 25:25) - (0 ? 25:25) + 1))))) << (0 ? 25:25)));
            Instruction->binary[2] = (((gctUINT32)(Instruction->binary[2]) & ~((gctUINT32)(((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))) << (0 ?
 26:26))) | ((gctUINT32)((gctUINT32)(Absolute) & ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 26:26) - (0 ? 26:26) + 1))))) << (0 ? 26:26)));
            Instruction->binary[2] = (((gctUINT32)(Instruction->binary[2]) & ~((gctUINT32)(((((1 ?
 29:27) - (0 ?
 29:27) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 29:27) - (0 ?
 29:27) + 1))))) << (0 ?
 29:27))) | ((gctUINT32)((gctUINT32)(Relative) & ((((1 ?
 29:27) - (0 ?
 29:27) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 29:27) - (0 ? 29:27) + 1))))) << (0 ? 29:27)));
            Instruction->binary[3] = (((gctUINT32)(Instruction->binary[3]) & ~((gctUINT32)(((((1 ?
 2:0) - (0 ?
 2:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 2:0) - (0 ?
 2:0) + 1))))) << (0 ?
 2:0))) | ((gctUINT32)((gctUINT32)(Type) & ((((1 ?
 2:0) - (0 ?
 2:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 2:0) - (0 ? 2:0) + 1))))) << (0 ? 2:0)));
            break;

        case 2:
            Instruction->binary[3] = (((gctUINT32)(Instruction->binary[3]) & ~((gctUINT32)(((((1 ?
 3:3) - (0 ?
 3:3) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 3:3) - (0 ?
 3:3) + 1))))) << (0 ?
 3:3))) | ((gctUINT32)((gctUINT32)(1) & ((((1 ?
 3:3) - (0 ?
 3:3) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 3:3) - (0 ? 3:3) + 1))))) << (0 ? 3:3)));
            Instruction->binary[3] = (((gctUINT32)(Instruction->binary[3]) & ~((gctUINT32)(((((1 ?
 12:4) - (0 ?
 12:4) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 12:4) - (0 ?
 12:4) + 1))))) << (0 ?
 12:4))) | ((gctUINT32)((gctUINT32)(Address) & ((((1 ?
 12:4) - (0 ?
 12:4) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 12:4) - (0 ? 12:4) + 1))))) << (0 ? 12:4)));
            Instruction->binary[3] = (((gctUINT32)(Instruction->binary[3]) & ~((gctUINT32)(((((1 ?
 21:14) - (0 ?
 21:14) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 21:14) - (0 ?
 21:14) + 1))))) << (0 ?
 21:14))) | ((gctUINT32)((gctUINT32)(Swizzle) & ((((1 ?
 21:14) - (0 ?
 21:14) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 21:14) - (0 ? 21:14) + 1))))) << (0 ? 21:14)));
            Instruction->binary[3] = (((gctUINT32)(Instruction->binary[3]) & ~((gctUINT32)(((((1 ?
 22:22) - (0 ?
 22:22) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 22:22) - (0 ?
 22:22) + 1))))) << (0 ?
 22:22))) | ((gctUINT32)((gctUINT32)(Negate) & ((((1 ?
 22:22) - (0 ?
 22:22) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 22:22) - (0 ? 22:22) + 1))))) << (0 ? 22:22)));
            Instruction->binary[3] = (((gctUINT32)(Instruction->binary[3]) & ~((gctUINT32)(((((1 ?
 23:23) - (0 ?
 23:23) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 23:23) - (0 ?
 23:23) + 1))))) << (0 ?
 23:23))) | ((gctUINT32)((gctUINT32)(Absolute) & ((((1 ?
 23:23) - (0 ?
 23:23) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 23:23) - (0 ? 23:23) + 1))))) << (0 ? 23:23)));
            Instruction->binary[3] = (((gctUINT32)(Instruction->binary[3]) & ~((gctUINT32)(((((1 ?
 27:25) - (0 ?
 27:25) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 27:25) - (0 ?
 27:25) + 1))))) << (0 ?
 27:25))) | ((gctUINT32)((gctUINT32)(Relative) & ((((1 ?
 27:25) - (0 ?
 27:25) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 27:25) - (0 ? 27:25) + 1))))) << (0 ? 27:25)));
            Instruction->binary[3] = (((gctUINT32)(Instruction->binary[3]) & ~((gctUINT32)(((((1 ?
 30:28) - (0 ?
 30:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 30:28) - (0 ?
 30:28) + 1))))) << (0 ?
 30:28))) | ((gctUINT32)((gctUINT32)(Type) & ((((1 ?
 30:28) - (0 ?
 30:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 30:28) - (0 ? 30:28) + 1))))) << (0 ? 30:28)));
            break;
    }

    gcmFOOTER();
    return status;
}

gceSTATUS
gcoHARDWAREVX_SetImmediateValue(
    IN gctUINT32                            Where,
    IN gctUINT32                            Value,
    OUT gcoVX_Instruction                   *Instruction
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gctINT32 raw = (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 19:0) - (0 ?
 19:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 19:0) - (0 ?
 19:0) + 1))))) << (0 ?
 19:0))) | ((gctUINT32)((gctUINT32)(Value) & ((((1 ?
 19:0) - (0 ?
 19:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 19:0) - (0 ?
 19:0) + 1))))) << (0 ?
 19:0))) | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 21:20) - (0 ?
 21:20) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 21:20) - (0 ?
 21:20) + 1))))) << (0 ?
 21:20))) | ((gctUINT32)(0x2 & ((((1 ?
 21:20) - (0 ?
 21:20) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 21:20) - (0 ? 21:20) + 1))))) << (0 ? 21:20)));

    gcmHEADER_ARG("Where=0x%x", Where);

    gcmONERROR(gcoHARDWAREVX_SetSource(
        Where,
        GETBITS(raw, 8, 0),
        GETBITS(raw, 16, 9),
        0x7,
        GETBIT(raw, 17),
        GETBIT(raw, 18),
        GETBITS(raw, 21, 19),
        Instruction));

OnError:
    gcmFOOTER();
    return status;
}

gceSTATUS
gcoHARDWAREVX_SetImmediateValueF(
    IN gctUINT32                            Where,
    IN gctFLOAT                             Value,
    OUT gcoVX_Instruction                   *Instruction
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gctUINT32 raw = (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 19:0) - (0 ?
 19:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 19:0) - (0 ?
 19:0) + 1))))) << (0 ?
 19:0))) | ((gctUINT32)((gctUINT32)(*(gctUINT32*)&Value >> 12) & ((((1 ?
 19:0) - (0 ?
 19:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 19:0) - (0 ?
 19:0) + 1))))) << (0 ?
 19:0))) | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 21:20) - (0 ?
 21:20) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 21:20) - (0 ?
 21:20) + 1))))) << (0 ?
 21:20))) | ((gctUINT32)(0x0 & ((((1 ?
 21:20) - (0 ?
 21:20) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 21:20) - (0 ? 21:20) + 1))))) << (0 ? 21:20)));

    gcmHEADER_ARG("Where=0x%x", Where);

    gcmONERROR(gcoHARDWAREVX_SetSource(
        Where,
        GETBITS(raw, 8, 0),
        GETBITS(raw, 16, 9),
        0x7,
        GETBIT(raw, 17),
        GETBIT(raw, 18),
        GETBITS(raw, 21, 19),
        Instruction));

OnError:
    gcmFOOTER();
    return status;
}

gceSTATUS
gcoHARDWAREVX_DisableDestination(
    OUT gcoVX_Instruction                   *Instruction
    )
{
    Instruction->binary[0] = (((gctUINT32)(Instruction->binary[0]) & ~((gctUINT32)(((((1 ?
 12:12) - (0 ?
 12:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 12:12) - (0 ?
 12:12) + 1))))) << (0 ?
 12:12))) | ((gctUINT32)((gctUINT32)(0) & ((((1 ?
 12:12) - (0 ?
 12:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 12:12) - (0 ? 12:12) + 1))))) << (0 ? 12:12)));
    Instruction->binary[0] = (((gctUINT32)(Instruction->binary[0]) & ~((gctUINT32)(((((1 ?
 26:23) - (0 ?
 26:23) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 26:23) - (0 ?
 26:23) + 1))))) << (0 ?
 26:23))) | ((gctUINT32)((gctUINT32)(gcdVX_ENABLE) & ((((1 ?
 26:23) - (0 ?
 26:23) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 26:23) - (0 ? 26:23) + 1))))) << (0 ? 26:23)));

    return gcvSTATUS_OK;
}

gceSTATUS
gcoHARDWAREVX_SetDestination(
    IN gctUINT32                            Address,
    IN gctUINT32                            Enable,
    IN gctBOOL                              Saturate,
    OUT gcoVX_Instruction                   *Instruction
    )
{
    gceSTATUS status = gcvSTATUS_OK;

    gcmHEADER_ARG("Address=0x%x", Address);

    Instruction->binary[0] = (((gctUINT32)(Instruction->binary[0]) & ~((gctUINT32)(((((1 ?
 12:12) - (0 ?
 12:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 12:12) - (0 ?
 12:12) + 1))))) << (0 ?
 12:12))) | ((gctUINT32)((gctUINT32)(1) & ((((1 ?
 12:12) - (0 ?
 12:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 12:12) - (0 ? 12:12) + 1))))) << (0 ? 12:12)));
    Instruction->binary[0] = (((gctUINT32)(Instruction->binary[0]) & ~((gctUINT32)(((((1 ?
 22:16) - (0 ?
 22:16) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 22:16) - (0 ?
 22:16) + 1))))) << (0 ?
 22:16))) | ((gctUINT32)((gctUINT32)(Address) & ((((1 ?
 22:16) - (0 ?
 22:16) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 22:16) - (0 ? 22:16) + 1))))) << (0 ? 22:16)));
    Instruction->binary[0] = (((gctUINT32)(Instruction->binary[0]) & ~((gctUINT32)(((((1 ?
 26:23) - (0 ?
 26:23) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 26:23) - (0 ?
 26:23) + 1))))) << (0 ?
 26:23))) | ((gctUINT32)((gctUINT32)(Enable) & ((((1 ?
 26:23) - (0 ?
 26:23) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 26:23) - (0 ? 26:23) + 1))))) << (0 ? 26:23)));
    Instruction->binary[0] = (((gctUINT32)(Instruction->binary[0]) & ~((gctUINT32)(((((1 ?
 11:11) - (0 ?
 11:11) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 11:11) - (0 ?
 11:11) + 1))))) << (0 ?
 11:11))) | ((gctUINT32)((gctUINT32)(Saturate) & ((((1 ?
 11:11) - (0 ?
 11:11) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 11:11) - (0 ? 11:11) + 1))))) << (0 ? 11:11)));

    gcmFOOTER();
    return status;
}

gceSTATUS
gcoHARDWAREVX_SetDestinationExt(
    IN gctUINT32                            Address,
    IN gctUINT32                            Enable,
    IN gctBOOL                              Saturate,
    IN gctBOOL                              Rounding,
    OUT gcoVX_Instruction                   *Instruction
    )
{
    gceSTATUS status = gcvSTATUS_OK;

    gcmHEADER_ARG("Address=0x%x", Address);

    Instruction->binary[0] = (((gctUINT32)(Instruction->binary[0]) & ~((gctUINT32)(((((1 ?
 12:12) - (0 ?
 12:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 12:12) - (0 ?
 12:12) + 1))))) << (0 ?
 12:12))) | ((gctUINT32)((gctUINT32)(1) & ((((1 ?
 12:12) - (0 ?
 12:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 12:12) - (0 ? 12:12) + 1))))) << (0 ? 12:12)));
    Instruction->binary[0] = (((gctUINT32)(Instruction->binary[0]) & ~((gctUINT32)(((((1 ?
 22:16) - (0 ?
 22:16) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 22:16) - (0 ?
 22:16) + 1))))) << (0 ?
 22:16))) | ((gctUINT32)((gctUINT32)(Address) & ((((1 ?
 22:16) - (0 ?
 22:16) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 22:16) - (0 ? 22:16) + 1))))) << (0 ? 22:16)));
    Instruction->binary[0] = (((gctUINT32)(Instruction->binary[0]) & ~((gctUINT32)(((((1 ?
 26:23) - (0 ?
 26:23) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 26:23) - (0 ?
 26:23) + 1))))) << (0 ?
 26:23))) | ((gctUINT32)((gctUINT32)(Enable) & ((((1 ?
 26:23) - (0 ?
 26:23) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 26:23) - (0 ? 26:23) + 1))))) << (0 ? 26:23)));
    Instruction->binary[0] = (((gctUINT32)(Instruction->binary[0]) & ~((gctUINT32)(((((1 ?
 11:11) - (0 ?
 11:11) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 11:11) - (0 ?
 11:11) + 1))))) << (0 ?
 11:11))) | ((gctUINT32)((gctUINT32)(Saturate) & ((((1 ?
 11:11) - (0 ?
 11:11) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 11:11) - (0 ? 11:11) + 1))))) << (0 ? 11:11)));

    Instruction->binary[1] = (((gctUINT32)(Instruction->binary[1]) & ~((gctUINT32)(((((1 ?
 2:0) - (0 ?
 2:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 2:0) - (0 ?
 2:0) + 1))))) << (0 ?
 2:0))) | ((gctUINT32)((gctUINT32)(Rounding) & ((((1 ?
 2:0) - (0 ?
 2:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 2:0) - (0 ? 2:0) + 1))))) << (0 ? 2:0)));

    gcmFOOTER();
    return status;
}


gceSTATUS
gcoHARDWAREVX_SetEVIS(
    IN gctUINT32                            Start,
    IN gctUINT32                            End,
    IN gctUINT32                            Evis,
    OUT gcoVX_Instruction                   *Instruction
    )
{
    gceSTATUS status = gcvSTATUS_OK;

    gcmHEADER_ARG("Evis=0x%x", Evis);

    Instruction->binary[0] = (((gctUINT32)(Instruction->binary[0]) & ~((gctUINT32)(((((1 ?
 26:23) - (0 ?
 26:23) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 26:23) - (0 ?
 26:23) + 1))))) << (0 ?
 26:23))) | ((gctUINT32)((gctUINT32)(Start) & ((((1 ?
 26:23) - (0 ?
 26:23) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 26:23) - (0 ? 26:23) + 1))))) << (0 ? 26:23)));

    Instruction->binary[0] = SETBITS(Instruction->binary[0], 30, 27, End);

    Instruction->binary[1] = SETBITS(Instruction->binary[1], 10, 2, Evis);

    gcmFOOTER();
    return status;
}

static const gctUINT32 NEGATE_FLAG   = 1 << 0;
static const gctUINT32 ABSOLUTE_FLAG = 1 << 1;

gceSTATUS
gcoHARDWAREVX_SetUniform(
    IN gctUINT32                            Where,
    IN gctUINT32                            Address,
    IN gctUINT32                            Swizzle,
    IN gctUINT32                            Modifiers,
    OUT gcoVX_Instruction                   *Instruction
    )
{
    gceSTATUS status = gcvSTATUS_OK;

    gctBOOL negate   = (Modifiers & NEGATE_FLAG  ) ? gcvTRUE : gcvFALSE;
    gctBOOL absolute = (Modifiers & ABSOLUTE_FLAG) ? gcvTRUE : gcvFALSE;
    gcmHEADER_ARG("Where=0x%x", Where);

    gcmONERROR(gcoHARDWAREVX_SetSource(Where, Address, Swizzle, 0x2, negate, absolute, 0, Instruction));

OnError:
    gcmFOOTER();
    return status;
}
gceSTATUS
gcoHARDWAREVX_Setuniform(
    IN gctUINT32                            Where,
    IN gctUINT32                            Address,
    OUT gcoVX_Instruction                   *Instruction
    )
{
    gceSTATUS status = gcvSTATUS_OK;

    gcmHEADER_ARG("Where=0x%x", Where);

    gcmONERROR(gcoHARDWAREVX_SetSource(Where, Address, gcdVX_SWIZZLE, 0x4, gcvFALSE, gcvFALSE, 0, Instruction));

OnError:
    gcmFOOTER();
    return status;
}
gceSTATUS
gcoHARDWAREVX_SetTempReg(
    IN gctUINT32                            Where,
    IN gctUINT32                            Address,
    IN gctUINT32                            Swizzle,
    IN gctUINT32                            Modifiers,
    OUT gcoVX_Instruction                   *Instruction
    )
{
    gceSTATUS status = gcvSTATUS_OK;

    gctBOOL negate   = (Modifiers & NEGATE_FLAG  ) ? gcvTRUE : gcvFALSE;
    gctBOOL absolute = (Modifiers & ABSOLUTE_FLAG) ? gcvTRUE : gcvFALSE;
    gcmHEADER_ARG("Where=0x%x", Where);

    gcmONERROR(gcoHARDWAREVX_SetSource(Where, Address, Swizzle, 0x0, negate, absolute, 0, Instruction));

OnError:
    gcmFOOTER();
    return status;
}

gceSTATUS
gcoHARDWAREVX_SetTemp256Reg(
    IN gctUINT32                            Where,
    IN gctUINT32                            Address,
    IN gctUINT32                            Swizzle,
    IN gctUINT32                            Modifiers,
    OUT gcoVX_Instruction                   *Instruction
    )
{
    gceSTATUS status = gcvSTATUS_OK;

    gctBOOL negate   = (Modifiers & NEGATE_FLAG  ) ? gcvTRUE : gcvFALSE;
    gctBOOL absolute = (Modifiers & ABSOLUTE_FLAG) ? gcvTRUE : gcvFALSE;
    gcmHEADER_ARG("Where=0x%x", Where);

    gcmONERROR(gcoHARDWAREVX_SetSource(Where, Address, Swizzle, 0x1, negate, absolute, 0, Instruction));

OnError:
    gcmFOOTER();
    return status;
}

gceSTATUS
gcoHARDWAREVX_SetSourceBin(
    IN gctUINT32                            SourceBin,
    OUT gcoVX_Instruction                   *Instruction
    )
{
    gceSTATUS status = gcvSTATUS_OK;

    gcmHEADER_ARG("SourceBin=0x%x", SourceBin);

    Instruction->binary[1] = SETBITS(Instruction->binary[1], 25, 22, SourceBin);

    gcmFOOTER();
    return status;
}

gceSTATUS
gcoHARDWAREVX_SetInstructionType(
    IN gctUINT32                            Type,
    OUT gcoVX_Instruction                   *Instruction
    )
{
    gceSTATUS status = gcvSTATUS_OK;

    gcmHEADER_ARG("Type=0x%x", Type);

    Instruction->binary[1] = (((gctUINT32)(Instruction->binary[1]) & ~((gctUINT32)(((((1 ?
 21:21) - (0 ?
 21:21) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 21:21) - (0 ?
 21:21) + 1))))) << (0 ?
 21:21))) | ((gctUINT32)((gctUINT32)(GETBIT(Type, 0)) & ((((1 ?
 21:21) - (0 ?
 21:21) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 21:21) - (0 ? 21:21) + 1))))) << (0 ? 21:21)));
    Instruction->binary[2] = (((gctUINT32)(Instruction->binary[2]) & ~((gctUINT32)(((((1 ?
 31:30) - (0 ?
 31:30) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:30) - (0 ?
 31:30) + 1))))) << (0 ?
 31:30))) | ((gctUINT32)((gctUINT32)(GETBITS(Type, 2, 1)) & ((((1 ?
 31:30) - (0 ?
 31:30) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:30) - (0 ? 31:30) + 1))))) << (0 ? 31:30)));

    gcmFOOTER();
    return status;
}

gceSTATUS
gcoHARDWAREVX_AddOpcode(
    IN gctUINT32                            Opcode,
    IN gctUINT32                            Extended,
    IN gctINT32                             Type,
    OUT gcoVX_Instruction                   *Instruction
    )
{
    gceSTATUS status = gcvSTATUS_OK;

    gcmHEADER_ARG("Opcode=0x%x", Opcode);

    Instruction->binary[0] = (((gctUINT32)(Instruction->binary[0]) & ~((gctUINT32)(((((1 ?
 5:0) - (0 ?
 5:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 5:0) - (0 ?
 5:0) + 1))))) << (0 ?
 5:0))) | ((gctUINT32)((gctUINT32)(GETBITS(Opcode, 5, 0)) & ((((1 ?
 5:0) - (0 ?
 5:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 5:0) - (0 ? 5:0) + 1))))) << (0 ? 5:0)));
    Instruction->binary[2] = (((gctUINT32)(Instruction->binary[2]) & ~((gctUINT32)(((((1 ?
 16:16) - (0 ?
 16:16) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 16:16) - (0 ?
 16:16) + 1))))) << (0 ?
 16:16))) | ((gctUINT32)((gctUINT32)(GETBIT(Opcode, 6)) & ((((1 ?
 16:16) - (0 ?
 16:16) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 16:16) - (0 ? 16:16) + 1))))) << (0 ? 16:16)));
    if (Opcode == 0x7F)
    {
        gcmONERROR(gcoHARDWAREVX_SetImmediate(2, Extended, 0x2, Instruction));
    }
    else if (Opcode == 0x45)
    {
        Instruction->binary[0] = (((gctUINT32)(Instruction->binary[0]) & ~((gctUINT32)(((((1 ?
 15:13) - (0 ?
 15:13) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:13) - (0 ?
 15:13) + 1))))) << (0 ?
 15:13))) | ((gctUINT32)((gctUINT32)(GETBITS(Extended, 2, 0)) & ((((1 ?
 15:13) - (0 ?
 15:13) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:13) - (0 ? 15:13) + 1))))) << (0 ? 15:13)));
        Instruction->binary[0] = SETBIT(Instruction->binary[0], 31, GETBIT(Extended, 3));
        Instruction->binary[1] = SETBITS(Instruction->binary[1], 1, 0, GETBITS(Extended, 5, 4));
    }
    else if (Opcode == 0x31 || Opcode == 0x09 || Opcode == 0x0F)
    {
        Instruction->binary[0] = (((gctUINT32)(Instruction->binary[0]) & ~((gctUINT32)(((((1 ?
 10:6) - (0 ?
 10:6) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 10:6) - (0 ?
 10:6) + 1))))) << (0 ?
 10:6))) | ((gctUINT32)((gctUINT32)(GETBITS(Extended, 4, 0)) & ((((1 ?
 10:6) - (0 ?
 10:6) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 10:6) - (0 ? 10:6) + 1))))) << (0 ? 10:6)));
    }

    if((gctUINT32)Type != GCREG_SH_INSTRUCTION_TYPE_INVALID)
        gcmONERROR(gcoHARDWAREVX_SetInstructionType(Type, Instruction));

OnError:
    /* Return the status. */
    gcmFOOTER();
    return status;
}

gceSTATUS
gcoHARDWAREVX_BranchAny(
    IN gctUINT32                            Condition,
    IN gctINT32                             Target,
    IN gctINT32                             Type,
    IN gctINT32                             PC,
    OUT gcoVX_Instruction                   *Instruction
    )
{
    gceSTATUS status = gcvSTATUS_OK;

    gcmHEADER_ARG("Instruction=0x%x", Instruction);

    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x24, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, Instruction));

    Instruction->binary[0] = (((gctUINT32)(Instruction->binary[0]) & ~((gctUINT32)(((((1 ?
 10:6) - (0 ?
 10:6) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 10:6) - (0 ?
 10:6) + 1))))) << (0 ?
 10:6))) | ((gctUINT32)((gctUINT32)(Condition) & ((((1 ?
 10:6) - (0 ?
 10:6) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 10:6) - (0 ? 10:6) + 1))))) << (0 ? 10:6)));
    Instruction->binary[3] = (((gctUINT32)(Instruction->binary[3]) & ~((gctUINT32)(((((1 ?
 26:7) - (0 ?
 26:7) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 26:7) - (0 ?
 26:7) + 1))))) << (0 ?
 26:7))) | ((gctUINT32)((gctUINT32)(PC + Target - 0) & ((((1 ?
 26:7) - (0 ?
 26:7) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 26:7) - (0 ? 26:7) + 1))))) << (0 ? 26:7)));

    gcmONERROR(gcoHARDWAREVX_SetInstructionType(Type, Instruction));
OnError:
    gcmFOOTER();
    return status;
}

gceSTATUS
gcoHARDWAREVX_Branch(
    IN gctUINT32                            Condition,
    IN gctINT32                             Target,
    IN gctINT32                             Type,
    IN gctINT32                             PC,
    OUT gcoVX_Instruction                   *Instruction
    )
{
    gceSTATUS status = gcvSTATUS_OK;

    gcmHEADER_ARG("Instruction=0x%x", Instruction);

    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x16, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, Instruction));

    Instruction->binary[0] = (((gctUINT32)(Instruction->binary[0]) & ~((gctUINT32)(((((1 ?
 10:6) - (0 ?
 10:6) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 10:6) - (0 ?
 10:6) + 1))))) << (0 ?
 10:6))) | ((gctUINT32)((gctUINT32)(Condition) & ((((1 ?
 10:6) - (0 ?
 10:6) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 10:6) - (0 ? 10:6) + 1))))) << (0 ? 10:6)));
    Instruction->binary[3] = (((gctUINT32)(Instruction->binary[3]) & ~((gctUINT32)(((((1 ?
 26:7) - (0 ?
 26:7) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 26:7) - (0 ?
 26:7) + 1))))) << (0 ?
 26:7))) | ((gctUINT32)((gctUINT32)(PC + Target - 0) & ((((1 ?
 26:7) - (0 ?
 26:7) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 26:7) - (0 ? 26:7) + 1))))) << (0 ? 26:7)));

    gcmONERROR(gcoHARDWAREVX_SetInstructionType(Type, Instruction));
OnError:
    gcmFOOTER();
    return status;
}

gceSTATUS
gcoHARDWAREVX_Ctrl(
    IN gctUINT32                            Opcode,
    IN gctINT32                             Target,
    IN gctINT32                             PC,
    OUT gcoVX_Instruction                   *Instruction
    )
{
    gceSTATUS status = gcvSTATUS_OK;

    gcmHEADER_ARG("Instruction=0x%x", Instruction);

    gcmONERROR(gcoHARDWAREVX_AddOpcode(Opcode, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, Instruction));

    Instruction->binary[3] = (((gctUINT32)(Instruction->binary[3]) & ~((gctUINT32)(((((1 ?
 26:7) - (0 ?
 26:7) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 26:7) - (0 ?
 26:7) + 1))))) << (0 ?
 26:7))) | ((gctUINT32)((gctUINT32)(PC + Target - 0) & ((((1 ?
 26:7) - (0 ?
 26:7) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 26:7) - (0 ? 26:7) + 1))))) << (0 ? 26:7)));

OnError:
    gcmFOOTER();
    return status;
}

gceSTATUS
gcoHARDWAREVX_BranchANY(
    IN gctUINT32                            Condition,
    IN gctINT32                             Target,
    IN gctINT32                             Type,
    IN gctINT32                             PC,
    OUT gcoVX_Instruction                   *Instruction
    )
{
    gceSTATUS status = gcvSTATUS_OK;

    gcmHEADER_ARG("Instruction=0x%x", Instruction);

    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x24, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, Instruction));

    Instruction->binary[0] = (((gctUINT32)(Instruction->binary[0]) & ~((gctUINT32)(((((1 ?
 10:6) - (0 ?
 10:6) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 10:6) - (0 ?
 10:6) + 1))))) << (0 ?
 10:6))) | ((gctUINT32)((gctUINT32)(Condition) & ((((1 ?
 10:6) - (0 ?
 10:6) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 10:6) - (0 ? 10:6) + 1))))) << (0 ? 10:6)));
    Instruction->binary[3] = (((gctUINT32)(Instruction->binary[3]) & ~((gctUINT32)(((((1 ?
 26:7) - (0 ?
 26:7) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 26:7) - (0 ?
 26:7) + 1))))) << (0 ?
 26:7))) | ((gctUINT32)((gctUINT32)(PC + Target - 0) & ((((1 ?
 26:7) - (0 ?
 26:7) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 26:7) - (0 ? 26:7) + 1))))) << (0 ? 26:7)));

    gcmONERROR(gcoHARDWAREVX_SetInstructionType(Type, Instruction));
OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _absdiff(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;

    gctUINT32 Input1 = Context->input_type[0];
    gctUINT32 Input2 = Context->input_type[1];
    gctUINT32 Output = Context->output_type[0];
    gcoVX_Instructions   *Instructions = Context->instructions;

    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    /*img_load.u8 r1, c0, r0.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input1), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

    /*img_load.u8 r2, c1, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input2), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

    /*abs_diff.u8 r1, r1, r2*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x01, Output, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Output), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    if (Output != 0x7)
    {
        /*mul_shift, r1, r1.u8, 1, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, Output, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvTRUE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Output), (0x6 | (0x3 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, (1 | (1 << 16)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
    }

    /*img_store.u8 r1, c2, r0.xy, r1*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, Output, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Output), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 0x3;
OnError:
    gcmFOOTER();
    return status;
}

#define VX_DISABLE 0
#define VX_ADD 0x1
#define VX_SUBTRACT 0x2
#define VX_ACCUMULATOR 0x3
#define VXSETSELECTSRCVALUE(data, reg, field, value) \
(\
   (value==0)?AQSETFIELDVALUE(data, reg, SELECT##field, SRC0) \
    : AQSETFIELDVALUE(data, reg, SELECT##field, SRC1) \
    )

#define VXSETTERMCONFIGVALUE(data, reg, field, value) AQSETFIELD(data, reg, TERM##field, value)
#define VXSETDPABINALUE(data, reg, field, value) AQSETFIELD(data, reg, BIN##field, value)

typedef struct _gcVXConfig
{
    gctUINT16 matrix[16];
    gctINT32 termconfig[16];
    gctINT32 aselect[16];
    gctINT32 abin0[8];
    gctINT32 abin1[8];
    gctINT32 bselect[16];
    gctINT32 bbin0[8];
    gctINT32 bbin1[8];
}gcVXConfig;

#define TYPE4x4 0
#define TYPE8x2 1

static gceSTATUS _SetUniformItem(
    IN gctUINT32                            *Index,
    IN gctUINT32                            Offset0,
    IN gctUINT32                            Offset1,
    IN gctUINT32                            Offset2,
    IN gctUINT32                            Offset3,
    IN gctUINT32                            Shift,
    IN gctBOOL                              IgnoreOffset,
    IN gcVXConfig                           *Config,
    IN gctUINT32                            AccumulatorType,
    IN OUT gcoVX_Kernel_Context_Uniform     *Uniform
)
{
    gceSTATUS status = gcvSTATUS_OK;
    gctINT32 k = 0;

    gcmHEADER_ARG("Uniform=0x%x", Uniform);

    for(k = 0; k < 8; k++)
    {
        Uniform->uniform.bins[0].bin16[k] = Config->matrix[k];
        Uniform->uniform.bins[1].bin16[k] = Config->matrix[k + 8];
    }

    Uniform->uniform.termConfig = ((((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 1:0) - (0 ?
 1:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 1:0) - (0 ?
 1:0) + 1))))) << (0 ?
 1:0))) | ((gctUINT32)((gctUINT32)(Config->termconfig[0]) & ((((1 ?
 1:0) - (0 ?
 1:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 1:0) - (0 ? 1:0) + 1))))) << (0 ? 1:0)))
                     | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 3:2) - (0 ?
 3:2) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 3:2) - (0 ?
 3:2) + 1))))) << (0 ?
 3:2))) | ((gctUINT32)((gctUINT32)(Config->termconfig[1]) & ((((1 ?
 3:2) - (0 ?
 3:2) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 3:2) - (0 ? 3:2) + 1))))) << (0 ? 3:2)))
                     | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 5:4) - (0 ?
 5:4) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 5:4) - (0 ?
 5:4) + 1))))) << (0 ?
 5:4))) | ((gctUINT32)((gctUINT32)(Config->termconfig[2]) & ((((1 ?
 5:4) - (0 ?
 5:4) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 5:4) - (0 ? 5:4) + 1))))) << (0 ? 5:4)))
                     | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 7:6) - (0 ?
 7:6) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 7:6) - (0 ?
 7:6) + 1))))) << (0 ?
 7:6))) | ((gctUINT32)((gctUINT32)(Config->termconfig[3]) & ((((1 ?
 7:6) - (0 ?
 7:6) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 7:6) - (0 ? 7:6) + 1))))) << (0 ? 7:6)))
                     | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 9:8) - (0 ?
 9:8) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 9:8) - (0 ?
 9:8) + 1))))) << (0 ?
 9:8))) | ((gctUINT32)((gctUINT32)(Config->termconfig[4]) & ((((1 ?
 9:8) - (0 ?
 9:8) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 9:8) - (0 ? 9:8) + 1))))) << (0 ? 9:8)))
                     | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 11:10) - (0 ?
 11:10) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 11:10) - (0 ?
 11:10) + 1))))) << (0 ?
 11:10))) | ((gctUINT32)((gctUINT32)(Config->termconfig[5]) & ((((1 ?
 11:10) - (0 ?
 11:10) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 11:10) - (0 ? 11:10) + 1))))) << (0 ? 11:10)))
                     | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 13:12) - (0 ?
 13:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 13:12) - (0 ?
 13:12) + 1))))) << (0 ?
 13:12))) | ((gctUINT32)((gctUINT32)(Config->termconfig[6]) & ((((1 ?
 13:12) - (0 ?
 13:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 13:12) - (0 ? 13:12) + 1))))) << (0 ? 13:12)))
                     | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 15:14) - (0 ?
 15:14) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:14) - (0 ?
 15:14) + 1))))) << (0 ?
 15:14))) | ((gctUINT32)((gctUINT32)(Config->termconfig[7]) & ((((1 ?
 15:14) - (0 ?
 15:14) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:14) - (0 ? 15:14) + 1))))) << (0 ? 15:14)))
                     | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 17:16) - (0 ?
 17:16) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 17:16) - (0 ?
 17:16) + 1))))) << (0 ?
 17:16))) | ((gctUINT32)((gctUINT32)(Config->termconfig[8]) & ((((1 ?
 17:16) - (0 ?
 17:16) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 17:16) - (0 ? 17:16) + 1))))) << (0 ? 17:16)))
                     | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 19:18) - (0 ?
 19:18) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 19:18) - (0 ?
 19:18) + 1))))) << (0 ?
 19:18))) | ((gctUINT32)((gctUINT32)(Config->termconfig[9]) & ((((1 ?
 19:18) - (0 ?
 19:18) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 19:18) - (0 ? 19:18) + 1))))) << (0 ? 19:18)))
                     | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 21:20) - (0 ?
 21:20) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 21:20) - (0 ?
 21:20) + 1))))) << (0 ?
 21:20))) | ((gctUINT32)((gctUINT32)(Config->termconfig[10]) & ((((1 ?
 21:20) - (0 ?
 21:20) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 21:20) - (0 ? 21:20) + 1))))) << (0 ? 21:20)))
                     | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 23:22) - (0 ?
 23:22) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 23:22) - (0 ?
 23:22) + 1))))) << (0 ?
 23:22))) | ((gctUINT32)((gctUINT32)(Config->termconfig[11]) & ((((1 ?
 23:22) - (0 ?
 23:22) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 23:22) - (0 ? 23:22) + 1))))) << (0 ? 23:22)))
                     | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 25:24) - (0 ?
 25:24) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 25:24) - (0 ?
 25:24) + 1))))) << (0 ?
 25:24))) | ((gctUINT32)((gctUINT32)(Config->termconfig[12]) & ((((1 ?
 25:24) - (0 ?
 25:24) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 25:24) - (0 ? 25:24) + 1))))) << (0 ? 25:24)))
                     | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 27:26) - (0 ?
 27:26) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 27:26) - (0 ?
 27:26) + 1))))) << (0 ?
 27:26))) | ((gctUINT32)((gctUINT32)(Config->termconfig[13]) & ((((1 ?
 27:26) - (0 ?
 27:26) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 27:26) - (0 ? 27:26) + 1))))) << (0 ? 27:26)))
                     | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 29:28) - (0 ?
 29:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 29:28) - (0 ?
 29:28) + 1))))) << (0 ?
 29:28))) | ((gctUINT32)((gctUINT32)(Config->termconfig[14]) & ((((1 ?
 29:28) - (0 ?
 29:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 29:28) - (0 ? 29:28) + 1))))) << (0 ? 29:28)))
                     | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 31:30) - (0 ?
 31:30) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:30) - (0 ?
 31:30) + 1))))) << (0 ?
 31:30))) | ((gctUINT32)((gctUINT32)(Config->termconfig[15]) & ((((1 ?
 31:30) - (0 ?
 31:30) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:30) - (0 ? 31:30) + 1))))) << (0 ? 31:30)))
                     );

    Uniform->uniform.aSelect = (
                    ((Config->aselect[0] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 1:0) - (0 ?
 1:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 1:0) - (0 ?
 1:0) + 1))))) << (0 ?
 1:0))) | ((gctUINT32)(0x0 & ((((1 ?
 1:0) - (0 ?
 1:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 1:0) - (0 ?
 1:0) + 1))))) << (0 ?
 1:0))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 1:0) - (0 ?
 1:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 1:0) - (0 ?
 1:0) + 1))))) << (0 ?
 1:0))) | ((gctUINT32)(0x1 & ((((1 ?
 1:0) - (0 ?
 1:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 1:0) - (0 ? 1:0) + 1))))) << (0 ? 1:0))))
                  | ((Config->aselect[1] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 3:2) - (0 ?
 3:2) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 3:2) - (0 ?
 3:2) + 1))))) << (0 ?
 3:2))) | ((gctUINT32)(0x0 & ((((1 ?
 3:2) - (0 ?
 3:2) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 3:2) - (0 ?
 3:2) + 1))))) << (0 ?
 3:2))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 3:2) - (0 ?
 3:2) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 3:2) - (0 ?
 3:2) + 1))))) << (0 ?
 3:2))) | ((gctUINT32)(0x1 & ((((1 ?
 3:2) - (0 ?
 3:2) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 3:2) - (0 ? 3:2) + 1))))) << (0 ? 3:2))))
                  | ((Config->aselect[2] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 5:4) - (0 ?
 5:4) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 5:4) - (0 ?
 5:4) + 1))))) << (0 ?
 5:4))) | ((gctUINT32)(0x0 & ((((1 ?
 5:4) - (0 ?
 5:4) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 5:4) - (0 ?
 5:4) + 1))))) << (0 ?
 5:4))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 5:4) - (0 ?
 5:4) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 5:4) - (0 ?
 5:4) + 1))))) << (0 ?
 5:4))) | ((gctUINT32)(0x1 & ((((1 ?
 5:4) - (0 ?
 5:4) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 5:4) - (0 ? 5:4) + 1))))) << (0 ? 5:4))))
                  | ((Config->aselect[3] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 7:6) - (0 ?
 7:6) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 7:6) - (0 ?
 7:6) + 1))))) << (0 ?
 7:6))) | ((gctUINT32)(0x0 & ((((1 ?
 7:6) - (0 ?
 7:6) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 7:6) - (0 ?
 7:6) + 1))))) << (0 ?
 7:6))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 7:6) - (0 ?
 7:6) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 7:6) - (0 ?
 7:6) + 1))))) << (0 ?
 7:6))) | ((gctUINT32)(0x1 & ((((1 ?
 7:6) - (0 ?
 7:6) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 7:6) - (0 ? 7:6) + 1))))) << (0 ? 7:6))))
                  | ((Config->aselect[4] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 9:8) - (0 ?
 9:8) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 9:8) - (0 ?
 9:8) + 1))))) << (0 ?
 9:8))) | ((gctUINT32)(0x0 & ((((1 ?
 9:8) - (0 ?
 9:8) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 9:8) - (0 ?
 9:8) + 1))))) << (0 ?
 9:8))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 9:8) - (0 ?
 9:8) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 9:8) - (0 ?
 9:8) + 1))))) << (0 ?
 9:8))) | ((gctUINT32)(0x1 & ((((1 ?
 9:8) - (0 ?
 9:8) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 9:8) - (0 ? 9:8) + 1))))) << (0 ? 9:8))))
                  | ((Config->aselect[5] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 11:10) - (0 ?
 11:10) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 11:10) - (0 ?
 11:10) + 1))))) << (0 ?
 11:10))) | ((gctUINT32)(0x0 & ((((1 ?
 11:10) - (0 ?
 11:10) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 11:10) - (0 ?
 11:10) + 1))))) << (0 ?
 11:10))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 11:10) - (0 ?
 11:10) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 11:10) - (0 ?
 11:10) + 1))))) << (0 ?
 11:10))) | ((gctUINT32)(0x1 & ((((1 ?
 11:10) - (0 ?
 11:10) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 11:10) - (0 ? 11:10) + 1))))) << (0 ? 11:10))))
                  | ((Config->aselect[6] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 13:12) - (0 ?
 13:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 13:12) - (0 ?
 13:12) + 1))))) << (0 ?
 13:12))) | ((gctUINT32)(0x0 & ((((1 ?
 13:12) - (0 ?
 13:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 13:12) - (0 ?
 13:12) + 1))))) << (0 ?
 13:12))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 13:12) - (0 ?
 13:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 13:12) - (0 ?
 13:12) + 1))))) << (0 ?
 13:12))) | ((gctUINT32)(0x1 & ((((1 ?
 13:12) - (0 ?
 13:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 13:12) - (0 ? 13:12) + 1))))) << (0 ? 13:12))))
                  | ((Config->aselect[7] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 15:14) - (0 ?
 15:14) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:14) - (0 ?
 15:14) + 1))))) << (0 ?
 15:14))) | ((gctUINT32)(0x0 & ((((1 ?
 15:14) - (0 ?
 15:14) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:14) - (0 ?
 15:14) + 1))))) << (0 ?
 15:14))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 15:14) - (0 ?
 15:14) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:14) - (0 ?
 15:14) + 1))))) << (0 ?
 15:14))) | ((gctUINT32)(0x1 & ((((1 ?
 15:14) - (0 ?
 15:14) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:14) - (0 ? 15:14) + 1))))) << (0 ? 15:14))))
                  | ((Config->aselect[8] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 17:16) - (0 ?
 17:16) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 17:16) - (0 ?
 17:16) + 1))))) << (0 ?
 17:16))) | ((gctUINT32)(0x0 & ((((1 ?
 17:16) - (0 ?
 17:16) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 17:16) - (0 ?
 17:16) + 1))))) << (0 ?
 17:16))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 17:16) - (0 ?
 17:16) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 17:16) - (0 ?
 17:16) + 1))))) << (0 ?
 17:16))) | ((gctUINT32)(0x1 & ((((1 ?
 17:16) - (0 ?
 17:16) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 17:16) - (0 ? 17:16) + 1))))) << (0 ? 17:16))))
                  | ((Config->aselect[9] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 19:18) - (0 ?
 19:18) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 19:18) - (0 ?
 19:18) + 1))))) << (0 ?
 19:18))) | ((gctUINT32)(0x0 & ((((1 ?
 19:18) - (0 ?
 19:18) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 19:18) - (0 ?
 19:18) + 1))))) << (0 ?
 19:18))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 19:18) - (0 ?
 19:18) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 19:18) - (0 ?
 19:18) + 1))))) << (0 ?
 19:18))) | ((gctUINT32)(0x1 & ((((1 ?
 19:18) - (0 ?
 19:18) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 19:18) - (0 ? 19:18) + 1))))) << (0 ? 19:18))))
                  | ((Config->aselect[10] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 21:20) - (0 ?
 21:20) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 21:20) - (0 ?
 21:20) + 1))))) << (0 ?
 21:20))) | ((gctUINT32)(0x0 & ((((1 ?
 21:20) - (0 ?
 21:20) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 21:20) - (0 ?
 21:20) + 1))))) << (0 ?
 21:20))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 21:20) - (0 ?
 21:20) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 21:20) - (0 ?
 21:20) + 1))))) << (0 ?
 21:20))) | ((gctUINT32)(0x1 & ((((1 ?
 21:20) - (0 ?
 21:20) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 21:20) - (0 ? 21:20) + 1))))) << (0 ? 21:20))))
                  | ((Config->aselect[11] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 23:22) - (0 ?
 23:22) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 23:22) - (0 ?
 23:22) + 1))))) << (0 ?
 23:22))) | ((gctUINT32)(0x0 & ((((1 ?
 23:22) - (0 ?
 23:22) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 23:22) - (0 ?
 23:22) + 1))))) << (0 ?
 23:22))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 23:22) - (0 ?
 23:22) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 23:22) - (0 ?
 23:22) + 1))))) << (0 ?
 23:22))) | ((gctUINT32)(0x1 & ((((1 ?
 23:22) - (0 ?
 23:22) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 23:22) - (0 ? 23:22) + 1))))) << (0 ? 23:22))))
                  | ((Config->aselect[12] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 25:24) - (0 ?
 25:24) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 25:24) - (0 ?
 25:24) + 1))))) << (0 ?
 25:24))) | ((gctUINT32)(0x0 & ((((1 ?
 25:24) - (0 ?
 25:24) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 25:24) - (0 ?
 25:24) + 1))))) << (0 ?
 25:24))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 25:24) - (0 ?
 25:24) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 25:24) - (0 ?
 25:24) + 1))))) << (0 ?
 25:24))) | ((gctUINT32)(0x1 & ((((1 ?
 25:24) - (0 ?
 25:24) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 25:24) - (0 ? 25:24) + 1))))) << (0 ? 25:24))))
                  | ((Config->aselect[13] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 27:26) - (0 ?
 27:26) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 27:26) - (0 ?
 27:26) + 1))))) << (0 ?
 27:26))) | ((gctUINT32)(0x0 & ((((1 ?
 27:26) - (0 ?
 27:26) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 27:26) - (0 ?
 27:26) + 1))))) << (0 ?
 27:26))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 27:26) - (0 ?
 27:26) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 27:26) - (0 ?
 27:26) + 1))))) << (0 ?
 27:26))) | ((gctUINT32)(0x1 & ((((1 ?
 27:26) - (0 ?
 27:26) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 27:26) - (0 ? 27:26) + 1))))) << (0 ? 27:26))))
                  | ((Config->aselect[14] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 29:28) - (0 ?
 29:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 29:28) - (0 ?
 29:28) + 1))))) << (0 ?
 29:28))) | ((gctUINT32)(0x0 & ((((1 ?
 29:28) - (0 ?
 29:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 29:28) - (0 ?
 29:28) + 1))))) << (0 ?
 29:28))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 29:28) - (0 ?
 29:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 29:28) - (0 ?
 29:28) + 1))))) << (0 ?
 29:28))) | ((gctUINT32)(0x1 & ((((1 ?
 29:28) - (0 ?
 29:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 29:28) - (0 ? 29:28) + 1))))) << (0 ? 29:28))))
                  | ((Config->aselect[15] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 31:30) - (0 ?
 31:30) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:30) - (0 ?
 31:30) + 1))))) << (0 ?
 31:30))) | ((gctUINT32)(0x0 & ((((1 ?
 31:30) - (0 ?
 31:30) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:30) - (0 ?
 31:30) + 1))))) << (0 ?
 31:30))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 31:30) - (0 ?
 31:30) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:30) - (0 ?
 31:30) + 1))))) << (0 ?
 31:30))) | ((gctUINT32)(0x1 & ((((1 ?
 31:30) - (0 ?
 31:30) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:30) - (0 ? 31:30) + 1))))) << (0 ? 31:30))))
                  );

    Uniform->uniform.aBin[0] = (
                    (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 3:0) - (0 ?
 3:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 3:0) - (0 ?
 3:0) + 1))))) << (0 ?
 3:0))) | ((gctUINT32)((gctUINT32)(Offset0 + Config->abin0[0]) & ((((1 ?
 3:0) - (0 ?
 3:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 3:0) - (0 ? 3:0) + 1))))) << (0 ? 3:0)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 7:4) - (0 ?
 7:4) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 7:4) - (0 ?
 7:4) + 1))))) << (0 ?
 7:4))) | ((gctUINT32)((gctUINT32)(Offset0 + Config->abin0[1]) & ((((1 ?
 7:4) - (0 ?
 7:4) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 7:4) - (0 ? 7:4) + 1))))) << (0 ? 7:4)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 11:8) - (0 ?
 11:8) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 11:8) - (0 ?
 11:8) + 1))))) << (0 ?
 11:8))) | ((gctUINT32)((gctUINT32)(Offset0 + Config->abin0[2]) & ((((1 ?
 11:8) - (0 ?
 11:8) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 11:8) - (0 ? 11:8) + 1))))) << (0 ? 11:8)))
                  | ((Config->termconfig[3] == VX_ACCUMULATOR && IgnoreOffset)
                        ?
(((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 15:12) - (0 ?
 15:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:12) - (0 ?
 15:12) + 1))))) << (0 ?
 15:12))) | ((gctUINT32)((gctUINT32)(Config->abin0[3]) & ((((1 ?
 15:12) - (0 ?
 15:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:12) - (0 ? 15:12) + 1))))) << (0 ? 15:12)))
                        :(((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 15:12) - (0 ?
 15:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:12) - (0 ?
 15:12) + 1))))) << (0 ?
 15:12))) | ((gctUINT32)((gctUINT32)(Offset0 + Config->abin0[3]) & ((((1 ?
 15:12) - (0 ?
 15:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:12) - (0 ? 15:12) + 1))))) << (0 ? 15:12)))
                    )
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 19:16) - (0 ?
 19:16) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 19:16) - (0 ?
 19:16) + 1))))) << (0 ?
 19:16))) | ((gctUINT32)((gctUINT32)(Offset1 + Config->abin0[4]) & ((((1 ?
 19:16) - (0 ?
 19:16) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 19:16) - (0 ? 19:16) + 1))))) << (0 ? 19:16)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 23:20) - (0 ?
 23:20) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 23:20) - (0 ?
 23:20) + 1))))) << (0 ?
 23:20))) | ((gctUINT32)((gctUINT32)(Offset1 + Config->abin0[5]) & ((((1 ?
 23:20) - (0 ?
 23:20) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 23:20) - (0 ? 23:20) + 1))))) << (0 ? 23:20)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 27:24) - (0 ?
 27:24) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 27:24) - (0 ?
 27:24) + 1))))) << (0 ?
 27:24))) | ((gctUINT32)((gctUINT32)(Offset1 + Config->abin0[6]) & ((((1 ?
 27:24) - (0 ?
 27:24) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 27:24) - (0 ? 27:24) + 1))))) << (0 ? 27:24)))
                  | ((Config->termconfig[7] == VX_ACCUMULATOR && IgnoreOffset)
                        ?
(((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 31:28) - (0 ?
 31:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:28) - (0 ?
 31:28) + 1))))) << (0 ?
 31:28))) | ((gctUINT32)((gctUINT32)(Config->abin0[7]) & ((((1 ?
 31:28) - (0 ?
 31:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:28) - (0 ? 31:28) + 1))))) << (0 ? 31:28)))
                        :(((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 31:28) - (0 ?
 31:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:28) - (0 ?
 31:28) + 1))))) << (0 ?
 31:28))) | ((gctUINT32)((gctUINT32)(Offset1 + Config->abin0[7]) & ((((1 ?
 31:28) - (0 ?
 31:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:28) - (0 ? 31:28) + 1))))) << (0 ? 31:28)))
                    )
                  );

    Uniform->uniform.aBin[1] = (
                    (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 3:0) - (0 ?
 3:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 3:0) - (0 ?
 3:0) + 1))))) << (0 ?
 3:0))) | ((gctUINT32)((gctUINT32)(Offset2 + Config->abin1[0]) & ((((1 ?
 3:0) - (0 ?
 3:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 3:0) - (0 ? 3:0) + 1))))) << (0 ? 3:0)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 7:4) - (0 ?
 7:4) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 7:4) - (0 ?
 7:4) + 1))))) << (0 ?
 7:4))) | ((gctUINT32)((gctUINT32)(Offset2 + Config->abin1[1]) & ((((1 ?
 7:4) - (0 ?
 7:4) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 7:4) - (0 ? 7:4) + 1))))) << (0 ? 7:4)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 11:8) - (0 ?
 11:8) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 11:8) - (0 ?
 11:8) + 1))))) << (0 ?
 11:8))) | ((gctUINT32)((gctUINT32)(Offset2 + Config->abin1[2]) & ((((1 ?
 11:8) - (0 ?
 11:8) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 11:8) - (0 ? 11:8) + 1))))) << (0 ? 11:8)))
                  | ((Config->termconfig[11] == VX_ACCUMULATOR && IgnoreOffset)
                        ?
(((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 15:12) - (0 ?
 15:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:12) - (0 ?
 15:12) + 1))))) << (0 ?
 15:12))) | ((gctUINT32)((gctUINT32)(Config->abin1[3]) & ((((1 ?
 15:12) - (0 ?
 15:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:12) - (0 ? 15:12) + 1))))) << (0 ? 15:12)))
                        :(((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 15:12) - (0 ?
 15:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:12) - (0 ?
 15:12) + 1))))) << (0 ?
 15:12))) | ((gctUINT32)((gctUINT32)(Offset2 + Config->abin1[3]) & ((((1 ?
 15:12) - (0 ?
 15:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:12) - (0 ? 15:12) + 1))))) << (0 ? 15:12)))
                    )
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 19:16) - (0 ?
 19:16) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 19:16) - (0 ?
 19:16) + 1))))) << (0 ?
 19:16))) | ((gctUINT32)((gctUINT32)(Offset3 + Config->abin1[4]) & ((((1 ?
 19:16) - (0 ?
 19:16) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 19:16) - (0 ? 19:16) + 1))))) << (0 ? 19:16)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 23:20) - (0 ?
 23:20) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 23:20) - (0 ?
 23:20) + 1))))) << (0 ?
 23:20))) | ((gctUINT32)((gctUINT32)(Offset3 + Config->abin1[5]) & ((((1 ?
 23:20) - (0 ?
 23:20) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 23:20) - (0 ? 23:20) + 1))))) << (0 ? 23:20)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 27:24) - (0 ?
 27:24) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 27:24) - (0 ?
 27:24) + 1))))) << (0 ?
 27:24))) | ((gctUINT32)((gctUINT32)(Offset3 + Config->abin1[6]) & ((((1 ?
 27:24) - (0 ?
 27:24) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 27:24) - (0 ? 27:24) + 1))))) << (0 ? 27:24)))
                  | ((Config->termconfig[15] == VX_ACCUMULATOR)
                        ?
(((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 31:28) - (0 ?
 31:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:28) - (0 ?
 31:28) + 1))))) << (0 ?
 31:28))) | ((gctUINT32)((gctUINT32)(Config->abin1[7]) & ((((1 ?
 31:28) - (0 ?
 31:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:28) - (0 ? 31:28) + 1))))) << (0 ? 31:28)))
                        :(((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 31:28) - (0 ?
 31:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:28) - (0 ?
 31:28) + 1))))) << (0 ?
 31:28))) | ((gctUINT32)((gctUINT32)(Offset3 + Config->abin1[7]) & ((((1 ?
 31:28) - (0 ?
 31:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:28) - (0 ? 31:28) + 1))))) << (0 ? 31:28)))
                    )
                  );

    Uniform->uniform.bSelect =  ((((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 1:0) - (0 ?
 1:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 1:0) - (0 ?
 1:0) + 1))))) << (0 ?
 1:0))) | ((gctUINT32)(0x2 & ((((1 ?
 1:0) - (0 ?
 1:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 1:0) - (0 ? 1:0) + 1))))) << (0 ? 1:0)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 3:2) - (0 ?
 3:2) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 3:2) - (0 ?
 3:2) + 1))))) << (0 ?
 3:2))) | ((gctUINT32)(0x2 & ((((1 ?
 3:2) - (0 ?
 3:2) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 3:2) - (0 ? 3:2) + 1))))) << (0 ? 3:2)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 5:4) - (0 ?
 5:4) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 5:4) - (0 ?
 5:4) + 1))))) << (0 ?
 5:4))) | ((gctUINT32)(0x2 & ((((1 ?
 5:4) - (0 ?
 5:4) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 5:4) - (0 ? 5:4) + 1))))) << (0 ? 5:4)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 7:6) - (0 ?
 7:6) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 7:6) - (0 ?
 7:6) + 1))))) << (0 ?
 7:6))) | ((gctUINT32)(0x2 & ((((1 ?
 7:6) - (0 ?
 7:6) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 7:6) - (0 ? 7:6) + 1))))) << (0 ? 7:6)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 9:8) - (0 ?
 9:8) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 9:8) - (0 ?
 9:8) + 1))))) << (0 ?
 9:8))) | ((gctUINT32)(0x2 & ((((1 ?
 9:8) - (0 ?
 9:8) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 9:8) - (0 ? 9:8) + 1))))) << (0 ? 9:8)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 11:10) - (0 ?
 11:10) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 11:10) - (0 ?
 11:10) + 1))))) << (0 ?
 11:10))) | ((gctUINT32)(0x2 & ((((1 ?
 11:10) - (0 ?
 11:10) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 11:10) - (0 ? 11:10) + 1))))) << (0 ? 11:10)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 13:12) - (0 ?
 13:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 13:12) - (0 ?
 13:12) + 1))))) << (0 ?
 13:12))) | ((gctUINT32)(0x2 & ((((1 ?
 13:12) - (0 ?
 13:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 13:12) - (0 ? 13:12) + 1))))) << (0 ? 13:12)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 15:14) - (0 ?
 15:14) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:14) - (0 ?
 15:14) + 1))))) << (0 ?
 15:14))) | ((gctUINT32)(0x2 & ((((1 ?
 15:14) - (0 ?
 15:14) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:14) - (0 ? 15:14) + 1))))) << (0 ? 15:14)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 17:16) - (0 ?
 17:16) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 17:16) - (0 ?
 17:16) + 1))))) << (0 ?
 17:16))) | ((gctUINT32)(0x2 & ((((1 ?
 17:16) - (0 ?
 17:16) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 17:16) - (0 ? 17:16) + 1))))) << (0 ? 17:16)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 19:18) - (0 ?
 19:18) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 19:18) - (0 ?
 19:18) + 1))))) << (0 ?
 19:18))) | ((gctUINT32)(0x2 & ((((1 ?
 19:18) - (0 ?
 19:18) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 19:18) - (0 ? 19:18) + 1))))) << (0 ? 19:18)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 21:20) - (0 ?
 21:20) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 21:20) - (0 ?
 21:20) + 1))))) << (0 ?
 21:20))) | ((gctUINT32)(0x2 & ((((1 ?
 21:20) - (0 ?
 21:20) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 21:20) - (0 ? 21:20) + 1))))) << (0 ? 21:20)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 23:22) - (0 ?
 23:22) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 23:22) - (0 ?
 23:22) + 1))))) << (0 ?
 23:22))) | ((gctUINT32)(0x2 & ((((1 ?
 23:22) - (0 ?
 23:22) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 23:22) - (0 ? 23:22) + 1))))) << (0 ? 23:22)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 25:24) - (0 ?
 25:24) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 25:24) - (0 ?
 25:24) + 1))))) << (0 ?
 25:24))) | ((gctUINT32)(0x2 & ((((1 ?
 25:24) - (0 ?
 25:24) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 25:24) - (0 ? 25:24) + 1))))) << (0 ? 25:24)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 27:26) - (0 ?
 27:26) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 27:26) - (0 ?
 27:26) + 1))))) << (0 ?
 27:26))) | ((gctUINT32)(0x2 & ((((1 ?
 27:26) - (0 ?
 27:26) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 27:26) - (0 ? 27:26) + 1))))) << (0 ? 27:26)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 29:28) - (0 ?
 29:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 29:28) - (0 ?
 29:28) + 1))))) << (0 ?
 29:28))) | ((gctUINT32)(0x2 & ((((1 ?
 29:28) - (0 ?
 29:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 29:28) - (0 ? 29:28) + 1))))) << (0 ? 29:28)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 31:30) - (0 ?
 31:30) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:30) - (0 ?
 31:30) + 1))))) << (0 ?
 31:30))) | ((gctUINT32)(0x2 & ((((1 ?
 31:30) - (0 ?
 31:30) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:30) - (0 ? 31:30) + 1))))) << (0 ? 31:30)))
                  );

    Uniform->uniform.miscConfig = ((((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 4:0) - (0 ?
 4:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 4:0) - (0 ?
 4:0) + 1))))) << (0 ?
 4:0))) | ((gctUINT32)((gctUINT32)(Shift) & ((((1 ?
 4:0) - (0 ?
 4:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 4:0) - (0 ? 4:0) + 1))))) << (0 ? 4:0)))
                     | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 10:8) - (0 ?
 10:8) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 10:8) - (0 ?
 10:8) + 1))))) << (0 ?
 10:8))) | ((gctUINT32)(0x3 & ((((1 ?
 10:8) - (0 ?
 10:8) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 10:8) - (0 ? 10:8) + 1))))) << (0 ? 10:8)))
                     );

    if(AccumulatorType == 0x6)
        Uniform->uniform.miscConfig |= (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 14:12) - (0 ?
 14:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 14:12) - (0 ?
 14:12) + 1))))) << (0 ?
 14:12))) | ((gctUINT32)(0x6 & ((((1 ?
 14:12) - (0 ?
 14:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 14:12) - (0 ? 14:12) + 1))))) << (0 ? 14:12)));
    else if(AccumulatorType == 0x5)
        Uniform->uniform.miscConfig |= (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 14:12) - (0 ?
 14:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 14:12) - (0 ?
 14:12) + 1))))) << (0 ?
 14:12))) | ((gctUINT32)(0x5 & ((((1 ?
 14:12) - (0 ?
 14:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 14:12) - (0 ? 14:12) + 1))))) << (0 ? 14:12)));
    else if(AccumulatorType == 0x2)
        Uniform->uniform.miscConfig |= (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 14:12) - (0 ?
 14:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 14:12) - (0 ?
 14:12) + 1))))) << (0 ?
 14:12))) | ((gctUINT32)(0x2 & ((((1 ?
 14:12) - (0 ?
 14:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 14:12) - (0 ? 14:12) + 1))))) << (0 ? 14:12)));
    else if(AccumulatorType == 0x7)
        Uniform->uniform.miscConfig |= (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 14:12) - (0 ?
 14:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 14:12) - (0 ?
 14:12) + 1))))) << (0 ?
 14:12))) | ((gctUINT32)(0x7 & ((((1 ?
 14:12) - (0 ?
 14:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 14:12) - (0 ? 14:12) + 1))))) << (0 ? 14:12)));
    else
        Uniform->uniform.miscConfig |= (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 14:12) - (0 ?
 14:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 14:12) - (0 ?
 14:12) + 1))))) << (0 ?
 14:12))) | ((gctUINT32)(0x3 & ((((1 ?
 14:12) - (0 ?
 14:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 14:12) - (0 ? 14:12) + 1))))) << (0 ? 14:12)));

    Uniform->index = 4 * ((*Index) + 1);
    Uniform->num = 16 * 4;

    gcmFOOTER();
    return status;
}

static gceSTATUS _SetUniformItemExt(
    IN gctUINT32                            *Index,
    IN gctUINT32                            Offset0,
    IN gctUINT32                            Offset1,
    IN gctUINT32                            Offset2,
    IN gctUINT32                            Offset3,
    IN gctINT32                             Shift,
    IN gctBOOL                              IgnoreOffset,
    IN gcVXConfig                           *Config,
    IN gctUINT32                            AccumulatorType,
    IN OUT gcoVX_Kernel_Context_Uniform     *Uniform
)
{
    gceSTATUS status = gcvSTATUS_OK;
    gctINT32 k = 0;

    gcmHEADER_ARG("Uniform=0x%x", Uniform);

    for(k = 0; k < 8; k++)
    {
        Uniform->uniform.bins[0].bin16[k] = Config->matrix[k];
        Uniform->uniform.bins[1].bin16[k] = Config->matrix[k + 8];
    }

    Uniform->uniform.termConfig = ((((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 1:0) - (0 ?
 1:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 1:0) - (0 ?
 1:0) + 1))))) << (0 ?
 1:0))) | ((gctUINT32)((gctUINT32)(Config->termconfig[0]) & ((((1 ?
 1:0) - (0 ?
 1:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 1:0) - (0 ? 1:0) + 1))))) << (0 ? 1:0)))
                     | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 3:2) - (0 ?
 3:2) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 3:2) - (0 ?
 3:2) + 1))))) << (0 ?
 3:2))) | ((gctUINT32)((gctUINT32)(Config->termconfig[1]) & ((((1 ?
 3:2) - (0 ?
 3:2) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 3:2) - (0 ? 3:2) + 1))))) << (0 ? 3:2)))
                     | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 5:4) - (0 ?
 5:4) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 5:4) - (0 ?
 5:4) + 1))))) << (0 ?
 5:4))) | ((gctUINT32)((gctUINT32)(Config->termconfig[2]) & ((((1 ?
 5:4) - (0 ?
 5:4) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 5:4) - (0 ? 5:4) + 1))))) << (0 ? 5:4)))
                     | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 7:6) - (0 ?
 7:6) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 7:6) - (0 ?
 7:6) + 1))))) << (0 ?
 7:6))) | ((gctUINT32)((gctUINT32)(Config->termconfig[3]) & ((((1 ?
 7:6) - (0 ?
 7:6) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 7:6) - (0 ? 7:6) + 1))))) << (0 ? 7:6)))
                     | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 9:8) - (0 ?
 9:8) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 9:8) - (0 ?
 9:8) + 1))))) << (0 ?
 9:8))) | ((gctUINT32)((gctUINT32)(Config->termconfig[4]) & ((((1 ?
 9:8) - (0 ?
 9:8) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 9:8) - (0 ? 9:8) + 1))))) << (0 ? 9:8)))
                     | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 11:10) - (0 ?
 11:10) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 11:10) - (0 ?
 11:10) + 1))))) << (0 ?
 11:10))) | ((gctUINT32)((gctUINT32)(Config->termconfig[5]) & ((((1 ?
 11:10) - (0 ?
 11:10) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 11:10) - (0 ? 11:10) + 1))))) << (0 ? 11:10)))
                     | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 13:12) - (0 ?
 13:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 13:12) - (0 ?
 13:12) + 1))))) << (0 ?
 13:12))) | ((gctUINT32)((gctUINT32)(Config->termconfig[6]) & ((((1 ?
 13:12) - (0 ?
 13:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 13:12) - (0 ? 13:12) + 1))))) << (0 ? 13:12)))
                     | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 15:14) - (0 ?
 15:14) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:14) - (0 ?
 15:14) + 1))))) << (0 ?
 15:14))) | ((gctUINT32)((gctUINT32)(Config->termconfig[7]) & ((((1 ?
 15:14) - (0 ?
 15:14) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:14) - (0 ? 15:14) + 1))))) << (0 ? 15:14)))
                     | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 17:16) - (0 ?
 17:16) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 17:16) - (0 ?
 17:16) + 1))))) << (0 ?
 17:16))) | ((gctUINT32)((gctUINT32)(Config->termconfig[8]) & ((((1 ?
 17:16) - (0 ?
 17:16) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 17:16) - (0 ? 17:16) + 1))))) << (0 ? 17:16)))
                     | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 19:18) - (0 ?
 19:18) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 19:18) - (0 ?
 19:18) + 1))))) << (0 ?
 19:18))) | ((gctUINT32)((gctUINT32)(Config->termconfig[9]) & ((((1 ?
 19:18) - (0 ?
 19:18) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 19:18) - (0 ? 19:18) + 1))))) << (0 ? 19:18)))
                     | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 21:20) - (0 ?
 21:20) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 21:20) - (0 ?
 21:20) + 1))))) << (0 ?
 21:20))) | ((gctUINT32)((gctUINT32)(Config->termconfig[10]) & ((((1 ?
 21:20) - (0 ?
 21:20) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 21:20) - (0 ? 21:20) + 1))))) << (0 ? 21:20)))
                     | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 23:22) - (0 ?
 23:22) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 23:22) - (0 ?
 23:22) + 1))))) << (0 ?
 23:22))) | ((gctUINT32)((gctUINT32)(Config->termconfig[11]) & ((((1 ?
 23:22) - (0 ?
 23:22) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 23:22) - (0 ? 23:22) + 1))))) << (0 ? 23:22)))
                     | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 25:24) - (0 ?
 25:24) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 25:24) - (0 ?
 25:24) + 1))))) << (0 ?
 25:24))) | ((gctUINT32)((gctUINT32)(Config->termconfig[12]) & ((((1 ?
 25:24) - (0 ?
 25:24) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 25:24) - (0 ? 25:24) + 1))))) << (0 ? 25:24)))
                     | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 27:26) - (0 ?
 27:26) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 27:26) - (0 ?
 27:26) + 1))))) << (0 ?
 27:26))) | ((gctUINT32)((gctUINT32)(Config->termconfig[13]) & ((((1 ?
 27:26) - (0 ?
 27:26) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 27:26) - (0 ? 27:26) + 1))))) << (0 ? 27:26)))
                     | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 29:28) - (0 ?
 29:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 29:28) - (0 ?
 29:28) + 1))))) << (0 ?
 29:28))) | ((gctUINT32)((gctUINT32)(Config->termconfig[14]) & ((((1 ?
 29:28) - (0 ?
 29:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 29:28) - (0 ? 29:28) + 1))))) << (0 ? 29:28)))
                     | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 31:30) - (0 ?
 31:30) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:30) - (0 ?
 31:30) + 1))))) << (0 ?
 31:30))) | ((gctUINT32)((gctUINT32)(Config->termconfig[15]) & ((((1 ?
 31:30) - (0 ?
 31:30) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:30) - (0 ? 31:30) + 1))))) << (0 ? 31:30)))
                     );

    Uniform->uniform.aSelect = (
                    ((Config->aselect[0] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 1:0) - (0 ?
 1:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 1:0) - (0 ?
 1:0) + 1))))) << (0 ?
 1:0))) | ((gctUINT32)(0x0 & ((((1 ?
 1:0) - (0 ?
 1:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 1:0) - (0 ?
 1:0) + 1))))) << (0 ?
 1:0))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 1:0) - (0 ?
 1:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 1:0) - (0 ?
 1:0) + 1))))) << (0 ?
 1:0))) | ((gctUINT32)(0x1 & ((((1 ?
 1:0) - (0 ?
 1:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 1:0) - (0 ? 1:0) + 1))))) << (0 ? 1:0))))
                  | ((Config->aselect[1] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 3:2) - (0 ?
 3:2) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 3:2) - (0 ?
 3:2) + 1))))) << (0 ?
 3:2))) | ((gctUINT32)(0x0 & ((((1 ?
 3:2) - (0 ?
 3:2) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 3:2) - (0 ?
 3:2) + 1))))) << (0 ?
 3:2))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 3:2) - (0 ?
 3:2) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 3:2) - (0 ?
 3:2) + 1))))) << (0 ?
 3:2))) | ((gctUINT32)(0x1 & ((((1 ?
 3:2) - (0 ?
 3:2) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 3:2) - (0 ? 3:2) + 1))))) << (0 ? 3:2))))
                  | ((Config->aselect[2] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 5:4) - (0 ?
 5:4) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 5:4) - (0 ?
 5:4) + 1))))) << (0 ?
 5:4))) | ((gctUINT32)(0x0 & ((((1 ?
 5:4) - (0 ?
 5:4) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 5:4) - (0 ?
 5:4) + 1))))) << (0 ?
 5:4))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 5:4) - (0 ?
 5:4) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 5:4) - (0 ?
 5:4) + 1))))) << (0 ?
 5:4))) | ((gctUINT32)(0x1 & ((((1 ?
 5:4) - (0 ?
 5:4) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 5:4) - (0 ? 5:4) + 1))))) << (0 ? 5:4))))
                  | ((Config->aselect[3] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 7:6) - (0 ?
 7:6) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 7:6) - (0 ?
 7:6) + 1))))) << (0 ?
 7:6))) | ((gctUINT32)(0x0 & ((((1 ?
 7:6) - (0 ?
 7:6) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 7:6) - (0 ?
 7:6) + 1))))) << (0 ?
 7:6))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 7:6) - (0 ?
 7:6) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 7:6) - (0 ?
 7:6) + 1))))) << (0 ?
 7:6))) | ((gctUINT32)(0x1 & ((((1 ?
 7:6) - (0 ?
 7:6) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 7:6) - (0 ? 7:6) + 1))))) << (0 ? 7:6))))
                  | ((Config->aselect[4] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 9:8) - (0 ?
 9:8) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 9:8) - (0 ?
 9:8) + 1))))) << (0 ?
 9:8))) | ((gctUINT32)(0x0 & ((((1 ?
 9:8) - (0 ?
 9:8) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 9:8) - (0 ?
 9:8) + 1))))) << (0 ?
 9:8))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 9:8) - (0 ?
 9:8) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 9:8) - (0 ?
 9:8) + 1))))) << (0 ?
 9:8))) | ((gctUINT32)(0x1 & ((((1 ?
 9:8) - (0 ?
 9:8) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 9:8) - (0 ? 9:8) + 1))))) << (0 ? 9:8))))
                  | ((Config->aselect[5] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 11:10) - (0 ?
 11:10) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 11:10) - (0 ?
 11:10) + 1))))) << (0 ?
 11:10))) | ((gctUINT32)(0x0 & ((((1 ?
 11:10) - (0 ?
 11:10) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 11:10) - (0 ?
 11:10) + 1))))) << (0 ?
 11:10))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 11:10) - (0 ?
 11:10) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 11:10) - (0 ?
 11:10) + 1))))) << (0 ?
 11:10))) | ((gctUINT32)(0x1 & ((((1 ?
 11:10) - (0 ?
 11:10) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 11:10) - (0 ? 11:10) + 1))))) << (0 ? 11:10))))
                  | ((Config->aselect[6] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 13:12) - (0 ?
 13:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 13:12) - (0 ?
 13:12) + 1))))) << (0 ?
 13:12))) | ((gctUINT32)(0x0 & ((((1 ?
 13:12) - (0 ?
 13:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 13:12) - (0 ?
 13:12) + 1))))) << (0 ?
 13:12))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 13:12) - (0 ?
 13:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 13:12) - (0 ?
 13:12) + 1))))) << (0 ?
 13:12))) | ((gctUINT32)(0x1 & ((((1 ?
 13:12) - (0 ?
 13:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 13:12) - (0 ? 13:12) + 1))))) << (0 ? 13:12))))
                  | ((Config->aselect[7] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 15:14) - (0 ?
 15:14) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:14) - (0 ?
 15:14) + 1))))) << (0 ?
 15:14))) | ((gctUINT32)(0x0 & ((((1 ?
 15:14) - (0 ?
 15:14) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:14) - (0 ?
 15:14) + 1))))) << (0 ?
 15:14))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 15:14) - (0 ?
 15:14) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:14) - (0 ?
 15:14) + 1))))) << (0 ?
 15:14))) | ((gctUINT32)(0x1 & ((((1 ?
 15:14) - (0 ?
 15:14) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:14) - (0 ? 15:14) + 1))))) << (0 ? 15:14))))
                  | ((Config->aselect[8] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 17:16) - (0 ?
 17:16) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 17:16) - (0 ?
 17:16) + 1))))) << (0 ?
 17:16))) | ((gctUINT32)(0x0 & ((((1 ?
 17:16) - (0 ?
 17:16) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 17:16) - (0 ?
 17:16) + 1))))) << (0 ?
 17:16))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 17:16) - (0 ?
 17:16) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 17:16) - (0 ?
 17:16) + 1))))) << (0 ?
 17:16))) | ((gctUINT32)(0x1 & ((((1 ?
 17:16) - (0 ?
 17:16) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 17:16) - (0 ? 17:16) + 1))))) << (0 ? 17:16))))
                  | ((Config->aselect[9] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 19:18) - (0 ?
 19:18) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 19:18) - (0 ?
 19:18) + 1))))) << (0 ?
 19:18))) | ((gctUINT32)(0x0 & ((((1 ?
 19:18) - (0 ?
 19:18) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 19:18) - (0 ?
 19:18) + 1))))) << (0 ?
 19:18))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 19:18) - (0 ?
 19:18) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 19:18) - (0 ?
 19:18) + 1))))) << (0 ?
 19:18))) | ((gctUINT32)(0x1 & ((((1 ?
 19:18) - (0 ?
 19:18) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 19:18) - (0 ? 19:18) + 1))))) << (0 ? 19:18))))
                  | ((Config->aselect[10] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 21:20) - (0 ?
 21:20) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 21:20) - (0 ?
 21:20) + 1))))) << (0 ?
 21:20))) | ((gctUINT32)(0x0 & ((((1 ?
 21:20) - (0 ?
 21:20) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 21:20) - (0 ?
 21:20) + 1))))) << (0 ?
 21:20))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 21:20) - (0 ?
 21:20) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 21:20) - (0 ?
 21:20) + 1))))) << (0 ?
 21:20))) | ((gctUINT32)(0x1 & ((((1 ?
 21:20) - (0 ?
 21:20) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 21:20) - (0 ? 21:20) + 1))))) << (0 ? 21:20))))
                  | ((Config->aselect[11] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 23:22) - (0 ?
 23:22) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 23:22) - (0 ?
 23:22) + 1))))) << (0 ?
 23:22))) | ((gctUINT32)(0x0 & ((((1 ?
 23:22) - (0 ?
 23:22) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 23:22) - (0 ?
 23:22) + 1))))) << (0 ?
 23:22))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 23:22) - (0 ?
 23:22) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 23:22) - (0 ?
 23:22) + 1))))) << (0 ?
 23:22))) | ((gctUINT32)(0x1 & ((((1 ?
 23:22) - (0 ?
 23:22) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 23:22) - (0 ? 23:22) + 1))))) << (0 ? 23:22))))
                  | ((Config->aselect[12] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 25:24) - (0 ?
 25:24) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 25:24) - (0 ?
 25:24) + 1))))) << (0 ?
 25:24))) | ((gctUINT32)(0x0 & ((((1 ?
 25:24) - (0 ?
 25:24) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 25:24) - (0 ?
 25:24) + 1))))) << (0 ?
 25:24))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 25:24) - (0 ?
 25:24) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 25:24) - (0 ?
 25:24) + 1))))) << (0 ?
 25:24))) | ((gctUINT32)(0x1 & ((((1 ?
 25:24) - (0 ?
 25:24) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 25:24) - (0 ? 25:24) + 1))))) << (0 ? 25:24))))
                  | ((Config->aselect[13] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 27:26) - (0 ?
 27:26) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 27:26) - (0 ?
 27:26) + 1))))) << (0 ?
 27:26))) | ((gctUINT32)(0x0 & ((((1 ?
 27:26) - (0 ?
 27:26) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 27:26) - (0 ?
 27:26) + 1))))) << (0 ?
 27:26))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 27:26) - (0 ?
 27:26) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 27:26) - (0 ?
 27:26) + 1))))) << (0 ?
 27:26))) | ((gctUINT32)(0x1 & ((((1 ?
 27:26) - (0 ?
 27:26) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 27:26) - (0 ? 27:26) + 1))))) << (0 ? 27:26))))
                  | ((Config->aselect[14] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 29:28) - (0 ?
 29:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 29:28) - (0 ?
 29:28) + 1))))) << (0 ?
 29:28))) | ((gctUINT32)(0x0 & ((((1 ?
 29:28) - (0 ?
 29:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 29:28) - (0 ?
 29:28) + 1))))) << (0 ?
 29:28))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 29:28) - (0 ?
 29:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 29:28) - (0 ?
 29:28) + 1))))) << (0 ?
 29:28))) | ((gctUINT32)(0x1 & ((((1 ?
 29:28) - (0 ?
 29:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 29:28) - (0 ? 29:28) + 1))))) << (0 ? 29:28))))
                  | ((Config->aselect[15] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 31:30) - (0 ?
 31:30) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:30) - (0 ?
 31:30) + 1))))) << (0 ?
 31:30))) | ((gctUINT32)(0x0 & ((((1 ?
 31:30) - (0 ?
 31:30) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:30) - (0 ?
 31:30) + 1))))) << (0 ?
 31:30))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 31:30) - (0 ?
 31:30) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:30) - (0 ?
 31:30) + 1))))) << (0 ?
 31:30))) | ((gctUINT32)(0x1 & ((((1 ?
 31:30) - (0 ?
 31:30) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:30) - (0 ? 31:30) + 1))))) << (0 ? 31:30))))
                  );

    Uniform->uniform.aBin[0] = (
                    (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 3:0) - (0 ?
 3:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 3:0) - (0 ?
 3:0) + 1))))) << (0 ?
 3:0))) | ((gctUINT32)((gctUINT32)(Offset0 + Config->abin0[0]) & ((((1 ?
 3:0) - (0 ?
 3:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 3:0) - (0 ? 3:0) + 1))))) << (0 ? 3:0)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 7:4) - (0 ?
 7:4) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 7:4) - (0 ?
 7:4) + 1))))) << (0 ?
 7:4))) | ((gctUINT32)((gctUINT32)(Offset0 + Config->abin0[1]) & ((((1 ?
 7:4) - (0 ?
 7:4) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 7:4) - (0 ? 7:4) + 1))))) << (0 ? 7:4)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 11:8) - (0 ?
 11:8) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 11:8) - (0 ?
 11:8) + 1))))) << (0 ?
 11:8))) | ((gctUINT32)((gctUINT32)(Offset0 + Config->abin0[2]) & ((((1 ?
 11:8) - (0 ?
 11:8) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 11:8) - (0 ? 11:8) + 1))))) << (0 ? 11:8)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 15:12) - (0 ?
 15:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:12) - (0 ?
 15:12) + 1))))) << (0 ?
 15:12))) | ((gctUINT32)((gctUINT32)(Offset0 + Config->abin0[3]) & ((((1 ?
 15:12) - (0 ?
 15:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:12) - (0 ? 15:12) + 1))))) << (0 ? 15:12)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 19:16) - (0 ?
 19:16) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 19:16) - (0 ?
 19:16) + 1))))) << (0 ?
 19:16))) | ((gctUINT32)((gctUINT32)(Offset1 + Config->abin0[4]) & ((((1 ?
 19:16) - (0 ?
 19:16) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 19:16) - (0 ? 19:16) + 1))))) << (0 ? 19:16)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 23:20) - (0 ?
 23:20) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 23:20) - (0 ?
 23:20) + 1))))) << (0 ?
 23:20))) | ((gctUINT32)((gctUINT32)(Offset1 + Config->abin0[5]) & ((((1 ?
 23:20) - (0 ?
 23:20) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 23:20) - (0 ? 23:20) + 1))))) << (0 ? 23:20)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 27:24) - (0 ?
 27:24) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 27:24) - (0 ?
 27:24) + 1))))) << (0 ?
 27:24))) | ((gctUINT32)((gctUINT32)(Offset1 + Config->abin0[6]) & ((((1 ?
 27:24) - (0 ?
 27:24) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 27:24) - (0 ? 27:24) + 1))))) << (0 ? 27:24)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 31:28) - (0 ?
 31:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:28) - (0 ?
 31:28) + 1))))) << (0 ?
 31:28))) | ((gctUINT32)((gctUINT32)(Offset1 + Config->abin0[7]) & ((((1 ?
 31:28) - (0 ?
 31:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:28) - (0 ? 31:28) + 1))))) << (0 ? 31:28)))
                  );

    Uniform->uniform.aBin[1] = (
                    (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 3:0) - (0 ?
 3:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 3:0) - (0 ?
 3:0) + 1))))) << (0 ?
 3:0))) | ((gctUINT32)((gctUINT32)(Offset2 + Config->abin1[0]) & ((((1 ?
 3:0) - (0 ?
 3:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 3:0) - (0 ? 3:0) + 1))))) << (0 ? 3:0)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 7:4) - (0 ?
 7:4) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 7:4) - (0 ?
 7:4) + 1))))) << (0 ?
 7:4))) | ((gctUINT32)((gctUINT32)(Offset2 + Config->abin1[1]) & ((((1 ?
 7:4) - (0 ?
 7:4) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 7:4) - (0 ? 7:4) + 1))))) << (0 ? 7:4)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 11:8) - (0 ?
 11:8) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 11:8) - (0 ?
 11:8) + 1))))) << (0 ?
 11:8))) | ((gctUINT32)((gctUINT32)(Offset2 + Config->abin1[2]) & ((((1 ?
 11:8) - (0 ?
 11:8) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 11:8) - (0 ? 11:8) + 1))))) << (0 ? 11:8)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 15:12) - (0 ?
 15:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:12) - (0 ?
 15:12) + 1))))) << (0 ?
 15:12))) | ((gctUINT32)((gctUINT32)(Offset2 + Config->abin1[3]) & ((((1 ?
 15:12) - (0 ?
 15:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:12) - (0 ? 15:12) + 1))))) << (0 ? 15:12)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 19:16) - (0 ?
 19:16) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 19:16) - (0 ?
 19:16) + 1))))) << (0 ?
 19:16))) | ((gctUINT32)((gctUINT32)(Offset3 + Config->abin1[4]) & ((((1 ?
 19:16) - (0 ?
 19:16) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 19:16) - (0 ? 19:16) + 1))))) << (0 ? 19:16)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 23:20) - (0 ?
 23:20) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 23:20) - (0 ?
 23:20) + 1))))) << (0 ?
 23:20))) | ((gctUINT32)((gctUINT32)(Offset3 + Config->abin1[5]) & ((((1 ?
 23:20) - (0 ?
 23:20) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 23:20) - (0 ? 23:20) + 1))))) << (0 ? 23:20)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 27:24) - (0 ?
 27:24) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 27:24) - (0 ?
 27:24) + 1))))) << (0 ?
 27:24))) | ((gctUINT32)((gctUINT32)(Offset3 + Config->abin1[6]) & ((((1 ?
 27:24) - (0 ?
 27:24) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 27:24) - (0 ? 27:24) + 1))))) << (0 ? 27:24)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 31:28) - (0 ?
 31:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:28) - (0 ?
 31:28) + 1))))) << (0 ?
 31:28))) | ((gctUINT32)((gctUINT32)(Offset3 + Config->abin1[7]) & ((((1 ?
 31:28) - (0 ?
 31:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:28) - (0 ? 31:28) + 1))))) << (0 ? 31:28)))
                  );

    Uniform->uniform.bSelect = (
                    ((Config->bselect[0] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 1:0) - (0 ?
 1:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 1:0) - (0 ?
 1:0) + 1))))) << (0 ?
 1:0))) | ((gctUINT32)(0x0 & ((((1 ?
 1:0) - (0 ?
 1:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 1:0) - (0 ?
 1:0) + 1))))) << (0 ?
 1:0))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 1:0) - (0 ?
 1:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 1:0) - (0 ?
 1:0) + 1))))) << (0 ?
 1:0))) | ((gctUINT32)(0x1 & ((((1 ?
 1:0) - (0 ?
 1:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 1:0) - (0 ? 1:0) + 1))))) << (0 ? 1:0))))
                  | ((Config->bselect[1] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 3:2) - (0 ?
 3:2) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 3:2) - (0 ?
 3:2) + 1))))) << (0 ?
 3:2))) | ((gctUINT32)(0x0 & ((((1 ?
 3:2) - (0 ?
 3:2) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 3:2) - (0 ?
 3:2) + 1))))) << (0 ?
 3:2))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 3:2) - (0 ?
 3:2) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 3:2) - (0 ?
 3:2) + 1))))) << (0 ?
 3:2))) | ((gctUINT32)(0x1 & ((((1 ?
 3:2) - (0 ?
 3:2) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 3:2) - (0 ? 3:2) + 1))))) << (0 ? 3:2))))
                  | ((Config->bselect[2] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 5:4) - (0 ?
 5:4) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 5:4) - (0 ?
 5:4) + 1))))) << (0 ?
 5:4))) | ((gctUINT32)(0x0 & ((((1 ?
 5:4) - (0 ?
 5:4) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 5:4) - (0 ?
 5:4) + 1))))) << (0 ?
 5:4))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 5:4) - (0 ?
 5:4) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 5:4) - (0 ?
 5:4) + 1))))) << (0 ?
 5:4))) | ((gctUINT32)(0x1 & ((((1 ?
 5:4) - (0 ?
 5:4) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 5:4) - (0 ? 5:4) + 1))))) << (0 ? 5:4))))
                  | ((Config->bselect[3] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 7:6) - (0 ?
 7:6) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 7:6) - (0 ?
 7:6) + 1))))) << (0 ?
 7:6))) | ((gctUINT32)(0x0 & ((((1 ?
 7:6) - (0 ?
 7:6) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 7:6) - (0 ?
 7:6) + 1))))) << (0 ?
 7:6))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 7:6) - (0 ?
 7:6) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 7:6) - (0 ?
 7:6) + 1))))) << (0 ?
 7:6))) | ((gctUINT32)(0x1 & ((((1 ?
 7:6) - (0 ?
 7:6) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 7:6) - (0 ? 7:6) + 1))))) << (0 ? 7:6))))
                  | ((Config->bselect[4] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 9:8) - (0 ?
 9:8) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 9:8) - (0 ?
 9:8) + 1))))) << (0 ?
 9:8))) | ((gctUINT32)(0x0 & ((((1 ?
 9:8) - (0 ?
 9:8) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 9:8) - (0 ?
 9:8) + 1))))) << (0 ?
 9:8))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 9:8) - (0 ?
 9:8) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 9:8) - (0 ?
 9:8) + 1))))) << (0 ?
 9:8))) | ((gctUINT32)(0x1 & ((((1 ?
 9:8) - (0 ?
 9:8) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 9:8) - (0 ? 9:8) + 1))))) << (0 ? 9:8))))
                  | ((Config->bselect[5] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 11:10) - (0 ?
 11:10) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 11:10) - (0 ?
 11:10) + 1))))) << (0 ?
 11:10))) | ((gctUINT32)(0x0 & ((((1 ?
 11:10) - (0 ?
 11:10) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 11:10) - (0 ?
 11:10) + 1))))) << (0 ?
 11:10))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 11:10) - (0 ?
 11:10) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 11:10) - (0 ?
 11:10) + 1))))) << (0 ?
 11:10))) | ((gctUINT32)(0x1 & ((((1 ?
 11:10) - (0 ?
 11:10) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 11:10) - (0 ? 11:10) + 1))))) << (0 ? 11:10))))
                  | ((Config->bselect[6] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 13:12) - (0 ?
 13:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 13:12) - (0 ?
 13:12) + 1))))) << (0 ?
 13:12))) | ((gctUINT32)(0x0 & ((((1 ?
 13:12) - (0 ?
 13:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 13:12) - (0 ?
 13:12) + 1))))) << (0 ?
 13:12))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 13:12) - (0 ?
 13:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 13:12) - (0 ?
 13:12) + 1))))) << (0 ?
 13:12))) | ((gctUINT32)(0x1 & ((((1 ?
 13:12) - (0 ?
 13:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 13:12) - (0 ? 13:12) + 1))))) << (0 ? 13:12))))
                  | ((Config->bselect[7] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 15:14) - (0 ?
 15:14) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:14) - (0 ?
 15:14) + 1))))) << (0 ?
 15:14))) | ((gctUINT32)(0x0 & ((((1 ?
 15:14) - (0 ?
 15:14) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:14) - (0 ?
 15:14) + 1))))) << (0 ?
 15:14))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 15:14) - (0 ?
 15:14) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:14) - (0 ?
 15:14) + 1))))) << (0 ?
 15:14))) | ((gctUINT32)(0x1 & ((((1 ?
 15:14) - (0 ?
 15:14) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:14) - (0 ? 15:14) + 1))))) << (0 ? 15:14))))
                  | ((Config->bselect[8] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 17:16) - (0 ?
 17:16) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 17:16) - (0 ?
 17:16) + 1))))) << (0 ?
 17:16))) | ((gctUINT32)(0x0 & ((((1 ?
 17:16) - (0 ?
 17:16) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 17:16) - (0 ?
 17:16) + 1))))) << (0 ?
 17:16))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 17:16) - (0 ?
 17:16) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 17:16) - (0 ?
 17:16) + 1))))) << (0 ?
 17:16))) | ((gctUINT32)(0x1 & ((((1 ?
 17:16) - (0 ?
 17:16) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 17:16) - (0 ? 17:16) + 1))))) << (0 ? 17:16))))
                  | ((Config->bselect[9] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 19:18) - (0 ?
 19:18) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 19:18) - (0 ?
 19:18) + 1))))) << (0 ?
 19:18))) | ((gctUINT32)(0x0 & ((((1 ?
 19:18) - (0 ?
 19:18) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 19:18) - (0 ?
 19:18) + 1))))) << (0 ?
 19:18))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 19:18) - (0 ?
 19:18) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 19:18) - (0 ?
 19:18) + 1))))) << (0 ?
 19:18))) | ((gctUINT32)(0x1 & ((((1 ?
 19:18) - (0 ?
 19:18) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 19:18) - (0 ? 19:18) + 1))))) << (0 ? 19:18))))
                  | ((Config->bselect[10] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 21:20) - (0 ?
 21:20) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 21:20) - (0 ?
 21:20) + 1))))) << (0 ?
 21:20))) | ((gctUINT32)(0x0 & ((((1 ?
 21:20) - (0 ?
 21:20) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 21:20) - (0 ?
 21:20) + 1))))) << (0 ?
 21:20))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 21:20) - (0 ?
 21:20) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 21:20) - (0 ?
 21:20) + 1))))) << (0 ?
 21:20))) | ((gctUINT32)(0x1 & ((((1 ?
 21:20) - (0 ?
 21:20) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 21:20) - (0 ? 21:20) + 1))))) << (0 ? 21:20))))
                  | ((Config->bselect[11] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 23:22) - (0 ?
 23:22) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 23:22) - (0 ?
 23:22) + 1))))) << (0 ?
 23:22))) | ((gctUINT32)(0x0 & ((((1 ?
 23:22) - (0 ?
 23:22) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 23:22) - (0 ?
 23:22) + 1))))) << (0 ?
 23:22))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 23:22) - (0 ?
 23:22) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 23:22) - (0 ?
 23:22) + 1))))) << (0 ?
 23:22))) | ((gctUINT32)(0x1 & ((((1 ?
 23:22) - (0 ?
 23:22) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 23:22) - (0 ? 23:22) + 1))))) << (0 ? 23:22))))
                  | ((Config->bselect[12] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 25:24) - (0 ?
 25:24) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 25:24) - (0 ?
 25:24) + 1))))) << (0 ?
 25:24))) | ((gctUINT32)(0x0 & ((((1 ?
 25:24) - (0 ?
 25:24) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 25:24) - (0 ?
 25:24) + 1))))) << (0 ?
 25:24))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 25:24) - (0 ?
 25:24) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 25:24) - (0 ?
 25:24) + 1))))) << (0 ?
 25:24))) | ((gctUINT32)(0x1 & ((((1 ?
 25:24) - (0 ?
 25:24) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 25:24) - (0 ? 25:24) + 1))))) << (0 ? 25:24))))
                  | ((Config->bselect[13] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 27:26) - (0 ?
 27:26) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 27:26) - (0 ?
 27:26) + 1))))) << (0 ?
 27:26))) | ((gctUINT32)(0x0 & ((((1 ?
 27:26) - (0 ?
 27:26) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 27:26) - (0 ?
 27:26) + 1))))) << (0 ?
 27:26))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 27:26) - (0 ?
 27:26) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 27:26) - (0 ?
 27:26) + 1))))) << (0 ?
 27:26))) | ((gctUINT32)(0x1 & ((((1 ?
 27:26) - (0 ?
 27:26) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 27:26) - (0 ? 27:26) + 1))))) << (0 ? 27:26))))
                  | ((Config->bselect[14] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 29:28) - (0 ?
 29:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 29:28) - (0 ?
 29:28) + 1))))) << (0 ?
 29:28))) | ((gctUINT32)(0x0 & ((((1 ?
 29:28) - (0 ?
 29:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 29:28) - (0 ?
 29:28) + 1))))) << (0 ?
 29:28))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 29:28) - (0 ?
 29:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 29:28) - (0 ?
 29:28) + 1))))) << (0 ?
 29:28))) | ((gctUINT32)(0x1 & ((((1 ?
 29:28) - (0 ?
 29:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 29:28) - (0 ? 29:28) + 1))))) << (0 ? 29:28))))
                  | ((Config->bselect[15] == 0) ?
 (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 31:30) - (0 ?
 31:30) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:30) - (0 ?
 31:30) + 1))))) << (0 ?
 31:30))) | ((gctUINT32)(0x0 & ((((1 ?
 31:30) - (0 ?
 31:30) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:30) - (0 ?
 31:30) + 1))))) << (0 ?
 31:30))) : (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 31:30) - (0 ?
 31:30) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:30) - (0 ?
 31:30) + 1))))) << (0 ?
 31:30))) | ((gctUINT32)(0x1 & ((((1 ?
 31:30) - (0 ?
 31:30) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:30) - (0 ? 31:30) + 1))))) << (0 ? 31:30))))
                  );

    Uniform->uniform.bBin[0] = (
                    (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 3:0) - (0 ?
 3:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 3:0) - (0 ?
 3:0) + 1))))) << (0 ?
 3:0))) | ((gctUINT32)((gctUINT32)(Offset0 + Config->bbin0[0]) & ((((1 ?
 3:0) - (0 ?
 3:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 3:0) - (0 ? 3:0) + 1))))) << (0 ? 3:0)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 7:4) - (0 ?
 7:4) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 7:4) - (0 ?
 7:4) + 1))))) << (0 ?
 7:4))) | ((gctUINT32)((gctUINT32)(Offset0 + Config->bbin0[1]) & ((((1 ?
 7:4) - (0 ?
 7:4) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 7:4) - (0 ? 7:4) + 1))))) << (0 ? 7:4)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 11:8) - (0 ?
 11:8) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 11:8) - (0 ?
 11:8) + 1))))) << (0 ?
 11:8))) | ((gctUINT32)((gctUINT32)(Offset0 + Config->bbin0[2]) & ((((1 ?
 11:8) - (0 ?
 11:8) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 11:8) - (0 ? 11:8) + 1))))) << (0 ? 11:8)))
                  | ((Config->termconfig[3] == VX_ACCUMULATOR && IgnoreOffset)
                        ?
(((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 15:12) - (0 ?
 15:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:12) - (0 ?
 15:12) + 1))))) << (0 ?
 15:12))) | ((gctUINT32)((gctUINT32)(Config->bbin0[3]) & ((((1 ?
 15:12) - (0 ?
 15:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:12) - (0 ? 15:12) + 1))))) << (0 ? 15:12)))
                        :(((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 15:12) - (0 ?
 15:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:12) - (0 ?
 15:12) + 1))))) << (0 ?
 15:12))) | ((gctUINT32)((gctUINT32)(Offset0 + Config->bbin0[3]) & ((((1 ?
 15:12) - (0 ?
 15:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:12) - (0 ? 15:12) + 1))))) << (0 ? 15:12)))
                    )
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 19:16) - (0 ?
 19:16) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 19:16) - (0 ?
 19:16) + 1))))) << (0 ?
 19:16))) | ((gctUINT32)((gctUINT32)(Offset1 + Config->bbin0[4]) & ((((1 ?
 19:16) - (0 ?
 19:16) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 19:16) - (0 ? 19:16) + 1))))) << (0 ? 19:16)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 23:20) - (0 ?
 23:20) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 23:20) - (0 ?
 23:20) + 1))))) << (0 ?
 23:20))) | ((gctUINT32)((gctUINT32)(Offset1 + Config->bbin0[5]) & ((((1 ?
 23:20) - (0 ?
 23:20) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 23:20) - (0 ? 23:20) + 1))))) << (0 ? 23:20)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 27:24) - (0 ?
 27:24) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 27:24) - (0 ?
 27:24) + 1))))) << (0 ?
 27:24))) | ((gctUINT32)((gctUINT32)(Offset1 + Config->bbin0[6]) & ((((1 ?
 27:24) - (0 ?
 27:24) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 27:24) - (0 ? 27:24) + 1))))) << (0 ? 27:24)))
                  | ((Config->termconfig[7] == VX_ACCUMULATOR && IgnoreOffset)
                        ?
(((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 31:28) - (0 ?
 31:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:28) - (0 ?
 31:28) + 1))))) << (0 ?
 31:28))) | ((gctUINT32)((gctUINT32)(Config->bbin0[7]) & ((((1 ?
 31:28) - (0 ?
 31:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:28) - (0 ? 31:28) + 1))))) << (0 ? 31:28)))
                        :(((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 31:28) - (0 ?
 31:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:28) - (0 ?
 31:28) + 1))))) << (0 ?
 31:28))) | ((gctUINT32)((gctUINT32)(Offset1 + Config->bbin0[7]) & ((((1 ?
 31:28) - (0 ?
 31:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:28) - (0 ? 31:28) + 1))))) << (0 ? 31:28)))
                    )
                  );

    Uniform->uniform.bBin[1] = (
                    (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 3:0) - (0 ?
 3:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 3:0) - (0 ?
 3:0) + 1))))) << (0 ?
 3:0))) | ((gctUINT32)((gctUINT32)(Offset2 + Config->bbin1[0]) & ((((1 ?
 3:0) - (0 ?
 3:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 3:0) - (0 ? 3:0) + 1))))) << (0 ? 3:0)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 7:4) - (0 ?
 7:4) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 7:4) - (0 ?
 7:4) + 1))))) << (0 ?
 7:4))) | ((gctUINT32)((gctUINT32)(Offset2 + Config->bbin1[1]) & ((((1 ?
 7:4) - (0 ?
 7:4) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 7:4) - (0 ? 7:4) + 1))))) << (0 ? 7:4)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 11:8) - (0 ?
 11:8) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 11:8) - (0 ?
 11:8) + 1))))) << (0 ?
 11:8))) | ((gctUINT32)((gctUINT32)(Offset2 + Config->bbin1[2]) & ((((1 ?
 11:8) - (0 ?
 11:8) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 11:8) - (0 ? 11:8) + 1))))) << (0 ? 11:8)))
                  | ((Config->termconfig[11] == VX_ACCUMULATOR && IgnoreOffset)
                        ?
(((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 15:12) - (0 ?
 15:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:12) - (0 ?
 15:12) + 1))))) << (0 ?
 15:12))) | ((gctUINT32)((gctUINT32)(Config->bbin1[3]) & ((((1 ?
 15:12) - (0 ?
 15:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:12) - (0 ? 15:12) + 1))))) << (0 ? 15:12)))
                        :(((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 15:12) - (0 ?
 15:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:12) - (0 ?
 15:12) + 1))))) << (0 ?
 15:12))) | ((gctUINT32)((gctUINT32)(Offset2 + Config->bbin1[3]) & ((((1 ?
 15:12) - (0 ?
 15:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 15:12) - (0 ? 15:12) + 1))))) << (0 ? 15:12)))
                    )
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 19:16) - (0 ?
 19:16) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 19:16) - (0 ?
 19:16) + 1))))) << (0 ?
 19:16))) | ((gctUINT32)((gctUINT32)(Offset3 + Config->bbin1[4]) & ((((1 ?
 19:16) - (0 ?
 19:16) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 19:16) - (0 ? 19:16) + 1))))) << (0 ? 19:16)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 23:20) - (0 ?
 23:20) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 23:20) - (0 ?
 23:20) + 1))))) << (0 ?
 23:20))) | ((gctUINT32)((gctUINT32)(Offset3 + Config->bbin1[5]) & ((((1 ?
 23:20) - (0 ?
 23:20) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 23:20) - (0 ? 23:20) + 1))))) << (0 ? 23:20)))
                  | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 27:24) - (0 ?
 27:24) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 27:24) - (0 ?
 27:24) + 1))))) << (0 ?
 27:24))) | ((gctUINT32)((gctUINT32)(Offset3 + Config->bbin1[6]) & ((((1 ?
 27:24) - (0 ?
 27:24) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 27:24) - (0 ? 27:24) + 1))))) << (0 ? 27:24)))
                  | ((Config->termconfig[15] == VX_ACCUMULATOR)
                        ?
(((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 31:28) - (0 ?
 31:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:28) - (0 ?
 31:28) + 1))))) << (0 ?
 31:28))) | ((gctUINT32)((gctUINT32)(Config->bbin1[7]) & ((((1 ?
 31:28) - (0 ?
 31:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:28) - (0 ? 31:28) + 1))))) << (0 ? 31:28)))
                        :(((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 31:28) - (0 ?
 31:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:28) - (0 ?
 31:28) + 1))))) << (0 ?
 31:28))) | ((gctUINT32)((gctUINT32)(Offset3 + Config->bbin1[7]) & ((((1 ?
 31:28) - (0 ?
 31:28) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 31:28) - (0 ? 31:28) + 1))))) << (0 ? 31:28)))
                    )
                  );

    Uniform->uniform.miscConfig = ((((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 4:0) - (0 ?
 4:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 4:0) - (0 ?
 4:0) + 1))))) << (0 ?
 4:0))) | ((gctUINT32)((gctUINT32)(Shift) & ((((1 ?
 4:0) - (0 ?
 4:0) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 4:0) - (0 ? 4:0) + 1))))) << (0 ? 4:0)))
                     | (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 10:8) - (0 ?
 10:8) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 10:8) - (0 ?
 10:8) + 1))))) << (0 ?
 10:8))) | ((gctUINT32)(0x3 & ((((1 ?
 10:8) - (0 ?
 10:8) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 10:8) - (0 ? 10:8) + 1))))) << (0 ? 10:8)))
                     );

    if(AccumulatorType == 0x6)
        Uniform->uniform.miscConfig |= (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 14:12) - (0 ?
 14:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 14:12) - (0 ?
 14:12) + 1))))) << (0 ?
 14:12))) | ((gctUINT32)(0x6 & ((((1 ?
 14:12) - (0 ?
 14:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 14:12) - (0 ? 14:12) + 1))))) << (0 ? 14:12)));
    else if(AccumulatorType == 0x5)
        Uniform->uniform.miscConfig |= (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 14:12) - (0 ?
 14:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 14:12) - (0 ?
 14:12) + 1))))) << (0 ?
 14:12))) | ((gctUINT32)(0x5 & ((((1 ?
 14:12) - (0 ?
 14:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 14:12) - (0 ? 14:12) + 1))))) << (0 ? 14:12)));
    else if(AccumulatorType == 0x2)
        Uniform->uniform.miscConfig |= (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 14:12) - (0 ?
 14:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 14:12) - (0 ?
 14:12) + 1))))) << (0 ?
 14:12))) | ((gctUINT32)(0x2 & ((((1 ?
 14:12) - (0 ?
 14:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 14:12) - (0 ? 14:12) + 1))))) << (0 ? 14:12)));
    else
        Uniform->uniform.miscConfig |= (((gctUINT32)(0) & ~((gctUINT32)(((((1 ?
 14:12) - (0 ?
 14:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 14:12) - (0 ?
 14:12) + 1))))) << (0 ?
 14:12))) | ((gctUINT32)(0x3 & ((((1 ?
 14:12) - (0 ?
 14:12) + 1) == 32) ?
 ~0 : (gctUINT32)(~((gctUINT64)(~0) << ((1 ?
 14:12) - (0 ? 14:12) + 1))))) << (0 ? 14:12)));

    Uniform->index = 4 * ((*Index) + 1);
    Uniform->num = 16 * 4;

    gcmFOOTER();
    return status;
}

static gceSTATUS _max_pooling(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gctINT32 size = Context->col;
    gcoVX_Instructions *Instructions = Context->instructions;
    gctUINT32 i = 0;
    gctINT16 off = (gctINT16)(-(gctINT32)(Context->row));
    RelOffset offset = {{0, 0}};
    gctUINT32 flag = 0;

    /*           x         y         z         w
     * r0 : |  srcx   |  srcy   |  srcx/2 |  dst_y  |
     * r1 : | x-1,y-1 | x-1,y-1 | x-1,y-1 | x-1,y-1 |
     * r2 : |   x,y   |   x,y   |   x,y   |   x,y   |
     * r3 : | x+1,y+1 | x+1,y+1 | x+1,y+1 | x+1,y+1 |
     * r4 : |dst0,dst1|dst2,dst3|dst4,dst5|         |
     * r5 : | start_y |  end_y  |  height |  all_h  |
     */

    gcmHEADER_ARG("Instructions=0x%x", Instructions);
    /*mov r5.xyzw, c2.zwxy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 2, gcdVX_ENABLE4(2, 3, 0, 1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*rshift.u32 r0.z, r0.x, 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

    /*add.u32 r5.xy, r5.xy, c3.ww */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE2(3, 3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    offset.u.x = off;
    offset.u.y = off;
    for (i = 0; i < (gctUINT32)size; i ++)
    {
        if (i == (gctUINT32)(size - 2))
            flag = Instructions->count;

        if(Context->borders == gcvVX_BORDER_MODE_CONSTANT)
        {
            /*mov r1/2/3, c3.z */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(i + 1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
        }

        /*img_load.u8 r1/2/3, c0, r0.xy, -1,-1*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(i + 1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset.raw, &Instructions->binarys[Instructions->count++]));

        offset.u.y += 1;

        if (i == 0)
        {
            /*mov.le r1 r0.z, r5.x(start_height_o), c3.z(min:0xfc00) */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x04, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE4(2, 2, 2, 2), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        }
        else
        {
            /*mov.ge r2/3 r0.z, r5.y(end_height_o), c3.z(min:0xfc00) */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x03, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(i + 1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE4(2, 2, 2, 2), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        }

    }

    if (Context->evisNoInst.isVX2)
    {
        /*vertMax3.u8, r4, r1, r2, r3 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x19, 0x3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 0x3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        /*horzMax3.u8, r4, r4 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x1C, 0x3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 0x3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
    }
    else if (!Context->evisNoInst.noFilter)
    {
        /*filter.box.u8 r4, r1, r2, r3*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x05, 0x3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 0x3 | (0x8 << 3), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
    }
    else
        gcmPRINT("not support filter or vertMax3/horzMax3");

    /*
    {
        gctUINT32 p = 0, index = 4;
        gcVXConfig config = {{0}};
        gcoVX_Kernel_Context_Uniform Uinform;

        for(p = 0; p < 16; p++)
              config.termconfig[p] = (p < 12 && (p % 4 == 0))?VX_ADD:VX_DISABLE;

        for(p = 0; p < 16; p++)
        {
            config.matrix[p]   = (p < 12 && (p % 4 == 0)) ? 1 : 0;
            config.aselect[p]  = 0;
        }

        for(p = 0; p < 8; p++)
        {
            config.abin0[p]    =(p % 4 == 0)?p/2:0;
            config.abin1[p]    = (p % 4 == 0)?(p + 8)/2:0;
        }

        _SetUniformItem(&index, 0, 0, 0, 0, 0, gcvTRUE, &config, 0x3, &Uinform);
    }
    */
    /*dp4.u8 r4[0-2], r4, r4, c4 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0A, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 2, (0x3 | (0x3 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4, &Instructions->binarys[Instructions->count++]));

    /*img_store.u8 c1, r0.zw, r4*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 2, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*mov r1, r3 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*add.u32 r0.yw, r0.yyww, c3.xxyy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE2(1, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE4(1, 1, 3, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE4(0, 0, 1, 1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*branch.u32 r0.w, r5.y, flag-count */
    gcmONERROR(gcoHARDWAREVX_Branch(0x04, flag-Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*add.u32 r0.y, r0.y, c3.x(-2) */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE1(0), gcvTRUE, &Instructions->binarys[Instructions->count++]));

    /*branch.u32 r0.y, c2.y, 0 */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, 0, 0x5, 2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 0x6;

OnError:
    gcmFOOTER();
    return status;
}


static gceSTATUS _lrn(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gcoVX_Instructions *Instructions = Context->instructions;
    RelOffset offset = {{ -1, 0 }};
    gctUINT32 flag;
    gctUINT32 i = 0;

    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    /*
     * r0 : |         |         | height-1|  index  |
     * r1 : | x-1,y-1 | x-1,y-1 | x-1,y-1 | x-1,y-1 |
     * r2 : |   x,y   |   x,y   |   x,y   |   x,y   |
     * r3 : | x+1,y+1 | x+1,y+1 | x+1,y+1 | x+1,y+1 |
     * r4 : |  shift  |  alpha  | index2  |         |
     * r5 : |   sum1  |   sum1  |   sum1  |   sum1  |
     * r6 : |   sum2  |   sum2  |   sum2  |   sum2  |
     * r7 : |   sum3  |   sum3  |   sum3  |   sum3  |
     *
     */

    /*mov r4.xyz, c4.xyw shift, alpha*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE3(0, 1, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE4(0, 1, 3, 3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*mov r0.zw, c2.xy  (height-1, 0)*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 2, gcdVX_SWIZZLE4(0, 1, 0, 1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*mov r1, 0*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

    offset.u.y = (1u << 5) - 1;

    /* img_load.s16 r1,c0,r0.xy, (-1,-1), load val0*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset.raw, &Instructions->binarys[Instructions->count++]));

    /*mov r1, r0.w, 0, 0, if(r0.w(index) == 0), 0->r1*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x05, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE4(3, 3, 3, 3), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE4(1, 1, 1, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

    /*mov r2, 0*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

    offset.u.y = (gctUINT16)0;
    /* img_load.s16 r2,c0,r0.xy, (-1,0), load val1*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset.raw, &Instructions->binarys[Instructions->count++]));

    /*mov r1, r0.w, r0.z, 0, r0.w(index) > r0.x(height-1), 0->r1*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x01, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE4(3, 3, 3, 3), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE4(0, 0, 0, 0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

    flag = Instructions->count;

    /*mov r3, 0*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

    offset.u.y = (gctUINT16)1;
    /* img_load.s16 r3,c0,r0.xy, (-1,1), load val2*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset.raw, &Instructions->binarys[Instructions->count++]));

    /*mov r1, r0.w, r0.z, 0, r0.w(index) > c2.z(height-2), 0->r1*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x01, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE4(3, 3, 3, 3), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE4(2, 2, 2, 2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

    /*dp4x4.evis.fp16 r5, r1, r1, c5    val0->sum0*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0A, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (1<<6)|(0x1 << 3) | 0x1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_Setuniform(2, 5, &Instructions->binarys[Instructions->count++]));

    /*dp4x4.evis.fp16 r6, r2, r2, c5    val2->sum2*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0A, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (1<<6)|(0x1 << 3) | 0x1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_Setuniform(2, 5, &Instructions->binarys[Instructions->count++]));

    /*dp4x4.evis.fp16 r7, r3, r3, c5    val2->sum3*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0A, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (1<<6)|(0x1 << 3) | 0x1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_Setuniform(2, 5, &Instructions->binarys[Instructions->count++]));

    /*add.f32 r5, r5, r6  sum1+sum2*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*add.f32 r5, r5, r7  sum1 + sum2 + sum3*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*mul.f32 r5, r5, 9  sum*sum*sum/9 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(1, 1/9.0f, &Instructions->binarys[Instructions->count++]));

    /*mad.f32 r6, r5, r4.y(alpha) ,r4.x(shift) sum*alpha+shift*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

    /*sum^0.75 = sum^(3/4) = (sum * sum * sum)^1/4 = e^(0.75*log(sum))*/
    /*mul.f32 r5, r6, r6  sum*sum */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*mul.f32 r5, r5, r6  sum*sum*sum */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    for (i = 0; i < 4; i ++)
    {
        /*sqrt.f32 r5.x/y/z/w, r5.x/y/z/w  sqrt(sum) */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x21, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count++]));

        /*sqrt.f32 r5.x/y/z/w, r5.x/y/z/w  sqrt(sqrt(sum)) */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x21, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count++]));
    }
    /*dp4.fp16 r6, r2, r2, c9   val1_32f fp16->fp32*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0A, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x1 | 0x0 << 3), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_Setuniform(2, 9, &Instructions->binarys[Instructions->count++]));

    for (i = 0; i < 4; i ++)
    {
        /*rcp.f32 r5.x/y/z/w, r5.x/y/z/w  1/(sum*sum*sum) */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x0C, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestinationExt(5, gcdVX_ENABLE1(i), gcvFALSE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    }

    /*mul.f32 r6, r6, r5   */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    if (Context->row == 2)
    {
    /*conv.s32 r6, r6; f32 -> f16 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x0, &Instructions->binarys[Instructions->count++]));

    /*dp4.fp16 r5, r6, r6, c13   val1_32f fp32->fp16*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0A, 0x1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x1 | 0x1 << 3), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 6, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_Setuniform(2, 13, &Instructions->binarys[Instructions->count++]));
    }

    /*img_store.evis.s16 c1, r0.xy, r5*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, (Context->row == 2)?3:7, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, (Context->row == 2)?5:6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*mov r1, r2*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*mov r2, r3*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*add.u32 r0.yw, r0.yw, 1*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE2(1, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1, &Instructions->binarys[Instructions->count++]));

    /*branch.u32 r0.w, r0.z, flag-count y <= (height-1)*/
    gcmONERROR(gcoHARDWAREVX_Branch(0x04, flag-Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*add.u32 r4.z, r4.z, 1*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1, &Instructions->binarys[Instructions->count++]));

    /*branch.u32 r4.z, 96, 1; y < depth*/
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, 1, 0x5, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 3, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 0x9;

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _filter(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gctUINT32 Kernel = Context->kernel;
    gctUINT32 Input = Context->input_type[0];
    gctUINT32 Output = Context->output_type[0];
    gctUINT32 Border = Context->borders;
    gcoVX_Instructions *Instructions = Context->instructions;
    gctUINT32 Evis = 0;
    RelOffset minusOne = {{ -1, -1 }};
    RelOffset zero = {{ -1, 0 }};
    RelOffset plusOne = {{ -1, 1 }};
    gctUINT32 end = 7;
    gctUINT32 flag;

    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    switch(Kernel)
    {
    case gcvVX_KERNEL_BOX_3x3:
        Evis = Input | (0x0 << 3);
        /*RTL/CMODEl requst box3x3 (end - start) < 6, */
        end = 3;
        break;
    case gcvVX_KERNEL_GAUSSIAN_3x3:
        Evis = Input | (0x1 << 3);
        break;
    case gcvVX_KERNEL_DILATE_3x3:
        Evis = Input | (0x8 << 3);
        break;
    case gcvVX_KERNEL_ERODE_3x3:
        Evis = Input | (0x9 << 3);
        break;
    case gcvVX_KERNEL_MEDIAN_3x3:
        Evis = Input | (0xA << 3);
        break;
    }

    if(Border == gcvVX_BORDER_MODE_CONSTANT || Border == gcvVX_BORDER_MODE_UNDEFINED)
    {
        /*mov r1, c3 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }

    /*img_load.u8 r1, c0, r0.xy, -1,-1*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, minusOne.raw, &Instructions->binarys[Instructions->count++]));

    if(Border == gcvVX_BORDER_MODE_CONSTANT || Border == gcvVX_BORDER_MODE_UNDEFINED)
    {
        /*mov r2, c3 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }

    /*img_load.u8 r2, c0, r0.xy, -1,0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, zero.raw, &Instructions->binarys[Instructions->count++]));

    flag = Instructions->count;
    if(Border == gcvVX_BORDER_MODE_CONSTANT || Border == gcvVX_BORDER_MODE_UNDEFINED)
    {
        /*mov r3, c3 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }

    /*img_load.u8 r3, c0, r0.xy, -1,1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusOne.raw, &Instructions->binarys[Instructions->count++]));

    /*filter.box.u8 r4, r1, r2, r3*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x05, Output, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, end, Evis, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*img_store.u8 c1, r0.xy, r4.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, end, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*mov r1, r2 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*mov r2, r3 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*add.u32 r0.yz, r0, 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE2(1, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

    /*branch.u32 r0.z, c2.x, flag-count */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, flag-Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 0x5;

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _nonlinearfilter(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gctUINT32 Kernel = Context->kernel;
    gctUINT32 Input = Context->input_type[0];
    gctUINT32 Output = Context->output_type[0];
    gctUINT32 Border = Context->borders;
    gctUINT16 origin_x = (gctUINT16)Context->policy;
    gctUINT16 origin_y = (gctUINT16)Context->rounding;
    gcoVX_Instructions *Instructions = Context->instructions;
    gctUINT32 Evis = 0;
    gctUINT32 end = Context->xstep - 1;
    gctUINT32 flag = 0;
    gcVXConfig                    config    = {{0}};
    gctUINT32                    *index     = Context->unifor_num;
    gcoVX_Kernel_Context_Uniform *Uinform   = Context->uniform;
    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    {
        gctUINT32 i      = 0;
        for (i = 0; i < 16; i++)
        {
            config.termconfig[i]   = VX_ADD;
            if(i < 8)
            {
                config.abin0[i]   = (gctUINT)(i/2);
            }
            else
            {
                config.abin1[i%8]   = (gctUINT)(i/2);
            }

            config.aselect[i]   = i%2 ? 1 : 0;
            config.matrix[i]    = (i+1)%2 ? 1 : (Kernel == gcvVX_KERNEL_SUBTRACT) ? -1 : 1;
        }
    }

    switch(Kernel)
    {
    case gcvVX_KERNEL_NONLINEAR_FILTER_MAX:
        Evis = Input | (0x8 << 3);
        break;
    case gcvVX_KERNEL_NONLINEAR_FILTER_MIN:
        Evis = Input | (0x9 << 3);
        break;
    case gcvVX_KERNEL_NONLINEAR_FILTER_MEDIAN:
        Evis = Input | (0xA << 3);
        break;
    }
    if (Context->row == 5 && Context->col == 5)
    {
        gctUINT32 i = 0;
        RelOffset offset5[5] = {{{ 0, 0 }}, {{ 0, 0 }}, {{ 0, 0 }}, {{ 0, 0 }}, {{ 0, 0 }}};

        /*                           x                                           y
         * r1: | x-2, y-2 | x-1, y-2 |   x, y-2 | x+1, y-1 | x+2, y-2 |          |
         * r2: | x-2, y-1 | x-1, y-1 |   x, y-1 | x+1, y-1 | x+2, y-1 |          |
         * r3: | x-2, y | x-1, y |   x, y | x+1, y | x+2, y-1 |          |
         * r4: | x-2, y+1 | x-1, y+1 |   x, y+1 | x+1, y+1 | x+2, y+1 |          |
         * r5: | x-2, y+1 | x-1, y+2 |   x, y+2 | x+1, y+1 | x+2, y+2 |          |
         * r6: |                    src0                   |                    src0                   |
         * r7: |                    src0                   |                    src0                   |
         * r8: |                    src0                   |                    src0                   |
         * r9: |                    src0                   |                    src0                   |
         * r10:|                    src0                   |                    src0                   |
         * r11:|                   output                  |                   output                  |
         */
        for (i = 0; i < 5; i++)
        {

            if(Border == gcvVX_BORDER_MODE_CONSTANT)
            {
                /*mov r(i + 1)(1/2/3/4/5), c3 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(i + 1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
            }

            /*img_load.u8 r(i + 1)(1/2/3/4/5), c0, r0.xy, -1,-1*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(i + 1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input), 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            offset5[i].u.x = offset5[i].u.x - origin_x;
            offset5[i].u.y = offset5[i].u.y + (gctUINT16)i - origin_y;
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset5[i].raw, &Instructions->binarys[Instructions->count++]));
        }


        if (Kernel != gcvVX_KERNEL_NONLINEAR_FILTER_MEDIAN)
        {
            for (i = 0; i < 5; i ++)
            {
                if (Context->volume == gcvVX_PARTTERN_MODE_CROSS || Context->volume == gcvVX_PARTTERN_MODE_DISK
                    || Context->volume == gcvVX_PARTTERN_MODE_OTHER)
                {
                    /*          x        y       z        w
                     * x max:
                     * c4 : 00000100 00000000 00000100 00000000
                     * c5 : 01010101 01000000 00000100 00000000
                     * c6 : 00000100 00000000 00000000 00000000
                     *
                     * + min:
                     * c4 : ffff00ff ff000000 ffff00ff ff000000
                     * c5 : 00000000 00000000 ffff00ff ff000000
                     * c6 : ffff00ff ff000000 00000000 00000000
                     */

                    if (Kernel == gcvVX_KERNEL_NONLINEAR_FILTER_MAX)
                    {
                        /*          x        y       z        w
                         * x max:
                         * c4 : 00000100 00000000 00000100 00000000
                         * c5 : 01010101 01000000 00000100 00000000
                         * c6 : 00000100 00000000 00000000 00000000
                         *
                         *
                         * r1: | 0000xx00 |   00     |          |          |
                         * r2: | 0000xx00 |   00     |          |          |
                         * r3: | xxxxxxxx |   xx     |          |          |
                         * r4: | 0000xx00 |   00     |          |          |
                         * r5: | 0000xx00 |   00     |          |          |
                         */
                        /* mul_shift.u8.clamp r1/2/3/4/5, r1/2/3/4/5, c4.x/y/z, 0 */
                        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x7, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetDestination(1 + i, gcdVX_ENABLE, gcvTRUE, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 4, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1 + i, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 4 + i/2, gcdVX_SWIZZLE2(i%2 * 2, i%2 * 2 + 1), 0, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
                    }
                    else if (Kernel == gcvVX_KERNEL_NONLINEAR_FILTER_MIN)
                    {
                        /*
                         * + min:
                         * c4 : ffff00ff ff000000 ffff00ff ff000000
                         * c5 : 00000000 00000000 ffff00ff ff000000
                         * c6 : ffff00ff ff000000 00000000 00000000
                         *
                         * r1: | ffffxxff |   ff     |          |          |
                         * r2: | ffffxxff |   ff     |          |          |
                         * r3: | xxxxxxxx |   xx     |          |          |
                         * r4: | ffffxxff |   ff     |          |          |
                         * r5: | ffffxxff |   ff     |          |          |
                         */
                        {
                            _SetUniformItem(index, 0, 0, 0, 0, 0, gcvTRUE, &config, Input, &Uinform[*index]);

                            /*mov r6, c4.x/y/z */
                            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                            gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4 + i/2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

                            /*dp2x8.u8 r1/2/3/4/5, r1/2/3/4/5, r6, c5_512 */
                            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0B, 0x7, &Instructions->binarys[Instructions->count]));
                            gcmONERROR(gcoHARDWAREVX_SetDestination(1 + i, gcdVX_ENABLE, gcvTRUE, &Instructions->binarys[Instructions->count]));
                            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1 + i, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 6, gcdVX_SWIZZLE2(i%2 * 2, i%2 * 2 + 1), 0, &Instructions->binarys[Instructions->count]));
                            gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));
                        }
                    }

                }
            }

            for (i = 0; i < 3; i++)
            {
                {
                    /*filter.box.u8 r6/7/8, r1/2/3, r2/3/4, r3/4/5*/
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x05, Output, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(6 + i, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, Evis, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1 + i, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2 + i, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3 + i, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
                }
            }
        }
        else
        {
            if (Context->volume == gcvVX_PARTTERN_MODE_CROSS)
            {
                typedef struct _config{
                    gctUINT32 dest;
                    gctUINT32 start;
                    gctUINT32 end;
                    gctUINT32 src0;
                    gctUINT32 startbin;
                }
                config;

                config configs[] = {
                    {6, 0, 0, 1, 2},
                    {6, 1, 2, 3, 0},
                    {7, 0, 2, 3, 2},
                    {8, 0, 0, 2, 2},
                    {8, 1, 1, 4, 2},
                    {8, 2, 2, 5, 2},
                };

                for (i = 0; i < sizeof(configs)/sizeof(configs[0]); i ++)
                {
                    /* mul_shift.u8.clamp r1/2/3/4/5, r1/2/3/4/5, c4.x/y/z, 0 */
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x7, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(configs[i].dest, gcdVX_ENABLE, gcvTRUE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetEVIS(configs[i].start, configs[i].end, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, configs[i].src0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetSourceBin(configs[i].startbin, &Instructions->binarys[Instructions->count++]));
                }
            }
        }


        {
            /*filter.box.u8 r9, r6, r7, r8*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x05, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, end, Evis, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
        }

        /*img_store.u8 c1, r0.xy, r9.xy*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, end, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

        Instructions->regs_count = 10;
    }
    else
    /*3x3*/
    {
        /*
         * r1: | x-1, y-1 |   x, y-1 | x+1, y-1 |          |
         * r2: | x-1, y |   x, y | x+1, y |          |
         * r3: | x-1, y+1 |   x, y+1 | x+1, y+1 |          |
         * r4: |   src0   |   src0   |   src0   |          |
         * r5: |   src1   |   src1   |   src1   |          |
         * r6: |   src2   |   src2   |   src2   |          |
         * r7: |  output  |  output  |  output  |          |
         */

        gctUINT32 i = 0, reg = 1;
        RelOffset offset3[3] = {{{ 0, 0 }}, {{ 0, 0 }}, {{ 0, 0 }}};

        for (i = 0; i < 3; i ++)
        {
            if (i == 2)
                flag = Instructions->count;

            if(Border == gcvVX_BORDER_MODE_CONSTANT)
            {
                /*mov r1/2/3, c3 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(1 + i, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
            }

            /*img_load.u8 r1/2/3, c0, r0.xy, -1,-1*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1 + i, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input), 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            offset3[i].u.x = offset3[i].u.x - origin_x;
            offset3[i].u.y = offset3[i].u.y + (gctUINT16)i - origin_y;
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset3[i].raw, &Instructions->binarys[Instructions->count++]));
        }

        for (i = 0; i < 3; i ++)
        {
            if (Context->volume == gcvVX_PARTTERN_MODE_CROSS || Context->volume == gcvVX_PARTTERN_MODE_OTHER)
            {
                if ((Kernel == gcvVX_KERNEL_NONLINEAR_FILTER_MAX)
                    || ((Kernel == gcvVX_KERNEL_NONLINEAR_FILTER_MEDIAN) && (i < 2)))
                {
                    /*
                     * r4: |  00xx00  |   src0   |   src0   |          |
                     * r5: |  xxxxxx  |   src1   |   src1   |          |
                     * r6: |  00xx00  |   src2   |   src2   |          |
                     */
                    /* mul_shift.u8.clamp r4/5/6, r1/2/3, c4.x/y/z, 0 */
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x7, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(4 + i, gcdVX_ENABLE, gcvTRUE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 2, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1 + i, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 4, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

                    reg = 4;
                }
                else if ((Kernel == gcvVX_KERNEL_NONLINEAR_FILTER_MIN) || ((Kernel == gcvVX_KERNEL_NONLINEAR_FILTER_MEDIAN) && (i == 2)))
                {
                    /*
                     * r4: |  ffxxff  |   src0   |   src0   |          |
                     * r5: |  xxxxxx  |   src1   |   src1   |          |
                     * r6: |  ffxxff  |   src2   |   src2   |          |
                     */
                    {
                        _SetUniformItem(index, 0, 0, 0, 0, 0, gcvTRUE, &config, Input, &Uinform[*index]);

                        /*mov r7, c4.x/y/z */
                        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetDestination(reg + 3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count++]));

                        /*dp2x8.u8 r4/5/6, r1/2/3, r7.x/y/z, c4_512 */
                        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0B, 0x7, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetDestination(4 + i, gcdVX_ENABLE, gcvTRUE, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1 + i, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, reg + 3, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));
                    }
                    reg = 4;
                }
            }
        }

        {
            /*filter.box.u8 r7/4, r4/1, r5/2, r6/3*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x05, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(reg + 3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, end, Evis, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, reg, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, reg + 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, reg + 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
        }

        /*img_store.u8 c1, r0.xy, r7/4.xy*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, end, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, reg + 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

        if (Context->ystep > 1)
        {
            /*mov r1, r2 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

            /*mov r2, r3 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

            /*add.u32 r0.yz, r0, 1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE2(1, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

            /*branch.u32 r0.z, c2.x, flag-count */
            gcmONERROR(gcoHARDWAREVX_Branch(0x02, flag-Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));
        }
        Instructions->regs_count = reg + 4;
    }
OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _nonlinearfilter_vx2(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gctUINT32 Kernel = Context->kernel;
    gctUINT32 Input = Context->input_type[0];
    gctUINT32 Output = Context->output_type[0];
    gctUINT16 origin_x = (gctUINT16)Context->policy;
    gctUINT16 origin_y = (gctUINT16)Context->rounding;
    gctUINT32 Border = Context->borders;
    gcoVX_Instructions *Instructions = Context->instructions;
    gctUINT32 end = Context->xstep - 1;
    gctUINT32 flag = 0;
    gctUINT32 vtype = 0, htype = 0;
    gcVXConfig                    config    = {{0}};
    gctUINT32                    *index     = Context->unifor_num;
    gcoVX_Kernel_Context_Uniform *Uinform   = Context->uniform;
    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    {
        gctUINT32 i      = 0;
        for (i = 0; i < 16; i++)
        {
            config.termconfig[i]   = VX_ADD;
            if(i < 8)
            {
                config.abin0[i]   = (gctUINT)(i/2);
            }
            else
            {
                config.abin1[i%8]   = (gctUINT)(i/2);
            }

            config.aselect[i]   = i%2 ? 1 : 0;
            config.matrix[i]    = (i+1)%2 ? 1 : (Kernel == gcvVX_KERNEL_SUBTRACT) ? -1 : 1;
        }
    }

    switch(Kernel)
    {
    case gcvVX_KERNEL_NONLINEAR_FILTER_MAX:
        vtype = 0x19;
        htype = 0x1C;
        break;
    case gcvVX_KERNEL_NONLINEAR_FILTER_MIN:
        vtype = 0x18;
        htype = 0x1B;
        break;
    case gcvVX_KERNEL_NONLINEAR_FILTER_MEDIAN:
        vtype = 0x1A;
        htype = 0x1D;
        break;
    }
    if (Context->row == 5 && Context->col == 5)
    {
        gctUINT32 i = 0;
        RelOffset offset5[5] = {{{ 0, 0 }}, {{ 0, 0 }}, {{ 0, 0 }}, {{ 0, 0 }}, {{ 0, 0 }}};

        /*                           x                                           y
         * r1: | x-2, y-2 | x-1, y-2 |   x, y-2 | x+1, y-1 | x+2, y-2 |          |
         * r2: | x-2, y-1 | x-1, y-1 |   x, y-1 | x+1, y-1 | x+2, y-1 |          |
         * r3: | x-2, y | x-1, y |   x, y | x+1, y | x+2, y-1 |          |
         * r4: | x-2, y+1 | x-1, y+1 |   x, y+1 | x+1, y+1 | x+2, y+1 |          |
         * r5: | x-2, y+1 | x-1, y+2 |   x, y+2 | x+1, y+1 | x+2, y+2 |          |
         * r6: |                    src0                   |                    src0                   |
         * r7: |                    src0                   |                    src0                   |
         * r8: |                    src0                   |                    src0                   |
         * r9: |                    src0                   |                    src0                   |
         * r10:|                    src0                   |                    src0                   |
         * r11:|                   output                  |                   output                  |
         */
        for (i = 0; i < 5; i++)
        {

            if(Border == gcvVX_BORDER_MODE_CONSTANT)
            {
                /*mov r(i + 1)(1/2/3/4/5), c3 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(i + 1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
            }

            /*img_load.u8 r(i + 1)(1/2/3/4/5), c0, r0.xy, -1,-1*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(i + 1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input), 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            offset5[i].u.x = offset5[i].u.x - origin_x;
            offset5[i].u.y = offset5[i].u.y + (gctUINT16)i - origin_y;
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset5[i].raw, &Instructions->binarys[Instructions->count++]));
        }


        if (Kernel != gcvVX_KERNEL_NONLINEAR_FILTER_MEDIAN)
        {
            for (i = 0; i < 5; i ++)
            {
                if (Context->volume == gcvVX_PARTTERN_MODE_CROSS || Context->volume == gcvVX_PARTTERN_MODE_DISK)
                {
                    /*          x        y       z        w
                     * x max:
                     * c4 : 00000100 00000000 00000100 00000000
                     * c5 : 01010101 01000000 00000100 00000000
                     * c6 : 00000100 00000000 00000000 00000000
                     *
                     * + min:
                     * c4 : ffff00ff ff000000 ffff00ff ff000000
                     * c5 : 00000000 00000000 ffff00ff ff000000
                     * c6 : ffff00ff ff000000 00000000 00000000
                     */

                    if (Kernel == gcvVX_KERNEL_NONLINEAR_FILTER_MAX)
                    {
                        /*          x        y       z        w
                         * x max:
                         * c4 : 00000100 00000000 00000100 00000000
                         * c5 : 01010101 01000000 00000100 00000000
                         * c6 : 00000100 00000000 00000000 00000000
                         *
                         *
                         * r1: | 0000xx00 |   00     |          |          |
                         * r2: | 0000xx00 |   00     |          |          |
                         * r3: | xxxxxxxx |   xx     |          |          |
                         * r4: | 0000xx00 |   00     |          |          |
                         * r5: | 0000xx00 |   00     |          |          |
                         */
                        /* mul_shift.u8.clamp r1/2/3/4/5, r1/2/3/4/5, c4.x/y/z, 0 */
                        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x7, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetDestination(1 + i, gcdVX_ENABLE, gcvTRUE, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 4, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1 + i, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 4 + i/2, gcdVX_SWIZZLE2(i%2 * 2, i%2 * 2 + 1), 0, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
                    }
                    else if (Kernel == gcvVX_KERNEL_NONLINEAR_FILTER_MIN)
                    {
                        /*
                         * + min:
                         * c4 : ffff00ff ff000000 ffff00ff ff000000
                         * c5 : 00000000 00000000 ffff00ff ff000000
                         * c6 : ffff00ff ff000000 00000000 00000000
                         *
                         * r1: | ffffxxff |   ff     |          |          |
                         * r2: | ffffxxff |   ff     |          |          |
                         * r3: | xxxxxxxx |   xx     |          |          |
                         * r4: | ffffxxff |   ff     |          |          |
                         * r5: | ffffxxff |   ff     |          |          |
                         */

                        {
                            _SetUniformItem(index, 0, 0, 0, 0, 0, gcvTRUE, &config, Input, &Uinform[*index]);

                            /*mov r6, c4.x/y/z */
                            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                            gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4 + i/2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

                            /*dp2x8.u8 r1/2/3/4/5, r1/2/3/4/5, r6, c5_512 */
                            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0B, 0x7, &Instructions->binarys[Instructions->count]));
                            gcmONERROR(gcoHARDWAREVX_SetDestination(1 + i, gcdVX_ENABLE, gcvTRUE, &Instructions->binarys[Instructions->count]));
                            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1 + i, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 6, gcdVX_SWIZZLE2(i%2 * 2, i%2 * 2 + 1), 0, &Instructions->binarys[Instructions->count]));
                            gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));
                        }

                    }

                }
            }

            for (i = 0; i < 3; i++)
            {

                {
                    /*vertMax3.u8, r6/7/8, r1/2/3, r2/3/4, r3/4/5 */
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, vtype, Output, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(6 + i, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, gcoHardwareVX_GetPixel(Output), &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1 + i, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2 + i, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3 + i, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

                    /*horzMax3.u8, r6/7/8, r6/7/8 */
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, htype, Output, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(6 + i, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, gcoHardwareVX_GetPixel(Output), &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6 + i, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

                    if (Kernel == gcvVX_KERNEL_NONLINEAR_FILTER_MEDIAN)
                    {
                        /*vertMax3.u8, r9, r1/2/3, r2/3/4, r3/4/5 */
                        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x19, Input, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input), Input, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1 + i, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2 + i, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3 + i, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
                        /*vertMin3.u8, r1, r1, r2, r3 */
                        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x18, Input, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetDestination(1 + i, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input), Input, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1 + i, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2 + i, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3 + i, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

                        /*horzMax3.u8, r1, r1 */
                        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x1C, Input, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetDestination(1 + i, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input) - 2, Input, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1 + i, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
                        /*horzMin3.u8, r9, r9 */
                        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x1B, Input, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input) - 2, Input, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

                        /*vertMed3.u8, r4, r1, r4, r5 */
                        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x1A, Input, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetDestination(6 + i, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input) - 2, Input, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1 + i, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 6 + i, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
                    }

                }
            }
        }
        else
        {
            if (Context->volume == gcvVX_PARTTERN_MODE_CROSS)
            {
                typedef struct _config{
                    gctUINT32 dest;
                    gctUINT32 start;
                    gctUINT32 end;
                    gctUINT32 src0;
                    gctUINT32 startbin;
                }
                config;

                config configs[] = {
                    {6, 0, 0, 1, 2},
                    {6, 1, 2, 3, 0},
                    {7, 0, 2, 3, 2},
                    {8, 0, 0, 2, 2},
                    {8, 1, 1, 4, 2},
                    {8, 2, 2, 5, 2},
                };

                for (i = 0; i < sizeof(configs)/sizeof(configs[0]); i ++)
                {
                    /* mul_shift.u8.clamp r1/2/3/4/5, r1/2/3/4/5, c4.x/y/z, 0 */
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x7, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(configs[i].dest, gcdVX_ENABLE, gcvTRUE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetEVIS(configs[i].start, configs[i].end, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, configs[i].src0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetSourceBin(configs[i].startbin, &Instructions->binarys[Instructions->count++]));
                }
            }
        }

        {
            /*vertMax3.u8, r9, r6, r7, r8 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, vtype, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, gcoHardwareVX_GetPixel(Output), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*horzMax3.u8, r9, r9 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, htype, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, end, gcoHardwareVX_GetPixel(Output), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            if (Kernel == gcvVX_KERNEL_NONLINEAR_FILTER_MEDIAN)
            {
                /*vertMax3.u8, r10, r6, r7, r8 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x19, Input, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input), Input, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
                /*vertMin3.u8, r6, r6, r7, r8 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x18, Input, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input), Input, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

                /*horzMax3.u8, r6, r6 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x1C, Input, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input) - 2, Input, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
                /*horzMin3.u8, r10, r10 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x1B, Input, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input) - 2, Input, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

                /*vertMed3.u8, r9, r6, r9, r10 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x1A, Input, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input) - 2, Input, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 10, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            }
        }

        /*img_store.u8 c1, r0.xy, r9.xy*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, end, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

        if (Kernel == gcvVX_KERNEL_NONLINEAR_FILTER_MEDIAN)
            Instructions->regs_count = 11;
        else
            Instructions->regs_count = 10;
    }
    else
    /*3x3*/
    {
        /*
         * r1: | x-1, y-1 |   x, y-1 | x+1, y-1 |          |
         * r2: | x-1, y |   x, y | x+1, y |          |
         * r3: | x-1, y+1 |   x, y+1 | x+1, y+1 |          |
         * r4: |   src0   |   src0   |   src0   |          |
         * r5: |   src1   |   src1   |   src1   |          |
         * r6: |   src2   |   src2   |   src2   |          |
         * r7: |  output  |  output  |  output  |          |
         */

        gctUINT32 i = 0, reg = 1;
        RelOffset offset3[3] = {{{ 0, 0 }}, {{ 0, 0 }}, {{ 0, 0 }}};

        for (i = 0; i < 3; i ++)
        {
            if (i == 2)
                flag = Instructions->count;

            if(Border == gcvVX_BORDER_MODE_CONSTANT)
            {
                /*mov r1/2/3, c3 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(1 + i, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
            }

            /*img_load.u8 r1/2/3, c0, r0.xy, -1,-1*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1 + i, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input), 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            offset3[i].u.x = offset3[i].u.x - origin_x;
            offset3[i].u.y = offset3[i].u.y + (gctUINT16)i - origin_y;
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset3[i].raw, &Instructions->binarys[Instructions->count++]));
        }

        for (i = 0; i < 3; i ++)
        {
            if (Context->volume == gcvVX_PARTTERN_MODE_CROSS)
            {
                if ((Kernel == gcvVX_KERNEL_NONLINEAR_FILTER_MAX)
                    || ((Kernel == gcvVX_KERNEL_NONLINEAR_FILTER_MEDIAN) && (i < 2)))
                {
                    /*
                     * r4: |  00xx00  |   src0   |   src0   |          |
                     * r5: |  xxxxxx  |   src1   |   src1   |          |
                     * r6: |  00xx00  |   src2   |   src2   |          |
                     */
                    /* mul_shift.u8.clamp r4/5/6, r1/2/3, c4.x/y/z, 0 */
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x7, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(4 + i, gcdVX_ENABLE, gcvTRUE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 2, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1 + i, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 4, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

                    reg = 4;
                }
                else if ((Kernel == gcvVX_KERNEL_NONLINEAR_FILTER_MIN) || ((Kernel == gcvVX_KERNEL_NONLINEAR_FILTER_MEDIAN) && (i == 2)))
                {
                    /*
                     * r4: |  ffxxff  |   src0   |   src0   |          |
                     * r5: |  xxxxxx  |   src1   |   src1   |          |
                     * r6: |  ffxxff  |   src2   |   src2   |          |
                     */

                    {
                        _SetUniformItem(index, 0, 0, 0, 0, 0, gcvTRUE, &config, Input, &Uinform[*index]);

                        /*mov r7, c4.x/y/z */
                        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count++]));

                        /*dp2x8.u8 r4/5/6, r1/2/3, c4.x/y/z, c4_512 */
                        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0B, 0x7, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetDestination(4 + i, gcdVX_ENABLE, gcvTRUE, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1 + i, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 7, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));
                    }
                    reg = 4;
                }
            }
        }

        {
            /*vertMax3.u8, r7/4, r4/1, r5/2, r6/3 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, vtype, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(reg + 3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, gcoHardwareVX_GetPixel(Output), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, reg, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, reg + 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, reg + 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*horzMax3.u8, r7/4, r7/4 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, htype, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(reg + 3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, end, gcoHardwareVX_GetPixel(Output), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, reg + 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            if (Kernel == gcvVX_KERNEL_NONLINEAR_FILTER_MEDIAN)
            {
                /*vertMax3.u8, r8, r4/1, r5/2, r6/3 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x19, Input, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(reg + 4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input), Input, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, reg, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, reg + 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, reg + 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
                /*vertMin3.u8, r9, r4/1, r5/2, r6/3 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x18, Input, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(reg + 5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input), Input, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, reg, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, reg + 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, reg + 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

                /*horzMax3.u8, r9, r9 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x1C, Input, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(reg + 5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input) - 2, Input, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, reg + 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
                /*horzMin3.u8, r8, r8 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x1B, Input, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(reg + 4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input) - 2, Input, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, reg + 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

                /*vertMed3.u8, r7/4, r7/4, r9, r8 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x1A, Input, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(reg + 3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input) - 2, Input, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, reg + 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, reg + 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, reg + 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            }
        }

        /*img_store.u8 c1, r0.xy, r7/4.xy*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, end, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, reg + 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

        if (Context->ystep > 1)
        {
            /*mov r1, r2 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

            /*mov r2, r3 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

            /*add.u32 r0.yz, r0, 1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE2(1, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

            /*branch.u32 r0.z, c2.x, flag-count */
            gcmONERROR(gcoHARDWAREVX_Branch(0x02, flag-Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));
        }
        if (Kernel == gcvVX_KERNEL_NONLINEAR_FILTER_MEDIAN)
            Instructions->regs_count = reg + 6;
        else
            Instructions->regs_count = reg + 4;
    }
OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _sobel3x3(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gctUINT32 Border = Context->borders;
    gcoVX_Instructions *Instructions = Context->instructions;
    RelOffset minusOne = {{ -1, -1 }};
    RelOffset zero = {{ -1, 0 }};
    RelOffset plusOne = {{ -1, 1 }};
    gctUINT32 Height = Context->col;
    gctUINT32 flag = 0;

    gctUINT32 skipXOutput = Context->optionalOutputs[0];
    gctUINT32 skipYOutput = Context->optionalOutputs[1];

    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    if (Border == gcvVX_BORDER_MODE_CONSTANT)
    {
        /*mov r1, c3 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }

    /*img_load.u8 r1, c0, r0.xy, -1,-1*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(0x7), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, minusOne.raw, &Instructions->binarys[Instructions->count++]));

    if (Border == gcvVX_BORDER_MODE_CONSTANT)
    {
        /*mov r2, c3 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }

    /*img_load.u8 r2, c0, r0.xy, -1,0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(0x7), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, zero.raw, &Instructions->binarys[Instructions->count++]));
    flag = Instructions->count;
    if (Border == gcvVX_BORDER_MODE_CONSTANT)
    {
        /*mov r3, c3 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }

    /*img_load.u8 r3, c0, r0.xy, -1,1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(0x7), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusOne.raw, &Instructions->binarys[Instructions->count++]));
    if (!skipXOutput)
    {
    /*filter.sobelX.s16 r4, r1, r2, r3 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x05, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    /* RTL limit. filter Output bin# <= 6 */
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, (0x7 | (0x2 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
    /*img_store.s16 c1, r0.xy, r4*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    /* RTL limit. filter Output bin# <= 6 */
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }

    if (!skipYOutput)
    {
    /*filter.sobelY.s16 r5, r1, r2, r3 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x05, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    /* RTL limit. filter Output bin# <= 6 */
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, (0x7 | (0x3 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
    /*img_store.s16 c2, r0.xy, r5*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    /* RTL limit. filter Output bin# <= 6 */
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }


    /*mov r1, r2 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    /*mov r2, r3 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*add.u32 r0.y, r0.y, 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

    /*branch.u32 r0.y, Height, flag0-curr */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, flag-Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, Height, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 0x6;

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _scharr3x3(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gcoVX_Instructions *Instructions = Context->instructions;
    RelOffset minusOne = {{ -1, -1 }};
    RelOffset zero = {{ -1, 0 }};
    RelOffset plusOne = {{ -1, 1 }};
    gctUINT32 loopStart = 0;

    gcmHEADER_ARG("Instructions=0x%x", Instructions);


    /*img_load.u8 r1, c0, r0.xy, -1,-1*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(0x7), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, minusOne.raw, &Instructions->binarys[Instructions->count++]));


    /*img_load.u8 r2, c0, r0.xy, -1,0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(0x7), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, zero.raw, &Instructions->binarys[Instructions->count++]));

    /*img_load.u8 r3, c0, r0.xy, -1,1 */
    loopStart = Instructions->count;
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(0x7), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusOne.raw, &Instructions->binarys[Instructions->count++]));

    /*filter.scharrX.s16 r4, r1, r2, r3 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x05, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, (0x7 | (0x4 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*iadd.s16.sat r4, -r4, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x3 | (0x3 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, NEGATE_FLAG, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*img_store.s16 c1, r0.xy, r4*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*filter.scharrY.s16 r4, r1, r2, r3 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x05, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, (0x7 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*iadd.s16.sat r4, -r4, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x3 | (0x3 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, NEGATE_FLAG, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*img_store.s16 c2, r0.xy, r4*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*mov r1, r2 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*mov r2, r3 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*add.u32 r0.yz, r0, 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE2(1, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

    /*branch.u32 r0.z, c3.y, -12 */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, (gctINT32)(loopStart - Instructions->count), 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 0x5;

OnError:
    gcmFOOTER();
    return status;
}

#define  USE_FP32_PRECISION 1
#if USE_FP32_PRECISION
static gceSTATUS _histogram_vx2(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gcoVX_Instructions *Instructions = Context->instructions;
    gcVXConfig                    subConfig    = {{0}};
    gctUINT32                    *index        = Context->unifor_num;
    gcoVX_Kernel_Context_Uniform *Uinform      = Context->uniform;
    gctUINT32           flag, i, count =  Context->volume;
    gctUINT32           Height = Context->col;

    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    for (i = 0; i < 16; i++)
    {
        subConfig.termconfig[i]   = VX_ADD;
        if(i < 8)
        {
            subConfig.abin0[i]   = (gctUINT)(i/2);
            }
            else
            {
            subConfig.abin1[i%8]   = (gctUINT)(i/2);
        }

        subConfig.aselect[i]   = i%2 ? 1 : 0;
        subConfig.matrix[i]    = i%2 ? -1 : 1;
    }

    for(i = 0; i < count; i += 8)
    {
        /*mov r0.y, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0U, &Instructions->binarys[Instructions->count++]));

        /*mov r1, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0U, &Instructions->binarys[Instructions->count++]));

        /*mov r4, c5 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        /*mov r5, c4 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

        flag = Instructions->count;

        /*img_load.u8 r3, c0, r0.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

        _SetUniformItem(index, 0, 0, 0, 0, 0, gcvTRUE, &subConfig, 0x7, &Uinform[*index]);
        /*dp2x8.u8 r3, r3, r5, c4_512 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0B, 0x3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));

        /*mul_shift.u32, r2, r3.u16, 1, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x3 | 0x3 << 3), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 1 | (1 << 16), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        /*mad r2, r2, 1.0f/window, 0.00002f;*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(2, 0.00002f, &Instructions->binarys[Instructions->count++]));

        /* floor r2 r2; */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x25, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /*conv.s32 r2 r2 f32 -> s32*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x0, &Instructions->binarys[Instructions->count++]));

        /*bitextract.u32 r2, r1, 0, c3;  c2 = [0, 32, 64, 96, 0, 0, 0, 0, 8, 8, 8, 8] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x5 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        /*mul_shift.u32, r2, r3.u16, 1, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x3 | 0x3 << 3), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 1 | (1 << 16), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(4, &Instructions->binarys[Instructions->count++]));

        /*mad r2, r2, 1.0f/window, 0.00002f;*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(2, 0.00002f, &Instructions->binarys[Instructions->count++]));

        /* floor r2 r2; */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x25, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /*conv.s32 r2 r2 f32 -> s32*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x0, &Instructions->binarys[Instructions->count++]));

        /*bitextract.u32 r3, r2, 0, c3;  c2 = [0, 32, 64, 96, 0, 0, 0, 0, 8, 8, 8, 8] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(4, 7, (0x5 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        /*index_add.u16 r1[0-3], r3[0-3], r4, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x17, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x6 | (0x6 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, i, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        if (count - i > 4)
        {
            /*index_add.u16 r1[4-7], r3[4-7], r4, 4 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x17, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(4, 7, (0x6 | (0x6 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 4 + i, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
        }


        /*add.u32 r0.y, r0.y, 1 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

        /*branch.u32 r0.y, height, flag-count */
        gcmONERROR(gcoHARDWAREVX_Branch(0x02, flag-Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, Height, &Instructions->binarys[Instructions->count++]));

        /*atomic_add.u32 c1, 0, r1.u16[0-3] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0F, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, i * 4, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        if (count - i > 4)
        {
            /*atomic_add.u32 c1, 16, r1.u16[4-7] */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0F, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, i * 4 + 16, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
        }

    }

    Context->hasAtomic = gcvTRUE;
    Instructions->regs_count = 0x6;

OnError:
    gcmFOOTER();
    return status;
}
#else
static gceSTATUS _histogram_vx2(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gcoVX_Instructions *Instructions = Context->instructions;
    gcVXConfig                    subConfig    = {{0}};
    gctUINT32                    *index        = Context->unifor_num;
    gcoVX_Kernel_Context_Uniform *Uinform      = Context->uniform;
    gctUINT32           flag, i, count =  Context->volume;
    gctUINT32           Height = Context->col;

    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    for (i = 0; i < 16; i++)
    {
        subConfig.termconfig[i]   = VX_ADD;
        subConfig.aselect[i] = i%2 ? 1 : 0;
        subConfig.bselect[i] = 1;


        if(i < 8)
        {
            if (i % 2)
            {
                subConfig.abin0[i]   = 3;
                subConfig.bbin0[i]   = 0;
            }
            else
            {
                subConfig.abin0[i]   = (gctUINT32) i / 2;
                subConfig.bbin0[i]   = 2;
            }
        }
        else
        {
            if (i % 2)
            {
                subConfig.abin1[i%8]   = 3;
                subConfig.bbin1[i%8]   = 0;
            }
            else
            {
                subConfig.abin1[i%8]   = (gctUINT32) i / 2;
                subConfig.bbin1[i%8]   = 2;
            }
        }

    }

    /*mov r2, c5 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    /*mov r4, c2 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    for(i = 0; i < count; i += 8)
    {
        /*mov r0.y, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0U, &Instructions->binarys[Instructions->count++]));
        /*mov r1, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0U, &Instructions->binarys[Instructions->count++]));

        flag = Instructions->count;

        /*img_load.u8 r3, c0, r0.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

        _SetUniformItemExt(index, 0, 0, 0, 0, 0, gcvTRUE, &subConfig, 0x7, &Uinform[*index]);
        /*dp2x8.u8 r3, r3, r4, c4_512 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0B, 0x3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x1 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));

        /*index_add.u16 r1[0-3], r3[0-3], r2, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x17, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x6 | (0x6 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, i, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        if (count - i > 4)
        {
            /*index_add.u16 r1[4-7], r3[4-7], r2, 4 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x17, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(4, 7, (0x6 | (0x6 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 4 + i, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
        }


        /*add.u32 r0.y, r0.y, 1 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

        /*branch.u32 r0.y, height, flag-count */
        gcmONERROR(gcoHARDWAREVX_Branch(0x02, flag-Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, Height, &Instructions->binarys[Instructions->count++]));

        /*atomic_add.u32 c1, 0, r1.u16[0-3] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0F, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, i * 4, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        if (count - i > 4)
        {
            /*atomic_add.u32 c1, 16, r1.u16[4-7] */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0F, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, i * 4 + 16, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
        }

    }

    Context->hasAtomic = gcvTRUE;
    Instructions->regs_count = 0x5;

OnError:
    gcmFOOTER();
    return status;
}
#endif
static gceSTATUS _histogram(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gcoVX_Instructions *Instructions = Context->instructions;

    gctUINT32           flag, i, count =  Context->volume, max = 7;

    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    /*clamp save the size of input image. If the size less than one instruction, only select valid bit*/
    if (Context->clamp && (Context->clamp < max))
        max = Context->clamp - 1;

    for(i = 0; i < count; i++)
    {
    /*mov r0.y, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0U, &Instructions->binarys[Instructions->count++]));

    /*mov r1, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0U, &Instructions->binarys[Instructions->count++]));

    /*mov r2, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0U, &Instructions->binarys[Instructions->count++]));

    /*mov r4, c11((2*i + 2) * 4 + 3) */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, (2*i + 2) * 4 + 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    flag = Instructions->count;

    /*img_load.u8 r3, c0, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

    /*select_add.u16 r1, r3[0-7], r4, c4((2*i + 1) * 4) */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0E, 0x6, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcmMIN(max, 7), (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_Setuniform(2, (2*i + 1) * 4, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*select_add.u16 r2, r3[0-7], r4, c8((2*i + 2) * 4) */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0E, 0x6, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcmMIN(max, 7), (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_Setuniform(2, (2*i + 2) * 4, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*if the size large than one instruction*/
    if (Context->clamp > 8)
    {
        max = (Context->clamp < 16)?(Context->clamp - 8):7;

        /*select_add.u16 r1, r3[8-15], r4, c4((2*i + 1) * 4) */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0E, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, max, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, (2*i + 1) * 4, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(8, &Instructions->binarys[Instructions->count++]));

        /*select_add.u16 r2, r3[8-15], r4, c8((2*i + 2) * 4) */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0E, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, max, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, (2*i + 2) * 4, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(8, &Instructions->binarys[Instructions->count++]));
    }

    /*add.u32 r0.y, r0.y, 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

    /*branch.u32 r0.y, c3.x, flag-count */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, flag-Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

    /*atomic_add.u32 c1, 0, r1.u16[0-3] */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0F, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 0x6, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, (64 * i + 0), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*atomic_add.u32 c1, 16, r1.u16[4-7] */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0F, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 0x6, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, (64 * i + 16), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*atomic_add.u32 c1, 32, r2.u16[0-3] */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0F, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 0x6, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, (64 * i + 32), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*atomic_add.u32 c1, 48, r2.u16[4-7] */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0F, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 0x6, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, (64 * i + 48), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
    }
    Context->hasAtomic = gcvTRUE;
    Instructions->regs_count = 0x5;

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _equalizehistogram_hist(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gcoVX_Instructions *Instructions = Context->instructions;
    gctUINT32 i = 0, j = 0;
    gctUINT32           flag;

    gcmHEADER_ARG("Context=0x%x", Context);

    /*mov r3.y, 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

    flag = Instructions->count;

    /*img_load.u8 r1, c0, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

    for(j = 0; j < Context->xstep/4; j++)
    {
        /*bitextract.u32 r2, r1.i, c4, 8;  c3 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(j), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));

        for(i = 0; i < 4; i++)
        {
            /*lshift r3.x, r2.i, 2 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 2U, &Instructions->binarys[Instructions->count++]));

            /*atom_add c1, r3.x, r3.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x65, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));

            /*atom_min c2, 0, r2.i */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x68, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count++]));
        }
    }

    /*add.u32 r0.y, r0, 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

    /*branch.u32 r0.y, c4.x, flag-count */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, flag-Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 0x4;
    Context->hasAtomic = gcvTRUE;

OnError:
    gcmFOOTER();
    return status;
}
static gceSTATUS _equalizehistogram_gcdf(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gcoVX_Instructions *Instructions = Context->instructions;
    gctUINT32 i = 0, flag = 0;

    gcmHEADER_ARG("Context=0x%x", Context);

    /*          x       y       z       w
     * r0 : |       |       |  min  | min_v |
     * r1 : |       |       |       |       |
     */
    /* load r0.z, c2, 0; min -> r0.z */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count++]));

    /*lshift r0.z, r0.z, 2 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 2U, &Instructions->binarys[Instructions->count++]));

    /* load r0.w, c0, r0.z; min_v -> r0.w */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /* store c3, 0, r0.w; min value -> min_v(vx_scalar) */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_DisableDestination(&Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*mov r2, 0; sum(r2.x) = 0*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0U, &Instructions->binarys[Instructions->count++]));

    flag = Instructions->count;

    /*img_load.u32 r1, c0, r0.xy; */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

    for(i = 0; i < 4; i++)
    {
        /*add.u32 r2.x, r2.x, r1.i(x,y,z,w); sum(r2.x) += hist[n](r1.i)  */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count++]));

        /*add.sat.u32 r2.y, r2.x, r0.w; cdf[n](r2.y) = sum(r2.x) - min_v(r0.w)  */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE1(3), gcvTRUE, &Instructions->binarys[Instructions->count++]));

        /*conv.s32 r3.i(x,y,z,w), r2.y(cdf[n]); s32 -> f32 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x5, &Instructions->binarys[Instructions->count++]));

    }

    /*img_store.f32 c1, r0.xy, r3; */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_DisableDestination(&Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*add.sat.u32 r0.x, r0.x, 4; r0.x += 4 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 4, &Instructions->binarys[Instructions->count++]));

    /*branch.le.u32 r0.x, 0xff, flag-count */
    gcmONERROR(gcoHARDWAREVX_Branch(0x04, (flag - Instructions->count), 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0xff, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 0x4;

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _equalizehistogram_cdf(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gcoVX_Instructions *Instructions = Context->instructions;

    gcmHEADER_ARG("Context=0x%x", Context);


    /*           x        y       z        w
     * r0 : |        |        |  min   | min_v  |
     * r1 : |  data  |  data  |  data  |  data  |
     */

    /* load r0.w, c2, 0; min -> r0.z */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count++]));

    /*add.sat.u32 r0.z, w*h, r0.w; div(r0.z) = w*h - min_v(r0.w) */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(0, Context->volume, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE1(3), gcvTRUE, &Instructions->binarys[Instructions->count++]));

    /*branch.gt.u32 r0.z, 0, 2 */
    gcmONERROR(gcoHARDWAREVX_Branch(0x01, (2 + 1), 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count++]));

    /*add r1, r0.xxxx, c4; r0.x + 0/1/2/3 => r1*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE4(0, 0, 0, 0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*branch.gt.u32 1, 0, 5 */
    gcmONERROR(gcoHARDWAREVX_Branch(0x01, (6 + 1), 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(0, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count++]));

    /*conv.f32 r0.z r0.z s32 -> f32*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x2, &Instructions->binarys[Instructions->count++]));

    /* rcp r0.z r0.z; r0.z = 1/div */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x0C, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*img_load.u32 r1, c0, r0.xy; */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

    /*mul r1, r1, 1.0f/div; r1 = cdfx/div;*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*mad r1 r1 255.0f 0.5f */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(1, 255.0f, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(2, 0.5f, &Instructions->binarys[Instructions->count++]));

    /*conv.s32 r1 r1 f32 -> s32*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x0, &Instructions->binarys[Instructions->count++]));

    /*img_store.u32 c1, r0.xy, r1; */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_DisableDestination(&Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 0x2;

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _equalizehistogram_lut(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gcoVX_Instructions   *Instructions = Context->instructions;
    gctUINT32 i = 0, j = 0;
    gctUINT32           flag;

    gcmHEADER_ARG("Context=0x%x", Context);

    /*
     * r1: | data | data | data | data |
     * r2: | data | data | data | data |
     * r3: | data | data | data | data |
     * r4: |  pcx |  1   |   0  |   0  |
     */

    flag = Instructions->count;

    /*img_load.32 r1, c0, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

    /*mov r3.y, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0U, &Instructions->binarys[Instructions->count++]));

    for(j = 0; j < Context->xstep/4; j++)
    {
        /*bitextract.u32 r2, r1.j, c4, 8;  c3 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(j), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));


        for(i = 0; i < 4; i ++)
        {
            /*mov r3.x, r2.i */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count++]));

            /*img_load.u32 r4.i, c1, r3.xy; */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(i + 4*j, i + 4*j, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
        }
    }

    /*img_store.s16 c2, r0.xy, r4; */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, Context->xstep - 1, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*add.u32 r0.y, r0, 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

    /*branch.u32 r0.y, c4.x, flag-count */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, flag-Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 0x5;

OnError:
    gcmFOOTER();
    return status;
}

#define EQUAL_HISTOGRAM_HIST 0
#define EQUAL_HISTOGRAM_GCDF 1
#define EQUAL_HISTOGRAM_CDF  2
#define EQUAL_HISTOGRAM_LUT  3

static gceSTATUS _equalizehistogram(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;

    gcoVX_Hardware_Step steps[] = {
        {0, "histograme", EQUAL_HISTOGRAM_HIST, &_equalizehistogram_hist},
        {1, "cdf", EQUAL_HISTOGRAM_GCDF, &_equalizehistogram_gcdf},
        {2, "cdf", EQUAL_HISTOGRAM_CDF, &_equalizehistogram_cdf},
        {3, "lut", EQUAL_HISTOGRAM_LUT, &_equalizehistogram_lut},
    };

    gcmHEADER_ARG("Context=0x%x", Context);
    assert(Context->step < 4);

    steps[Context->step].func(Context);

    gcmFOOTER();
    return status;
}

static gceSTATUS _integralimage(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;

    gcoVX_Instructions  *Instructions = Context->instructions;
    gctUINT32           Input = Context->input_type[0];
    gctUINT32           Output = Context->output_type[0];

    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    if (Context->step == 0)
    {
    /*mov r2, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0U, &Instructions->binarys[Instructions->count]));
    Instructions->count++;

    /*img_load.u8 r1, c0, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    Instructions->count++;

    /*bitextract.u32 r1, r1.x, c2, 8;  c2 = [0, 0x8, 0x10, 0x20] */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count]));
    Instructions->count++;

    /*add r2, r2, r1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    Instructions->count++;

    /*img_store.u32 r2, c1, r0.xy, r2 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, Output, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_DisableDestination(&Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    Instructions->count++;

    /*add.u32 r0.y, r0.y, 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count]));
    Instructions->count++;

    /*branch.u32 r0.y, c3.y, -5 */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, -5, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    Instructions->count++;

    Instructions->regs_count = 0x3;
    }
    else if (Context->step == 1)
    {
        /* mov r0.w, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0U, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /*img_load.u16 r1, c0, r0.xy; */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /* add r1.x, r1.x, r0.w */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /* add r1.y, r1.y, r1.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /* add r1.z, r1.z, r1.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /* add r1.w, r1.w, r1.z */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /* mov r0.w, r1.w */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /* img_store.u16 r1, c1, r0.xy, r1;*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_DisableDestination(&Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /* add r0.x, r0.x, 0x4 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 4U, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /* branch.u32 r0.x, c3.x, -8 */
        gcmONERROR(gcoHARDWAREVX_Branch(0x02, -8, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /* mov r0.xw, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE2(0, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0U, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /* add r0.y, r0.y, 0x1 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /*img_load.u16 r1, c0, r0.xy; */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /* add r1.x, r1.x, r0.w */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /* add r1.y, r1.y, r1.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /* add r1.z, r1.z, r1.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /* add r1.w, r1.w, r1.z */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /* mov r0.w, r1.w */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /* img_store.u16 r1, c1, r0.xy, r1;*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_DisableDestination(&Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /* add r0.x, r0.x, 0x4 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 4U, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /* branch.u32 r0.x, c3.x, -8 */
        gcmONERROR(gcoHARDWAREVX_Branch(0x02, -8, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        Instructions->regs_count = 0x2;
    }
    else
    {
        status = gcvSTATUS_INVALID_ARGUMENT;
    }

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _add_sub(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gctUINT32 Kernel = Context->kernel;
    gctBOOL Saturate = Context->policy;
    gctUINT32 Input1 = Context->input_type[0];
    gctUINT32 Input2 = Context->input_type[1];
    gctUINT32 Output = Context->output_type[0];
    gctUINT32 Signed = (Kernel == gcvVX_KERNEL_SUBTRACT)?(NEGATE_FLAG):0;
    gcoVX_Instructions *Instructions = Context->instructions;

    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    /*img_load.u8 r1, c0, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input1, &Instructions->binarys[0]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[0]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input1), 1, &Instructions->binarys[0]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[0]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[0]));
    Instructions->count++;

    /*img_load.u8 r2, c1, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input2, &Instructions->binarys[1]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[1]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input2), 1, &Instructions->binarys[1]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[1]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[1]));
    Instructions->count++;

    /*iadd.u8.sat r1, r1.u08, r2.u8 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, Output, &Instructions->binarys[2]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, Saturate, &Instructions->binarys[2]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Output), (Input1 | (Input2 << 3)), &Instructions->binarys[2]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[2]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, Signed, &Instructions->binarys[2]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[2]));
    Instructions->count++;

    /*img_store.u8 r1, c2, r0.xy, r1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, Output, &Instructions->binarys[3]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Output), 1, &Instructions->binarys[3]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[3]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[3]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[3]));
    Instructions->count++;

    Instructions->regs_count = 0x3;

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _bitwise(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gctUINT32 Kernel = Context->kernel;
    gctUINT32 Input1 = Context->input_type[0];
    gctUINT32 Input2 = Context->input_type[1];
    gctUINT32 Output = Context->output_type[0];
    gcoVX_Instructions *Instructions = Context->instructions;
    gctUINT32 opcode = 0;

    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    switch(Kernel)
    {
    case gcvVX_KERNEL_AND:
        opcode = 0x5D;
        break;
    case gcvVX_KERNEL_OR:
        opcode = 0x5C;
        break;
    case gcvVX_KERNEL_XOR:
        opcode = 0x5E;
        break;
    }

    /*img_load.u8 r1, c0, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input1, &Instructions->binarys[0]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[0]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input1), 1, &Instructions->binarys[0]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[0]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[0]));
    Instructions->count++;

    /*img_load.u8 r2, c1, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input2, &Instructions->binarys[1]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[1]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input2), 1, &Instructions->binarys[1]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[1]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[1]));
    Instructions->count++;

    /*and.u8 r1, r1, r2 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(opcode, 0, 0x7, &Instructions->binarys[2]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[2]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[2]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[2]));
    Instructions->count++;

    /*img_store.u8 r1, c2, r0.xy, r1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, Output, &Instructions->binarys[3]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Output), 1, &Instructions->binarys[3]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[3]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[3]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[3]));
    Instructions->count++;

    Instructions->regs_count = 0x3;

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _not(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gctUINT32 Input = Context->input_type[0];
    gctUINT32 Output = Context->output_type[0];
    gcoVX_Instructions *Instructions = Context->instructions;

    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    /*img_load.u8 r1, c0, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[0]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[0]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input), 1, &Instructions->binarys[0]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[0]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[0]));
    Instructions->count++;

    /*not.u8 r1, r1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5F, 0, 0x7, &Instructions->binarys[1]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[1]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[1]));
    Instructions->count++;

    /*img_store.u8 r1, c1, r0.xy, r1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, Output, &Instructions->binarys[2]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Output), 1, &Instructions->binarys[2]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[2]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[2]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[2]));
    Instructions->count++;

    Instructions->regs_count = 0x2;

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _accumulate(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gcoVX_Instructions *Instructions = Context->instructions;

    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    /*img_load.u8 r1, c0, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[0]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[0]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[0]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[0]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[0]));
    Instructions->count++;

    /*img_load.u8 r2, c1, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[1]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[1]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[1]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[1]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[1]));
    Instructions->count++;

    /*iadd.s16 r2, r2, r1.u8 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x3, &Instructions->binarys[2]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvTRUE, &Instructions->binarys[2]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 0x3 | (0x7 << 3), &Instructions->binarys[2]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[2]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[2]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[2]));
    Instructions->count++;

    /*img_store.s16 r2, c1, r0.xy, r2 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x3, &Instructions->binarys[3]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[3]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[3]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[3]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[3]));
    Instructions->count++;

    Instructions->regs_count = 0x3;

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _remap(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gctUINT32 Border = Context->borders;
    gctUINT32 Policy = Context->policy;
    gctUINT32 i;
    gcoVX_Instructions *Instructions = Context->instructions;

    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    if(Policy == gcvVX_INTERPOLATION_TYPE_NEAREST_NEIGHBOR)
    {
        if(Border == gcvVX_BORDER_MODE_CONSTANT || Border == gcvVX_BORDER_MODE_UNDEFINED)
        {
            /*mov r2, c4 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        }
        /*mov r3, r0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 8; i++)
        {
            /*img_load.32 r1, c1, r3.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
            /*conv.s32 r1, r1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x0, &Instructions->binarys[Instructions->count++]));

            /*img_load.u32 r2.x, c0, r1.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(i * 2, i * 2, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
            /*img_load.u32 r2.y, c0, r1.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(i * 2 + 1, i * 2 + 1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));

            /*add.u32 r3.x, r3.x, 2 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 2U, &Instructions->binarys[Instructions->count++]));
        }
        /*img_store r2, c2, r0.xy, r2 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        Instructions->regs_count = 0x4;
    }
    else if(Policy == gcvVX_INTERPOLATION_TYPE_BILINEAR)
    {
        /* uniform input_descriptor := c0, s0
         * uniform remap_descriptor := c1
         * uniform output_descriptor := c2
         */
        const static RelOffset plusOne = {{0, 1}};

        if(Border == gcvVX_BORDER_MODE_CONSTANT || Border == gcvVX_BORDER_MODE_UNDEFINED)
        {
            /*mov r4, c4 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        }
        /*mov r3, r0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 8; i++)
        {
            /*img_load.32 r1, c1, r3.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*floor.f32 r2, r1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x25, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

            /*conv.s32 r2, r2 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x0, &Instructions->binarys[Instructions->count++]));

            if(Border == gcvVX_BORDER_MODE_CONSTANT || Border == gcvVX_BORDER_MODE_UNDEFINED)
            {
                /*mov r4, c4 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
            }

            /*img_load.u8 r4[0-1], c0, r2.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
            /*img_load.u8 r4[8-9], c0, r2.xy, +0,1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(8, 9, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusOne.raw, &Instructions->binarys[Instructions->count++]));
            /*bilinear.u8 r5[0], r4.x, r4.z, r1.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0D, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(i * 2, i * 2, 0x7 | (0x0 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            if(Border == gcvVX_BORDER_MODE_CONSTANT || Border == gcvVX_BORDER_MODE_UNDEFINED)
            {
                /*mov r4, c4 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
            }
            /*img_load.u8 r4[0-1], c0, r2.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));
            /*img_load.u8 r4[8-9], c0, r2.zw, +0,1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(8, 9, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusOne.raw, &Instructions->binarys[Instructions->count++]));
            /*bilinear.u8 r5[1], r4.x, r4.z, r1.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0D, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(i * 2 + 1, i * 2 + 1, 0x7 | (0x0 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            /*add.u32 r3.x, r3.x, 2 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 2U, &Instructions->binarys[Instructions->count++]));
        }
        /*img_store r5, c2, r0.xy, r5 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

        Instructions->regs_count = 0x6;
    }

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _minmaxloc_filter(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gcoVX_Instructions *Instructions = Context->instructions;
    gceSTATUS                 status = gcvSTATUS_OK;
    gctUINT32                  Input = Context->input_type[0];
    gctUINT32                   flag = 0;
    gctUINT16 j;
    gcmHEADER_ARG("Context=0x%x", Context);

    /*
     * r1 : | l1/min | l1/min | l1/min | l1/min |
     * r2 : |   l2   |   l2   |   l2   |   l2   |
     * r3 : |   l3   |   l3   |   l3   |   l3   |
     * r4 : |   max  |   max  |   max  |   max  |
     * r5 : |   pcx  |   pcy  |    0   |    0   |
     */

    /*mov r4, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

    /*mov r0.z, r0.y */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    flag = Instructions->count;

    for(j = 0; j < 3; j++)
    {
        /*img_load.u8 r2/3, c0, r0.xz */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(j+1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input), 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 2), 0, &Instructions->binarys[Instructions->count++]));

        /* add r0.z, r0.z  1 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1, &Instructions->binarys[Instructions->count++]));
    }

    /*filter.max.u8 r4, r2, r3, r4*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x05, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input) - 2, Input | (0x8 << 3), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*filter.min.u8 r1, r1, r2, r3*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x05, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input) - 2, Input | (0x9 << 3), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*branch r0.z, ystep, (flag - Instructions->count + 2); r0.z < ystep => loop */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, (flag - Instructions->count + 2), 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, Context->ystep, &Instructions->binarys[Instructions->count++]));

    /*bitextract.u8, r2, r1, r4, c3;*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*bitextract.u8, r3, r1, r4, c4;*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*filter.max.u8 r4, r2, r3, r4*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x05, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, (gcoHardwareVX_GetPixel(Input) + 1)/2 -1, Input | (0x8 << 3), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*filter.max.u8 r4, r4, r4, r4*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x05, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, (gcoHardwareVX_GetPixel(Input) + 1)/2 -1, Input | (0x8 << 3), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*filter.min.u8 r1, r1, r2, r3*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x05, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, (gcoHardwareVX_GetPixel(Input) + 1)/4 -1, Input | (0x9 << 3), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*filter.min.u8 r1, r1, r1, r1*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x05, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, (gcoHardwareVX_GetPixel(Input) + 1)/4 -1, Input | (0x9 << 3), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*div r0.x, r0.x, xstep */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x44, 0, 0x6, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, Context->xstep, &Instructions->binarys[Instructions->count++]));

    /*conv.s32 r1, r1; u8/s16 -> u32*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, (Input | (0 << 4)), &Instructions->binarys[Instructions->count++]));

    /*conv.s32 r4, r4; u8/s16 -> u32*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, (Input | (0 << 4)), &Instructions->binarys[Instructions->count++]));

    /*atom_min c1, 0, r1.x */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x68, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

    /*atom_max c2, 0, r4.y */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x69, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 0x5;
    Context->hasAtomic = gcvTRUE;

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _minmaxloc_filter_vx2(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gcoVX_Instructions *Instructions = Context->instructions;
    gceSTATUS                 status = gcvSTATUS_OK;
    gctUINT32                  Input = Context->input_type[0];
    gctUINT32                   flag = 0;
    gctUINT16 j;
    gcmHEADER_ARG("Context=0x%x", Context);

    /*
     * r1 : | l1/min | l1/min | l1/min | l1/min |
     * r2 : |   l2   |   l2   |   l2   |   l2   |
     * r3 : |   l3   |   l3   |   l3   |   l3   |
     * r4 : |   max  |   max  |   max  |   max  |
     * r5 : |   pcx  |   pcy  |    0   |    0   |
     */

    /*mov r4, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

    /*mov r0.z, r0.y */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    flag = Instructions->count;

    for(j = 0; j < 3; j++)
    {
        /*img_load.u8 r2/3, c0, r0.xz */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(j+1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input), 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 2), 0, &Instructions->binarys[Instructions->count++]));

        /* add r0.z, r0.z  1 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1, &Instructions->binarys[Instructions->count++]));
    }

    /*vertMax3.u8, r4, r2, r3, r4 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x19, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input), Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
    /*horzMax3.u8, r4, r4 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x1C, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input) - 2, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*vertMin3.u8, r1, r2, r3, r4 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x18, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input), Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
    /*horzMin3.u8, r1, r1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x1B, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input) - 2, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*branch r0.z, ystep, (flag - Instructions->count + 2); r0.z < ystep => loop */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, (flag - Instructions->count + 2), 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, Context->ystep, &Instructions->binarys[Instructions->count++]));

    /*bitextract.u8, r2, r1, r4, c3;*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*bitextract.u8, r3, r1, r4, c4;*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*vertMax3.u8, r4, r2, r3, r4 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x19, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input) - 2, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
    /*horzMax3.u8, r4, r4 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x1C, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, (gcoHardwareVX_GetPixel(Input) + 1)/2 - 1, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*vertMin3.u8, r4, r2, r3, r4 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x18, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, (gcoHardwareVX_GetPixel(Input) + 1)/4 -1, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
    /*horzMin3.u8, r1, r1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x1B, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input) - 2, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*div r0.x, r0.x, xstep */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x44, 0, 0x6, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, Context->xstep, &Instructions->binarys[Instructions->count++]));

    /*conv.s32 r1, r1; u8/s16 -> u32*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, (Input | (0 << 4)), &Instructions->binarys[Instructions->count++]));

    /*conv.s32 r4, r4; u8/s16 -> u32*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, (Input | (0 << 4)), &Instructions->binarys[Instructions->count++]));

    /*atom_min c1, 0, r1.x */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x68, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

    /*atom_max c2, 0, r4.y */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x69, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 0x5;
    Context->hasAtomic = gcvTRUE;

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _minmaxloc_loc(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gcoVX_Instructions *Instructions = Context->instructions;
    gceSTATUS                 status = gcvSTATUS_OK;
    gctUINT32                  Input = Context->input_type[0];
    gctUINT32 flag[2], end, i, j;
    gctUINT32 *index = Context->unifor_num;
    gctUINT32 return_loc = Context->policy;
    gctUINT32 offset1 = Context->volume;
    gctUINT32 offset2 = Context->clamp;
    gcoVX_Kernel_Context_Uniform *Uinform = Context->uniform;
    gcVXConfig config = {{0}};
    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    end = (Input == 0x7) ? 16 : 8;
    for (i = 0; i < end; i++)
    {
        config.termconfig[i] = VX_ADD;
        if(i < 8)
        config.abin0[i] = i;
        else
        config.abin1[i%8] = i;
        config.aselect[i] = 0;
        config.matrix[i] = 1;
    }

    _SetUniformItem(index, 0, 0, 0, 0, 0, gcvTRUE, &config, Input, &Uinform[*index]);

    /*mov r4, r0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*mov r10, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0U, &Instructions->binarys[Instructions->count++]));
    /*mov r11, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0U, &Instructions->binarys[Instructions->count++]));
    /*mul r9.x, r0.y (row number), (width*itemSize)  */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, offset2, &Instructions->binarys[Instructions->count++]));
    /*mul r12.x, r0.y (row number), (width*itemSize)  */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(12, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, offset2, &Instructions->binarys[Instructions->count++]));

    flag[0] = Instructions->count;
    /*img_load r1, c0, r4.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

    /*mov r13, r4 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*cmp r3, r1, c7.x(minVal), c7.y(1);   */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x05, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 7, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 7, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));

    /*cmp r1, r1, c7.z(maxVal), c7.y(1);   */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x05, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 7, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 7, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));

    if (Input == 0x7)
    {
        /*bitextract.u32 r5, r3.x, c8, 8;  c8 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));
        /*bitextract.u32 r6, r3.y, c8, 8;  c8 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));
        /*bitextract.u32 r7, r3.z, c8, 8;  c8 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));
        /*bitextract.u32 r8, r3.w, c8, 8;  c8 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));
        for (i = 5; i < 9;i++)
        {
            for (j = 0; j < 4; j++)
            {
                /*branch.u32 r5.x, 0, 7 */
                gcmONERROR(gcoHARDWAREVX_Branch(0x05, (return_loc == gcvTRUE)? 8 : 6, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, i, gcdVX_SWIZZLE1(j), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count++]));

                /*branch.u32 r13.x, c7.w(width), 7*/
                gcmONERROR(gcoHARDWAREVX_Branch(0x03, (return_loc == gcvTRUE)? 8 : 6, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 13, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(1, 7, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count++]));

                /*branch.u32 r13.y, (height), 6*/
                gcmONERROR(gcoHARDWAREVX_Branch(0x03, (return_loc == gcvTRUE)? 7 : 5, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 13, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, Context->col, &Instructions->binarys[Instructions->count++]));

                if (return_loc)
                {
                    /* store the cordinate*/
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x5, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 12, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 13, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
                }

                /*mov r2, 1 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

                /*atom_add c3(mincount), 0, r2 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x65, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

                if (return_loc)
                {
                    /*add.u32 r10.x, r10.x, 1 */
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1, &Instructions->binarys[Instructions->count++]));
                }

                /*add.u32 r12.x, r12.x, 8 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(12, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 12, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset1, &Instructions->binarys[Instructions->count++]));

                /*add.u32 r13.x, r13.x, 1 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 13, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));
            }
        }
        /*bitextract.u32 r5, r1.x, c8, 8;  c8 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));
        /*bitextract.u32 r6, r1.y, c8, 8;  c8 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));
        /*bitextract.u32 r7, r1.z, c8, 8;  c8 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));
        /*bitextract.u32 r8, r1.w, c8, 8;  c8 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));
        for (i = 5; i < 9;i++)
        {
            for (j = 0; j < 4; j++)
            {
                /*branch.u32 r5.x, 0, 7 */
                gcmONERROR(gcoHARDWAREVX_Branch(0x05, (return_loc == gcvTRUE)? 8 : 6, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, i, gcdVX_SWIZZLE1(j), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count++]));

                /*branch.u32 r4.x, c7.w(width), 7*/
                gcmONERROR(gcoHARDWAREVX_Branch(0x03, (return_loc == gcvTRUE)? 8 : 6, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(1, 7, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count++]));

                /*branch.u32 r4.y, (height), 6*/
                gcmONERROR(gcoHARDWAREVX_Branch(0x03, (return_loc == gcvTRUE)? 7 : 5, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, Context->col, &Instructions->binarys[Instructions->count++]));

                if (return_loc)
                {
                    /* store the cordinate*/
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x5, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
                }

                /*mov r2, 1 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

                /*atom_add c4, 0, 1 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x65, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(0, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

                if (return_loc)
                {
                    /*add.u32 r11.x, r11.x, 1 */
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 11, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1, &Instructions->binarys[Instructions->count++]));
                }

                /*add.u32 r9.x, r9.x, 8 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset1, &Instructions->binarys[Instructions->count++]));

                /*add.u32 r4.x, r4.x, 1 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));
            }
        }
    }
    else if (Input == 0x3)
    {
        /*bitextract.u32 r5, r3.x, c8, 8;  c8 = [0, 0x10, 0x20, 0x20] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));
        /*bitextract.u32 r6, r3.y, c8, 8;  c8 = [0, 0x10, 0x20, 0x20] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));
        /*bitextract.u32 r7, r3.z, c8, 8;  c8 = [0, 0x10, 0x20, 0x20] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));
        /*bitextract.u32 r8, r3.w, c8, 8;  c8 = [0, 0x10, 0x20, 0x20] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));
        for (i = 5; i < 9;i++)
        {
            for (j = 0; j < 2; j++)
            {
                /*branch.u32 r5.x, 0, 7 */
                gcmONERROR(gcoHARDWAREVX_Branch(0x05, (return_loc == gcvTRUE)? 8 : 6, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, i, gcdVX_SWIZZLE1(j), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count++]));

                /*branch.u32 r13.x, c7.w(width), 7*/
                gcmONERROR(gcoHARDWAREVX_Branch(0x03, (return_loc == gcvTRUE)? 8 : 6, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 13, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(1, 7, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count++]));

                /*branch.u32 r13.y, (height), 6*/
                gcmONERROR(gcoHARDWAREVX_Branch(0x03, (return_loc == gcvTRUE)? 7 : 5, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 13, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, Context->col, &Instructions->binarys[Instructions->count++]));

                if (return_loc)
                {
                    /* store the cordinate*/
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x5, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 12, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 13, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
                }

                /*mov r2, 1 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

                /*atom_add c3(mincount), 0, r2 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x65, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

                if (return_loc)
                {
                    /*add.u32 r10.x, r10.x, 1 */
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1, &Instructions->binarys[Instructions->count++]));
                }

                /*add.u32 r12.x, r12.x, 1 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(12, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 12, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset1, &Instructions->binarys[Instructions->count++]));

                /*add.u32 r13.x, r13.x, 1 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 13, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));
            }
        }
        /*bitextract.u32 r5, r1.x, c8, 8;  c8 = [0, 0x10, 0x20, 0x20] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));
        /*bitextract.u32 r6, r1.y, c8, 8;  c8 = [0, 0x10, 0x20, 0x20] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));
        /*bitextract.u32 r7, r1.z, c8, 8;  c8 = [0, 0x10, 0x20, 0x20] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));
        /*bitextract.u32 r8, r1.w, c8, 8;  c8 = [0, 0x10, 0x20, 0x20] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));
        for (i = 5; i < 9;i++)
        {
            for (j = 0; j < 2; j++)
            {
                /*branch.u32 r5.x, 0, 7 */
                gcmONERROR(gcoHARDWAREVX_Branch(0x05, (return_loc == gcvTRUE)? 8 : 6, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, i, gcdVX_SWIZZLE1(j), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count++]));

                /*branch.u32 r4.x, c7.w(width), 7*/
                gcmONERROR(gcoHARDWAREVX_Branch(0x03, (return_loc == gcvTRUE)? 8 : 6, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(1, 7, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count++]));

                /*branch.u32 r4.y, (height), 6*/
                gcmONERROR(gcoHARDWAREVX_Branch(0x03, (return_loc == gcvTRUE)? 7 : 5, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, Context->col, &Instructions->binarys[Instructions->count++]));

                if (return_loc)
                {
                    /* store the cordinate*/
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x5, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
                }

                /*mov r2, 1 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

                /*atom_add c4, 0, 1 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x65, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(0, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

                if (return_loc)
                {
                    /*add.u32 r11.x, r11.x, 1 */
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 11, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1, &Instructions->binarys[Instructions->count++]));
                }

                /*add.u32 r9.x, r9.x, 1 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset1, &Instructions->binarys[Instructions->count++]));

                /*add.u32 r4.x, r4.x, 1 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));
            }
        }
    }

    /*branch.u32 r4.x, c7.w(width), flag[0] - curr */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, (gctINT32)flag[0] - Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 7, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count++]));
    if (return_loc)
    {
        /*save count to count img*/
        /*img_store r10.x, c1, r0.xy, r10.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 10, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        /*img_store r11.x, c2, r0.xy, r11.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 11, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }

    Instructions->regs_count = 14;

    Context->hasAtomic = gcvTRUE;

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _minmaxloc_pack(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gcoVX_Instructions *Instructions = Context->instructions;
    gceSTATUS                 status = gcvSTATUS_OK;
    gctUINT32 flag[2];
    gctUINT32 offset = Context->volume;
    gctUINT32 offsetSrc = Context->clamp;
    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    /*mov r1, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0U, &Instructions->binarys[Instructions->count++]));
    /*mov r2, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0U, &Instructions->binarys[Instructions->count++]));
    /*mov r3, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0U, &Instructions->binarys[Instructions->count++]));
    /*mov r4, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0U, &Instructions->binarys[Instructions->count++]));

    flag[0] = Instructions->count;
    /*img_load r1.x, c0, r2.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x6, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
     /*add.u32 r3.x, r1.x, r3.x */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));
    /*add.u32 r2.y, r2.y, 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));
    /*branch.u32 r2.y, r0.y, flag[0] - curr */
    gcmONERROR(gcoHARDWAREVX_Branch(0x04, (gctINT32)flag[0] - Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));
    /*add.u32 r3.y, r3.x, -r1.x */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(0), NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));
    /*branch.u32 r1.x, 0, 8 */
    gcmONERROR(gcoHARDWAREVX_Branch(0x04, 10, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count++]));
    /*Compute src start offset*/
    /*mul r4.x, r0.y (row number), (width * itemsize)  */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, offsetSrc, &Instructions->binarys[Instructions->count++]));
    /*Compute dst start offset*/
    /*mul r4.y, r3.y (before number), itemsize  */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, offset, &Instructions->binarys[Instructions->count++]));

    flag[1] = Instructions->count;
    /* Skip when dst offset is large than cap size*/
    /*branch.u32 r4.y, c3.x(capSize), 10 */
    gcmONERROR(gcoHARDWAREVX_Branch(0x03, 7, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

    /*branch.u32 r4.x, c3.y(width*height*itemSize), 6 */
    gcmONERROR(gcoHARDWAREVX_Branch(0x03, 2, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));

    /* load r5.xy, c1, r4.x */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));
    /* store r5.xy, c2, r4.y, r5*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
    /*add.u32 r4, r4, offset */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset, &Instructions->binarys[Instructions->count++]));
    /*add.u32 r3.z, r3.z, 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));
    /*branch.u32 r3.z, r1.x, flag[1] - curr */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, (gctINT32)flag[1] - Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 6;

    OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _minmaxloc(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
#define MML_FILTER 0
#define MML_LOC   1
#define MML_PACK 2

    gceSTATUS status                    = gcvSTATUS_OK;
    gcoVX_Hardware_Step steps[] = {
        {0, "filter", MML_FILTER, &_minmaxloc_filter},
        {1, "location", MML_LOC, &_minmaxloc_loc},
        {1, "pack data", MML_PACK, &_minmaxloc_pack},
    };

    gcmHEADER_ARG("Context=0x%x", Context);
    assert(Context->step < 3);

    gcmONERROR(steps[Context->step].func(Context));

OnError:
    gcmFOOTER();

    return status;
}

static gceSTATUS _minmaxloc_vx2(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
#define MML_FILTER 0
#define MML_LOC   1
#define MML_PACK 2

    gceSTATUS status                    = gcvSTATUS_OK;
    gcoVX_Hardware_Step steps[] = {
        {0, "filter", MML_FILTER, &_minmaxloc_filter_vx2},
        {1, "location", MML_LOC, &_minmaxloc_loc},
        {1, "pack data", MML_PACK, &_minmaxloc_pack},
    };

    gcmHEADER_ARG("Context=0x%x", Context);
    assert(Context->step < 3);

    gcmONERROR(steps[Context->step].func(Context));

OnError:
    gcmFOOTER();

    return status;
}

static gceSTATUS _meanstddev(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS                     status       = gcvSTATUS_OK;
    gcoVX_Instructions           *Instructions = Context->instructions;
    gcVXConfig                    sumConfig    = {{0}};
    gcVXConfig                    sqsumConfig  = {{0}};
    gctUINT32                    *index        = Context->unifor_num;
    gcoVX_Kernel_Context_Uniform *Uinform      = Context->uniform;
    gctUINT32                     Input        = Context->input_type[0];
    gctUINT32                     i, flag;

    gcmHEADER_ARG("Context=0x%x", Context);

    /*
     *         s32
     * c1 |    sum    |     0     |     0     |     0     |
     * c2 |   sqsum   |     0     |     0     |     0     |
     */

    for (i = 0; i < 16; i++)
    {
        sumConfig.termconfig[i]   = VX_ADD;
        sqsumConfig.termconfig[i] = VX_ADD;
        if(i < 8)
        {
            sumConfig.abin0[i]   = i;
            sqsumConfig.abin0[i] = i;
            sqsumConfig.bbin0[i] = i;
        }
        else
        {
            sumConfig.abin1[i%8]   = i;
            sqsumConfig.abin1[i%8] = i;
            sqsumConfig.bbin1[i%8] = i;
        }
        sumConfig.aselect[i]   = 0;
        sumConfig.matrix[i]    = 1;
        sqsumConfig.aselect[i] = 0;
        sqsumConfig.bselect[i] = 1;
    }

    /*mov r1, 0; clean r1 to avoid garbage  */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

    /*mov r2, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

    /*size of sqsum is larger than 32-bit*/
    if (Context->ystep != 1)
    {
        /*mov r3, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

        /*add.u32 r2.y, r0.y, 255U */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 255U, &Instructions->binarys[Instructions->count++]));

        flag = Instructions->count;

        /*mov r1, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

        /*img_load.u8 r1, c0, r0.xy*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

        _SetUniformItem(index, 0, 0, 0, 0, 0, gcvTRUE, &sumConfig, Input, &Uinform[*index]);

        /*dp16.u8 r2, r1, 1, c4_512 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (Input | (Input << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));

        /*add.u32 r3.x, r3.x, r2.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

        _SetUniformItemExt(index, 0, 0, 0, 0, 0, gcvTRUE, &sqsumConfig, Input, &Uinform[*index]);

        /*dp16.u8 r2, r1, r1, c4_512 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (Input | (Input << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));

        /*add.u32 r3.y, r3.y, r2.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

        /*add.u32 r0.y, r0, 1 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

        /*branch.u32 r0.y, r2.y, flag-count */
        gcmONERROR(gcoHARDWAREVX_Branch(0x02, flag-Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));

        /* do shift into 32-bit */
        /*rshift r3.xy, r3.xy, 1*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE2(0,1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE2(0,1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

        /*atom_add c1, 0, r3.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x65, 0, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

        /*atom_add c2, 0, r3.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x65, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));

        Instructions->regs_count = 0x4;
    }
    else /*size of sqsum is smaller than 32-bit*/
    {
        _SetUniformItem(index, 0, 0, 0, 0, 0, gcvTRUE, &sumConfig, Input, &Uinform[*index]);

        /*mov r1, 0; clean r1 to avoid garbage  */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

        /*mov r2, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

        /*img_load.u8 r1, c0, r0.xy*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /*dp16.u8 r2, r1, 1, c4_512 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (Input | (Input << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));

        /*atom_add c1, 0, r2.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x65, 0, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

        _SetUniformItemExt(index, 0, 0, 0, 0, 0, gcvTRUE, &sqsumConfig, Input, &Uinform[*index]);

        /*dp16.u8 r2, r1, r1, c4_512 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (Input | (Input << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));

        /*atom_add c2, 0, r2.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x65, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

        Instructions->regs_count = 0x3;
    }

    Context->hasAtomic = gcvTRUE;

OnError:
    gcmFOOTER();
    return status;
}

   /*    for openvx 1.1 'OptFlowPyrLK.GraphProcessing/0/case1/5x5/ReferencePyramid',
    * 'OptFlowPyrLK.GraphProcessing/1/case1/9x9/ReferencePyramid'
    */

static gceSTATUS _optLKTracker(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;

    gctUINT8 isUseInitialEstimate = Context->isUseInitialEstimate;
    gctINT32 maxLevel = Context->maxLevel;
    gctINT32 winSize = 5; /*Context->winSize;*/

    RelOffset CoordOffset = {{-2, -2}}; /*{{-1, -1}};*/
    gctINT32 row = 0, level = 0, startIteration1 = 0, startIteration2 = 0, startIteration3 = 0;
    gctINT32 OPT_INS_COUNT[10];

    gcoVX_Instructions *Instructions = Context->instructions;
    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    if(1==maxLevel)
    {
        if(isUseInitialEstimate) OPT_INS_COUNT[0] = 119 - 7 + 5 + 1;
        else OPT_INS_COUNT[0] = 118 - 7 + 5 + 1;
    }
    else
    {
        if(isUseInitialEstimate) OPT_INS_COUNT[1] = 124 + maxLevel - 7 + 5 + 5 + 1;
        else OPT_INS_COUNT[1] = 122 + maxLevel - 7 + 5 + 5 + 1;

        for(level=2; level<maxLevel; level++)
        {
            OPT_INS_COUNT[level] = 121 - 7 + 5 + 5;
        }

        OPT_INS_COUNT[0] = 119 - 7 + 5;

        /* accumulate */
        for(level=2; level<maxLevel; level++)
        {
            OPT_INS_COUNT[level] = OPT_INS_COUNT[level] + OPT_INS_COUNT[level-1];
        }
        OPT_INS_COUNT[0] += OPT_INS_COUNT[maxLevel-1];
    }

    /*
        prevPts - index = 0
        nextPts - index = 1
        estimatedPts - index = 2
        prevImg[] - index = 3 ~ 3+maxLevel-1
        nextImg[] - index = 3+maxLevel ~ 3+maxLevel*2-1
        prevDerivIx[] - index = 3+maxLevel*2 ~ 3+maxLevel*3-1
        prevDerivIy[] - index = 3+maxLevel*3 ~ 3+maxLevel*4-1
        DP8 - index = 3+maxLevel*4 ~ 3+maxLevel*4+3
        epsilon, numIterations, minEig(104.8576f), D(109951.1627776f) - index = 3+maxLevel*4+4
        prevDelta(0.01), 1/pyramidScale, iteration step, pyramidScale - index = 3+maxLevel*4+5
        bounding box--winSize/2, max width&height - index = 3+maxLevel*4+6 ~ 3+maxLevel*5+6-1
        L shift - index = 3+maxLevel*5+6
        minEigWin, 0.5f, 4.0f, 1 - index = 3+maxLevel*5+7
        bilinear uniform1 - index = 3+maxLevel*5+8
        bilinear uniform2 - index = 3+maxLevel*5+9
        DP4x8 - index = 3+maxLevel*5+10~3+maxLevel*5+10+3
        DP4x8 - index = 3+maxLevel*5+14~3+maxLevel*5+14+3
        DP16x1 - index = 3 + maxLevel * 5 + 18 ~ 3 + maxLevel * 5 + 18 +3
        DP16x1 - index = 3 + maxLevel * 5 + 22 ~ 3 + maxLevel * 5 + 22 +3
    */

    /* branchAny.GE OPT_INS_COUNT[0], r0.x, c(3+maxLevel*5+7).x  */
    gcmONERROR(gcoHARDWAREVX_BranchAny(0x03, OPT_INS_COUNT[0]-Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+7), gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));


    if(maxLevel>=2)
    {
        /* mov r2, c(3+maxLevel*4+5) */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, (3+maxLevel*4+5), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

        for(level=2; level<maxLevel; level++)
        {
            /* mul r2.w, r2.w, c(3+maxLevel*4+5).w */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+5), gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count++]));
        }

        /* prevPts - load r1.xy, c0, r0.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* I2F r1.xy, r1.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x2D, 0, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* mul r1.xy, r1.xy, r2.ww */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE2(3, 3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* assign nextPts */
        if(isUseInitialEstimate)
        {
            /* estimatedPts - load r16.xy, c2, r0.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /* I2F r16.xy, r16.xy  */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x2D, 0, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /* mul r16.xy, r16.xy, r2.ww */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE2(3, 3), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        }
        else
        {
            /* mov r16, r1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        }

        /* F2I r1.zw, r1.xy  */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x2E, 0, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE4(0, 1, 0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* branchAny.LT (OPT_INS_COUNT[1]-1), r1.zw, c(3+maxLevel*4+6).xy */
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x02, (OPT_INS_COUNT[1]-1)-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+6), gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* branchAny.GE (OPT_INS_COUNT[1]-1), r1.zw, c(3+maxLevel*4+6).zw  */
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x03, (OPT_INS_COUNT[1]-1)-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+6), gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));

    /*-------------------------------------- pre_arr x, y ---------------------------------------*/

        CoordOffset.u.y = (gctUINT16)0x1e; /* (gctUINT16)0x1f; */

        /* grad_x - img_load.s16 r2[11:0], c(3+maxLevel*2), r1.zw */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*2), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

        row = 0;
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* grad_x - img_load.s16 r3/2[11:0], c(3+maxLevel*2), r1.zw, */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*2), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* Bilinear.s16 r4[9:0], r2/3[11:0], r3/2[11:0], r1.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0D, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3|(0x0<<3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r5[15:12], r4[9:0], r4[9:0], c(3+maxLevel*5+22)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+22), &Instructions->binarys[Instructions->count++]));
        }

        for(row=1; row<winSize-1; row++)
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* grad_x - img_load.s16 r3/2[11:0], c(3+maxLevel*2), r1.zw, */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*2), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* Bilinear.s16 r5-7/5[9:0], r2/3[11:0], r3/2[11:0], r1.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0D, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3|(0x0<<3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r6-8/6[15:12], r5-7/5[9:0,15:12], r5-7/5[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        row = winSize - 1;
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* grad_x - img_load.s16 r3/2[11:0], c(3+maxLevel*2), r1.zw, */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*2), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* Bilinear.s16 r8/6[9:0], r2/3[11:0], r3/2[11:0], r1.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0D, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3|(0x0<<3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.f32 r9[3:0], r8/6[9:0,15:12], r8/6[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        CoordOffset.u.y = (gctUINT16)0x1e; /* (gctUINT16)0x1f; */

        /* grad_y - img_load.s16 r2[11:0], c(3+maxLevel*3), r1.zw */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*3), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

        row = 0;
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row;*/

            /* grad_y - img_load.s16 r3/2[11:0], c(3+maxLevel*3), r1.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*3), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* Bilinear.s16 r10[9:0], r2/3[11:0], r3/2[11:0], r1.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0D, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(10+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3|(0x0<<3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r5[15:12], r4[9:0], r10[9:0], c(3+maxLevel*5+22)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+22), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r11[15:12], r10[9:0], r10[9:0], c(3+maxLevel*5+22)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+22), &Instructions->binarys[Instructions->count++]));
        }

        for(row=1; row<winSize-1; row++)
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row;*/

            /* grad_y - img_load.s16 r3/2[11:0], c(3+maxLevel*3), r1.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*3), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* Bilinear.s16 r11-13/11[9:0], r2/3[11:0], r3/2[11:0], r1.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0D, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(10+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3|(0x0<<3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r6-8/6[15:12], r5-7/5[9:0,15:12], r11-13/11[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));

             /* dp16x1.s32 r12-14/6[15:12], r11-13/11[9:0,15:12], r11-13/11[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        row = winSize - 1;
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row;*/

            /* grad_y - img_load.s16 r3/2[11:0], c(3+maxLevel*3), r1.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*3), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* Bilinear.s16 r14/12[9:0], r2/3[11:0], r3/2[11:0], r1.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0D, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(10+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3|(0x0<<3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.f32 r9[8:4], r8/6[9:0,15:12], r14/12[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(1, 1, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.f32 r9[12:9], r14/12[9:0,15:12], r14/12[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(2, 2, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        /* mul r9.w, r9.y, -r9.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(1), NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));

        /* mad r9.w, r9.x, r9.z, r9.w */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* add r2.x, r9.x, -r9.z */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE1(2), NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));

        /* mul r2.x, r2.x, r2.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* mul r2.y, r9.y, c(3+maxLevel*5+7).z */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+7), gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));

        /* mad r2.x, r2.y, r9.y, r2.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* sqrt r2.x, r2.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x21, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* add r2.x, r9.x, -r2.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));

        /* add r2.x, r9.z, r2.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* branchAny.LT (OPT_INS_COUNT[1]-1), r2.x, c(3+maxLevel*4+4).z*/
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x02, (OPT_INS_COUNT[1]-1)-Instructions->count, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+4), gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));

        /* branchAny.LT (OPT_INS_COUNT[1]-1), r9.w, c(3+maxLevel*4+4).w */
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x02, (OPT_INS_COUNT[1]-1)-Instructions->count, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+4), gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count++]));

        /* rcp r9.w r9.w */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x0C, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* --------------------------------------  D ---------------------------------------  */

        CoordOffset.u.y = (gctUINT16)0x1e; /* (gctUINT16)0x1f; */

        /* pre_img - img_load.u8 r2[5:0], c3, r1.zw */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

        /* mul_shift r2[11:0], r2[5:0], c(3+maxLevel*5+6), 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        row = 0;
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* pre_img - img_load.u8, r3/2[5:0], c3, r1.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* mul_shift r3/2[11:0], r3/2[5:0], c(3+maxLevel*5+6), 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* Bilinear.s16 r2/3[9:0], r2/3[11:0], r3/2[11:0], r1.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0D, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2+row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, (0x6|(0x0<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r5[15:12], r4[9:0], r2/3[9:0], c(3+maxLevel*5+22)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+22), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r11[12:15], r10[0:9], r2/3[9:0], c(3+maxLevel*5+22)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+22), &Instructions->binarys[Instructions->count++]));
        }

        for (row=1; row<winSize-1; row++)
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* pre_img - img_load.u8 r3/2[5:0], c3, r1.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* mul_shift r3/2[11:0], r3/2[5:0], c(3+maxLevel*5+6), 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* Bilinear.s16 r2/3[9:0], r2/3[11:0], r3/2[11:0], r1.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0D, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2+row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, (0x6|(0x0<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r6-r8[12:15], r5-7[9:0, 15:12], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r12-r14[12:15], r11-13[0:9,12:15], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        row = winSize-1;
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* pre_img - img_load.u8, r3/2[5:0], c3, r1.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* mul_shift r3/2[11:0], r3/2[5:0], c(3+maxLevel*5+6), 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* Bilinear.s16 r2/3[9:0], r2/3[11:0], r3/2[11:0], r1.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0D, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2+row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, (0x6|(0x0<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.f32 r15[3:0], r8/6[9:0, 15:12], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.f32 r15[7:4], r14/12[0:9,12:15], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(1, 1, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        /* mul r2.xy, r9.yy, -r15.yx */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE2(1, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE2(1, 0), NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));

        /* mad r15.xy, r9.zx, r15.xy, r2.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE2(2, 0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* --------------------------------------  deltaXN, deltaYN --------------------------------------- */

        /* mov r17.x, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(17, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

        startIteration1 = Instructions->count;

        /* F2I r16.zw, r16.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x2E, 0, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE4(0, 1, 0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* branchAny.LT (OPT_INS_COUNT[1]-1), r16.zw, c(3+maxLevel*4+6).xy */
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x02, (OPT_INS_COUNT[1]-1)-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+6), gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* branchAny.GE (OPT_INS_COUNT[1]-1), r16.zw, c(3+maxLevel*4+6).zw */
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x03, (OPT_INS_COUNT[1]-1)-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+6), gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));

        /*--------------------------------------  cur_arr x, y ---------------------------------------*/

        CoordOffset.u.y = (gctUINT16)0x1e; /* (gctUINT16)0x1f; */

        /* nextImg - img_load.u8 r2[5:0], c(3+maxLevel), r16.zw */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

        /* mul_shift r2[11:0], r2[5:0], c(3+maxLevel*5+6), 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        row = 0;
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* nextImg - img_load.u8 r3/2[5:0], c(3+maxLevel), r16.zw, */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* mul_shift r3/2[11:0], r3/2[5:0], c(3+maxLevel*5+6), 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* Bilinear.s16 r2/3[9:0], r2/3[11:0], r3/2[11:0], r16.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0D, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2+row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, (0x6|(0x0<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 16, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r5[12:15], r4[9:0], r2[9:0], c(3+maxLevel*5+22)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+22), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r11[12:15], r10[9:0], r2[9:0], c(3+maxLevel*5+22)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+22), &Instructions->binarys[Instructions->count++]));
        }

        for (row=1; row<winSize-1; row++)
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* nextImg - img_load.u8 r3/2[5:0], c(3+maxLevel), r16.zw, */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* mul_shift r3/2[11:0], r3/2[5:0], c(3+maxLevel*5+6), 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* Bilinear.s16 r2/3[9:0], r2/3[11:0], r3/2[11:0], r16.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0D, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2+row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, (0x6|(0x0<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 16, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r6-8[12:15], r5-7[0:9,12:15], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r12-r14[12:15], r11-13[0:9,12:15], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        row = winSize-1;
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* nextImg - img_load.u8 r3/2[5:0], c(3+maxLevel), r16.zw, */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* mul_shift r3/2[11:0], r3/2[5:0], c(3+maxLevel*5+6), 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* Bilinear.s16 r2/3[9:0], r2/3[11:0], r3/2[11:0], r16.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0D, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2+row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, (0x6|(0x0<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 16, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.f32 r15[11:8], r8/6[0:9,12:15], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(2, 2, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.f32 r15[15:12], r14/12[0:9,12:15], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        /* mul r2.xy, r9.zx, -r15.zw*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE2(2, 0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE2(2, 3), NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));

        /* mad r15.zw, r9.yy, r15.wz, r2.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE4(1, 1, 1, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE4(3, 2, 3, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE4(0, 1, 0, 1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* add.f32 r15.zw, r15.zw, r15.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE4(2, 3, 2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE4(0, 1, 0, 1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* mul.f32 r15.zw, r15.zw, r9.ww */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE4(2, 3, 2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE4(3, 3, 3, 3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /*-----------------------  delta_x, delta_y ------------------*/

        /* add.f32 r16.xy, r16.xy, r15.zw*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* dp2 r2.x, r15.zw, r15.zw*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x73, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));

        /* add r17.x, r17.x, c(3+maxLevel*4+5).z*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(17, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 17, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, (3+maxLevel*4+5), gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));

        /* mov r2.y, r17.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 17, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

        /* branch.f32 startIteration1, r2.xy, c(3+maxLevel*4+4).xy */
        gcmONERROR(gcoHARDWAREVX_Branch(0x01, (startIteration1-Instructions->count), 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+4), gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* NOP -- (OPT_INS_COUNT[1]-1)==Instructions->count*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x00, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_DisableDestination(&Instructions->binarys[Instructions->count++]));
    }

    /*------------------------------  maxLevel>=2 ------------------------------------*/

    if(maxLevel>=3)
    {
    for(level=2; level<maxLevel; level++)
    {
        /* mul r1.xy, r1.xy, c(3+maxLevel*4+5).yy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+5), gcdVX_SWIZZLE2(1, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* mul r16.xy, r16.xy, c(3+maxLevel*4+5).yy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+5), gcdVX_SWIZZLE2(1, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* F2I r1.zw, r1.xy    */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x2E, 0, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE4(0, 1, 0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* branchAny.LT (OPT_INS_COUNT[level]-1), r1.zw, c(3+maxLevel*4+6+level-1).xy */
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x02, (OPT_INS_COUNT[level]-1)-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+6+level-1), gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* branchAny.GE (OPT_INS_COUNT[level]-1), r1.zw, c(3+maxLevel*4+6+level-1).zw */
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x03, (OPT_INS_COUNT[level]-1)-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+6+level-1), gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));

    /*-------------------------------------- pre_arr x, y ---------------------------------------*/

        CoordOffset.u.y = (gctUINT16)0x1e; /* (gctUINT16)0x1f; */

        /* grad_x - img_load.s16 r2[11:0], c(3+maxLevel*2+level-1), r1.zw */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*2+level-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

        row = 0;
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* grad_x - img_load.s16 r3/2[11:0], c(3+maxLevel*2+level-1), r1.zw, */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*2+level-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* Bilinear.s16 r4[9:0], r2/3[11:0], r3/2[11:0], r1.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0D, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3|(0x0<<3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r5[15:12], r4[9:0], r4[9:0], c(3+maxLevel*5+22)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+22), &Instructions->binarys[Instructions->count++]));
        }

        for(row=1; row<winSize-1; row++)
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* grad_x - img_load.s16 r3/2[11:0], c(3+maxLevel*2+level-1), r1.zw, */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*2+level-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* Bilinear.s16 r5-7/5[9:0], r2/3[11:0], r3/2[11:0], r1.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0D, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3|(0x0<<3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r6-8/6[15:12], r5-7/5[9:0,15:12], r5-7/5[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        row = winSize - 1;
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* grad_x - img_load.s16 r3/2[11:0], c(3+maxLevel*2+level-1), r1.zw, */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*2+level-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* Bilinear.s16 r8/6[9:0], r2/3[11:0], r3/2[11:0], r1.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0D, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3|(0x0<<3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.f32 r9[3:0], r8/6[9:0,15:12], r8/6[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        CoordOffset.u.y = (gctUINT16)0x1e; /* (gctUINT16)0x1f; */

        /* grad_y - img_load.s16 r2[11:0], c(3+maxLevel*3+level-1), r1.zw */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*3+level-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

        row = 0;
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* grad_y - img_load.s16 r3/2[11:0], c(3+maxLevel*3+level-1), r1.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*3+level-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* Bilinear.s16 r10[9:0], r2/3[11:0], r3/2[11:0], r1.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0D, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(10+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3|(0x0<<3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r5[15:12], r4[9:0], r10[9:0], c(3+maxLevel*5+22)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+22), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r11[15:12], r10[9:0], r10[9:0], c(3+maxLevel*5+22)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+22), &Instructions->binarys[Instructions->count++]));
        }

        for(row=1; row<winSize-1; row++)
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row;*/

            /* grad_y - img_load.s16 r3/2[11:0], c(3+maxLevel*3+level-1), r1.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*3+level-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* Bilinear.s16 r11-13/11[9:0], r2/3[11:0], r3/2[11:0], r1.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0D, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(10+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3|(0x0<<3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r6-8/6[15:12], r5-7/5[9:0,15:12], r11-13/11[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));

             /* dp16x1.s32 r12-14/6[15:12], r11-13/11[9:0,15:12], r11-13/11[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        row = winSize - 1;
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row;*/

            /* grad_y - img_load.s16 r3/2[11:0], c(3+maxLevel*3+level-1), r1.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*3+level-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* Bilinear.s16 r14/12[9:0], r2/3[11:0], r3/2[11:0], r1.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0D, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(10+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3|(0x0<<3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.f32 r9[8:4], r8/6[9:0,15:12], r14/12[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(1, 1, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.f32 r9[12:9], r14/12[9:0,15:12], r14/12[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(2, 2, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        /* mul r9.w, r9.y, -r9.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(1), NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));

        /* mad r9.w, r9.x, r9.z, r9.w */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* add r2.x, r9.x, -r9.z */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE1(2), NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));

        /* mul r2.x, r2.x, r2.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* mul r2.y, r9.y, c(3+maxLevel*5+7).z */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+7), gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));

        /* mad r2.x, r2.y, r9.y, r2.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* sqrt r2.x, r2.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x21, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* add r2.x, r9.x, -r2.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));

        /* add r2.x, r9.z, r2.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* branchAny.LT (OPT_INS_COUNT[level]-1), r2.x, c(3+maxLevel*4+4).z*/
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x02, (OPT_INS_COUNT[level]-1)-Instructions->count, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+4), gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));

        /* branchAny.LT (OPT_INS_COUNT[level]-1), r9.w, c(3+maxLevel*4+4).w */
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x02, (OPT_INS_COUNT[level]-1)-Instructions->count, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+4), gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count++]));

        /* rcp r9.w r9.w */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x0C, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* --------------------------------------  D ---------------------------------------  */

        CoordOffset.u.y = (gctUINT16)0x1e; /* (gctUINT16)0x1f; */

        /* prevImg - img_load.u8 r2[5:0], c(3+level-1), r1.zw */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+level-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

        /* mul_shift r2[11:0], r2[5:0], c(3+maxLevel*5+6), 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        row = 0;
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* prevImg - img_load.u8 r3/2[5:0], c(3+level-1), r1.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+level-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* mul_shift r3/2[11:0], r3/2[5:0], c(3+maxLevel*5+6), 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* Bilinear.s16 r2/3[9:0], r2/3[11:0], r3/2[11:0], r1.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0D, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2+row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, (0x6|(0x0<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r5[12:15], r4[0:9], r2[0:9], c(3+maxLevel*5+22)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+22), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r11[12:15], r10[0:9], r2[0:9], c(3+maxLevel*5+22)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+22), &Instructions->binarys[Instructions->count++]));
        }

        for (row=1; row<winSize-1; row++)
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* prevImg - img_load.u8 r3/2[5:0], c(3+level-1), r1.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+level-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* mul_shift r3/2[11:0], r3/2[5:0], c(3+maxLevel*5+6), 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* Bilinear.s16 r2/3[9:0], r2/3[11:0], r3/2[11:0], r1.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0D, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2+row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, (0x6|(0x0<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r6-8[12:15], r5-7[0:9,12:15], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r12-r14[12:15], r11-12[0:9,12:15], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        row = winSize-1;
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* prevImg - img_load.u8 r3/2[5:0], c(3+level-1), r1.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+level-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* mul_shift r3/2[11:0], r3/2[5:0], c(3+maxLevel*5+6), 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* Bilinear.s16 r2/3[9:0], r2/3[11:0], r3/2[11:0], r1.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0D, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2+row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, (0x6|(0x0<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.f32 r15[3:0], r8/6[0:9,12:15], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.f32 r15[7:4], r14/12[0:9,12:15], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(1, 1, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        /* mul r2.xy, r9.yy, -r15.yx  */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE2(1, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE2(1, 0), NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));

        /* mad r15.xy, r9.zx, r15.xy, r2.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE2(2, 0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* --------------------------------------  deltaXN, deltaYN --------------------------------------- */

        /* mov r17.x, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(17, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

        startIteration2 = Instructions->count;

        /* F2I r16.zw, r16.xy   */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x2E, 0, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE4(0, 1, 0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* branchAny.LT (OPT_INS_COUNT[level]-1), r16.zw, c(3+maxLevel*4+6+level-1).xy */
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x02, (OPT_INS_COUNT[level]-1)-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+6+level-1), gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* branchAny.GE (OPT_INS_COUNT[level]-1), r16.zw, c(3+maxLevel*4+6+level-1).zw */
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x03, (OPT_INS_COUNT[level]-1)-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+6+level-1), gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));

        /*--------------------------------------  cur_arr x, y ---------------------------------------*/

        CoordOffset.u.y = (gctUINT16)0x1e; /* (gctUINT16)0x1f; */

        /* nextImg - img_load.u8 r2[5:0], c(3+maxLevel+level-1), r16.zw */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel+level-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

        /* mul_shift r2[11:0], r2[5:0], c(3+maxLevel*5+6), 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        row = 0;
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* nextImg - img_load.u8 r3/2[5:0], c(3+maxLevel+level-1), r16.zw, */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel+level-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* mul_shift r3/2[11:0], r3/2[5:0], c(3+maxLevel*5+6), 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* Bilinear.s16 r2/3[9:0], r2/3[11:0], r3/2[11:0], r16.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0D, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2+row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, (0x6|(0x0<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 16, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r5[12:15], r4[0:9], r2[0:9], c(3+maxLevel*5+22)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+22), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r11[12:15], r10[0:9], r2[0:9], c(3+maxLevel*5+22)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+22), &Instructions->binarys[Instructions->count++]));
        }

        for (row=1; row<winSize-1; row++)
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* nextImg - img_load.u8 r3/2[5:0], c(3+maxLevel+level-1), r16.zw, */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel+level-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* mul_shift r3/2[11:0], r3/2[5:0], c(3+maxLevel*5+6), 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* Bilinear.s16 r2/3[9:0], r2/3[11:0], r3/2[11:0], r16.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0D, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2+row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, (0x6|(0x0<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 16, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r6-8[12:15], r5-7[0:9], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r12-r14[12:15], r11-13[0:9,12:15], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        row = winSize-1;
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* nextImg - img_load.u8 r3/2[5:0], c(3+maxLevel+level-1), r16.zw, */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel+level-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* mul_shift r3/2[11:0], r3/2[5:0], c(3+maxLevel*5+6), 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* Bilinear.s16 r2/3[9:0], r2/3[11:0], r3/2[11:0], r16.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0D, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2+row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, (0x6|(0x0<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 16, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.f32 r15[11:8], r8/6[0:9,12:15], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(2, 2, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.f32 r15[15:12], r14/12[0:9,12:15], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        /* mul r2.xy, r9.zx, -r15.zw */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE2(2, 0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE2(2, 3), NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));

        /* mad r15.zw, r9.yy, r15.wz, r2.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE4(1, 1, 1, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE4(3, 2, 3, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE4(0, 1, 0, 1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* add.f32 r15.zw, r15.zw, r15.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE4(2, 3, 2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE4(0, 1, 0, 1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* mul.f32 r15.zw, r15.zw, r9.ww */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE4(2, 3, 2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE4(3, 3, 3, 3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /*-----------------------  delta_x, delta_y ------------------*/

        /* add.f32 r16.xy, r16.xy, r15.zw */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* dp2 r2.x, r15.zw, r15.zw */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x73, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));

        /* add r17.x, r17.x, c(3+maxLevel*4+5).z */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(17, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 17, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, (3+maxLevel*4+5), gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));

        /* mov r2.y, r17.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 17, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

        /* branch.f32 startIteration2, r2.xy, c(3+maxLevel*4+4).xy */
        gcmONERROR(gcoHARDWAREVX_Branch(0x01, (startIteration2-Instructions->count), 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+4), gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* NOP -- (OPT_INS_COUNT[level]-1)==Instructions->count */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x00, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_DisableDestination(&Instructions->binarys[Instructions->count++]));
    }
    }

    /*------------------------------  maxLevel>=3 ------------------------------------*/

    if(maxLevel>=1)
    {
    if(1==maxLevel)
    {
        /* prevPts - load r1.zw, c0, r0.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* assign nextPts */
        if(isUseInitialEstimate)
        {
            /* estimatedPts - load r16.xy, c2, r0.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /* I2F r16.xy, r16.xy  */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x2D, 0, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
        }
        else
        {
            /* I2F r16.xy, r1.zw  */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x2D, 0, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));
        }
    }
    else
    {
        /* mul r1.xy, r1.xy, c(3+maxLevel*4+5).yy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+5), gcdVX_SWIZZLE2(1, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* mul r16.xy, r16.xy, c(3+maxLevel*4+5).yy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+5), gcdVX_SWIZZLE2(1, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* F2I r1.zw, r1.xy   */ /* IN_ROUND */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x2E, 0, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE4(0, 1, 0, 1), 0, &Instructions->binarys[Instructions->count++]));
    }

        /* branchAny.LT r1.zw, c(3+maxLevel*5+6-1).xy, (OPT_INS_COUNT[0]-3) */
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x02, (OPT_INS_COUNT[0]-3)-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6-1), gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* branchAny.GE r1.zw, c(3+maxLevel*5+6-1).zw, (OPT_INS_COUNT[0]-3)  */
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x03, (OPT_INS_COUNT[0]-3)-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6-1), gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));

    /*-------------------------------------- pre_arr x, y ---------------------------------------*/

        /* mov r9, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

        for (row=0; row<winSize; row++)
        {
            CoordOffset.u.y = (gctUINT16)(row - 2); /* (gctUINT16)(row - 1); */

            /* grad_x - img_load.s16 r4-8, c(3+maxLevel*3-1), r1.zw, */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*3-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* grad_y - img_load.s16 r10-14, c(3+maxLevel*4-1), r1.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(10+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*4-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* dp8.f32 r2.x, r4-8, r4-8, c(3+maxLevel*4)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x09, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*4), &Instructions->binarys[Instructions->count++]));

            /* dp8.f32 r2.y, r4-8, r10-14, c(3+maxLevel*4)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x09, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(1, 1, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*4), &Instructions->binarys[Instructions->count++]));

            /* dp8.f32 r2.z, r10-14, r10-14, c(3+maxLevel*4)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x09, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(2, 2, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*4), &Instructions->binarys[Instructions->count++]));

            /* add r9.xyz, r9.xyz, r2.xyz */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE3(0, 1, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE4(0, 1, 2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE4(0, 1, 2, 3), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        }

        /* mul r9.w, r9.y, -r9.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(1), NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));

        /* mad r9.w, r9.x, r9.z, r9.w */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* add r2.x, r9.x, -r9.z */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE1(2), NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));

        /* mul r2.x, r2.x, r2.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* mul r2.y, r9.y, c(3+maxLevel*5+7).z */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+7), gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));

        /* mad r2.x, r2.y, r9.y, r2.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* sqrt r2.x, r2.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x21, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* add r2.x, r9.x, -r2.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));

        /* add r2.x, r9.z, r2.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* branchAny.LT (OPT_INS_COUNT[0]-3), r2.x, c(3+maxLevel*4+4).z */
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x02, (OPT_INS_COUNT[0]-3)-Instructions->count, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+4), gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));

        /* branchAny.LT (OPT_INS_COUNT[0]-3), r9.w, c(3+maxLevel*4+4).w */
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x02, (OPT_INS_COUNT[0]-3)-Instructions->count, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+4), gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count++]));

        /* rcp r9.w r9.w */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x0C, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* --------------------------------------  D ---------------------------------------  */

        row = 0;
        {
            CoordOffset.u.y = (gctUINT16)(row - 2); /* (gctUINT16)(row - 1); */

            /* pre_img - img_load.u8, r2[4:0], c(3+maxLevel-1), r1.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* mul_shift r2[9:0], r2[4:0], c(3+maxLevel*5+6), 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r2[15:12], r2[9:0], r4[9:0], c(3+maxLevel*5+22)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+22), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r11[15:12], r2[9:0], r10[9:0], c(3+maxLevel*5+22)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+22), &Instructions->binarys[Instructions->count++]));
        }

        for(row=1; row<winSize-1; row++)
        {
            CoordOffset.u.y = (gctUINT16)(row - 2); /* (gctUINT16)(row - 1); */

            /* pre_img - img_load.u8, r2[4:0], c(3+maxLevel-1), r1.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* mul_shift r2[9:0], r2[4:0], c(3+maxLevel*5+6), 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r2[12:15], r2[0:9,12:15], r5-7[0:9], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r12-r14[12:15], r11-13[0:9,12:15], r2[0:9], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        row = winSize - 1;
        {
            CoordOffset.u.y = (gctUINT16)(row - 2); /* (gctUINT16)(row - 1); */

            /* pre_img - img_load.u8, r2[4:0], c(3+maxLevel-1), r1.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* mul_shift r2[9:0], r2[4:0], c(3+maxLevel*5+6), 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.f32 r15[3:0], r2[0:9,12:15], r8/6[0:9], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.f32 r15[7:4], r14/12[0:9,12:15], r2[0:9], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(1, 1, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
       }

        /* mul r2.xy, r9.yy, -r15.yx */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE2(1, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE2(1, 0), NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));

        /* mad r15.xy, r9.zx, r15.xy, r2.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE2(2, 0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /*--------------------------------------  deltaXN, deltaYN ---------------------------------------*/

        /* mov r17.x, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(17, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

        startIteration3 = Instructions->count;

        /* F2I r16.zw, r16.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x2E, 0, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE4(0, 1, 0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* branchAny.LT r16.zw, c(3+maxLevel*5+6-1).xy, (OPT_INS_COUNT[0]-3) */
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x02, (OPT_INS_COUNT[0]-3)-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6-1), gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* branchAny.GE r16.zw, c(3+maxLevel*5+6-1).zw, (OPT_INS_COUNT[0]-3) */
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x03, (OPT_INS_COUNT[0]-3)-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6-1), gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));

        /*--------------------------------------  cur_arr x, y ---------------------------------------*/

        CoordOffset.u.y = (gctUINT16)0x1e; /* (gctUINT16)0x1f; */

        /* nextImg - img_load.u8 r2[5:0], c(3+maxLevel*2-1), r16.zw */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*2-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

        /* mul_shift r2[11:0], r2[5:0], c(3+maxLevel*5+6), 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        row = 0;
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* nextImg - img_load.u8 r3/2[5:0], c(3+maxLevel*2-1), r16.zw, */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*2-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* mul_shift r3/2[11:0], r3/2[5:0], c(3+maxLevel*5+6), 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* Bilinear.s16 r2/3[9:0], r2/3[11:0], r3/2[11:0], r16.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0D, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2+row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, (0x6|(0x0<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 16, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r5[12:15], r4[0:9], r2[0:9], c(3+maxLevel*5+22)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+22), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r11[12:15], r10[0:9], r2[0:9], c(3+maxLevel*5+22)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+22), &Instructions->binarys[Instructions->count++]));
        }

        for (row=1; row<winSize-1; row++)
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* nextImg - img_load.u8 r3/2[5:0], c(3+maxLevel*2-1), r16.zw, */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*2-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* mul_shift r3/2[11:0], r3/2[5:0], c(3+maxLevel*5+6), 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* Bilinear.s16 r2/3[9:0], r2/3[11:0], r3/2[11:0], r16.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0D, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2+row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, (0x6|(0x0<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 16, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r6-8[12:15], r5-7[0:9,12:15], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r12-r14[12:15], r11-13[0:9,12:15], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        row = winSize-1;
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* nextImg - img_load.u8 r3/2[5:0], c(3+maxLevel*2-1), r16.zw, */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*2-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* mul_shift r3/2[11:0], r3/2[5:0], c(3+maxLevel*5+6), 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* Bilinear.s16 r2/3[9:0], r2/3[11:0], r3/2[11:0], r16.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0D, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2+row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, (0x6|(0x0<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 16, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.f32 r15[11:8], r8/6[0:9,12:15], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(2, 2, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.f32 r15[15:12], r14/12[0:9,12:15], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        /* mul r2.xy, r9.zx, -r15.zw */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE2(2, 0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE2(2, 3), NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));

        /* mad r15.zw, r9.yy, r15.wz, r2.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE4(1, 1, 1, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE4(3, 2, 3, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE4(0, 1, 0, 1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* add.f32 r15.zw, r15.zw, r15.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE4(2, 3, 2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE4(0, 1, 0, 1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* mul.f32 r15.zw, r15.zw, r9.ww */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE4(2, 3, 2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE4(3, 3, 3, 3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /*-----------------------  delta_x, delta_y ------------------*/

        /* add.f32 r16.xy, r16.xy, r15.zw */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* dp2 r2.x, r15.zw, r15.zw */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x73, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));

        /* add r17.x, r17.x, c(3+maxLevel*4+5).z */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(17, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 17, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, (3+maxLevel*4+5), gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));

        /* mov r2.y, r17.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 17, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

        /* branch.f32 startIteration3, r2.xy, c(3+maxLevel*4+4).xy */
        gcmONERROR(gcoHARDWAREVX_Branch(0x01, (startIteration3-Instructions->count), 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+4), gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /*--------------------------  store ------------------------------*/

        /* F2I r16.zw, r16.xy --(OPT_INS_COUNT[0]-2)==Instructions->count */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x2E, 0, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE4(0, 1, 0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* store c1, r0.xy, r16.zw */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));

        /* mov r17.y, c(3+maxLevel*5+7).w */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(17, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, (3+maxLevel*5+7), gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count++]));

        /* branchAny.EQ, r17.y, c(3+maxLevel*5+7).w, (OPT_INS_COUNT[0]-2) */
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x05, (OPT_INS_COUNT[0]-2)-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 17, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+7), gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count++]));

        /* mov r17.y, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(17, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

        /* add r2.x, r0.x, 20 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 20, &Instructions->binarys[Instructions->count++]));

        /* store c1, r2.x, r17.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(17, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 17, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));
    }

    /*------------------------------  maxLevel>=1 ------------------------------------*/

    Instructions->regs_count = 18;  /* take attention */

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _scaleimage(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gcoVX_Instructions   *Instructions = Context->instructions;

    gctUINT32 Input = Context->input_type[0];
    gctUINT32 Output = Context->output_type[0];
    gctUINT32 end = 0;

    gctUINT32 i = 0;

    gcmHEADER_ARG("Context=0x%x", Context);

    /* matrix         x  y  z  w
     * r1/c8(float) : wr hr 0  0
     *
     * x_src = ((vx_float32)r0.x + 0.5f) * wr - 0.5f;
     * y_src = ((vx_float32)r0.y + 0.5f) * hr - 0.5f;
     */

    /*mov r1, c8 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    /*mov r2, r0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /*mov r2.w, r2.y */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    if (Context->borders == gcvVX_BORDER_MODE_CONSTANT || Context->borders == gcvVX_BORDER_MODE_UNDEFINED)
    {
        /*mov r4, c4 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }

    end = (Input == 0x7) ? 8 : 4;

    for (i = 0; i < end; i++)
    {
        /*add.u32 r2.z, r2.x, 1 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));
        /*conv.s32 r7, r2; u32 -> float*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x2 | (0 << 4), &Instructions->binarys[Instructions->count++]));
        /*add r7, r7, 0.5f */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(2, 0.5f, &Instructions->binarys[Instructions->count++]));
        /*mad r3 r1 r7 -0.5f */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(2, -0.5f, &Instructions->binarys[Instructions->count++]));

        if (Context->policy == gcvVX_INTERPOLATION_TYPE_NEAREST_NEIGHBOR
            || Context->policy == gcvVX_INTERPOLATION_TYPE_AREA)
        {
            /*conv.s32 r3, r3 float -> s32*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x0 | (1 << 4), &Instructions->binarys[Instructions->count++]));
            /*img_load.u32 r4(0), c0, r3.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(i * 2, i * 2, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
            /*img_load.u32 r4(1), c0, r3.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(i * 2 + 1, i * 2 + 1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));
        }
        else if (Context->policy == gcvVX_INTERPOLATION_TYPE_BILINEAR)
        {
            const static RelOffset plusOne = {{0, 1}};
            /*
             * uniform input_descriptor := c0
             * uniform output_descriptor := c1
            */
            /* ======== checking if the pixel on border start ======== */
            /*mov r6, r3 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));
            /*branch r3.x, 0.0, 2 */
            gcmONERROR(gcoHARDWAREVX_Branch(0x03, 2, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(1, 0.0f, &Instructions->binarys[Instructions->count++]));
            /*add r3.x, r3.x, -1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(2, -1.0f, &Instructions->binarys[Instructions->count++]));
            /*branch r3.y, 0.0f, 2 */
            gcmONERROR(gcoHARDWAREVX_Branch(0x03, 2, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(1, 0.0f, &Instructions->binarys[Instructions->count++]));
            /*add r3.y, r3.y, -1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(2, -1.0f, &Instructions->binarys[Instructions->count++]));
            /*branch r3.z, 0.0, 2 */
            gcmONERROR(gcoHARDWAREVX_Branch(0x03, 2, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(1, 0.0f, &Instructions->binarys[Instructions->count++]));
            /*add r3.z, r3.z, -1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(2, -1.0f, &Instructions->binarys[Instructions->count++]));
            /*branch r3.w, 0.0f, 2 */
            gcmONERROR(gcoHARDWAREVX_Branch(0x03, 2, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(1, 0.0f, &Instructions->binarys[Instructions->count++]));
            /*add r3.w, r3.w, -1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(2, -1.0f, &Instructions->binarys[Instructions->count++]));
            /* ======== checking if the pixel on border end ======== */

            /*conv.s32 r3, r3 float -> s32*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestinationExt(3, gcdVX_ENABLE, gcvFALSE, gcvTRUE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x0 | (0 << 4), &Instructions->binarys[Instructions->count++]));
            if (Context->borders == gcvVX_BORDER_MODE_CONSTANT || Context->borders == gcvVX_BORDER_MODE_UNDEFINED)
            {
                /*mov r5, c4 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
            }
            /*img_load.u8 r5[0-1], c0, r3.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
            /*img_load.u8 r5[8-9], c0, r3.xy, +0,1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(8, 9, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusOne.raw, &Instructions->binarys[Instructions->count++]));
            /*bilinear.u8 r4[0], r5.x, r5.z, r6.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0D, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(i * 2, i * 2, 0x7 | (0x0 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

             /*img_load.u8 r5[4-5], c0, r3.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(4, 5, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));
            /*img_load.u8 r5[12-13], c0, r3.zw, +0,1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(12, 13, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusOne.raw, &Instructions->binarys[Instructions->count++]));
            /*bilinear.u8 r4[1], r5.x, r5.z, r6.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0D, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(i * 2 + 1, i * 2 + 1, 0x7 | (0x0 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(4, &Instructions->binarys[Instructions->count++]));
        }
        /*add.u32 r2.x, r2.x, 2 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 2U, &Instructions->binarys[Instructions->count++]));
    }
    /*img_store r4, c1, r0.xy, r4 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, Output, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Output), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 0x8;

OnError:
    gcmFOOTER();
    return status;
}


static gceSTATUS _warpperspective(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gcoVX_Instructions   *Instructions = Context->instructions;
    gctUINT32 i = 0;

    gcmHEADER_ARG("Context=0x%x", Context);

    /* matrix         x  y  z  w
     * r1/c8(float) : m0 m1 m2 0
     * r2/c9(float) : m3 m4 m5 0
     * r3/c10(float): m6 m7 m8 0
     *
     * z    = (r0.x * m[2] + r0.y * m[5] + m[8]);
     *
     * r4.y = (r0.x * m[1] + r0.y * m[4] + m[7]) / z;
     * r4.x = (r0.x * m[0] + r0.y * m[3] + m[6]) / z;
     */

    /*mov r1, c8 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*mov r2, c9 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 9, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*mov r9, c10 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 10, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*mov r8, r0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /*mov r8.w, r8.y */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 8, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    if (Context->borders == gcvVX_BORDER_MODE_CONSTANT || Context->borders == gcvVX_BORDER_MODE_UNDEFINED)
    {
        /*mov r4, c4 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }

    for (i = 0; i < 8; i++)
    {
        /*add.u32 r8.z, r8.x, 1 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));
        /*conv.s32 r7, r8; u32 -> float*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x2 | (0 << 4), &Instructions->binarys[Instructions->count++]));

        /*mad r6 r7.yyww r2.xyxy r9.xyxy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE4(1, 1, 3, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE4(0, 1, 0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE4(0, 1, 0, 1), 0, &Instructions->binarys[Instructions->count++]));
        /*mad r3 r7.xxzz r1.xyxy r6 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE4(0, 0, 2, 2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE4(0, 1, 0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        /*mad r10.zw r7.yw r2.zz r9.zz */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE2(1, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE2(2, 2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE2(2, 2), 0, &Instructions->binarys[Instructions->count++]));
        /*mad r10.xy r7.yw r2.zz r9.zz */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE2(0, 2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 10, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));
        /* r3.xy = r3.xy/r10.x */
        /* r3.zw = r3.zw/r10.y */
        /*rcp r10.x r10.x; Get the reciprocal of r10.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x0C, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 10, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*rcp r10.y r10.y; Get the reciprocal of r10.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x0C, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 10, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mul r3 r3 r10.xxyy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10, gcdVX_SWIZZLE4(0, 0, 1, 1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        if (Context->policy == gcvVX_INTERPOLATION_TYPE_NEAREST_NEIGHBOR
            || Context->policy == gcvVX_INTERPOLATION_TYPE_AREA)
        {
            /*conv.s32 r3, r3 float -> s32*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x0 | (0 << 4), &Instructions->binarys[Instructions->count++]));
            /*img_load.u32 r4(0), c0, r3.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(i * 2, i * 2, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
            /*img_load.u32 r4(1), c0, r3.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(i * 2 + 1, i * 2 + 1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));
        }
        else if (Context->policy == gcvVX_INTERPOLATION_TYPE_BILINEAR)
        {
            const static RelOffset plusOne = {{0, 1}};
            /*
             * uniform input_descriptor := c0
             * uniform output_descriptor := c1
            */
            /*mov r6, r3 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));
            /*branch r3.x, 0.0, 2 */
            gcmONERROR(gcoHARDWAREVX_Branch(0x03, 2, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(1, 0.0f, &Instructions->binarys[Instructions->count++]));
            /*add r3.x, r3.x, -1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(2, -1.0f, &Instructions->binarys[Instructions->count++]));
            /*branch r3.y, 0.0f, 2 */
            gcmONERROR(gcoHARDWAREVX_Branch(0x03, 2, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(1, 0.0f, &Instructions->binarys[Instructions->count++]));
            /*add r3.y, r3.y, -1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(2, -1.0f, &Instructions->binarys[Instructions->count++]));
            /*branch r3.z, 0.0, 2 */
            gcmONERROR(gcoHARDWAREVX_Branch(0x03, 2, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(1, 0.0f, &Instructions->binarys[Instructions->count++]));
            /*add r3.z, r3.z, -1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(2, -1.0f, &Instructions->binarys[Instructions->count++]));
            /*branch r3.w, 0.0f, 2 */
            gcmONERROR(gcoHARDWAREVX_Branch(0x03, 2, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(1, 0.0f, &Instructions->binarys[Instructions->count++]));
            /*add r3.w, r3.w, -1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(2, -1.0f, &Instructions->binarys[Instructions->count++]));
            /* ======== checking if the pixel on border end ======== */
            /*conv.s32 r3, r3 float -> s32*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestinationExt(3, gcdVX_ENABLE, gcvFALSE, gcvTRUE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x0 | (0 << 4), &Instructions->binarys[Instructions->count++]));
            if (Context->borders == gcvVX_BORDER_MODE_CONSTANT || Context->borders == gcvVX_BORDER_MODE_UNDEFINED)
            {
                /*mov r5, c4 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
            }
            /*img_load.u8 r5[0-1], c0, r3.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
            /*img_load.u8 r5[8-9], c0, r3.xy, +0,1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(8, 9, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusOne.raw, &Instructions->binarys[Instructions->count++]));
            /*bilinear.u8 r4[0], r5.x, r5.z, r6.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0D, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(i * 2, i * 2, 0x7 | (0x0 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

             /*img_load.u8 r5[4-5], c0, r3.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(4, 5, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));
            /*img_load.u8 r5[12-13], c0, r3.zw, +0,1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(12, 13, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusOne.raw, &Instructions->binarys[Instructions->count++]));
            /*bilinear.u8 r4[1], r5.x, r5.z, r6.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0D, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(i * 2 + 1, i * 2 + 1, 0x7 | (0x0 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(4, &Instructions->binarys[Instructions->count++]));
        }
        /*add.u32 r8.x, r8.x, 2 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 2U, &Instructions->binarys[Instructions->count++]));
    }
    /*img_store r4, c1, r0.xy, r4 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 0xb;
OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _warpaffine(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gcoVX_Instructions   *Instructions = Context->instructions;
    gctUINT32 i = 0;

    gcmHEADER_ARG("Context=0x%x", Context);

    /* matrix
     * r1/c8(float): m0 m1 m2 m3
     * r2/c9(float): m4 m5 m6 m7
     *
     * r5.x(float)/src_x = r0.x * m[0] + r0.y * m[2] + m[4];
     * r5.y(float)/src_y = r0.x * m[1] + r0.y * m[3] + m[5];
     */

    /*mov r1, c8 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*mov r2, c9 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 9, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    /*mov r8, r0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /*mov r8.w, r8.y */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 8, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    if (Context->borders == gcvVX_BORDER_MODE_CONSTANT || Context->borders == gcvVX_BORDER_MODE_UNDEFINED)
    {
        /*mov r4, c4 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }

    for (i = 0; i < 8; i++)
    {
        /*add.u32 r8.z, r8.x, 1 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));
        /*conv.s32 r7, r8; u32 -> float*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x2 | (1 << 4), &Instructions->binarys[Instructions->count++]));

        /*mad r6 r7.yyww r1.zwzw r2.xyxy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE4(1, 1, 3, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE4(2, 3, 2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE4(0, 1, 0, 1), 0, &Instructions->binarys[Instructions->count++]));
        /*mad r3 r7.xxzz r1.xyxy r6 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE4(0, 0, 2, 2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE4(0, 1, 0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        if (Context->policy == gcvVX_INTERPOLATION_TYPE_NEAREST_NEIGHBOR
            || Context->policy == gcvVX_INTERPOLATION_TYPE_AREA)
        {
            /*conv.s32 r3, r3 float -> s32*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x0 | (0 << 4), &Instructions->binarys[Instructions->count++]));
            /*img_load.u32 r4(0), c0, r3.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(i * 2, i * 2, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
            /*img_load.u32 r4(1), c0, r3.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(i * 2 + 1, i * 2 + 1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));
        }
        else if (Context->policy == gcvVX_INTERPOLATION_TYPE_BILINEAR)
        {
            const static RelOffset plusOne = {{0, 1}};
            /*
             * uniform input_descriptor := c0
             * uniform output_descriptor := c1
            */
            /*mov r6, r3 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));
            /*conv.s32 r3, r3 float -> s32*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestinationExt(3, gcdVX_ENABLE, gcvFALSE, gcvTRUE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x0 | (0 << 4), &Instructions->binarys[Instructions->count++]));
            if (Context->borders == gcvVX_BORDER_MODE_CONSTANT || Context->borders == gcvVX_BORDER_MODE_UNDEFINED)
            {
                /*mov r5, c4 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
            }
            /*img_load.u8 r5[0-1], c0, r3.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
            /*img_load.u8 r5[8-9], c0, r3.xy, +0,1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(8, 9, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusOne.raw, &Instructions->binarys[Instructions->count++]));
            /*bilinear.u8 r4[0], r5.x, r5.z, r6.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0D, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(i * 2, i * 2, 0x7 | (0x0 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

             /*img_load.u8 r5[4-5], c0, r3.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(4, 5, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));
            /*img_load.u8 r5[12-13], c0, r3.zw, +0,1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(12, 13, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusOne.raw, &Instructions->binarys[Instructions->count++]));
            /*bilinear.u8 r4[1], r5.x, r5.z, r6.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0D, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(i * 2 + 1, i * 2 + 1, 0x7 | (0x0 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(4, &Instructions->binarys[Instructions->count++]));
        }
        /*add.u32 r8.x, r8.x, 2 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 2U, &Instructions->binarys[Instructions->count++]));
    }
    /*img_store r4, c1, r0.xy, r4 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 0x9;
OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _accumulateweighted(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gcoVX_Instructions *Instructions = Context->instructions;
    gctFLOAT alpha = (gctFLOAT)Context->policy / 1000;

    gcmHEADER_ARG("Instructions=0x%x", Instructions);
    /*img_load.u8 r1, c0, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[0]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

    /*img_load.s16 r2, c1, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x4, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

    /*lerp.u8[7-0] r2, r1, r2, m_Alpha */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 0x7 | (0x7 << 3) | (1 << 6), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(2, alpha, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*img_store.s16 r2, c1, r0.xy, r2 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x4, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 0x3;

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _multiply(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gctBOOL Saturate = Context->policy;
    gctFLOAT Shift = Context->scale;
    gctUINT32 isScale0 = Context->volume;
    gctUINT32 Rounding = Context->rounding;
    gctUINT32 Input1 = Context->input_type[0];
    gctUINT32 Input2 = Context->input_type[1];
    gctUINT32 Output = Context->output_type[0];
    gcoVX_Instructions *Instructions = Context->instructions;
    gctFLOAT ShiftR = floorf(Shift);
    gctUINT32 intPart = Context->clamp;
    gctUINT32 i = 0;

    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    if (Shift == 0 && isScale0 == 1)
    {
        /*mov r1, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0U, &Instructions->binarys[Instructions->count++]));
        /*img_store.u8, r1, c2, r0.xy, r1[0-7] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, Output, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, Context->xstep - 1, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        Instructions->regs_count = 0x2;
    }
    else if (isScale0 == 2)
    {
        /*img_load.u8 r1, c0, r0.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input1), 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /*img_load.u8 r2, c1, r0.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input2), 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

        if (Shift == 0)
        {
            /*mov r3, 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0U, &Instructions->binarys[Instructions->count++]));
        }
        /* check if the scale is the integer power of 2 */
        else if((Shift - ShiftR) == 0)
        {
            /*mul_shift.u8, r3, r1.u8, r2.u8, shift */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, Saturate, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (Input1 | (Input2 << 3) | Rounding), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, (gctINT32)Shift, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
        }
        else
        {
            /*mul_shift.u8, r3, r1.u8, r2.u8, 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (Input1 | (Input2 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            /*conv.s32 r3, r3 : S16 -> float32 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, (0x2 | (0 << 4)), &Instructions->binarys[Instructions->count++]));
            /*mul r3, r3, c3(shift) */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, 3, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));
            /*conv.s32 r3, r3 : float32 -> s32*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, Saturate, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, (0x0 | (Rounding << 4)), &Instructions->binarys[Instructions->count++]));
        }
        /*mul_shift.u8, r1, r1.u8, r2.u8, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, Saturate, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (Input1 | (Input2 << 3) | Rounding), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
        if (intPart != 1)
        {
            for (i = 0; i < 4; i++)
            {
                /*mul r1, r1, intPart*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x2, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, intPart, &Instructions->binarys[Instructions->count++]));
            }
        }
        /*add.s32 r1, r1, r3*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

        /*conv.s32 r1, r1 : s32 -> output*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, Output, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, Saturate, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, (0x2 | (Rounding << 4)), &Instructions->binarys[Instructions->count++]));

        if (Output == 0x3)
        {
            /*bitextract.u32 r3[0-3], r1, 0, c4;  c4 = [0, 32, 64, 96, 0, 0, 0, 0, 8, 8, 8, 8] */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x5 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
        }
        else
        {
            /*bitextract.u32 r3[0-3], r1, 0, c4;  c4 = [0, 32, 64, 96, 0, 0, 0, 0, 8, 8, 8, 8] */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x5 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
        }

        /*img_store.u8, r3, c2, r0.xy, r1[0-3] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, Output, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

        Instructions->regs_count = 4;
    }
    else
    {
    /*img_load.u8 r1, c0, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input1), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

    /*img_load.u8 r2, c1, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input2), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

    /* check if the scale is the integer power of 2 */
    if((Shift - ShiftR) != 0)
    {
        if(
            Input1 == 0x3
            && Input2 == 0x3
            && Output == 0x3
            && Saturate == gcvFALSE)
        {
            /*mul_shift, r1, r1.u8, 1, 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x3 | (0x3 << 3)/* | Rounding*/), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, (1 | (1 << 16)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*mul_shift, r2, r2.u8, 1, 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x3 | (0x3 << 3)/* | Rounding*/), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, (1 | (1 << 16)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*conv.s32 r1, r1 : S16 -> float32 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, (0x2 | (0 << 4)), &Instructions->binarys[Instructions->count++]));

            /*conv.s32 r2, r2 : S16 -> float32 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, (0x2 | (0 << 4)), &Instructions->binarys[Instructions->count++]));

            /*mov r3, shift*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(2, Shift, &Instructions->binarys[Instructions->count++]));

            /*add r3, r3, 1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0x82, &Instructions->binarys[Instructions->count++]));

            /*mul r1, r1, r3*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

            /*mul r1, r1, r2*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

        }
        else
        {
            /*mul_shift.u32, r1, r1.u8, r2.u8, 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (Input1 | (Input2 << 3) | Rounding), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*conv.s32 r1, r1 : u32 -> float32 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, (0x2 | (0 << 4)), &Instructions->binarys[Instructions->count++]));

            /*mul r1, r1, shift 0.00392156887f*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(1, Shift, &Instructions->binarys[Instructions->count++]));

            /*add r1, r1, 1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0x100, &Instructions->binarys[Instructions->count++]));
        }

        /*conv.s32 r1, r1 : float32 -> s32*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, (0x0 | (0 << 4)), &Instructions->binarys[Instructions->count++]));

        /*conv.s32 r1, r1 : s32 -> output*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, Output, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, Saturate, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, (0x2 | (0 << 4)), &Instructions->binarys[Instructions->count++]));

        /*lshift r2.xy, r1.yw, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE2(1, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 16, &Instructions->binarys[Instructions->count++]));

        /*add r1.xy, r2.xy, r1.xz */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE2(0, 2), 0, &Instructions->binarys[Instructions->count++]));

        if(Output == 0x7 || Output == 0x4)
        {
            /*mul_shift.u8, r1, r1.u8, 1, 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x6 | (0x6 << 3)/* | Rounding*/), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, (1 | (1 << 16)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
        }

        /*img_store.u8, r1, c2, r0.xy, r1[0-7] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, Output, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, Context->xstep - 1, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }
    else
    {

        /*mul_shift.u8, r1, r1.u8, r2.u8, shift */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, Output, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, Saturate, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (Input1 | (Input2 << 3) | Rounding), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, (gctINT32)Shift, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        /*img_store.u8, r1, c2, r0.xy, r1[0-7] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, Output, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, Context->xstep - 1, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    }

    Instructions->regs_count = 0x4;
    }

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _accumulatesquare(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gctUINT32 Shift = Context->policy;
    gcoVX_Instructions *Instructions = Context->instructions;

    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    /*img_load.u8 r1, c0, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[0]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[0]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[0]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[0]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[0]));
    Instructions->count++;

    /*img_load.s16 r2, c1, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[1]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[1]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[1]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[1]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[1]));
    Instructions->count++;

    /*iacc_sq.s16 r2, r2, r1, _shiftValue */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x03, 0x3, &Instructions->binarys[2]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvTRUE, &Instructions->binarys[2]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 0x7, &Instructions->binarys[2]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[2]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[2]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, Shift, &Instructions->binarys[2]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[2]));
    Instructions->count++;

    /*img_store.s16 r2, c1, r0.xy, r2 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x3, &Instructions->binarys[3]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[3]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[3]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[3]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[3]));
    Instructions->count++;

    Instructions->regs_count = 0x3;

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _threshold(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    /*gctBOOL Binary = Context->policy;*/
    gcoVX_Instructions *Instructions = Context->instructions;

    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    /*img_load.u8 r1, c0, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    Instructions->count++;

    /*clamp.u8 r1, r1, c2.x, c2.y */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0C, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, (0x7 | (1 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count]));
    Instructions->count++;

    /*mov r4, c3 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*cmp r2, r1, r4, c5;*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x05, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 5, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*mov r5, c4 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*cmp r3, r1, r5, c6;*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x05, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 6, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /* add r1, r2, r3 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*img_store, c1, r0.xy, r1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    Instructions->count++;

    Instructions->regs_count = 0x6;

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _magphase(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gctUINT32 Kernel = Context->kernel;
    gcoVX_Instructions *Instructions = Context->instructions;
    gctUINT32 out_type = 0x7;
    gctUINT32 dst = 0, dst_f = 0, dst_f1 = 0, src = 0, src_f = 0, src_f1 = 0;
    gctUINT32 i = 0;
    gctBOOL f16 = gcvFALSE;

    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    if(Context->policy == VX_DF_IMAGE('F','0','1','6'))
        f16 = gcvTRUE;

    switch(Kernel)
    {
    case gcvVX_KERNEL_PHASE:
        dst     = 4;
        dst_f   = 0;
        src     = 3;
        src_f   = 1;
        out_type = 0x7;
        break;
    case gcvVX_KERNEL_MAGNITUDE:
        dst     = 3;
        src     = 4;
        src_f   = 0;
        dst_f   = 2;
        src_f1  = 1;
        dst_f1  = 3;
        out_type = 0x3;
        break;
    default:
        break;
    }

    /*img_load.u8 r1, c0, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

    /*img_load.u8 r2, c1, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

    if (Kernel == gcvVX_KERNEL_MAGNITUDE && f16)
    {
        /*dp4.fp16 r3, r1, r2, c4   squre r3 = r1*r1 + r2*r2 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0A, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x1 | 0x1 << 3), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4, &Instructions->binarys[Instructions->count++]));
        /*dp4.fp16 r4, r1, r2, c4   squre r4 = r1*r1 + r2*r2(4-7) */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0A, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x1 | 0x1 << 3), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 8, &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 4; i++)
        {
            /* sqrt r3.x, r3.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x21, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
            /* sqrt r4.x, r4.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x21, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        }
        /* add r3, r3, 0.5f */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(2, 0.5f, &Instructions->binarys[Instructions->count++]));
        /* add r4, r4, 0.5f */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(2, 0.5f, &Instructions->binarys[Instructions->count++]));
        /*conv.s32 r3, r3; float32 -> s16*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x0 | (1 << 4), &Instructions->binarys[Instructions->count++]));
        /*conv.s32 r4, r4; float32 -> s16*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x0 | (1 << 4), &Instructions->binarys[Instructions->count++]));
        /*bitextract.u8 r2, r3, 0, c3;  c3 = [0, 32, 64, 96, 0, 0, 0, 0, 8, 8, 8, 8] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x6 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
        /*bitextract.u8 r1, r4, 0, c3;  c3 = [0, 32, 64, 96, 0, 0, 0, 0, 8, 8, 8, 8] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x6 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        /*mov r2.z, r1.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mov r2.w, r1.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /*img_store.u8 r2, c2, r0.xy, r3*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }
    else
    {
        if (Kernel == gcvVX_KERNEL_PHASE && f16)
        {
            /*dp2x8.u8 r1, r1, r1, c3_512  r1: f16 -> s16 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0B, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x1 | (0x1 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, 3, &Instructions->binarys[Instructions->count++]));
            /*dp2x8.u8 r2, r2, r2, c3_512  r2: f16 -> s16 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0B, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x1 | (0x1 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, 3, &Instructions->binarys[Instructions->count++]));
        }

        /*magPhase.s16 r3[0-3], r1[0-3], r2[0-3] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x06, out_type, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 0x3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        /*magPhase.s16 r4[0-3], r1[4-7], r2[4-7] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x06, out_type, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 0x3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(4, &Instructions->binarys[Instructions->count++]));

        if(Kernel == gcvVX_KERNEL_PHASE)
        {
            /*
            *     |    x     | |    y     | |    z     | |    w     |
            * r3: |magnitude0| |  phase0  | |    0     | |    0     |
            *     |    x     | |    y     | |    z     | |    w     |
            * r4: |magnitude1| |  phase1  | |    0     | |    0     |
            * for phase     : r3.y -> r4.x  r4->c2
            */

            /*mov r4.x, r3.y(phase)/mov r3.y, r4.x(magnitude) */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(dst, gcdVX_ENABLE1(dst_f), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, src, gcdVX_SWIZZLE1(src_f), 0, &Instructions->binarys[Instructions->count++]));

            /*img_store.s16 c2, r0.xy, r4[0-7](phase)/img_store.s16 c2, r0.xy, r3[0-7](magnitude) */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, dst, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        }
        else
        {
            /*
            *     |    x     | |    y     | |    z     | |    w     |
            * r3: |magnitude0| |magnitude1| |  phase0  | |  phase1  |
            *     |    x     | |    y     | |    z     | |    w     |
            * r4: |magnitude2| |magnitude3| |  phase2  | |  phase3  |
            * for magnitude : r4.x -> r3.z, r4.y->r3.w  r3->c2
            */
            /*mov r3.z, r4.x(magnitude) */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(dst, gcdVX_ENABLE1(dst_f), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, src, gcdVX_SWIZZLE1(src_f), 0, &Instructions->binarys[Instructions->count++]));

            /*mov r3.w, r4.y(magnitude) */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(dst, gcdVX_ENABLE1(dst_f1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, src, gcdVX_SWIZZLE1(src_f1), 0, &Instructions->binarys[Instructions->count++]));

            /*img_store.s16 c2, r0.xy, r4(phase)/img_store.s16 c2, r0.xy, r3(magnitude) */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, dst, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        }
    }
    Instructions->regs_count = 0x5;

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _convolution8x(
    IN gctUINT32                        Border,
    IN gctINT16                         *Matrix,
    IN gctINT32                         Col,
    IN gctINT32                         Row,
    IN gctUINT32                        Output,
    IN gctUINT32                        Scale,
    IN gctUINT32                        Clamp,
    IN gctUINT32                        Xstep,
    IN OUT gcoVX_Instructions           *Instructions,
    OUT gcoVX_Kernel_Context_Uniform    *Uinform,
    OUT gctUINT32                       *Num
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gctINT32 i = 0, j = 0, p = 0;
    gctUINT32 index = *Num;
    RelOffset offset_index = {{0}};
    gctINT32 max = Col * Row - 1;

    gctUINT32 src0 = 1, src1 = 2, dst = 3;
    gctUINT32 start = 2, end = 3;           /*dest start and dest end*/
    gctINT32 offset0 = 0;                   /* the offset of src0 and the length of src0*/
    gctINT32 offset = 0;
    gctUINT32 count = (gctUINT32)ceil((max - 10)/7.0f) + 1;
    gctINT32 items = ((Row / 2 + 2 + Col) > 8) ? 1 : 2;

    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    if(Row == 5 && Col == 5)items = 2;

    if(max < 10) count = 1;
    *Num += count * items + 1;

    Instructions->count = 0;

    offset_index.u.x = -(gctINT16)(Col/2);
    offset_index.u.y =  -(gctINT16)(Row/2);

    for(i = 0; i < Row; i ++)
    {
        if(Border == gcvVX_BORDER_MODE_CONSTANT || Border == gcvVX_BORDER_MODE_UNDEFINED)
        {
            /*mov r1, c3 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(i + 1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        }


        /*img_load.u8 r(i+1), c0, r0.xy, @-Col,+y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(i + 1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset_index.raw, &Instructions->binarys[Instructions->count++]));

        offset_index.u.y ++;
    }

    for(i = 0; i < items; i++)
    {
        gctUINT32 k = 0;

        src0 = 1;
        src1 = 2;
        dst = Row + 1;
        start = 2;
        end = start + 1;    /*dest start and dest end*/
        offset0 = 0;        /* the offset of src0 and the length of src0*/
        offset = 0;

        for(k = 0; k < count; k++)
        {
            gcVXConfig config = {{0}};
            gctINT32 length0 = Col - offset0;
            gctINT32 length = (k > 0)?7:8;      /*valid length*/

            for(p = 0; p < 16; p++)
                   config.termconfig[p] = VX_ADD;

            /*non-first line, just use 15 bit*/
            if(k != 0)
                config.termconfig[7] = config.termconfig[15] = VX_ACCUMULATOR;

            for(p = 0; p < 16; p++)
            {
                config.matrix[p]   = (p%8 < 2 * Col) ? ((max - offset - p%8 >= 0)?Matrix[max - offset - p%8]:0) : 0;
                config.aselect[p]  = (p%8 < length0) ? 0 : ((p%8 < 2 * Col)?1:0);
            }


            for(p = 0; p < 8; p++)
            {
                config.abin0[p]    = (p < length0) ? (offset0 + p) : ((p < 2 * Col)?((Col < 4)?(p - Col):(p - length0)):0);
                config.abin1[p]    = config.abin0[p];
            }

            if(k > 0)
            {
                config.matrix[7] = config.matrix[15] = 0;
                config.aselect[7] = config.aselect[15] = 0;

                config.abin0[7] = 2;
                config.abin1[7] = 3;
            }

            if(k < (count -1))
            {
                if((length - length0) >= Col)
                    dst = src1 + 1;
                else
                    dst = src1;
            }
            else
            {
                dst = Row + 1;
                start = 2 * i;
                end = start + 1;
            }

            _SetUniformItem(&index, 2*i, 2*i, 2*i + 1, 2*i + 1, 0, gcvTRUE, &config, 0x5, &Uinform[index]);

            /*dp8.u16 r2[6-7], r1, r2, c4_512 :selection for first dp8 pixels 0-1*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x09, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(dst, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(start, end, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, src0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, src1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++index), &Instructions->binarys[Instructions->count++]));

            if((length - length0) >= Col)
            {
                src0 = src1 + 1;
                src1 = src0 + 1;
            }
            else
            {
                src0 = src1;
                src1 = src0 + 1;
            }

            /* prepare next offset and length*/
            offset0 = ((7 - length0) > Col) ? 0 : ((7 - length0)%Col);
            offset += (2 * Col < 7) ? (2 * Col) : 7;

            if(k == 0 && (Col > 4))
            {
                offset ++;
                offset0 ++;
            }
        }
    }

    for(j = 0; j < 1; j++)
    {
        gcVXConfig config = {{0}};

        for(p = 0; p < 16; p++)
              config.termconfig[p] = VX_ADD;

        config.termconfig[3] = config.termconfig[7] = config.termconfig[11] = config.termconfig[15] = VX_ACCUMULATOR;

        for(p = 0; p < 16; p++)
        {
            config.matrix[p]   = (p%4 < Col) ? ((max - offset - p%4 >= 0)?Matrix[max - offset - p%4]:0) : 0;
            config.aselect[p]  = ((p + 1)%4 == 0)?1:0;
        }

        for(p = 0; p < 8; p++)
        {
            config.abin0[p]    = ((p + 1) % 4 == 0)?(p/4):(offset0 + p%4);
            config.abin1[p]    = ((p + 1) % 4 == 0)?(p/4 + 2):(offset0 + p%4);
        }

        _SetUniformItem(&index, 4*j + 0, 4*j + 1, 4*j + 2, 4*j + 3, Scale, gcvTRUE, &config, 0x2, &Uinform[index]);

        /*dp4.u8 r7[0-3], r6, r5, c28_512 :selection for last dp4 pixels 0-3 + r5[6,7];r4[6,7]*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0A, Output, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(Row + 2, gcdVX_ENABLE, Clamp, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(4*j, 4*j + 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, Row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, Row + 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++index), &Instructions->binarys[Instructions->count++]));
    }

    /*img_store.u8, r7[0-7], c1, r0.xy, r7*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, Output, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, Xstep - 1, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, Row + 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = Row + 3;

OnError:

    gcmFOOTER();
    return status;
}

static gceSTATUS _convolution16x(
    IN gctUINT32                        Border,
    IN gctINT16                         *Matrix,
    IN gctINT32                         Col,
    IN gctINT32                         Row,
    IN gctUINT32                        Output,
    IN gctUINT32                        Scale,
    IN gctUINT32                        Xstep,
    IN OUT gcoVX_Instructions           *Instructions,
    OUT gcoVX_Kernel_Context_Uniform    *Uinform,
    OUT gctUINT32                       *Num
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gctINT32 i = 0, p = 0;
    gctUINT32 index = *Num;
    RelOffset offset_index = {{0}};
    gctINT32 max = Col * Row - 1;

    gctUINT32 src0 = 1, src1 = 2, dst = 3;
    gctUINT32 start = 2, end = 3;           /*dest start and dest end*/
    gctINT32 offset0 = 0;                   /* the offset of src0 and the length of src0*/
    gctINT32 offset = 0;
    gctUINT32 count = (Row/3) * 2;
    gctINT32 items = 4;

    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    *Num += count * items;

    Instructions->count = 0;

    offset_index.u.x = -(gctINT16)(Col/2);
    offset_index.u.y =  -(gctINT16)(Row/2);

    for(i = 0; i < Row; i ++)
    {
        if(Border == gcvVX_BORDER_MODE_CONSTANT || Border == gcvVX_BORDER_MODE_UNDEFINED)
        {
            /*mov r1, c3 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(i + 1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        }

        /*img_load.u8 r(i+1), c0, r0.xy, @-Col,+y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(i + 1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset_index.raw, &Instructions->binarys[Instructions->count++]));

        offset_index.u.y ++;
    }

    for(i = 0; i < items; i++)
    {
        gctUINT32 k = 0;

        src0 = 1;
        src1 = 2;
        dst = Row + 1;
        start = 3;
        end = start;        /*dest start and dest end*/
        offset0 = 0;        /* the offset of src0 and the length of src0*/
        offset = 0;

        for(k = 0; k < count; k++)
        {
            gcVXConfig config = {{0}};
            gctINT32 length0 = Col - offset0;
            gctINT32 length = (k > 0)?15:16;      /*valid length*/
            gctUINT32 output = 0x2;
            gctUINT32 shift = 0;
            gctBOOL   clamp = gcvFALSE;
            gctUINT32 rounding = 0;

            for(p = 0; p < 16; p++)
                   config.termconfig[p] = VX_ADD;

            /*non-first line, just use 15 bit*/
            if(k > 0)
                config.termconfig[15] = VX_ACCUMULATOR;

            for(p = 0; p < 16; p++)
            {
                config.matrix[p]   = ((max - offset - p) >= 0) ? ((p > (length0 + Col - 1))?0:Matrix[max - offset - p]) : 0;
                config.aselect[p]  = (p < length0) ? 0 : ((p > length0 + Col - 1)?0:1);
            }

            for(p = 0; p < 8; p++)
            {
                config.abin0[p]    = (p < length0) ? (offset0 + p) : ((p > length0 + Col - 1)?0:(p - length0));
                config.abin1[p]    = ((p + 8) < length0) ? (offset0 + (p + 8)) : (((p + 8) > length0 + Col - 1)?0:((p + 8) - length0));
            }

            if(k > 0)
            {
                config.matrix[15] = 0;
                config.aselect[15] = 0;

                config.abin1[7] = 3;
            }

            if(k < (count -1))
            {
                if((length - length0) >= Col)
                    dst = src1 + 1;
                else
                    dst = src1;
            }
            else
            {
                output = Output;
                shift = Scale;
                clamp = gcvTRUE;
                dst = Row + 1;
                start = i;
                end = start;
            }

            _SetUniformItem(&index, i, i, i, i, shift, gcvTRUE, &config, 0x5, &Uinform[index]);

            /*dp8.u16 r2[6-7], r1, r2, c4_512 :selection for first dp8 pixels 0-1*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(dst, gcdVX_ENABLE, clamp, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(start, end, (0x7 | (0x7 << 3) | (rounding << 6)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, src0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, src1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++index), &Instructions->binarys[Instructions->count++]));

            if((length - length0) >= Col)
            {
                src0 = src1 + 1;
                src1 = src0 + 1;
            }
            else
            {
                src0 = src1;
                src1 = src0 + 1;
            }

            /* prepare next offset and length*/
            offset0 = ((length - length0) > Col) ? 0 : ((length - length0)%Col);
            offset += length0 + ((offset0 > 0)?offset0:Col);
        }
    }

    /*img_store.u8, r7[0-7], c1, r0.xy, r7*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, Output, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, Xstep - 1, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, Row + 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = Row + 3;

OnError:

    gcmFOOTER();
    return status;
}


static gceSTATUS _convolution(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;

    gcmHEADER_ARG("Context=0x%x", Context);

    if(Context->col > 8)
    {
        gcmONERROR(_convolution16x(Context->borders, Context->matrix, Context->col,
            Context->row, Context->output_type[0], (gctUINT32)Context->scale, Context->xstep,
            Context->instructions, Context->uniform, Context->unifor_num));
    }
    else
    {
        gcmONERROR(_convolution8x(Context->borders, Context->matrix, Context->col,
            Context->row, Context->output_type[0], (gctUINT32)Context->scale, Context->clamp, Context->xstep,
            Context->instructions, Context->uniform, Context->unifor_num));
    }

OnError:

    gcmFOOTER();
    return status;
}

static gceSTATUS _channelcombine(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gctUINT32 Output = Context->output_type[0];
    gceSURF_FORMAT format = Context->outputFormat;
    gcoVX_Instructions *Instructions = Context->instructions;

    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    switch (format)
    {
    case gcvSURF_R8G8B8:
        /*img_load.u8 r1, c0, r0.xy*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*bitextract.u32 r2, r1.x, c4, 8;  c4 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /* lshift r2.y, r2.y, shift */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, Output, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 24, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /* lshift r2.z, r2.z, shift */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, Output, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 16, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /* lshift r2.w, r2.w, shift */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, Output, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /*img_load.u8 r1, c1, r0.xy*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*bitextract.u32 r3, r1.x, c4, 8;  c4 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /* lshift r3.x, r3.x, shift */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, Output, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /* lshift r3.x, r3.z, shift */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, Output, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 24, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /* lshift r3.x, r3.w, shift */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, Output, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 16, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /*img_load.u8 r1, c2, r0.xy*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*bitextract.u32 r4, r1.x, c4, 8;  c4 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /* lshift r4.x, r4.x, shift */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, Output, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 16, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /* lshift r4.y, r4.y, shift */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, Output, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /* lshift r4.w, r4.w, shift */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, Output, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 24, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /*or.u32 r5.x, r2.x, r3.x*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*or.u32 r5.x, r5.x, r4.x*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*or.u32 r5.x, r5.x, r2.y*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /*or.u32 r5.y, r3.y, r4.y*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*or.u32 r5.y, r5.y, r2.z*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*or.u32 r5.y, r5.y, r3.z*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /*or.u32 r5.z, r4.z, r2.w*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*or.u32 r5.z, r5.z, r3.w*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*or.u32 r5.z, r5.z, r4.w*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /*img_store.32 r5, c3, r0.xy, r5*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        Instructions->regs_count = 0x6;
        break;

    case gcvSURF_X8R8G8B8:
        /*img_load.u8 r1, c0, r0.xy*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*bitextract.u32 r2, r1.x, c5, 8;  c5 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count]));
        Instructions->count++;


        /*img_load.u8 r1, c1, r0.xy*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*bitextract.u32 r3, r1.x, c5, 8;  c5 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /* lshift r3, r3, shift */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, Output, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /*img_load.u8 r1, c2, r0.xy*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*bitextract.u32 r4, r1.x, c5, 8;  c5 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /* lshift r4, r4, shift */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, Output, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 16, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /*img_load.u8 r1, c3, r0.xy*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*bitextract.u32 r5, r1.x, c5, 8;  c5 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /* lshift r5, r5, shift */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, Output, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 24, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /*or.u32 r5, r5, r2*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*or.u32 r5, r5, r3*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*or.u32 r5, r5, r4*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /*img_store.u32 r5, c4, r0.xy, r5*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        /* gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count])); */
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        Instructions->regs_count = 0x6;
        break;
    case gcvSURF_YUY2:
        /*mov r7, r0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /* rshift r7.x, r7.x, 1 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*img_load.u8 r1, c0, r0.xy*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*bitextract.u32 r2, r1.x, c4, 8;  c4 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /* lshift r2.y, r2.y, shift */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 16, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /* lshift r2.w, r2.w, shift */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 16, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*bitextract.u32 r6, r1.y, c4, 8;  c4 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /* lshift r6.y, r6.y, shift */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 16, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /* lshift r6.w, r6.w, shift */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 16, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /*img_load.u8 r1, c1, r7.xy*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 7, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*bitextract.u32 r3, r1.x, c4, 8;  c4 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /* lshift r3, r3, shift */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /*img_load.u8 r1, c2, r7.xy*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 7, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*bitextract.u32 r4, r1.x, c4, 8;  c4 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /* lshift r4, r4, shift */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 24, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /*or.u32 r5.xy, r2.xz, r2.yw*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE2(0,1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE2(0,2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE2(1,3), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*or.u32 r5.z, r6.x, r6.y*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*or.u32 r5.w, r6.z, r6.w*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*or.u32 r5, r5, r3*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*or.u32 r5, r5, r4*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*img_store.32 r5, c3, r0.xy, r5*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        Instructions->regs_count = 0x8;
        break;

        case gcvSURF_UYVY:
        /*mov r7, r0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /* rshift r7.x, r7.x, 1 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*img_load.u8 r1, c0, r0.xy*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*bitextract.u32 r2, r1.x, c4, 8;  c4 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /* lshift r2.x, r2.x, shift */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /* lshift r2.z, r2.z, shift */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /* lshift r2.y, r2.y, shift */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 24, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /* lshift r2.w, r2.w, shift */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 24, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*bitextract.u32 r6, r1.y, c4, 8;  c4 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /* lshift r6.x, r6.x, shift */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /* lshift r6.z, r6.z, shift */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /* lshift r6.y, r6.y, shift */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 24, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /* lshift r6.w, r6.w, shift */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 24, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /*img_load.u8 r1, c1, r7.xy*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 7, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*bitextract.u32 r3, r1.x, c4, 8;  c4 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /*img_load.u8 r1, c2, r7.xy*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 7, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*bitextract.u32 r4, r1.x, c4, 8;  c4 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /* lshift r4, r4, shift */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 16, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /*or.u32 r5.xy, r2.xz, r2.yw*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE2(0,1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE2(0,2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE2(1,3), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*or.u32 r5.z, r6.x, r6.y*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*or.u32 r5.w, r6.z, r6.w*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*or.u32 r5, r5, r3*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*or.u32 r5, r5, r4*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*img_store.32 r5, c3, r0.xy, r5*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        Instructions->regs_count = 0x8;
        break;
    case gcvSURF_I420:
        /*img_load.u8 r1, c0, r0.xy*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*img_store.u8 r1, c3, r0.xy, r1*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*img_load.u8 r2, c1, r0.xy*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*img_store.u8 r2, c4, r0.xy, r2*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*img_load.u8 r2, c2, r0.xy*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*img_store.u8 r2, c5, r0.xy, r2*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        Instructions->regs_count = 0x3;
        break;
    case gcvSURF_AYUV:
        /*img_load.u8 r1, c0, r0.xy*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*img_store.u8 r1, c3, r0.xy, r1*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*img_load.u8 r2, c1, r0.xy*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*img_store.u8 r2, c4, r0.xy, r2*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*img_load.u8 r3, c2, r0.xy*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*img_store.u8 r3, c5, r0.xy, r3*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        Instructions->regs_count = 0x4;
        break;

    case gcvSURF_NV12:
        /*img_load.u8 r1, c0, r0.xy*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*img_store.u8 r1, c3, r0.xy, r1*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*img_load.u8 r1, c1, r0.xy*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*bitextract.u32 r2, r1.x, c5, 8;  c5 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*bitextract.u32 r3, r1.y, c5, 8;  c5 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*mov r4.xy, r2.xz */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE2(0,1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE2(0,2), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*mov r4.z, r3.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*mov r4.w, r3.z */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*mov r5.xy, r2.yw */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE2(0,1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE2(1,3), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*mov r5.z, r3.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*mov r5.w, r3.w */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /* lshift r5, r5, shift */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 16, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /*img_load.u8 r1, c2, r0.xy*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*bitextract.u32 r2, r1.x, c5, 8;  c5 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*bitextract.u32 r3, r1.y, c5, 8;  c5 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*mov r6.xy, r2.xz */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE2(0,1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE2(0,2), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*mov r6.z, r3.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*mov r6.w, r3.z */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /* lshift r6, r6, shift */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*mov r7.xy, r2.yw */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE2(0,1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE2(1,3), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*mov r7.z, r3.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*mov r7.w, r3.w */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /* lshift r7, r7, shift */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 24, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /*or.u32 r4, r4, r5*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*or.u32 r4, r4, r6*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*or.u32 r4, r4, r7*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /*img_store.u8 r4, c4, r0.xy, r4*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        Instructions->regs_count = 0x8;
        break;
    case gcvSURF_NV21:
        /*img_load.u8 r1, c0, r0.xy*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*img_store.u8 r1, c3, r0.xy, r1*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*img_load.u8 r1, c1, r0.xy*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*bitextract.u32 r2, r1.x, c5, 8;  c5 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*bitextract.u32 r3, r1.y, c5, 8;  c5 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*mov r4.xy, r2.xz */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE2(0,1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE2(0,2), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*mov r4.z, r3.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*mov r4.w, r3.z */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /* lshift r4, r4, shift */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*mov r5.xy, r2.yw */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE2(0,1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE2(1,3), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*mov r5.z, r3.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*mov r5.w, r3.w */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /* lshift r5, r5, shift */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 24, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /*img_load.u8 r1, c2, r0.xy*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*bitextract.u32 r2, r1.x, c5, 8;  c5 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*bitextract.u32 r3, r1.y, c5, 8;  c5 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*mov r6.xy, r2.xz */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE2(0,1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE2(0,2), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*mov r6.z, r3.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*mov r6.w, r3.z */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*mov r7.xy, r2.yw */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE2(0,1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE2(1,3), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*mov r7.z, r3.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*mov r7.w, r3.w */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /* lshift r7, r7, shift */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 16, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /*or.u32 r4, r4, r5*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*or.u32 r4, r4, r6*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*or.u32 r4, r4, r7*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        /*img_store.u8 r4, c4, r0.xy, r4*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        Instructions->regs_count = 0x8;
        break;
    default:
        break;
    }

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _channelextract(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gceSURF_FORMAT format = Context->inputFormat;
    gctUINT32 chan = Context->volume;
    gctUINT32 width = Context->row;
    gctUINT32 height = Context->col;
    gctUINT32 pixels;
    gctUINT32 mask;
    gcoVX_Instructions *Instructions = Context->instructions;

    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    pixels = width * height;

    /*mov r2, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0U, &Instructions->binarys[Instructions->count]));
    Instructions->count++;

    if (format == gcvSURF_X8R8G8B8)
    {
        /*img_load.32 r1, c0, r0.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*bitextract.u32 r2, r1, 0, c4;  c4 = [0+8*chan, 32+8*chan, 64+8*chan, 96+8*chan, 0, 0, 0, 0, 8, 8, 8, 8] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*img_store.u8 r2.x, c3, r0.xy, r2.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        Instructions->regs_count = 0x3;
    }
    else if (format == gcvSURF_R8G8B8)
    {
        /*img_load.u8 r1, c0, r0.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 11, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*bitextract.u32 r2, r1, 0, c4;  c4 = [0+8*chan, 32+8*chan, 64+8*chan, 96+8*chan, 0, 0, 0, 0, 8, 8, 8, 8] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*mov r3, r0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*div r3.x, r0.x, 3 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x44, 0, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 3, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*img_store.u8 r2.x, c3, r3.xy, r2.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        Instructions->regs_count = 0x4;
    }
    else if (format == gcvSURF_UYVY || format == gcvSURF_YUY2)
    {
        /*img_load.u8 r1, c0, r0.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        switch (chan)
        {
        case 0:
            /*bitextract.u32 r2, r1, 0, c4;  */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count]));
            Instructions->count++;
            /*img_store.u8 r2.xy, c3, r0.xy, r2.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            Instructions->count++;

            Instructions->regs_count = 0x3;
            break;
        case 1:
        case 2:
            /*mov r3, r0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            Instructions->count++;
            /* rshift r3.x, r3.x, 1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1, &Instructions->binarys[Instructions->count]));
            Instructions->count++;
            /*bitextract.u32 r2, r1, 0, c4;  */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count]));
            Instructions->count++;
            /*img_store.u8 r2.x, c3, r0.xy, r2.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            Instructions->count++;

            Instructions->regs_count = 0x4;
            break;
        default:
            status = gcvSTATUS_INVALID_ARGUMENT;
            break;
        }
    }
    else if (format == gcvSURF_NV21 || format == gcvSURF_NV12)
    {
        switch (chan)
        {
        case 0:
            /*img_load.u8 r1, c0, r0.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            Instructions->count++;
            /*img_store.u8 r1, c3, r0.xy, r1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            Instructions->count++;

            Instructions->regs_count = 0x3;
            break;
        case 1:
        case 2:
            mask = pixels / 32;
            /*branch.u32 r0.y, mask, 1 */
            gcmONERROR(gcoHARDWAREVX_Branch(0x03, 4, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, mask, &Instructions->binarys[Instructions->count]));
            Instructions->count++;
            /*img_load.u8 r1, c1, r0.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            Instructions->count++;
            /*bitextract.u32 r2, r1, 0, c4;  */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count]));
            Instructions->count++;
            /*img_store.u8 r2, c3, r0.xy, r2 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            Instructions->count++;

            Instructions->regs_count = 0x4;
            break;
        default:
            return gcvSTATUS_INVALID_ARGUMENT;
        }
    }
    else if (format == gcvSURF_I420)
    {
        switch (chan)
        {
        case 0:
            /*img_load.u8 r1, c0, r0.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            Instructions->count++;
            /*img_store.u8 r1, c3, r0.xy, r1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            Instructions->count++;

            Instructions->regs_count = 0x3;
            break;
        case 1:
        case 2:
            /*img_load.u8 r1, c1, r0.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, chan, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            Instructions->count++;
            /*img_store.u8 r1, c3, r0.xy, r1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            Instructions->count++;
            Instructions->regs_count = 0x3;
            break;
        default:
            return gcvSTATUS_INVALID_ARGUMENT;
        }
    }
    else if (format == gcvSURF_AYUV)
    {
        /*img_load.u8 r1, c0, r0.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, chan, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;
        /*img_store.u8 r1, c3, r0.xy, r1 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        Instructions->count++;

        Instructions->regs_count = 0x3;
    }


    OnError:
    gcmFOOTER();
    return status;
}

/*  convert rgb to yuv.
    startReg and nextReg are for this function.
    startReg.x is for red, startReg.y is for green, startReg.z is for blue.
    nextReg.x is for Y, nextReg.y is for U, nextReg.z is for V.
    Y = r * 0.2126f    + g * 0.7152f    + b * 0.0722f    + 0.5f;
    U = r * (-0.1146f) + g * (-0.3854)  + b * 0.5f       + 128.5f;
    V = r * 0.5f       + g * (-0.4542f) + b * (-0.0458f) + 128.5f;
*/
gceSTATUS rgb2yuv_bt709(gcoVX_Instructions *Instructions, gctUINT32 StartReg)
{
    gceSTATUS status = gcvSTATUS_OK;
    gctUINT32 nextReg = 0;

    /*conv.s32 startReg, startReg s32 -> f32*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(StartReg, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, StartReg, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x5, &Instructions->binarys[Instructions->count++]));

    /* mov startReg.w, 1.0f */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(StartReg, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(2, 1.0f, &Instructions->binarys[Instructions->count++]));

    nextReg = StartReg + 1;

    /*dp4.u32 nextReg.x, startReg, c5  get Y */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x06, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(nextReg, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, StartReg, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*dp4.u32 nextReg.y, startReg, c6  get U */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x06, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(nextReg, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, StartReg, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*dp4.u32 nextReg.z, startReg, c7  get V */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x06, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(nextReg, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, StartReg, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*conv.s32 nextReg, nextReg f32 -> U8*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(nextReg, gcdVX_ENABLE, gcvTRUE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, nextReg, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x0, &Instructions->binarys[Instructions->count++]));

OnError:
    return status;
}


/*  convert yuv to rgb.
    startReg and nextReg are for this function.
    startReg.x is for Y, startReg.y is for U, startReg.z is for V.
    nextReg.x is for red, nextReg.y is for green, nextReg.z is for blue.
    orignal formula:
    Y' = Y + 0.5f;
    U' = U - 128;
    V' = V - 128;
    r = Y' + 0.0000f * U' + 1.5748f * V';
    g = Y' - 0.1873f * U' - 0.4681f * V';
    b = Y' + 1.8556f * U' + 0.0000f * V';
    transfer formula:
    r = Y + 0.0000f * U + 1.5748f * V + 0.5f - 1.5748f * 128;
    g = Y + 0.1873f * U + 0.4681f * V + 0.5f + 0.1873f * 128 + 0.4681f * 128;
    b = Y + 1.8556f * U + 0.0000f * V + 0.5f - 1.8556f * 128;
*/

gceSTATUS yuv2rgb_bt709(gcoVX_Instructions *Instructions, gctUINT32 StartReg)
{
    gceSTATUS status = gcvSTATUS_OK;
    gctUINT32 nextReg = StartReg + 1;

    /* conv.s32 StartReg.xyz, StartReg.xyz s32 -> f32 get yuv */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(StartReg, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, StartReg, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x5, &Instructions->binarys[Instructions->count++]));

    /* mov startReg.w, 1.0f */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(StartReg, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(2, 1.0f, &Instructions->binarys[Instructions->count++]));

    /*dp4.u32 nextReg.x, StartReg, c5  get red */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x06, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(nextReg, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, StartReg, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*dp4.u32 nextReg.y, StartReg, c6  get green */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x06, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(nextReg, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, StartReg, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*dp4.u32 nextReg.z, StartReg, c7  get blue */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x06, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(nextReg, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, StartReg, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*conv.s32 nextReg, nextReg f32 -> U8*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(nextReg, gcdVX_ENABLE, gcvTRUE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, nextReg, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x0, &Instructions->binarys[Instructions->count++]));

OnError:
    return status;
}

static gceSTATUS _convertcolor(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gceSURF_FORMAT inputFormat = Context->inputFormat;
    gceSURF_FORMAT outputFormat = Context->outputFormat;
    gcoVX_Instructions *Instructions = Context->instructions;

    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    if (inputFormat == gcvSURF_R8G8B8)
    {
        if (outputFormat == gcvSURF_R8G8B8X8)
        {
            /*img_load.u8 r1, c0, r0.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 11, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r2, r1, 0, c4;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r3, r1, 0, c5;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*mov r2.z, r3.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

            /*mov r2.w, r3.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));

            /*lshift r3, 0xff, 24*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(0, 0xff, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 24U, &Instructions->binarys[Instructions->count++]));

            /*or.u32 r2, r2, r3 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

            /*mov r3, r0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*div r3.x, r0.x, 3 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x44, 0, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 3, &Instructions->binarys[Instructions->count++]));

            /*img_store.u8 r2, c1, r3.xy, r2*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

            Instructions->regs_count = 0x4;
        }
        else if (outputFormat == gcvSURF_AYUV)
        {
            /*img_load.u8 r1, c0, r0.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 11, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r2, r1, 0, c4;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* r2 to r3 is for rgb2yuv_bt709 function*/
            rgb2yuv_bt709(Instructions, 2);

            /*bitextract.u32 r4, r1, 0, c8;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* r4 to r5 is for rgb2yuv_bt709 function*/
            rgb2yuv_bt709(Instructions, 4);

            /*bitextract.u32 r6, r1, 0, c9;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 9, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* r6 to r7 is for rgb2yuv_bt709 function*/
            rgb2yuv_bt709(Instructions, 6);

            /*bitextract.u32 r8, r1, 0, c10;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 10, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* r8 to r9 is for rgb2yuv_bt709 function*/
            rgb2yuv_bt709(Instructions, 8);

            /*lshift r5, r5, 8*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));

            /*lshift r7, r7, 16*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 16U, &Instructions->binarys[Instructions->count++]));

            /*lshift r9, r9, 24*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 24U, &Instructions->binarys[Instructions->count++]));

            /*or.u32 r3, r3, r5 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

            /*or.u32 r3, r3, r7 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

            /*or.u32 r3, r3, r9 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

            /*mov r10, r0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*div r10.x, r0.x, 3 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x44, 0, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 3, &Instructions->binarys[Instructions->count++]));

            /* img_store r3, c1, r10.xy, r3; */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

            /* img_store r3, c2, r10.xy, r3; */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));

            /* img_store r3, c3, r10.xy, r3; */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));

            Instructions->regs_count = 11;
        }
        else if (outputFormat == gcvSURF_NV12 || outputFormat == gcvSURF_I420)
        {
            gctUINT i = 0;
            gctUINT j = 0;

            /*mov r12, r0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(12, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*mov r13, r0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*div r13.x, r0.x, 3 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x44, 0, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 3, &Instructions->binarys[Instructions->count++]));

            for (j = 0; j < 2; j++)
            {
                if (j == 1)
                {
                    /*add.u32 r12.y, r12.y, 1 */
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(12, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 12, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

                    /*add.u32 r13.y, r13.y, 1 */
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 13, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));
                }

                /*img_load.u8 r1, c0, r12.xy */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 11, 1, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 12, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

                for (i = 0; i < 4; i++)
                {
                    if (i == 0)
                    {
                        /*bitextract.u32 r((i+1)*2), r1, c4, 8; */
                        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x5, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetDestination((i+1)*2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
                    }
                    else
                    {
                        /*bitextract.u32 r((i+1)*2), r1, 0, c(7+i);*/
                        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x5, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetDestination((i+1)*2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 7+i, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
                    }

                    /* r((i+1)*2) to r((i+1)*2+1) is for rgb2yuv_bt709 function*/
                    rgb2yuv_bt709(Instructions, (i+1)*2);

                    if (i != 0)
                    {
                        /*lshift r((i+1)*2+1), r9, 8*i*/
                        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetDestination((i+1)*2+1, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, (i+1)*2+1, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8*i, &Instructions->binarys[Instructions->count++]));

                        /*or.u32 r3.x, r3.x, r((i+1)*2+1).x */
                        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, (i+1)*2+1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));
                    }
                }

                /* img_store r3, c1, r13.xy, r3; */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

                /*add.u32 r10.xy, r7.yz, r9.yz */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(10+j, gcdVX_ENABLE2(0,1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE2(1,2), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE2(1,2), 0, &Instructions->binarys[Instructions->count++]));

                /*mov r10.z, r10.x */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(10+j, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 10+j, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

                /*mov r10.w, r10.y */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(10+j, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 10+j, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));

                /*add.u32 r10.xy, r3.yz, r5.yz */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(10+j, gcdVX_ENABLE2(0,1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE2(1,2), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE2(1,2), 0, &Instructions->binarys[Instructions->count++]));
            }

            /*add.u32 r10, r10, r11 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 11, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

            /*rshift r10, r10, 2*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 2U, &Instructions->binarys[Instructions->count++]));

            /*mov r12, r0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(12, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*div r12.x, r0.x, 3 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x44, 0, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(12, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 3, &Instructions->binarys[Instructions->count++]));

            if (outputFormat == gcvSURF_NV12)
            {
                /*bitextract.u32 r10, r10, 0, c11;*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(2, 11, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

                /*rshift r12.y, r12.y, 1U*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(12, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 12, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

                /* img_store r10.x, c2, r12.xy, r10.x; */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 12, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 10, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

                Instructions->regs_count = 14;
            }
            else
            {
                /*lshift r10.z, r10.z, 8*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));

                /*lshift r10.w, r10.w, 8*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));

                /*or.u32 r10.xy, r10.xy, r10.zw */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE2(0,1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10, gcdVX_SWIZZLE2(0,1), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 10, gcdVX_SWIZZLE2(2,3), 0, &Instructions->binarys[Instructions->count++]));

                /*rshift r12.xy, r12.xy, 1U*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(12, gcdVX_ENABLE2(0,1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 12, gcdVX_SWIZZLE2(0,1), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

                /* img_store r10.x, c2, r12.xy, r10.x; */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 12, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 10, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

                /* img_store r10.y, c3, r12.xy, r10.y; */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 12, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 10, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));

                Instructions->regs_count = 14;
            }
        }
    }

    if (inputFormat == gcvSURF_R8G8B8X8)
    {
        if (outputFormat == gcvSURF_R8G8B8)
        {
            /*img_load.u8 r1, c0, r0.xy*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r2, r1, 0, c4;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r3, r1, 0, c5;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*mov r2.z, r3.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

            /*mov r3, r0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /* lshift r3.x, r3.x, 1U */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

            /*add.u32 r3.x, r3.x, r0.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

            /*img_store.u8 r2, c1, r3.xy, r2*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 11, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

            Instructions->regs_count = 0x4;
        }
        else if (outputFormat == gcvSURF_AYUV)
        {
            gctUINT32 i = 0;
            /*img_load.u8 r1, c0, r0.xy*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            for (i = 0; i < 4; i++)
            {
                /*bitextract.u32 r2, r1.i, c4, 8;  c4 = [0, 0x8, 0x10, 0x18] */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));

                /* r2 to r3 is for rgb2yuv_bt709 function*/
                rgb2yuv_bt709(Instructions, 2);

                /* lshift r3, r3, 8*i */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8*i, &Instructions->binarys[Instructions->count++]));

                if (i == 0)
                {
                    /*mov r4, r3*/
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
                }
                else
                {
                    /*or.u32 r4, r4, r3 */
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
                }
            }

            /* img_store r4, c1, r0.xy, r4; */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

            /* img_store r4, c2, r0.xy, r4; */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));

            /* img_store r4, c3, r0.xy, r4; */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));

            Instructions->regs_count = 5;
        }
        else if (outputFormat == gcvSURF_NV12 || outputFormat == gcvSURF_I420)
        {
            gctUINT i = 0;

            /*img_load.u8 r1, c0, r0.xy*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            for (i = 0; i < 4; i++)
            {
                /*bitextract.u32 r2, r1.i, c4, 8;  c4 = [0, 0x8, 0x10, 0x18] */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));

                /*r2->r3 are for this function*/
                rgb2yuv_bt709(Instructions, 2);

                /*mov r(i+4), r3 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(i+4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

                /* lshift r(i+4).x, r(i+4).x, 8i */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(i+4, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, i+4, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8*i, &Instructions->binarys[Instructions->count++]));

                if (i != 0)
                {
                    /*or.u32 r4.x, r4.x, r(i+4).x */
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, i+4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));
                }
            }

            /*mov r8, r0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*add.u32 r8.y, r8.y, 1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

            /*img_load.u8 r9, c0, r8.xy*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            for (i = 0; i < 4; i++)
            {
                /*bitextract.u32 r10, r9.i, c4, 8;  c4 = [0, 0x8, 0x10, 0x18] */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));

                /*r10->r11 are for this function*/
                rgb2yuv_bt709(Instructions, 10);

                /*mov r(i+12), r11 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(i+12, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 11, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

                /* lshift r(i+12).x, r(i+12).x, 8i */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(i+12, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, i+12, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8*i, &Instructions->binarys[Instructions->count++]));

                if (i != 0)
                {
                    /*or.u32 r12.x, r12.x, r(12+4).x */
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(12, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 12, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, i+12, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));
                }
            }

            /*img_store.u8 r4.x, c1, r0.xy, r4.x store y*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

            /*img_store.u8 r12.x, c1, r8.xy, r12.x store y*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 12, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

            /*add.u32 r5.xy, r4.yz, r5.yz */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE2(0,1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE2(1,2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE2(1,2), 0, &Instructions->binarys[Instructions->count++]));

            /*add.u32 r5.xy, r5.xy, r12.yz */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE2(0,1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE2(0,1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 12, gcdVX_SWIZZLE2(1,2), 0, &Instructions->binarys[Instructions->count++]));

            /*add.u32 r5.xy, r5.xy, r13.yz */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE2(0,1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE2(0,1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 13, gcdVX_SWIZZLE2(1,2), 0, &Instructions->binarys[Instructions->count++]));

            /*add.u32 r7.xy, r6.yz, r7.yz */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE2(0,1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE2(1,2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 7, gcdVX_SWIZZLE2(1,2), 0, &Instructions->binarys[Instructions->count++]));

            /*add.u32 r7.xy, r7.xy, r14.yz */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE2(0,1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE2(0,1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 14, gcdVX_SWIZZLE2(1,2), 0, &Instructions->binarys[Instructions->count++]));

            /*add.u32 r7.xy, r7.xy, r15.yz */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE2(0,1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE2(0,1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE2(1,2), 0, &Instructions->binarys[Instructions->count++]));

            /* rshift r5.xy, r5.xy, 2 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE2(0,1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE2(0,1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 2U, &Instructions->binarys[Instructions->count++]));

            /* rshift r7.xy, r7.xy, 2 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE2(0,1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE2(0,1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 2U, &Instructions->binarys[Instructions->count++]));

            /*mov r8, r0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            if (outputFormat == gcvSURF_NV12)
            {
                /* lshift r5.y, r5.y, 8 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));

                /*or.u32 r5.x, r5.x, r5.y */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));

                /* lshift r7.x, r7.x, 16 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 16U, &Instructions->binarys[Instructions->count++]));

                /*or.u32 r5.x, r5.x, r7.x */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 7, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

                /* lshift r7.y, r7.y, 24 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 24U, &Instructions->binarys[Instructions->count++]));

                /*or.u32 r5.x, r5.x, r7.y */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 7, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));

                /* rshift r8.y, r8.y, 1 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

                /*img_store.u8 r5.x, c2, r8.xy, r5.x store uv*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));
            }
            else
            {
                /* lshift r7.xy, r7.xy, 8 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE2(0,1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE2(0,1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));

                /*or.u32 r5.xy, r5.xy, r7.xy */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE2(0,1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE2(0,1), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 7, gcdVX_SWIZZLE2(0,1), 0, &Instructions->binarys[Instructions->count++]));

                /* rshift r8.xy, r8.xy, 1 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE2(0,1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE2(0,1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

                /*img_store.u8 r5.x, c2, r8.xy, r5.x store u*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

                /*img_store.u8 r5.y, c3, r8.xy, r5.y store u*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));
            }

            Instructions->regs_count = 16;
        }
    }

    if (inputFormat == gcvSURF_YUY2 || inputFormat == gcvSURF_UYVY)
    {
        if ((outputFormat == gcvSURF_R8G8B8X8) || (outputFormat == gcvSURF_R8G8B8))
        {
            gctUINT i = 0;

            /*img_load.u8 r1, c0, r0.xy*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            for (i = 0; i < 4; i++)
            {
                gctUINT constUniform = (i == 0) ? 4 : 7 + i;

                /*bitextract.u32 r2, r1, 0, constUniform;*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(2, constUniform, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

                /* r2->r3 are for this function */
                yuv2rgb_bt709(Instructions, 2);

                /* lshift r3.y, r3.y, 8 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8, &Instructions->binarys[Instructions->count++]));

                /* lshift r3.z, r3.z, 16 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 16, &Instructions->binarys[Instructions->count++]));

                /*or.u32 r4.i, r3.x, r3.y */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));

                /*or.u32 r4.i, r4.i, r3.z */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));

            }

            /*mov r5, r0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            if (outputFormat == gcvSURF_R8G8B8X8)
            {
                 /*lshift r6, 0xff, 24*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(0, 0xff, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 24U, &Instructions->binarys[Instructions->count++]));

                /*or.u32 r4, r4, r6 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

                /* rshift r5.x, r5.x, 1 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1, &Instructions->binarys[Instructions->count++]));

                /*img_store.u8 r4, c1, r5.xy, r4*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

                Instructions->regs_count = 7;
            }
            else
            {
                /*bitextract.u32 r6, r4, 0, c11;*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(2, 11, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

                /*bitextract.u32 r7, r4, 0, c12;*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(2, 12, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

                /*mov r6.z, r7.x */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 7, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

                /* rshift r5.x, r5.x, 1 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1, &Instructions->binarys[Instructions->count++]));

                /*add.u32 r5.x, r5.x, r0.x */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

                /*img_store.u8 r6, c1, r5.xy, r6*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 11, 1, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

                Instructions->regs_count = 8;
            }
        }
        else if (outputFormat == gcvSURF_NV12)
        {
            /*img_load.u8 r1, c0, r0.xy*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*get y (line 0)*/
            /*bitextract.u32 r2, r1, 0, c4;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*img_store.u8 r2.xy, c1, r0.xy, r2.xy store y*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE2(0,1), 0, &Instructions->binarys[Instructions->count++]));

            /*mov r2, r0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*add.u32 r2.y, r2.y, 1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

            /*get y (line1)*/
            /*img_load.u8 r3, c0, r2.xy*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r4, r3, 0, c4;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*img_store.u8 r4.xy, c1, r2.xy, r4.xy store y*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE2(0,1), 0, &Instructions->binarys[Instructions->count++]));

            /*get u line0*/
            /*bitextract.u32 r5, r1, 0, c5;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*get v*/
            /*bitextract.u32 r6, r1, 0, c6;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*get u line1*/
            /*bitextract.u32 r7, r3, 0, c5;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*get v*/
            /*bitextract.u32 r8, r3, 0, c6;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* average u */
            /*add.u32 r5, r5, r7 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

            /*rshift r5, r5, 1*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

            /* average v */
            /*add.u32 r6, r6, r8 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

            /*rshift r6, r6, 1*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

            /*lshift r6, r6, 8*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));

            /*or.u32 r5, r5, r6 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r5, r5, 0, c7; */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*store uv*/
            /*mov r3, r0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /* rshift r3.y, r3.y, 1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

            /*img_store.u8 r5.xy, c2, r3.xy, r5.xy store uv*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE2(0,1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            Instructions->regs_count = 9;
        }
        else if (outputFormat == gcvSURF_I420)
        {
            /*img_load.u8 r1, c0, r0.xy*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*get y (line 0)*/
            /*bitextract.u32 r2, r1, 0, c4;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*mov r3, r0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /* rshift r3.x, r3.x, 1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

            /*img_store.u8 r2.xy, c1, r3.xy, r2.xy store y*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE2(0,1), 0, &Instructions->binarys[Instructions->count++]));

            /*mov r3, r0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*add.u32 r3.y, r3.y, 1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

            /*img_load.u8 r4, c0, r3.xy*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*get y (line 0)*/
            /*bitextract.u32 r2, r4, 0, c4;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* rshift r3.x, r3.x, 1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

            /*img_store.u8 r2.xy, c1, r3.xy, r2.xy store y*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE2(0,1), 0, &Instructions->binarys[Instructions->count++]));

            /*get u line 0*/
            /*bitextract.u32 r2, r1, 0, c5;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*get v*/
            /*bitextract.u32 r3, r1, 0, c6;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*get u line 1*/
            /*bitextract.u32 r5, r4, 0, c5;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*get v*/
            /*bitextract.u32 r6, r4, 0, c6;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* average u */
            /*add.u32 r2, r2, r5 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

            /*rshift r2, r2, 1*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

            /* average v */
            /*add.u32 r3, r3, r6 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

            /*rshift r3, r3, 1*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

            /*store uv*/
            /*mov r1, r0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /* rshift r1.x, r1.x, 2*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 2U, &Instructions->binarys[Instructions->count++]));

            /* rshift r1.y, r1.y, 1*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r2, r2, 0, c8;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r3, r3, 0, c8;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*img_store.u8 r2.x, c2, r1.xy, r2.x store u*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE2(0,1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

            /*img_store.u8 r3.x, c3, r1.xy, r3.x store u*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE2(0,1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

            Instructions->regs_count = 7;
        }
    }

    if (inputFormat == gcvSURF_I420)
    {
        if (outputFormat == gcvSURF_NV12)
        {
            gctUINT xstep = Context->xstep;

            /*img_load.u8 r1, c0, r0.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, xstep-1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*img_store.u8 r1, c3, r0.xy, r1 store y line0*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, xstep-1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

            /*mov r2, r0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*add.u32 r2.y, r2.y, 1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

            /*img_load.u8 r1, c0, r2.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, xstep-1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*img_store.u8 r1, c3, r2.xy, r1 store y line1*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, xstep-1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

            /*mov r2, r0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            if (xstep == 16)
            {
                /* rshift r2.x, r2.x, 1 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));
            }

            /* rshift r2.y, r2.y, 1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

            /*img_load.u8 r3, c1, r2.xy*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r4, r3, 0, c6;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r5, r3, 0, c7;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*mov r4.z, r5.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

            /*mov r4.w, r5.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));


            /*img_load.u8 r5, c2, r2.xy*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r6, r5, 0, c6;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r7, r5, 0, c7;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*mov r6.z, r7.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 7, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

            /*mov r6.w, r7.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 7, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));

            /* lshift r6, r6, 8 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));

            /*or.u32 r4, r4, r6 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

            /*mov r5, r0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            if (xstep == 8)
            {
                /* lshift r5.x, r5.x, 1 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));
            }

            /* rshift r5.y, r5.y, 1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));


            /*img_store.u8 r4, c4, r5.xy, r4 store uv*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

            Instructions->regs_count = 8;
        }
        else if (outputFormat == gcvSURF_AYUV)
        {
            gctUINT xstep = Context->xstep;

            /*img_load.u8 r1, c0, r0.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, xstep-1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*img_store.u8 r1, c3, r0.xy, r1 store y line0*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, xstep-1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

            /*mov r5, r0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            if (xstep == 16)
            {
                /* rshift r5.x, r5.x, 1 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));
            }

            /* rshift r5.y, r5.y, 1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

            /*img_load.u8 r1, c1, r5.xy*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r2, r1, 0, c6;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r3, r1, 0, c7;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*mov r2.z, r3.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

            /*mov r2.z, r3.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));

            /*img_load.u8 r3, c2, r5.xy*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r4, r3, 0, c6;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r5, r3, 0, c7;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*mov r4.z, r5.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

            /*mov r4.z, r5.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));

            /*mov r5, r0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            if (xstep == 8)
            {
                /* lshift r5.x, r5.x, 1 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));
            }

            /*img_store.u8 r2, c4, r5.xy, r2 store u*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

            /*img_store.u8 r4, c5, r5.xy, r4 store v*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

            Instructions->regs_count = 6;
        }
        else if (outputFormat == gcvSURF_R8G8B8X8 || outputFormat == gcvSURF_R8G8B8)
        {
            gctUINT i = 0;

            /*img_load.u8 r1, c0, r0.xy get y row 0*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r1, r1.x, c4, 8;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));

            /*mov r10, r0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*add r10.y, r10.y, 1U */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

            /*img_load.u8 r2, c0, r10.xy get y row 1*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r2, r2.x, c4, 8;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));

            /*mov r10, r0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /* rshift r10.xy, r10.xy, 1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE2(0,1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10, gcdVX_SWIZZLE2(0,1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

            /*img_load.u8 r3, c1, r10.xy get u*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r3, r3.x, c4, 8;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));

            /*img_load.u8 r4, c2, r10.xy get v*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r4, r4.x, c4, 8;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));

            for (i = 0; i < 4; i++)
            {
                /*mov r5.x, r1.x */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, (i<2)?1:2, gcdVX_SWIZZLE1(i%2), 0, &Instructions->binarys[Instructions->count++]));

                /*mov r5.y, r3.x */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

                /*mov r5.z, r4.x */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

                /*r5->r6 are for this function*/
                yuv2rgb_bt709(Instructions, 5);

                if (i < 2)
                {
                    /*bitextract.u32 r7, r6, 0, c8;*/
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetEVIS(0+4*i, 3+4*i, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
                }
                else
                {
                    /*bitextract.u32 r8, r6, 0, c8;*/
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetEVIS(0+4*(i%2), 3+4*(i%2), (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
                }
            }

            for (i = 0; i < 4; i++)
            {
                gctUINT swizzle = (i % 2) ? 3 : 2;

                /*mov r5.x, r1.z */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, (i<2)?1:2, gcdVX_SWIZZLE1(swizzle), 0, &Instructions->binarys[Instructions->count++]));

                /*mov r5.y, r3.y */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));

                /*mov r5.z, r4.y */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));

                /*r4->r5 are for this function*/
                yuv2rgb_bt709(Instructions, 5);

                if (i < 2)
                {
                    /*bitextract.u32 r9, r6, 0, c8;*/
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetEVIS(0+4*i, 3+4*i, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
                }
                else
                {
                    /*bitextract.u32 r10, r6, 0, c8;*/
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetEVIS(0+4*(i%2), 3+4*(i%2), (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
                }
            }

            /*mov r7.z, r9.x*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

            /*mov r7.w, r9.y*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

            /*mov r8.z, r10.x*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 10, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

            /*mov r8.w, r10.y*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 10, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

            if (outputFormat == gcvSURF_R8G8B8X8)
            {
                /*lshift r5, 0xff, 24*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(0, 0xff, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 24U, &Instructions->binarys[Instructions->count++]));

                /*or.u32 r7, r7, r5 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

                /*or.u32 r8, r8, r5 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

                /*mov r6, r0 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

                /*add r12.y, r6.y, 1U */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

                /*img_store.u8 r7.xy, c3, r0.xy, r7.xy*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

                /*img_store.u8 r8.xy, c3, r6.xy, r8.xy*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 6, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

                Instructions->regs_count = 11;
            }
            else
            {
                /*mov r3, r0 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

                /* lshift r3.x, r3.x, 1U */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

                /*add r3.x, r3.x, r0.x */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

                /*bitextract.u32 r4, r7, 0, c9;*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(2, 9, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

                /*bitextract.u32 r5, r7, 0, c10;*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(2, 10, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

                /*mov r4.z, r5.x */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

                /*img_store.u8 r4, c3, r3.xy, r4*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 11, 1, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

                /*bitextract.u32 r6, r8, 0, c9;*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(2, 9, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

                /*bitextract.u32 r7, r8, 0, c10;*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(2, 10, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

                /*mov r6.z, r7.x */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 7, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

                /*add r3.y, r3.y, 1U */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

                /*img_store.u8 r6, c3, r3.xy, r6*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 11, 1, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

                Instructions->regs_count = 11;
            }
        }
    }

    if (inputFormat == gcvSURF_NV12 || inputFormat == gcvSURF_NV21)
    {
        if (outputFormat == gcvSURF_R8G8B8X8 || outputFormat == gcvSURF_R8G8B8)
        {
            gctUINT i = 0;

            /*img_load.u8 r1, c0, r0.xy get y row 0*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r1, r1.x, c4, 8;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));

            /*mov r8, r0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*add r8.y, r8.y, 1U */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

            /*img_load.u8 r2, c0, r8.xy get y row 1*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r2, r2.x, c4, 8;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));

            /*mov r11, r0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /* rshift r11.y, r11.y, 1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 11, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

            /*img_load.u8 r3, c1, r11.xy get uv*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 11, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r3, r3.x, c4, 8;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));

            for (i = 0; i < 4; i++)
            {
                /*mov r4.x, r1.x */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, (i<2)?1:2, gcdVX_SWIZZLE1(i%2), 0, &Instructions->binarys[Instructions->count++]));

                if (inputFormat == gcvSURF_NV12)
                {
                    /*mov r4.y, r3.x */
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

                    /*mov r4.z, r3.y */
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));
                }
                else
                {
                    /*mov r4.y, r3.y */
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));

                    /*mov r4.z, r3.x */
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));
                }

                /*r4->r5 are for this function*/
                yuv2rgb_bt709(Instructions, 4);

                if (i < 2)
                {
                    /*bitextract.u32 r6, r5, 0, c8;*/
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetEVIS(0+4*i, 3+4*i, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
                }
                else
                {
                    /*bitextract.u32 r7, r5, 0, c8;*/
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetEVIS(0+4*(i%2), 3+4*(i%2), (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
                }
            }

            for (i = 0; i < 4; i++)
            {
                gctUINT swizzle = (i % 2) ? 3 : 2;

                /*mov r4.x, r1.z */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, (i<2)?1:2, gcdVX_SWIZZLE1(swizzle), 0, &Instructions->binarys[Instructions->count++]));

                if (inputFormat == gcvSURF_NV12)
                {
                    /*mov r4.y, r3.z */
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));

                    /*mov r4.z, r3.w */
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count++]));
                }
                else
                {
                    /*mov r4.y, r3.w */
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count++]));

                    /*mov r4.z, r3.z */
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
                }

                /*r4->r5 are for this function*/
                yuv2rgb_bt709(Instructions, 4);

                if (i < 2)
                {
                    /*bitextract.u32 r9, r5, 0, c8;*/
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetEVIS(0+4*i, 3+4*i, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
                }
                else
                {
                    /*bitextract.u32 r10, r5, 0, c8;*/
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetEVIS(0+4*(i%2), 3+4*(i%2), (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
                }
            }

            /*mov r6.z, r9.x*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

            /*mov r6.w, r9.y*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

            /*mov r7.z, r10.x*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 10, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

            /*mov r7.w, r10.y*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 10, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

            if (outputFormat == gcvSURF_R8G8B8X8)
            {
                /*lshift r4, 0xff, 24*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(0, 0xff, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 24U, &Instructions->binarys[Instructions->count++]));

                /*or.u32 r6, r6, r4 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

                /*or.u32 r7, r7, r4 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5C, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

                /*img_store.u8 r6.xy, c3, r0.xy, r6.xy*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

                /*img_store.u8 r7.xy, c3, r8.xy, r7.xy*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

                Instructions->regs_count = 12;
            }
            else
            {
                /*mov r3, r0 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

                /* lshift r3.x, r3.x, 1U */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

                /*add r3.x, r3.x, r0.x */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

                /*bitextract.u32 r4, r6, 0, c9;*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(2, 9, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

                /*bitextract.u32 r5, r6, 0, c10;*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(2, 10, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

                /*mov r4.z, r5.x */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

                /*img_store.u8 r4, c3, r3.xy, r4*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 11, 1, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

                /*bitextract.u32 r4, r7, 0, c9;*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(2, 9, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

                /*bitextract.u32 r5, r7, 0, c10;*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(2, 10, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

                /*mov r4.z, r5.x */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

                /*add r3.y, r3.y, 1U */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

                /*img_store.u8 r4, c3, r3.xy, r4*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 11, 1, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

                Instructions->regs_count = 12;
            }
        }
        else if (outputFormat == gcvSURF_AYUV)
        {
            gctUINT i = 0;

            /*img_load.u8 r1, c0, r0.xy get y row 0*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /* img_store r1, c3, r0.xy, r1; */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

            /*mov r5, r0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /* rshift r5.y, r5.y, 1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

            /*img_load.u8 r2, c1, r5.xy get uv*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            for (i = 0; i < 2; i++)
            {
                gctUINT constUniform = (i == 0) ? 6 : 8;

                /*bitextract.u32 r3, r2, 0, c6;*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(2, constUniform, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

                /*bitextract.u32 r4, r2, 0, c7;*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(2, constUniform+1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

                /*mov r3.z, r4.x */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

                /*mov r3.w, r4.y */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));

                /* img_store r3, c4, r0.xy, r3; */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(0, 4 + i, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
            }

            Instructions->regs_count = 6;
        }
        else if (outputFormat == gcvSURF_I420)
        {
            gctINT xstep = Context->xstep;

            /*img_load.u8 r1, c0, r0.xy get y*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, xstep-1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /* img_store r1, c3, r0.xy, r1; */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, xstep-1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

            /*mov r5, r0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /* rshift r5.y, r5.y, 1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

            /*img_load.u8 r2, c1, r5.xy get uv*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, xstep-1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r3, r2, 0, c6;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, xstep/2-1, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r4, r2, 0, c7;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, xstep/2-1, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* rshift r5.x, r5.x, 1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

            /* img_store r3.xy, c4, r5.xy, r3.xy; */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, xstep/2-1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE2(0,1), 0, &Instructions->binarys[Instructions->count++]));

            /* img_store r4.xy, c5, r5.xy, r4.xy; */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, xstep/2-1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            Instructions->regs_count = 6;
        }
    }

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _convertdepth(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gctBOOL Saturate = Context->policy;
    gctUINT32 Input = Context->input_type[0];
    gctUINT32 Output = Context->output_type[0];
    gctUINT32 Shift = Context->volume;
    gcoVX_Instructions *Instructions = Context->instructions;

    gcmHEADER_ARG("Instructions=0x%x", Instructions);




    if (Input == 0x7)
    {
        switch (Output)
        {
        case 0x6:
        case 0x3:
            /*img_load.u8 r1, c0, r0.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
            /*iadd.u8 r2, r1, 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (Input | (Input << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            /* lshift r2, r2, c2.x(shift) */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));
            /*img_store.u8 r2, c1, r0.xy, r2 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
            break;
        case 0x5:
            /*img_load.u8 r1, c0, r0.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
            /*iadd.u8 r2, r1, 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (Input | (Input << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            /* lshift r2, r2, shift */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));
            /*img_store.u8 r2, c1, r0.xy, r2 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
            break;
        default:
            status = gcvSTATUS_INVALID_ARGUMENT;
            break;
        }
    }
    else if (Input == 0x6)
    {
        switch (Output)
        {
        case 0x5:
            /*img_load.u8 r1, c0, r0.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
            /*iadd.u8 r2, r1, 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (Input | (Input << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            /* lshift r2, r2, shift */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));
            /*img_store.u8 r2, c1, r0.xy, r2 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
            /*img_store.u8 r2, c1, r0.xy, r2 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
            break;
        case 0x7:
            /*img_load.u8 r1, c0, r0.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
            /*mul_shift.u8, r2, r1, 1, Shift */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, Saturate, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (Input | (0x6 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, Shift, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            /*img_store.u8 r2, c1, r0.xy, r2 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
            break;
        default:
            status = gcvSTATUS_INVALID_ARGUMENT;
            break;
        }
    }
    else if (Input == 0x3)
    {
        switch (Output)
        {
        case 0x2:
            /*img_load.u8 r1, c0, r0.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
            /*iadd.u8 r2, r1, 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (Input | (Input << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            /* lshift r2, r2, shift */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));
            break;
        case 0x7:
            /*img_load.u8 r1, c0, r0.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
            /*mul_shift.u8, r2, r1, 1, Shift */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, Saturate, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (Input | (0x6 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, Shift, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            /*img_store.u8 r2, c1, r0.xy, r2 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
            break;
        default:
            status = gcvSTATUS_INVALID_ARGUMENT;
            break;
        }
    }
    else if (Input == 0x5)
    {
        switch (Output)
        {
        case 0x6:
            /*TO DO*/
            status = gcvSTATUS_NOT_SUPPORTED;
            break;
        case 0x7:
            /*TO DO*/
            status = gcvSTATUS_NOT_SUPPORTED;
            break;
        default:
            status = gcvSTATUS_INVALID_ARGUMENT;
            break;
        }
    }
    else if (Input == 0x2)
    {
        switch (Output)
        {
        case 0x3:
            /*TO DO*/
            status = gcvSTATUS_NOT_SUPPORTED;
            break;
        default:
            status = gcvSTATUS_INVALID_ARGUMENT;
            break;
        }
    }
    else if (Input == 0x0)
    {
        switch (Output)
        {
        case 0x7:
            /*TO DO*/
            status = gcvSTATUS_NOT_SUPPORTED;
            break;
        default:
            status = gcvSTATUS_INVALID_ARGUMENT;
            break;
        }
    }
    else
        status = gcvSTATUS_INVALID_ARGUMENT;

    Instructions->regs_count = 0x3;
OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _lut(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gcoVX_Instructions   *Instructions = Context->instructions;
    gctUINT32 i = 0;
    gctUINT32 j = 0;

    gcmHEADER_ARG("Context=0x%x", Context);

    if (Context->input_type[0] == 0x7)
    {

         /*img_load.u8 r1, c0, r0.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

        for (i = 0; i < 4; i++)
        {
            /*bitextract.u32 r2, r1.x, c3, 8;  c3 = [0, 0x8, 0x10, 0x18] */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));
            for (j = 0; j < 4; j++)
            {
                /* load r3.x, c1, r2.x */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(j), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE1(j), 0, &Instructions->binarys[Instructions->count++]));
            }
            if (i < 2)
            {
                /*bitextract.u8 r4, r3, 0, c4;  c4 = [0, 32, 64, 96, 0, 0, 0, 0, 8, 8, 8, 8] */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(i * 4, i * 4 + 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            }
            else
            {
                /*bitextract.u8 r5, r3, 0, c4;  c4 = [0, 32, 64, 96, 0, 0, 0, 0, 8, 8, 8, 8] */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS((i - 2) * 4, (i - 2) * 4 + 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            }
        }
        /*mov r4.z, r5.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mov r4.w, r5.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*img_store.u8 r4, c2, r0.xy, r4 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

        Instructions->regs_count = 0x6;
    }
    else
    {
        /*img_load.u8 r1, c0, r0.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

        for (i = 0; i < 2; i++)
        {
            /*bitextract.u8 r2, r1.x, 0, c3, 8;  c3 = [0, 8, 0, 0, 16, 24, 0, 0, 8, 8, 0, 0, 8, 8, 0, 0] */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, i==0?3:5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u8 r3, r1.y, 0, c4, 8;  c4 = [0, 8, 0, 0, 16, 24, 0, 0, 8, 8, 0, 0, 8, 8, 0, 0] */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, i==0?4:6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*add.u32 r2, r2, 65536/2 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 32768, &Instructions->binarys[Instructions->count++]));

            /*mul_shift.u8, r2, r2, 2, 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x6 | (0x6 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 2 | (2 << 16), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*add.u32 r3, r3, 65536/2 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 32768, &Instructions->binarys[Instructions->count++]));

            /*mul_shift.u8, r3, r3, 2, 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x6 | (0x6 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 2 | (2 << 16), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* load r4.x, c1, r2.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

            /* load r4.x, c1, r2.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));

            /* load r4.x, c1, r3.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

            /* load r4.x, c1, r3.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));

            if (i == 0)
            {
                /*bitextract.u8 r5, r4, 0, c7;  c7 = [0, 8, 32, 40, 64, 72, 96, 104, 8, 8, 8, 8, 8, 8, 8, 8] */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(2, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            }
            else
            {
                /*bitextract.u8 r6, r4, 0, c7;  c4 = [0, 8, 32, 40, 64, 72, 96, 104, 8, 8, 8, 8, 8, 8, 8, 8] */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(2, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            }
        }

        /*mov r5.z, r6.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mov r5.w, r6.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*img_store.u8 r5, c2, r0.xy, r5 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

        Instructions->regs_count = 0x7;
    }

OnError:
    gcmFOOTER();
    return status;
}

typedef struct _gcoVX_Index
{
    gctINT32 dst;
    gctINT32 src;
    gctINT32 src1;
    gctINT32 start;
    gctINT32 end;
    gctINT32 uniform;
}
gcoVX_Index;

static gceSTATUS _fast9corners_load16pixels(
    IN OUT gcoVX_Hardware_Context   *Context,
    IN gctUINT32 Index
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gcoVX_Instructions   *Instructions = Context->instructions;
    gctINT32 i;
    gcoVX_Index indexs[]                = {
        /* dst, src, src1,start, end, uniform */
        {   10, 1, 7, 0, 5, 3+4*Index    }, /* 16, 1, 2, 10, 9, 8 */
        {   10, 4, 4, 6, 7, 5+4*Index    }, /* 13,5 */
        {   11, 2, 6, 0, 3, 4+4*Index    }, /* 15,3, 11,7 */
        {   11, 3, 5, 4, 7, 5+4*Index    }, /* 14,4,12,6 */

        /* sort */
        {   8, 10, 11, 0, 7, 40    }, /* 1,2,3,4,5,6,7,8 */
        {   9, 10, 11, 0, 7, 41    }, /* 9,10,11,12,13,14,15,16 */
    };

    gcmHEADER_ARG("Context=0x%x", Context);


    /*
    *       0   1   2   3   4   5   6   7   8   9   a   b   c   d   e   f
    * r1: |   |   | 16| 1 | 2 |   |   |   |   |   |   |   |   |   |   |   |
    * r2: |   | 15|   |   |   | 3 |   |   |   |   |   |   |   |   |   |   |
    * r3: | 14|   |   |   |   |   | 4 |   |   |   |   |   |   |   |   |   |
    * r4: | 13|   |   | p |   |   | 5 |   |   |   |   |   |   |   |   |   |
    * r5: | 12|   |   |   |   |   | 6 |   |   |   |   |   |   |   |   |   |
    * r6: |   | 11|   |   |   | 7 |   |   |   |   |   |   |   |   |   |   |
    * r7: |   |   | 10| 9 | 8 |   |   |   |   |   |   |   |   |   |   |   |
    *
    * r8: |   1   |   2   |   3   |   4   |   5   |   6   |   7   |   8   |     pixel array[0 - 7]
    * r9: |   9   |   a   |   b   |   c   |   d   |   e   |   f   |  16   |     pixel array[8 -15]
    *
    *r10: |   16  |   1   |   2   |   10  |   9   |   8   |   13  |   5   |     temp[0 - 7]
    *r11: |   15  |   3   |   11  |   7   |   14  |   4   |   12  |   6   |     temp[8 -15]
    *
    * ...
    *          x         y        z         w
    *r10: |       p       |       p       |       p       |       p       |
    * ...
    *r14: |    a     a    |    b     b    |    c     c    |    0     0    |
    */
    for(i = 0; i < (gctINT32)(sizeof(indexs)/sizeof(indexs[0])); i ++)
    {
        gcoVX_Index index = indexs[i];
        /*bitextract.type, r(dst)[start, end], r(src), r(src1), c(uniform); p[i + 1]*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(index.dst, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(index.start, index.end, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, index.src, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, index.src1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, index.uniform, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
    }

    /*bitextract.u8, r10, r4.x, r4.y, c(6+4*Index); p load pixel*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 6+4*Index, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*mov r14, c35 ;{a,b,c,0} -> r14*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 35, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));


OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _fast9corners_iscorner(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gcoVX_Instructions   *Instructions = Context->instructions;
    gctINT32 i = 0;

    gcmHEADER_ARG("Context=0x%x", Context);

    /*
     *  r8: |  0    1  |  2    3  |  4    5  |  6    7  |
     *  r9: |  8    9  |  10   11 |  12   13 |  14   15 |
     * r10: |    p     |    p     |    p     |    p     |
     * r11: |   p+/-t  |   p+/-t  |   p+/-t  |   p+/-t  |
     * r12: | c+/-[0-7]| c+/-[0-7]| c+/-[0-7]| c+/-[0-7]|
     * r13: |c+/-[0-15]|c+/-[0-15]|c+/-[0-15]|c+/-[0-15]|
     * r14: |  a    a  |  b    b  |  c    c  |  0    0  |
     */

    /*mov r0.zw, c36.zwzw; */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 36, gcdVX_SWIZZLE4(2, 3, 2, 3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    for(i = 0; i < 2; i++)
    {
        gctUINT32 condition[2] = {0x01, 0x02};
        /*add.u32 r11, r10, r14.zzzz; r2 = (p +/- tolerance) */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 14, gcdVX_SWIZZLE4(2, 2, 2, 2), i, &Instructions->binarys[Instructions->count++]));

        /*compare with (p +/- tolerance)*/
        /*cmp r12, r8, r11, c36.xxxx;  (data[0-7] > (p + tolerance))/(data[0-7] < (p - tolerance)) -> 1 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, condition[i], 0x3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(12, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 11, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 36, gcdVX_SWIZZLE4(0, 0, 0, 0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /*cmp r13, r9, r11, c36.xxxx;  (data[8-15] > (p + tolerance))/(data[8-15] < (p - tolerance)) -> 1 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, condition[i], 0x3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 11, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 36, gcdVX_SWIZZLE4(0, 0, 0, 0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /*dp16x1.u8 r12[0, 0], r12, r13, c45 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(12, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x6 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 12, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 45, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        /*mul_shift.u8, r12, r12, 1, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(12, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(1, 1, (0x6 | (0x6 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 12, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 1 | (1 << 16), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
        /*mov r12, r12.x; */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(12, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 12, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /*bitextract.u8, r13, r12, r12, c37; ((r4 >>> (0~7)) & 111111111) */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 12, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 12, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 37, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        /*bitextract.u8, r12, r12, r12, c38; ((r4 >>> (8~15)) & 111111111)*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(12, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 12, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 12, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 38, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        /*cmp r13, r13, c39, r0.wwww; */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x05, 0x3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 13, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 39, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE4(3, 3, 3, 3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /*cmp r12, r12, c39, r0.wwww; */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x05, 0x3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(12, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 12, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 39, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE4(3, 3, 3, 3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /*dp16x1.u8 r12.z, r12, r13, c45 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(12, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(2, 2, (0x6 | (0x6 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 12, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 45, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        /*mov.eq r0.z, r12.z, 0, 2; if(r12.z != 0)?r0.z = 2:r0.z = 0*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x06, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 12, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 2, &Instructions->binarys[Instructions->count++]));

    }


OnError:
    gcmFOOTER();
    return status;
}

#define FAST_NO_BRANCH 0

static gceSTATUS _fast9corners_score(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gcoVX_Instructions   *Instructions = Context->instructions;

    gcmHEADER_ARG("Context=0x%x", Context);

    /*
     *    for (j = 0; j < 8; j++)
     *    {
     *      buf[16+j] = buf[j];
     *    }
     *
     *    for(j = 0; j < 16; j++)
     *    {
     *      maxs[j] = buf[j];
     *      mins[j] = buf[j];
     *
     *      vxMinMax(&buf[j], &maxs[j], &mins[j], 9);
     *    }
     *
     *    score_b = maxs[0];
     *    score_d = mins[0];
     *
     *    vxMinMax(maxs, NULL, &score_b, 16);
     *    vxMinMax(mins, &score_d, NULL, 16);
     *
     * # way 1
     *
     *    if((score_b > cb) && (score_d > cb))
     *    {
     *       if(score_b > score_d)
     *       score = score_d - cb - 1;
     *       else
     *       score = score_b - cb - 1;
     *    }
     *    else if ((score_b < cb) && (score_d < cb))
     *    {
     *       if(score_b > score_d)
     *       score = cb - score_b - 1;
     *          else
     *       score = cb - score_d - 1;
     *    }
     *
     * # way 2
     *
     *    strength = ((score_b > score_d)?score_d:score_b);
     *    temp = ((score_b > score_d)?score_b:score_d);
     *    strength = (strength > p)?strength:temp;
     *    strength = abs(strength - p) - 1;
     *
     * # way 3
     *
     *    strength = abs(score_b - p);
     *    strength1 = abs(score_d - p);
     *    strength = (strength > strength1)?strength1:strength;
     *    strength -= 1;
     *
     * #endif
     *    return strength;
     *
     * buf[16]:r11 max:r14 min:r13
     *                                                |
     * r11 : | 0 1 2 3 | 4 5 6 7 | 8 9 a b | c d e f ||| 8 9 a b | c d e f | 0 1 2 3 | 4 5 6 7 |
     * r12 : | 3 4 5 6 | 7 8 9 a | b c d e | f 0 1 2 ||| b c d e | f 0 1 2 | 3 4 5 6 | 7 8 9 a |
     * r13 : | 6 7 8 9 | a b c d | e f 0 1 | 2 3 4 5 ||| e f 0 1 | 2 3 4 5 | 6 7 8 9 | a b c d |
     * r14 : |         |         |         |         ||
     *                                                |
     */

    /*mul_shift.u8, r11[0, 7], r8, 1, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x6 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 1 | (1 << 16), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*mul_shift.u8, r11[8, 15], r9, 1, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(8, 15, (0x6 | (0x6 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 1 | (1 << 16), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*bitextract.u8, r12, r11, r11, c42; r11 >> 8*3 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(12, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 11, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 11, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 42, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*bitextract.u8, r13, r11, r11, c43; r11 >> 8*6 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 11, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 11, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 43, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*filter.max.u8 r8[0-7], r11, r12, r13; max set [0-7]*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x05, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 0x7 | (0x8 << 3), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 11, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 12, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*filter.min.u8 r9[0-7], r11, r12, r13; min set [0-7]*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x05, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 0x7 | (0x9 << 3), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 11, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 12, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*bitextract.u8, r11, r11, r11, c44; r11.xy <=> r11.zw*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 11, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 11, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 44, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*bitextract.u8, r13, r13, r13, c44; r13.xy <=> r13.zw*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 13, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 44, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));


    /*filter.max.u8 r8[8-15], r11, r12, r13; max set [8-15]*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x05, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(8, 15, 0x7 | (0x8 << 3), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 11, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 12, gcdVX_SWIZZLE4(2, 3, 0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*filter.min.u8 r9[8-15], r11, r12, r13; min set [8-15]*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x05, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(8, 15, 0x7 | (0x9 << 3), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 11, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 12, gcdVX_SWIZZLE4(2, 3, 0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*get min from max sets*/
    /*filter.min.u8[0, 7] r8, r8, r8.zw, r8;*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x05, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 0x7 | (0x9 << 3), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE4(2, 3, 2, 3), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*filter.min.u8[0, 3] r8, r8, r8.y, r8;*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x05, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 0x7 | (0x9 << 3), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*get max from min sets*/
    /*filter.max.u8[0, 7] r9, r9, r9.zw, r9;*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x05, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 0x7 | (0x8 << 3), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE4(2, 3, 2, 3), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*filter.max.u8[4, 7] r8, r9, r9.y, r9;*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x05, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(4, 7, 0x7 | (0x8 << 3), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*abs_diff.u8 r14.x, r8.x, r10.x; strength = abs(score_b(r8.x) - p(r10.x))*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x01, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*abs_diff.u8 r8.y, r10.x, r8.y; strength = abs(p(r10.x) - score_d(r8.y))*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x01, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(4, 4, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*mov.gt r4.x, r14.x, 8.y, 8.y; if(r14.x > r14.y)?r14.x = r14.y*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x01, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 8, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*iadd r14.x, r14.x, -1 ; strength = strength - 1*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x3 | (0x3 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0xffff, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _fast9corners_nonmax_suppression(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS                    status = gcvSTATUS_OK;
    gcoVX_Instructions   *Instructions  = Context->instructions;
    gctUINT32                         i = 0;
    gctBOOL                   do_nonmax = Context->col;
    RelOffset                    offset = {{ -1, 0 }};

    gcmHEADER_ARG("Context=0x%x", Context);

    /*
     * r1: |    y-1   |          |          |          |
     * r2: |     y    |          |          |          |
     * r3: |    y+1   |          |          |          |
     * r4: |     p    |          |          |          |
     * r5: | cmp(y-1) | cmp(y+1) |          |          |
     * r6: |   count  |    t/p   |     x    |     y    |
     * r7: |          |          |          |          |
     */

    /*mov r1, 0 ;zero r1 -> count*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));
    /*mov r2, 0 ;zero r2 -> count*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));
    /*mov r3, 0 ;zero r3 -> count*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

    for(i = 1; i < 4; i++)
    {
        offset.u.y = (gctUINT16)(i-2);

        /*img_load.u8 r1-3, c0, r0.xy, -1,i; */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(i, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset.raw, &Instructions->binarys[Instructions->count++]));
    }

    /*bitextract.u8, r4, r2.x, r2.y, c3; p load pixel*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    if(do_nonmax)
    {
        /*bitextract.u8, r1, r2.x, r2.y, c4; load (x-1,y)/r2[0] -> r3[3]*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        /*bitextract.u8, r3, r2.x, r2.y, c5; load (x+1,y)/r2[2] -> r1[3]*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 5, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        /*cmp r5.x, r4.x, r1.x, c6;  p >= r1*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x03, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 6, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /*cmp r5.y, r4.x, r3.x, c6;  p > r3 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x01, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 6, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /*cmp r4.x, r5.x, c6.x, r4.x;   */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x05, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 6, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /*cmp r4.x, r5.y, c6.y, r4.x;   */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x05, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 6, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    }

    /*img_store c1, r0.xy, r4.x; store point array; */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 8;

OnError:
    gcmFOOTER();
    return status;
}


static gceSTATUS _fast9corners_strength(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status                    = gcvSTATUS_OK;
    gcoVX_Instructions *Instructions    = Context->instructions;
    gctUINT32 k = 0, i = 0;
    gctBOOL do_nonmax = Context->constant_value;
    RelOffset offset                    = {{ -3, 0 }};

    gcmHEADER_ARG("Context=0x%x", Context);

    /* load 1-16 pixel, there are 26 instructions
    *       0   1   2   3   4   5   6   7   8   9   a   b   c   d   e   f
    * r1: |   |   | 16| 1 | 2 |   |   |   |   |   |   |   |   |   |   |   |
    * r2: |   | 15|   |   |   | 3 |   |   |   |   |   |   |   |   |   |   |
    * r3: | 14|   |   |   |   |   | 4 |   |   |   |   |   |   |   |   |   |
    * r4: | 13|   |   | p |   |   | 5 |   |   |   |   |   |   |   |   |   |
    * r5: | 12|   |   |   |   |   | 6 |   |   |   |   |   |   |   |   |   |
    * r6: |   | 11|   |   |   | 7 |   |   |   |   |   |   |   |   |   |   |
    * r7: |   |   | 10| 9 | 8 |   |   |   |   |   |   |   |   |   |   |   |
    *
    * r8: |   1   |   2   |   3   |   4   |   5   |   6   |   7   |   8   |
    * r9: |   9   |   a   |   b   |   c   |   d   |   e   |   f   |  16   |
    * ...
    *          x         y         z         w
    * r10:|       p       |       p       |       p       |       p       |
    * ...
    * r14:|    a     a    |    b     b    |    c     c    |    0     0    |
    */
    for(i = 1; i < 8; i++)
    {
        offset.u.y = (gctUINT16)(i-4);

        /*img_load.u8 r1-7, c0, r0.xy, -3,i*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(i, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset.raw, &Instructions->binarys[Instructions->count++]));
    }

    for(k = 0; k < Context->xstep; k++)
    {
        _fast9corners_load16pixels(Context, k);

        _fast9corners_iscorner(Context);

        if(do_nonmax)
        {
#if !FAST_NO_BRANCH
            gctUINT32 count = 18, flag = 0;
            /* branch.eq r0.z, 0, 13 */
            gcmONERROR(gcoHARDWAREVX_Branch(0x05, count + 1, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count++]));
            flag = Instructions->count;
#endif

            /* compute nonmax suppression stength, there are 7 instructions */
            _fast9corners_score(Context);
#if !FAST_NO_BRANCH
            flag = flag;
            gcmASSERT((Instructions->count - flag) == count);
#endif
        }
        /*mov.eq r14.x, r0.z, 0, 0 ;if(r0.z == 0)0 -> r14.x*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x05, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));

        /*iadd.s16.sat r15, r14.x, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(k, k, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE4(0, 0, 0, 0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    }

    /*img_store c1, r0.xy, r15.xy; store strength */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, Context->xstep - 1, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

    for(i = 1; i < 7; i++)
    {
        /*mov ri, r(i+1) ;*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(i, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, i+1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));
    }

    /* add.u32 r0.y, r0.y, 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1, &Instructions->binarys[Instructions->count++]));
    /*branch.lt r0.y, height + 1, loop */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, 6, 0x5, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, Context->volume + 1, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 16;

    assert(Instructions->count < 1536);
OnError:
    gcmFOOTER();

    return status;
}


static gceSTATUS _fast9corners(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
#define F9C_STRENGTH 0
#define F9C_NONMAX   1

    gceSTATUS status                    = gcvSTATUS_OK;
    gcoVX_Hardware_Step steps[] = {
        {0, "strength", F9C_STRENGTH, &_fast9corners_strength},
        {1, "nonmax suppression", F9C_NONMAX, &_fast9corners_nonmax_suppression},
    };

    gcmHEADER_ARG("Context=0x%x", Context);
    assert(Context->step < 2);

    gcmONERROR(steps[Context->step].func(Context));

OnError:
    gcmFOOTER();

    return status;
}

static gceSTATUS _harriscorners(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gcoVX_Instructions   *Instructions = Context->instructions;
    gctINT32 i, win = (gctINT16)(Context->volume/2), shift = 0;
    gctUINT32 j = 0, m, *index = Context->unifor_num, temp = 4;
    RelOffset offset                   = {{ -3, 0 }};

    gcmHEADER_ARG("Context=0x%x", Context);

    /*
     * r1 : |   lx   |   lx   |   lx   |   lx   |
     * r2 : |   ly   |   ly   |   ly   |   ly   |
     * r3 : |  temp  |  temp  |  temp  |  temp  |
     * r4 : |  s_x2  |  s_x2  |  s_x2  |  s_x2  |
     * r5 : |  s_y2  |  s_y2  |  s_y2  |  s_y2  |
     * r6 : |  s_xy  |  s_xy  |  s_xy  |  s_xy  |
     * r7 : | output | output | output | output |
     * r8 : |  s1_x2 |  s1_x2 |  s1_x2 |  s1_x2 |
     * r9 : |  s1_y2 |  s1_y2 |  s1_y2 |  s1_y2 |
     * r10: |  s1_xy |  s1_xy |  s1_xy |  s1_xy |
     */

    for(i = 0; i < 3; i++)
    {
        /*mov r.(temp+1+i), 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(temp + i, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));
    }

    for(j = 0; j < Context->xstep/2; j++)
    {
        if(Context->volume < 4)
        {
            /*mov r1.zw, 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));
        }

        offset.u.x = (gctINT16)(-win + 2*j);
        for(i = -win; i <= win; i++)
        {
            offset.u.y = (gctINT16)i;

            /*img_load.u8 r1, c0, r0.xy, -3,i*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, Context->volume, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset.raw, &Instructions->binarys[Instructions->count++]));

            /*img_load.u8 r2, c1, r0.xy, -3,i*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, Context->volume, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset.raw, &Instructions->binarys[Instructions->count++]));

            for(m = 0; m < 3; m++)
            {
                gcVXConfig config = {{0}};
                gctUINT32 p = 0, dst = 0, src0 = 0, src1 = 0, start = 0, end = start + 1;
                gctUINT32 output = 0x0;

                if(m == 0)
                {
                    dst     = temp;
                    src0    = 1;
                    src1    = temp;
                    start   =  2 * j;
                    end     = start + 1;
                }
                else if(m == 2)
                {
                    dst     = 6;
                    src0    = 1;
                    src1    = 2;
                    start   = 2*j;
                    end     = start + 1;
                }
                else
                {
                    dst     = temp + 1;
                    src0    = 2;
                    src1    = temp + 1;
                    start   = 2 * j;
                    end     = start + 1;
                }

                for(p = 0; p < 16; p++)
                {
                    config.matrix[p]        = 1;

                    config.termconfig[p]    = (p%8 < Context->volume)?VX_ADD:VX_DISABLE;

                    config.aselect[p]       = 0;
                    config.abin0[p%8]       =
                    config.abin1[p%8]       = p%8;

                    config.bselect[p]       = (m < 2)?0:1;
                    config.bbin0[p%8]       =
                    config.bbin1[p%8]       = p%8;
                }

                _SetUniformItemExt(index, 0, 0, 1, 1, shift, 0, &config, 0x2, &Context->uniform[*index]);

                /*dp8.u16 r.dst[0, 1], r1, r2, c4x */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x09, output, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(2, 3, (0x1 | (0x1 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, src0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, src1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++(*index)), &Instructions->binarys[Instructions->count++]));

                /*mul r7.zw, r7.zw, scale; sum_xy * scale * scale */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE4(2, 3, 2, 3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(1, Context->scale, &Instructions->binarys[Instructions->count++]));

                /*add r.dst[0, 1], r.dst[0, 1], r7.zw */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(dst, gcdVX_ENABLE2(start, end), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, dst, gcdVX_SWIZZLE4(start, end, start, end), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 7, gcdVX_SWIZZLE4(2, 3, 2, 3), 0, &Instructions->binarys[Instructions->count++]));
            }
        }
    }

    /************************************************************************************************************/
    /* compute det_A */
    /*mul r6.x, r6.x, r6.x; r6.x = sum_ixy * sum_ixy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*mad r7, r4, r5, -r6; det_A(r7) = sum_ix2 * sum_iy2 - sum_ixy * sum_ixy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE, gcvTRUE, &Instructions->binarys[Instructions->count++]));

    /* compute ktrace_A2 */
    /*add r4, r4, r5; trace_A(r4) = sum_ix2 + sum_iy2 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*mul r4, r4, r4; ktrace_A2(r4) = trace_A * trace_A */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*mul r4, r4, k; r4 = trace_A * k * trace_A */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(1, Context->factor, &Instructions->binarys[Instructions->count++]));

    /* compute M_c */
    /*add.sat r7, r7, r4; M_c(r7) = det_A(r7) - ktrace_A2(r4) */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, gcvTRUE, &Instructions->binarys[Instructions->count++]));

    /*cmp r7, r0.yyyy, c3, r7;  y > 3,else r7 = 0*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x03, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE4(1, 1, 1, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 3, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 7, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*cmp r7, r0.yyyy, c4, r7;  y < width - 3,else r7 = 0*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x04, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE4(1, 1, 1, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 4, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 7, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*cmp r7, r0.xxxx, c5, r7;  x > 3,else r7 = 0*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x03, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE4(0, 0, 0, 0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 5, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 7, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*cmp r7, r0.xxxx, c6, r7;  x < width - 3,else r7 = 0*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x04, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE4(0, 0, 0, 0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 6, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 7, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*img_store.u8 c2, r0.xy, r7 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_DisableDestination(&Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 8;

OnError:
    gcmFOOTER();

    return status;
}



static gceSTATUS _canny_nonmax_suppression(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS                    status = gcvSTATUS_OK;
    gcoVX_Instructions   *Instructions  = Context->instructions;
    RelOffset minusOne = {{ -1, -1 }};
    RelOffset zero = {{ -1, 0 }};
    RelOffset plusOne = {{ -1, 1 }};
    gctUINT32 flag[2];
    gctUINT32 Input1 = Context->input_type[0];
    gctUINT32 Input2 = Context->input_type[1];
    gctUINT32 Output = Context->output_type[0];
    gctUINT32 Height = Context->col;

    gcmHEADER_ARG("Context=0x%x", Context);

    /*mov r1, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0U, &Instructions->binarys[Instructions->count]));
    Instructions->count++;
    /*mov r2, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0U, &Instructions->binarys[Instructions->count]));
    Instructions->count++;
    /*mov r3, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0U, &Instructions->binarys[Instructions->count]));
    Instructions->count++;

    /*      Get MAG      */
    /*-------------------*/
    /*| r4.x| r4.y| r1.y|*/
    /*-------------------*/
    /*| r5.x| r5.y| r2.y|*/
    /*-------------------*/
    /*| r6.x| r6.y| r3.y|*/
    /*-------------------*/
    /*img_load.u8 r1, c0, r0.xy, -1,-1*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 2, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, minusOne.raw, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r2, c0, r0.xy, -1,0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 2, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, zero.raw, &Instructions->binarys[Instructions->count++]));
    flag[0] = Instructions->count;

    /*img_load.u8 r3, c0, r0.xy, -1,1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 2, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusOne.raw, &Instructions->binarys[Instructions->count++]));

    /*bitextract.u32 r4, r1.x, c3, 16;  c3 = [0, 16] */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 16U, &Instructions->binarys[Instructions->count]));
    Instructions->count++;
    /*bitextract.u32 r5, r2.x, c3, 16;  c3 = [0, 0x8, 0x10, 0x18] */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 16U, &Instructions->binarys[Instructions->count]));
    Instructions->count++;
    /*bitextract.u32 r6, r3.x, c3, 16;  c3 = [0, 0x8, 0x10, 0x18] */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 16U, &Instructions->binarys[Instructions->count]));
    Instructions->count++;

    /*Get ANG*/
    /*img_load.u8 r1, c1, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    Instructions->count++;
    /*bitextract.u32 r7, r1.x, c3, 16;  c3 = [0, 16] */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count]));
    Instructions->count++;
    /*add r7.x, r7.x, 16 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 16U, &Instructions->binarys[Instructions->count]));
    Instructions->count++;
    /* rshift r7.x, r7.x, 5 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 5, &Instructions->binarys[Instructions->count]));
    Instructions->count++;
    /* mod r7.x, r7.x, 4 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x48, 0, 0x6, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 4, &Instructions->binarys[Instructions->count]));
    Instructions->count++;

    /* branch.eq r7.x, 3, 6;  */
    gcmONERROR(gcoHARDWAREVX_Branch(0x05, 6, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 3, &Instructions->binarys[Instructions->count]));
    Instructions->count++;

    /* branch.eq r7.x, 2, 8;  */
    gcmONERROR(gcoHARDWAREVX_Branch(0x05, 8, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 2, &Instructions->binarys[Instructions->count]));
    Instructions->count++;

    /* branch.eq r7.x, 1, 10;  */
    gcmONERROR(gcoHARDWAREVX_Branch(0x05, 10, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 1, &Instructions->binarys[Instructions->count]));
    Instructions->count++;

    /*cmp r5.y to r5.x & r2.y*/
    /*cmp r5.y, r5.y, r5.x, r5.y;   */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x01, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /*cmp r8.x, r5.y, r2.y, r5.y;   */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x01, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /* branch.eq r8.x, r8.x, 9;  */
    gcmONERROR(gcoHARDWAREVX_Branch(0x05, 9, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    Instructions->count++;

    /*cmp r5.y to r4.x & r3.y*/
    /*cmp r5.y, r5.y, r4.x, r5.y;   */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x01, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /*cmp r8.x, r5.y, r3.y, r5.y;   */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x01, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /* branch.eq r8.x, r8.x, 6;  */
    gcmONERROR(gcoHARDWAREVX_Branch(0x05, 6, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    Instructions->count++;

    /*cmp r5.y to r4.y & r6.y*/
    /*cmp r5.y, r5.y, r4.y, r5.y;   */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x01, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /*cmp r8.x, r5.y, r6.y, r5.y;   */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x01, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 6, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /* branch.eq r8.x, r8.x, 3;  */
    gcmONERROR(gcoHARDWAREVX_Branch(0x05, 3, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    Instructions->count++;

    /*cmp r5.y to r6.x & r1.y*/
    /*cmp r5.y, r5.y, r6.x, r5.y;   */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x01, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 6, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /*cmp r8.x, r5.y, r1.y, r5.y;   */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x01, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*mov r1, r2 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    /*mov r2, r3 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    /*Store*/
    /*img_store.u8 r8.x, c2, r0.xy, r8.x */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, Output, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 8, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    Instructions->count++;

    /*add.u32 r0.yz, r0, 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE2(1, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

    /*branch.u32 r0.z, c3.y, flag0-curr */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, flag[0]-Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, Height, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 9;

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _element_wise_norm(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS                    status = gcvSTATUS_OK;
    gcoVX_Instructions   *Instructions  = Context->instructions;
    gctUINT32 Input1 = Context->input_type[0];
    gctUINT32 Input2 = Context->input_type[1];
    gctUINT32 Output = Context->output_type[0];

    gcmHEADER_ARG("Context=0x%x", Context);

    /*img_load.u8 r1, c0, r0.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input1), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    Instructions->count++;
    /*abs_diff.u8 r1, r1, 0*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x01, Input1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count]));
    Instructions->count++;

    /*img_load.u8 r2, c1, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input2), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    Instructions->count++;
    /*abs_diff.u8 r2, r2, 0*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x01, Input2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count]));
    Instructions->count++;
    /*add r1, r1, r2 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, Output, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    Instructions->count++;

    /*img_store.u8 r1, c2, r0.xy, r3*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, Output, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Output), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    Instructions->count++;


    Instructions->regs_count = 0x3;

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _euclidean_nonmax_suppression(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gctUINT32 InputType = Context->input_type[0];
    gctUINT32 src_width = Context->col;
    gctUINT32 src_height = Context->row;
    RelOffset offset00 = {{ -1, -1 }};
    RelOffset offset01 = {{ 0, -1 }};
    RelOffset offset02 = {{ 1, -1 }};
    RelOffset offset10 = {{ -1, 0 }};
    RelOffset offset12 = {{ 1, 0 }};
    RelOffset offset20 = {{ -1, 1 }};
    RelOffset offset21 = {{ 0, 1 }};
    RelOffset offset22 = {{ 1, 1 }};
    gcoVX_Instructions   *Instructions = Context->instructions;
    gctUINT32 stage1_end = 27 ;
    gctUINT32 stage1_add_y = 25 ;
    gctUINT32 reset_x_check_y = 1 ;
    gctUINT32 stage1_add_x = 23 ;
    gctUINT32 check_x = 3 ;
    gctUINT32 stage2_end = 62;
    gctUINT32 stage2_add_y = 60;
    gctUINT32 stage2_add_x = 58;
    gctUINT32 stage2_add_ry = 56;
    gctUINT32 stage2_add_rx = 54;
    gctUINT32 check_rx = 38;
    gctUINT32 check_ry = 35;
    gctUINT32 check_x1 = 30;
    gctUINT32 check_y1 = 28;
    gctUINT32 rx_not_0 = 49;


    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    /*0000: mov.u32                     r0.z, 0                            */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

    /*reset_x_check_y: 0001: branch.ge.u32                        r0.z, src_height, stage1_end              */
    gcmONERROR(gcoHARDWAREVX_Branch(0x03, stage1_end-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, src_height, &Instructions->binarys[Instructions->count++]));

    /*0002: mov.u32                     r0.y, 0                            */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

    /*check_x:  0003: branch.ge.s32                        r0.y, src_width, stage1_add_y                 */
    gcmONERROR(gcoHARDWAREVX_Branch(0x03, stage1_add_y-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, src_width, &Instructions->binarys[Instructions->count++]));

    /*0004: img_load.f32            r2.{0, 0}, c0, r0.yz, 0            */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(1, 2), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*0005: branch.lt.f32                        r2.x, threshold, stage1_add_x                 */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, stage1_add_x-Instructions->count, InputType, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(1, Context->scale, &Instructions->binarys[Instructions->count++]));

    /*0006: img_load.f32            r1, c0, r0.yz, offset00         */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(1, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset00.raw, &Instructions->binarys[Instructions->count++]));

    /*0007: branch.lt.f32                        r2.x, r1.x, stage1_add_x                 */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, stage1_add_x-Instructions->count, InputType, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

    /*0008: img_load.f32            r1, c0, r0.yz, offset01         */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(1, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset01.raw, &Instructions->binarys[Instructions->count++]));

     /*0009: branch.lt.f32                        r2.x, r1.x, stage1_add_x                 */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, stage1_add_x-Instructions->count, InputType, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

    /*0010: img_load.f32            r1, c0, r0.yz, offset02         */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(1, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset02.raw, &Instructions->binarys[Instructions->count++]));

     /*0011: branch.lt.f32                        r2.x, r1.x, stage1_add_x                 */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, stage1_add_x-Instructions->count, InputType, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

    /*0012: img_load.f32            r1, c0, r0.yz, offset10         */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(1, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset10.raw, &Instructions->binarys[Instructions->count++]));

     /*0013: branch.lt.f32                        r2.x, r1.x, stage1_add_x                 */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, stage1_add_x-Instructions->count, InputType, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

    /*0014: img_load.f32            r1, c0, r0.yz, offset12         */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(1, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset12.raw, &Instructions->binarys[Instructions->count++]));

     /*0015: branch.le.f32                        r2.x, r1.x, stage1_add_x                 */
    gcmONERROR(gcoHARDWAREVX_Branch(0x04, stage1_add_x-Instructions->count, InputType, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

    /*0016: img_load.f32            r1, c0, r0.yz, offset20         */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(1, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset20.raw, &Instructions->binarys[Instructions->count++]));

     /*0017: branch.le.f32                        r2.x, r1.x, stage1_add_x                 */
    gcmONERROR(gcoHARDWAREVX_Branch(0x04, stage1_add_x-Instructions->count, InputType, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

    /*0018: img_load.f32            r1, c0, r0.yz, offset21         */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(1, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset21.raw, &Instructions->binarys[Instructions->count++]));

     /*0019: branch.le.f32                        r2.x, r1.x, stage1_add_x                 */
    gcmONERROR(gcoHARDWAREVX_Branch(0x04, stage1_add_x-Instructions->count, InputType, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

    /*0020: img_load.f32            r1, c0, r0.yz, offset22        */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(1, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset22.raw, &Instructions->binarys[Instructions->count++]));

     /*0021: branch.le.f32                        r2.x, r1.x, stage1_add_x                 */
    gcmONERROR(gcoHARDWAREVX_Branch(0x04, stage1_add_x-Instructions->count, InputType, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

    /*0022: img_store.sat.skpHp.f32              c1, r0.yz, r2.x             */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(1, 2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

    /*stage1_add_x: 0023: add.s32                     r0.y, r0.y, 1                     */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(0, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*0024: branch.eq.f32                        r2.x, r2.x, check_x                 */
    gcmONERROR(gcoHARDWAREVX_Branch(0x05, check_x-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

    /*stage1_add_y: 0025: add.s32                     r0.z, r0.z, 1                     */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(0, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*0026: branch.eq.f32                        r0.z, r0.z, reset_x_check_y                 */
    gcmONERROR(gcoHARDWAREVX_Branch(0x05, reset_x_check_y-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));

    /*stage1_end: 0027: mov.u32                     r0.z, 0                            */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

    /*check_y1: 0028: branch.ge.u32                        r0.z, src_height, stage2_end              */
    gcmONERROR(gcoHARDWAREVX_Branch(0x03, stage2_end-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, src_height, &Instructions->binarys[Instructions->count++]));

    /*0029: mov.u32                     r0.y, 0                            */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

    /*check_x1:  0030: branch.ge.s32                        r0.y, src_width, stage2_add_y                 */
    gcmONERROR(gcoHARDWAREVX_Branch(0x03, stage2_add_y-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, src_width, &Instructions->binarys[Instructions->count++]));

    /*0031: img_load.f32            r1.{0, 0}, c1, r0.yz, 0            */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(1, 2), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*0032: branch.le.f32                        r1.x, 0, stage2_add_x                 */
    gcmONERROR(gcoHARDWAREVX_Branch(0x04, stage2_add_x-Instructions->count, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(1, (gctFLOAT)0, &Instructions->binarys[Instructions->count++]));

    /*reset_ry: 0033: mov.u32                     r7.y, r                            */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, Context->volume, &Instructions->binarys[Instructions->count++]));

    /*0034: add.u32                     r2.y, 0, -r7.y    */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(0, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 7, gcdVX_SWIZZLE1(1), NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));

    /*check_ry: 0035: branch.gt.u32                        r2.y, r, stage2_add_x              */
    gcmONERROR(gcoHARDWAREVX_Branch(0x01, stage2_add_x-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, Context->volume, &Instructions->binarys[Instructions->count++]));

    /*reset_rx: 0036: mov.u32                     r7.x, r                            */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, Context->volume, &Instructions->binarys[Instructions->count++]));

    /*0037: add.u32                     r2.x, 0, -r7.x    */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(0, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 7, gcdVX_SWIZZLE1(0), NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));

    /*check_rx: 0038: branch.gt.u32                        r2.x, r, stage2_add_ry              */
    gcmONERROR(gcoHARDWAREVX_Branch(0x01, stage2_add_ry-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, Context->volume, &Instructions->binarys[Instructions->count++]));

    /*0039: mul                         r3.x, r2.x, r2.x                */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*0040: mul                         r3.y, r2.y, r2.y                */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*0041: add.f32                     r3.w, r3.x, r3.y                 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*0042: i2f                     r3.w, r3.w                 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x2D, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count++]));

    /*0043: sqrt.f32 r3.w, r3.w   */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x21, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count++]));

    /*0044: branch.ge.f32                        r3.w, radius, stage2_add_rx                 */
    gcmONERROR(gcoHARDWAREVX_Branch(0x03, stage2_add_rx-Instructions->count, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(1, (gctFLOAT)Context->volume, &Instructions->binarys[Instructions->count++]));


    /*0045: add.s32                     r4.x, r2.x, r0.y                     */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*0046: add.s32                     r4.y, r2.y, r0.z                     */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*0047: branch.nq.f32                        r2.x, 0, rx_not_0                 */
    gcmONERROR(gcoHARDWAREVX_Branch(0x06, rx_not_0-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count++]));

    /*0048: branch.eq.f32                        r2.y, 0, stage2_add_rx                 */
    gcmONERROR(gcoHARDWAREVX_Branch(0x05, stage2_add_rx-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count++]));

    /*rx_not_0:  0049: img_load.f32            r5, c1, r4.xy, */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*0050: branch.gt.f32                        r1.x, r5.x, stage2_add_rx                 */
    gcmONERROR(gcoHARDWAREVX_Branch(0x01, stage2_add_rx-Instructions->count, InputType, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));


    /* 0051: mov.u32                     r6.x, 0                            */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, InputType, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(2, (gctFLOAT)0, &Instructions->binarys[Instructions->count++]));

    /*0052: img_store.sat.skpHp.f32              c1, r0.yz, r6.x             */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(1, 2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

    /*0053: branch.eq.f32                        r6.x, r6.x, stage2_add_x                 */
    gcmONERROR(gcoHARDWAREVX_Branch(0x05, stage2_add_x-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 6, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

    /*stage2_add_rx: 0054: add.s32                     r2.x, r2.x, 1                     */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(0, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*0055: branch.eq.f32                        r2.x, r2.x, check_rx                 */
    gcmONERROR(gcoHARDWAREVX_Branch(0x05, check_rx-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

    /*stage2_add_ry: 0056: add.s32                     r2.y, r2.y, 1                     */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(0, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*0057: branch.eq.f32                        r2.y, r2.y, check_ry                 */
    gcmONERROR(gcoHARDWAREVX_Branch(0x05, check_ry-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));

    /*stage2_add_x: 0058: add.s32                     r0.y, r0.y, 1                     */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(0, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*0059: branch.eq.f32                        r0.y, r0.y, check_x1                 */
    gcmONERROR(gcoHARDWAREVX_Branch(0x05, check_x1-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));

    /*stage2_add_y: 0060: add.s32                     r0.z, r0.z, 1                     */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(0, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*0061: branch.eq.f32                        r0.z, r0.z, check_y1                 */
    gcmONERROR(gcoHARDWAREVX_Branch(0x05, check_y1-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 0x08;

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _euclidean_nonmax_suppression_max(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS                    status = gcvSTATUS_OK;
    gcoVX_Instructions   *Instructions  = Context->instructions;
    RelOffset                    offset = {{ -1, 0 }};
    gctINT32                         i = 0;

    gcmHEADER_ARG("Context=0x%x", Context);

    /*
     * r0 :|         |         | point_x | point_c |
     * r1 :|    y    |    y    |    y    |    y    |
     * r2 :|   y-i   |   y-i   |   y-i   |   y-i   |
     * r3 :|   temp  |   temp  |   temp  |   temp  |
     */

    /*mov r0.z, 0;*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0U, &Instructions->binarys[Instructions->count++]));

    /*mov r4, c3;*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*img_load.u8 r1, c0, r0.xy, 0,0*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset.raw, &Instructions->binarys[Instructions->count++]));

    /* Checking threshold */
    /* branch.eq r1.y, threshold, ((1 + (Context->volume - 1)*2 + 1) + 1); r3.z(p) > threshold => out = 0 */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, (1 + (3 - 1)*2 + 1 + 5) + 1, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(1, Context->scale, &Instructions->binarys[Instructions->count++]));

    /************************ Get max ************************/
    /*cmp r3.xyz, r1.y, r1.xyz, r1.y;  p >= ri,else r1.y = 0*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x03, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE4(0, 1, 2, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    for(i = -1 ; i <= 1; i++)
    {
        if (i == 0)
            continue;

        offset.u.y = (gctUINT16)(i);
        /*img_load.u8 r2, c0, r0.xy, 0,0*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset.raw, &Instructions->binarys[Instructions->count++]));

        /*cmp r3.xyz, r1.y, r2.xyz, r3.xyz/r1.y;  p >= ri,else r1.x = 0*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x01, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE4(0, 1, 2, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));
    }

    /*branch.eq r3.xyz, r1.y, Instructions->count, 2; exit */
    gcmONERROR(gcoHARDWAREVX_BranchAny(0x06, 5 + 1, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, (Context->volume == 3)?gcdVX_SWIZZLE4(0, 1, 2, 2):gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /************************ store ppint to count and array start ************************/

    /*img_load.u8 r0.w, c2, 0, 0,0; load point count*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(6, 7, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count++]));

    /*atom_add c2, 0(r4), 1; point count inc */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x65, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count]));
    /*gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));*/
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

    /*img_store.[0,3] c1, r0.zw, r0.xy; store ; store (x,y) to points array*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

    /*add.u32 r0.z, r0.z, 4 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 4U, &Instructions->binarys[Instructions->count++]));

    /*img_store.[4,5] c1, r0.zw, r1.y, 2,0; store; store the point score */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(4, 5, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));

    /************************ store ppint to count and array end ************************/

    /*add.u32 r0.x, r0.x, 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

    /*branch.eq r0.x, c3.y(width), 0, 2; exit */
    gcmONERROR(gcoHARDWAREVX_BranchAny(0x02, 0, 0x5, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));

    /*mov r0.x, 0;*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0U, &Instructions->binarys[Instructions->count++]));

    /*add.u32 r0.y, r0.y, 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

    /*branch.eq r0.y, c3.z(height), 0, 2; exit */
    gcmONERROR(gcoHARDWAREVX_BranchAny(0x02, 0, 0x5, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));



    Instructions->regs_count = 5;

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _euclidean_nonmax_suppression_sort(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gcoVX_Instructions *Instructions  = Context->instructions;
    RelOffset offset = {{ 0, 0 }};
    gctUINT32 flag_loop = 0, flag_array = 0, flag1 = 0, flag2 = 0, flag3 = 0;

    gcmHEADER_ARG("Context=0x%x", Context);
    flag_loop = flag1 =
    flag2 = flag3;

    /*
     * r0 :|    x    |    y    |  index  |         |
     * r1 :| pre_max |  count  |   done  |         |
     * r2 :|  max_x  |  max_y  |  max_v  |         |
     * r3 :| input_x | input_y | input_v |         |
     * r4 :|         |         |         |         |
     */

    /*mov r1, c3; max value*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*img_load.u8 r1.z, c0, r1.xy, 0,0*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(2, 3, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

    /*mov r1.z(done), 0; zero r1.z(done)*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

    flag_array = Instructions->count;

    /*mov r0.z(index), 0; zero r0.z(index)*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

    /*mov r2, 0; zero r2*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

    flag_loop = Instructions->count;

    /*img_load.u8 r3, c1, r0.wz, 0,0*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(3, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset.raw, &Instructions->binarys[Instructions->count++]));

    flag1 = Instructions->count;
    /* find max start */
    /* branch.lt r3.z(input_v), r2.z(max_v), (3 + 1); r3.z(input_v) < r2.z(max_v) => out */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, 2 + 1, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    flag2 = Instructions->count;
    /* branch.gt r3.z(input_v), r1.x(pre_max), (2 + 1); r3.z(input_v) >= r1.x(pre_max) => out */
    gcmONERROR(gcoHARDWAREVX_Branch(0x03, 1 + 1, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*mov r2.xyz(max_x, max_y, max_z), r3.xyz(input_x, input_y, input_v); if (max_v < input_v < pre_max); get new current max: (x, y), value*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE3(0, 1, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*add.u32 r0.z, r0.z, 1; index ++ */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

    flag3 = Instructions->count;

    gcmASSERT(flag3 - flag1 == 4);
    gcmASSERT(flag3 - flag2 == 3);

    /*is current value done?*/
    /* branch.lt r0.z(index), r1.y(count), flag_loop; index < count => one loop */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, flag_loop, 0x5, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /* find max end */

    /*
     * r0 :|    x    |    y    |  index  |         |
     * r1 :| pre_max |  count  |   done  |  count  |
     * r2 :|  max_x  |  max_y  |  max_v  |         |
     * r3 :| input_x | input_y | input_v |         |
     * r4 :|         |         |         |         |
     */

    /*img_store.[0, 5] c2, r1.zw, r2, 2,0; store; max point position and value */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(3, 2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*mov r1.x(pre_max), r2.z(max_v); save current max to pre max*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*add.u32 r1.z(done), r1.z(done), 1; done ++ */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

    /* is all value done?*/
    /* branch.lt r1.z(done), r1.y(count, constant), flag_array; index < count => (one loop) */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, flag_array, 0x5, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 4;

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _euclidean_nonmax_suppression_nonmax(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS                    status = gcvSTATUS_OK;
    gcoVX_Instructions   *Instructions  = Context->instructions;
    gctINT32 i = 0, j = 0;

    gcmHEADER_ARG("Context=0x%x", Context);

    /*
     * r1 :| point_x | point_y | point_v |         |
     * r2 :|   y-i   |   y-i   |   y-i   |   y-i   |
     * r3 :|   temp  |   temp  |   temp  |   temp  |
     */

#define EXIT_FLAG 9341

    /*
     * r1 :| point_x | point_y | point_v |         |
     * r2 :|  x-i    |   y-j   |         |         |
     * r3 :|  x-30   |   y-30  |   x+30  |   y+30  |
     */
    /*mov r2, 0;*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

    /*img_load.u8 r0.z(count), c1, r0.ww, 0,0*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(4, 5, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(3, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

    /* branch.ge r0.y(index), r0.z(count), (EXIT_FLAG + 1); r0.y(index) >= r0.z(count) => exit */
    gcmONERROR(gcoHARDWAREVX_Branch(0x03, (EXIT_FLAG + 2 + 1), 0x5, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*img_load.u8 r1(point_x, point_y, point_v), c0, r0.xy, 0,0*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

    /*add.u32 r3, r1.xy, c3.yyxx(-30, -30, 30, 30); */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE4(0, 1, 0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE4(1, 1, 0, 0), gcvFALSE, &Instructions->binarys[Instructions->count++]));


    for (j = -30; j < 30; j ++)
    {
        /*add.u32 r3.x, r1.x, c3.y(-30); */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        for (i = -30; i < 30; i++)
        {
            if (!(i == 0 && j == 0))
            {
                if (sqrtf((gctFLOAT)((i * i) + (j * j))) < 30.0f)
                {

                    /*img_load.u8 r2.x, c2, r3.xy, 0,0*/
                    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

                    /* branch.ne r2.x, 0, exit;  */
                    gcmONERROR(gcoHARDWAREVX_Branch(0x06, (EXIT_FLAG + 1), 0x0, 0, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count++]));

                }
            }

            /*add.u32 r3.x, r3.x, 1*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1, &Instructions->binarys[Instructions->count++]));

        }

        /*add.u32 r3.y, r3.y, 1 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

    }

    /*img_store c2, r1.xy, r1.z; store */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));


    /*add.u32 r0.y, r0.y, 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

    /* branch.ge r0.y(index), r0.z(count), 0; r0.y(index) < r0.z(count) loop */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, 0, 0x5, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 4;

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _edge_trace_threshold(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS                    status = gcvSTATUS_OK;
    gcoVX_Instructions   *Instructions  = Context->instructions;
    gctUINT32 Input = Context->input_type[0];

    gcmHEADER_ARG("Context=0x%x", Context);

    /*img_load.u8 r1, c0, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    Instructions->count++;


    /*clamp.u8 r3, r1, c2.x(lower+1), c2.y(upper) */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0C, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (Input | (1 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count]));
    Instructions->count++;
    /*clamp.u8 r4, r1, c2.z(upper+1), c2.w(255) */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0C, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (Input | (1 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 2, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count]));
    Instructions->count++;
    /* rshift r3, r3, c3.x(15) */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    Instructions->count++;
    /* rshift r4, r4, c3.y(8) */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    Instructions->count++;
    /*add r3, r3, r4 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    Instructions->count++;
    /*mul_shift.u8, r2, r3, 1, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvTRUE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (Input | (Input << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, (1 | (1 << 16)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count]));
    Instructions->count++;

    /*img_store r2, c1, r0.xy, r2 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    Instructions->count++;

    Instructions->regs_count = 0x5;

    OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _edge_trace_hysteresis(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS                    status = gcvSTATUS_OK;
    gcoVX_Instructions   *Instructions  = Context->instructions;
    RelOffset minusOne = {{ -1, -1 }};
    RelOffset zero = {{ -1, 0 }};
    RelOffset plusOne = {{ -1, 1 }};
    gctUINT32 flag[2],i;
    gctUINT32 *index = Context->unifor_num;
    gcoVX_Kernel_Context_Uniform *Uinform = Context->uniform;
    gcVXConfig config = {{0}};
    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    for (i = 0; i < 14; i++)
    {
        config.termconfig[i] = VX_ADD;
        if(i < 8)
            config.abin0[i] = i + 1;
        else
            config.abin1[i%8] = i + 1;
        config.aselect[i] = 0;
        config.matrix[i] = 1;
    }

    _SetUniformItem(index, 0, 0, 0, 0, 0, gcvTRUE, &config, 0x7, &Uinform[*index]);

    /*mov r0.yz, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE2(1, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

    /*img_load.u8 r1, c0, r0.xy, -1,-1*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(0x7), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, minusOne.raw, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r2, c0, r0.xy, -1,0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(0x7), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, zero.raw, &Instructions->binarys[Instructions->count++]));
    flag[0] = Instructions->count;

    /*img_load.u8 r3, c0, r0.xy, -1,1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(0x7), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusOne.raw, &Instructions->binarys[Instructions->count++]));
    /*mov r8, r2 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    flag[1] = Instructions->count;

    /*mov r5, r2 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    /*filter.max.u8 r4, r1, r2, r3*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x05, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(1, 14, (0x7 | (0x8 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
    /*mul_shift.u8, r2, r2, r4, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvTRUE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(1, 8, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(1, &Instructions->binarys[Instructions->count++]));
    /*mul_shift.u8, r2, r2, r4, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvTRUE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(9, 14, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(9, &Instructions->binarys[Instructions->count++]));
    /* diff - IAdd.u8 r6, r2, -r5 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x4, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(1, 14, (0x4 | (0x4 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE, NEGATE_FLAG, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(1, &Instructions->binarys[Instructions->count++]));
    /*dp16.u8 r7, r6, 1, c4_512 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));

    /*branch.u32 r7.x, 0, flag1-curr */
    gcmONERROR(gcoHARDWAREVX_Branch(0x01, flag[1]-Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count++]));

    /* diff - IAdd.u8 r6, r2, -r8 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x4, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(1, 14, (0x4 | (0x4 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE, NEGATE_FLAG, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(1, &Instructions->binarys[Instructions->count++]));
    /*dp16.u8 r7, r6, 1, c4_512 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (*index), &Instructions->binarys[Instructions->count++]));

    /*atom_max c1, 0, r7.x */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x69, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 7, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));
    /*img_store r2, c0, r0.xy, r2 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(1, 14, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*mov r1, r2 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*mov r2, r3 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*add.u32 r0.yz, r0, 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE2(1, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

    /*branch.u32 r0.z, c2.y, flag0-curr */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, flag[0]-Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));

    /*barrier */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x2A, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    Context->hasBarrier = gcvTRUE;

    /*add.u32 r0.w, r0.w, 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));
    /*branch.u32 r0.w, 11, 2*/
    gcmONERROR(gcoHARDWAREVX_Branch(0x01, 2, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 11, &Instructions->binarys[Instructions->count++]));

    /*branch.u32 c1.x, 0, 0-curr */
    gcmONERROR(gcoHARDWAREVX_Branch(0x01, 0-Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count++]));
    /*mov r0.w, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 0x9;

    OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _edge_trace_hysteresis_vx2(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS                    status = gcvSTATUS_OK;
    gcoVX_Instructions   *Instructions  = Context->instructions;
    RelOffset minusOne = {{ -1, -1 }};
    RelOffset zero = {{ -1, 0 }};
    RelOffset plusOne = {{ -1, 1 }};
    gctUINT32 flag[2],i;
    gctUINT32 *index = Context->unifor_num;
    gcoVX_Kernel_Context_Uniform *Uinform = Context->uniform;
    gcVXConfig config = {{0}};
    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    for (i = 0; i < 14; i++)
    {
        config.termconfig[i] = VX_ACCUMULATOR;
        if(i < 8)
            config.abin0[i] = i + 1;
        else
            config.abin1[i%8] = i + 1;
        config.aselect[i] = 0;
        config.matrix[i] = 1;
    }

    _SetUniformItem(index, 0, 0, 0, 0, 0, gcvTRUE, &config, 0x7, &Uinform[*index]);

    /*mov r0.yz, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE2(1, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

    /*img_load.u8 r1, c0, r0.xy, -1,-1*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(0x7), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, minusOne.raw, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r2, c0, r0.xy, -1,0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(0x7), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, zero.raw, &Instructions->binarys[Instructions->count++]));
    flag[0] = Instructions->count;

    /*img_load.u8 r3, c0, r0.xy, -1,1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(0x7), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusOne.raw, &Instructions->binarys[Instructions->count++]));
    /*mov r8, r2 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    flag[1] = Instructions->count;

    /*mov r5, r2 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    /*vertMax3.u8, r4, r1, r2, r3 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x19, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
    /*horzMax3.u8, r4, r4 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x1C, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(1, 14, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
    /*mul_shift.u8, r2, r2, r4, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvTRUE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(1, 8, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(1, &Instructions->binarys[Instructions->count++]));
    /*mul_shift.u8, r2, r2, r4, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvTRUE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(9, 14, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(9, &Instructions->binarys[Instructions->count++]));
    /*add.u32 r6, r2, -r5 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE, NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));
    /*dp16.u8 r7, r6, 1, c4_512 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));


    /*branch.u32 r7.x, 0, flag1-curr */
    gcmONERROR(gcoHARDWAREVX_Branch(0x01, flag[1]-Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count++]));

    /*add.u32 r6, r2, -r8 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 8, gcdVX_SWIZZLE, NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));
    /*dp16.u8 r7, r6, 1, c4_512 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (*index), &Instructions->binarys[Instructions->count++]));

    /*atom_max c1, 0, r7.x */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x69, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 7, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));
    /*img_store r2, c0, r0.xy, r2 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(1, 14, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*mov r1, r2 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*mov r2, r3 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*add.u32 r0.yz, r0, 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE2(1, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

    /*branch.u32 r0.z, c2.y, flag0-curr */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, flag[0]-Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));

    /*barrier */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x2A, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    Context->hasBarrier = gcvTRUE;

    /*add.u32 r0.w, r0.w, 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));
    /*branch.u32 r0.w, 12, 2*/
    gcmONERROR(gcoHARDWAREVX_Branch(0x01, 2, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 12, &Instructions->binarys[Instructions->count++]));

    /*branch.u32 c1.x, 0, 0-curr */
    gcmONERROR(gcoHARDWAREVX_Branch(0x01, 0-Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count++]));
    /*mov r0.w, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 0x9;
    Context->hasAtomic = gcvTRUE;

    OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _edge_trace_clamp(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS                    status = gcvSTATUS_OK;
    gcoVX_Instructions   *Instructions  = Context->instructions;
    gcmHEADER_ARG("Context=0x%x", Context);

    /*img_load.u8 r1, c0, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    Instructions->count++;
    /* rshift r1, r1, c2.x(7) */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    Instructions->count++;
    /*mul_shift.u8, r1, r1, c2.y(255), 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count]));
    Instructions->count++;
    /*img_store r1, c1, r0.xy, r1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    Instructions->count++;

    Instructions->regs_count = 2;

    OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _edge_trace(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
#define ET_THRESHOLD 0
#define ET_HYST   1
#define ET_CLAMP   2

    gceSTATUS status                    = gcvSTATUS_OK;
    gcoVX_Hardware_Step steps[] = {
        {0, "threshold", ET_THRESHOLD, &_edge_trace_threshold},
        {1, "hysteresis", ET_HYST, &_edge_trace_hysteresis},
        {2, "clamp", ET_CLAMP, &_edge_trace_clamp},
    };

    gcmHEADER_ARG("Context=0x%x", Context);
    assert(Context->step < 3);

    gcmONERROR(steps[Context->step].func(Context));

OnError:
    gcmFOOTER();

    return status;
}

static gceSTATUS _img_lister_create(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gcoVX_Instructions *Instructions = Context->instructions;
    gceSTATUS                 status = gcvSTATUS_OK;
    gctUINT32                  Input = Context->input_type[0];
    gctUINT32 flag[2] = {0}, i, j;
    gctUINT32 offset = Context->volume;
    gctUINT32 offsetA = Context->clamp;
    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    /*mov r2, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0U, &Instructions->binarys[Instructions->count++]));
    /*mov r4, r0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /*mul r3.x, r0.y (row number), c3.x (width)  */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, offsetA, &Instructions->binarys[Instructions->count++]));

    if (Input == 0x0 || Input == 0x5 || Input == 0x2)
    {
        flag[0] = Instructions->count;
        /*img_load r1, c0, r4.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 4; i++)
        {
            if (Input == 0x0)
            {
                /*branch.u32 r1.x, 0f, 6 */
                gcmONERROR(gcoHARDWAREVX_Branch(0x04, 6, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(1, 0.0f, &Instructions->binarys[Instructions->count++]));
            }
            else
            {
                /*branch.u32 r1.x, 0, 6 */
                gcmONERROR(gcoHARDWAREVX_Branch(0x04, 6, Input, Instructions->count, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count++]));
            }
            gcmONERROR(gcoHARDWAREVX_Branch(0x03, 5, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));
            /*mov r4.z, r1.i */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
            /* store r4.xyz, c2, r3.x, r4*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE3(0, 1, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
            /*add.u32 r3.x, r3.x, offset */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset, &Instructions->binarys[Instructions->count++]));
            /*add.u32 r2.x, r2.x, 1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));
            /*add.u32 r4.x, r4.x, 1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));
        }
    }
    else if (Input == 0x7)
    {
        flag[0] = Instructions->count;
        /*img_load r1, c0, r4.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input), 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
        /*bitextract.u32 r5, r1.x, c4, 8;  c4 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));
        /*bitextract.u32 r6, r1.y, c4, 8;  c4 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));
        /*bitextract.u32 r7, r1.z, c4, 8;  c4 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));
        /*bitextract.u32 r8, r1.w, c4, 8;  c4 = [0, 0x8, 0x10, 0x18] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));
        for (i = 5; i < 9;i++)
        {
            /*conv.s32 ri ri u32 -> f32*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(i, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, i, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x5, &Instructions->binarys[Instructions->count++]));
            for (j = 0; j < 4; j++)
            {
                /*branch.u32 r5.x, 0, 9 */
                gcmONERROR(gcoHARDWAREVX_Branch(0x04, 9, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, i, gcdVX_SWIZZLE1(j), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(1, 0.0f, &Instructions->binarys[Instructions->count++]));
                gcmONERROR(gcoHARDWAREVX_Branch(0x02, 8, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 3, &Instructions->binarys[Instructions->count++]));
                gcmONERROR(gcoHARDWAREVX_Branch(0x02, 7, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 3, &Instructions->binarys[Instructions->count++]));
                gcmONERROR(gcoHARDWAREVX_Branch(0x03, 6, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(1, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
                gcmONERROR(gcoHARDWAREVX_Branch(0x03, 5, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(1, 3, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count++]));
                /*mov r4.z, ri.j */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, i, gcdVX_SWIZZLE1(j), gcvFALSE, &Instructions->binarys[Instructions->count++]));
                /* store r4.xyz, c2, r3.x, r4*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE3(0, 1, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
                /*add.u32 r3.x, r3.x, offset */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset, &Instructions->binarys[Instructions->count++]));
                /*add.u32 r2.x, r2.x, 1 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));
                /*add.u32 r4.x, r4.x, 1 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));
            }
        }
    }
    /*branch.u32 r4.x, c3.x(width), flag[0] - curr */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, (gctINT32)flag[0] - Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));
    /*save count to count img*/
    /*img_store r2.x, c1, r0.xy, r2.x */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x6, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));


    Instructions->regs_count = 9;


OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _img_lister_pack(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gcoVX_Instructions *Instructions = Context->instructions;
    gceSTATUS                 status = gcvSTATUS_OK;
    gctUINT32 flag[2];
    gctUINT32 offset = Context->volume;
    gctUINT32 offsetSrc = Context->clamp;
    gctUINT32 height = Context->col;
    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    /*mov r1, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0U, &Instructions->binarys[Instructions->count++]));
    /*mov r2, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0U, &Instructions->binarys[Instructions->count++]));
    /*mov r3, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0U, &Instructions->binarys[Instructions->count++]));
    /*mov r4, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0U, &Instructions->binarys[Instructions->count++]));
    /*mov r6, c4 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    flag[0] = Instructions->count;
    /*img_load r1.x, c0, r2.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x6, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
     /*add.u32 r3.x, r1.x, r3.x */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));
    /*add.u32 r2.y, r2.y, 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));
    /*branch.u32 r2.y, r0.y, flag[0] - curr */
    gcmONERROR(gcoHARDWAREVX_Branch(0x04, (gctINT32)flag[0] - Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));
    /*add.u32 r3.y, r3.x, -r1.x */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(0), NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));

    /*branch.u32 r1.x, 0, 8 */
    gcmONERROR(gcoHARDWAREVX_Branch(0x04, 9 + 2, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count++]));
    /*Compute src start offset*/
    /*mul r4.x, r0.y (row number), (width * itemsize)  */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, offsetSrc, &Instructions->binarys[Instructions->count++]));
    /*Compute dst start offset*/
    /*mul r4.y, r3.y (before number), itemsize  */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, offset, &Instructions->binarys[Instructions->count++]));

    flag[1] = Instructions->count;
    /* Skip when dst offset is large than cap size*/
    /*branch.u32 r4.y, c3.x(capSize), 6 */
    gcmONERROR(gcoHARDWAREVX_Branch(0x03, 6 + 2, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

    /* set (scale, orientation, tracking_status, error) as (0, 0, 1, 0), for ovx 1.1 start*/

    /*add.u32 r0.z, r4.y, 5 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 3*4, &Instructions->binarys[Instructions->count++]));

    /* store c2, r0.z, r6/1*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /* set (scale, orientation, tracking_status, error) as (0, 0, 1, 0), for ovx 1.1 end*/

    /* load r5.xyz, c1, r4.x */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE3(0, 1, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));
    /* store r5.xyz, c2, r4.y, r5*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE3(0, 1, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    /*add.u32 r4, r4, offset */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset, &Instructions->binarys[Instructions->count++]));
    /*add.u32 r3.z, r3.z, 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));
    /*branch.u32 r3.z, r1.x, flag[1] - curr */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, (gctINT32)flag[1] - Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

    /*branch.u32 r0.y, height - 1, 2 */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, 2, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, height - 1, &Instructions->binarys[Instructions->count++]));
    /*save total count num to img*/
    /*img_store r3.x, c0, r0.xy, r3.x */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x6, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 7;

    OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _img_lister(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
#define IMGLST_FIND 0
#define IMGLST_PACK 1

    gceSTATUS status                    = gcvSTATUS_OK;
    gcoVX_Hardware_Step steps[] = {
        {0, "create list", IMGLST_FIND, &_img_lister_create},
        {1, "pack array", IMGLST_PACK, &_img_lister_pack},
    };

    gcmHEADER_ARG("Context=0x%x", Context);
    assert(Context->step < 2);

    gcmONERROR(steps[Context->step].func(Context));

OnError:
    gcmFOOTER();

    return status;
}

static gceSTATUS _sobel_mxn(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gctUINT32 Border = Context->borders;
    gctINT16  *Matrix_x = Context->matrix;
    gctINT16  *Matrix_y = Context->matrix1;
    gctINT32  Col = Context->col;
    gctINT32  Row = Context->row;
    gctUINT32 Output = Context->output_type[0];
    gctUINT32 Scale = (gctUINT32)Context->scale;
    gctUINT32 Clamp = Context->clamp;
    gctUINT32 Xstep = Context->xstep;
    gcoVX_Kernel_Context_Uniform *Uinform = Context->uniform;
    gctUINT32 *index = Context->unifor_num;
    gctUINT32 Height = Context->volume;
    gctUINT32 flag = 0;
    gcoVX_Instructions *Instructions = Context->instructions;

    gctINT32 i = 0, j = 0, p = 0;
    RelOffset offset_index = {{0}};
    gctINT32 max = Col * Row - 1;

    gctUINT32 src0 = 1, src1 = 2, dst = 3;
    gctUINT32 start = 2, end = 3;           /*dest start and dest end*/
    gctINT32 offset0 = 0;                   /* the offset of src0 and the length of src0*/
    gctINT32 offset = 0;
    gctUINT32 count = (gctUINT32)ceil((max - 10)/7.0f) + 1;
    gctINT32 items = ((Row / 2 + 2 + Col) > 8) ? 1 : 2;

    gctBOOL f16_output = (Context->policy == VX_DF_IMAGE('F','0','1','6'))?gcvTRUE:gcvFALSE;

    gcmHEADER_ARG("Context=0x%x", Context);

    if(Row == 5 && Col == 5)items = 2;

    if(f16_output)
        Output = 0x1;

    if(max < 10) count = 1;

    offset_index.u.x = -(gctINT16)(Col/2);
    offset_index.u.y =  -(gctINT16)(Row/2);

    for (i = 0; i < Row; i ++)
    {
        if (i == Row - 1)
            flag = Instructions->count;
        if (Border == gcvVX_BORDER_MODE_CONSTANT || Border == gcvVX_BORDER_MODE_UNDEFINED)
        {
            /*mov r1, c3 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(i + 1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        }


        /*img_load.u8 r(i+1), c0, r0.xy, @-Col,+y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(i + 1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset_index.raw, &Instructions->binarys[Instructions->count++]));

        offset_index.u.y ++;
    }

    if (Row == 3 && Output != 0x1)
    {
        /*filter.sobelY.s16 r5, r1, r2, r3 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x05, 0x3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x3 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        /*img_store.s16 c2, r0.xy, r5*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < items; i++)
        {
            gctUINT32 k = 0;

            src0 = 1;
            src1 = 2;
            dst = Row + 1;
            start = 2;
            end = start + 1;    /*dest start and dest end*/
            offset0 = 0;        /* the offset of src0 and the length of src0*/
            offset = 0;

            for (k = 0; k < count; k++)
            {
                gcVXConfig config = {{0}};
                gctINT32 length0 = Col - offset0;
                gctINT32 length = (k > 0)?7:8;      /*valid length*/

                for (p = 0; p < 16; p++)
                       config.termconfig[p] = VX_ADD;

                /*non-first line, just use 15 bit*/
                if (k != 0)
                    config.termconfig[7] = config.termconfig[15] = VX_ACCUMULATOR;

                for (p = 0; p < 16; p++)
                {
                    config.matrix[p]   = (p%8 < 2 * Col) ? ((max - offset - p%8 >= 0)?Matrix_x[max - offset - p%8]:0) : 0;
                    config.aselect[p]  = (p%8 < length0) ? 0 : ((p%8 < 2 * Col)?1:0);
                }


                for (p = 0; p < 8; p++)
                {
                    config.abin0[p]    = (p < length0) ? (offset0 + p) : ((p < 2 * Col)?((Col < 4)?(p - Col):(p - length0)):0);
                    config.abin1[p]    = config.abin0[p];
                }

                if (k > 0)
                {
                    config.matrix[7] = config.matrix[15] = 0;
                    config.aselect[7] = config.aselect[15] = 0;

                    config.abin0[7] = 2;
                    config.abin1[7] = 3;
                }

                if (k < (count -1))
                {
                    if ((length - length0) >= Col)
                        dst = src1 + 1;
                    else
                        dst = src1;
                }
                else
                {
                    dst = Row + 1;
                    start = 2 * i;
                    end = start + 1;
                }

                _SetUniformItem(index, 2*i, 2*i, 2*i + 1, 2*i + 1, 0, gcvTRUE, &config, 0x5, &Uinform[*index]);

                /*dp8.u16 r2[6-7], r1, r2, c4_512 :selection for first dp8 pixels 0-1*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x09, 0x2, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(dst, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(start, end, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, src0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, src1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));

                if((length - length0) >= Col)
                {
                    src0 = src1 + 1;
                    src1 = src0 + 1;
                }
                else
                {
                    src0 = src1;
                    src1 = src0 + 1;
                }

                /* prepare next offset and length*/
                offset0 = ((7 - length0) > Col) ? 0 : ((7 - length0)%Col);
                offset += (2 * Col);

            }
        }

        for (j = 0; j < 1; j++)
        {
            gcVXConfig config = {{0}};

            for(p = 0; p < 16; p++)
                  config.termconfig[p] = VX_ADD;

            config.termconfig[3] = config.termconfig[7] = config.termconfig[11] = config.termconfig[15] = VX_ACCUMULATOR;

            for(p = 0; p < 16; p++)
            {
                config.matrix[p]   = (p%4 < Col) ? ((max - offset - p%4 >= 0)?Matrix_x[max - offset - p%4]:0) : 0;
                config.aselect[p]  = ((p + 1)%4 == 0)?1:0;
            }

            for (p = 0; p < 8; p++)
            {
                config.abin0[p]    = ((p + 1) % 4 == 0)?(p/4):(offset0 + p%4);
                config.abin1[p]    = ((p + 1) % 4 == 0)?(p/4 + 2):(offset0 + p%4);
            }

            _SetUniformItem(index, 4*j + 0, 4*j + 1, 4*j + 2, 4*j + 3, Scale, gcvTRUE, &config, 0x5, &Uinform[*index]);

            /*dp4.u8 r7[0-3], r6, r5, c28_512 :selection for last dp4 pixels 0-3 + r5[6,7];r4[6,7]*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0A, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(Row + 2, gcdVX_ENABLE, Clamp, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(4*j, 4*j + 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, Row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, Row + 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));
        }

        /*img_store.u8, r7[0-7], c1, r0.xy, r7*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, Output, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, Xstep - 1, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, Row + 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }
    else
    {
        for (i = 0; i < items; i++)
        {
            gctUINT32 k = 0;

            src0 = 1;
            src1 = 2;
            dst = Row + 1;
            start = 2;
            end = start + 1;    /*dest start and dest end*/
            offset0 = 0;        /* the offset of src0 and the length of src0*/
            offset = 0;

            for (k = 0; k < count; k++)
            {
                gcVXConfig config = {{0}};
                gctINT32 length0 = Col - offset0;
                gctINT32 length = (k > 0)?7:8;      /*valid length*/

                for (p = 0; p < 16; p++)
                       config.termconfig[p] = VX_ADD;

                /*non-first line, just use 15 bit*/
                if (k != 0)
                    config.termconfig[7] = config.termconfig[15] = VX_ACCUMULATOR;

                for (p = 0; p < 16; p++)
                {
                    config.matrix[p]   = (p%8 < 2 * Col) ? ((max - offset - p%8 >= 0)?Matrix_x[max - offset - p%8]:0) : 0;
                    config.aselect[p]  = (p%8 < length0) ? 0 : ((p%8 < 2 * Col)?1:0);
                }


                for (p = 0; p < 8; p++)
                {
                    config.abin0[p]    = (p < length0) ? (offset0 + p) : ((p < 2 * Col)?((Col < 4)?(p - Col):(p - length0)):0);
                    config.abin1[p]    = config.abin0[p];
                }

                if (k > 0)
                {
                    config.matrix[7] = config.matrix[15] = 0;
                    config.aselect[7] = config.aselect[15] = 0;

                    config.abin0[7] = 2;
                    config.abin1[7] = 3;
                }

                if (k < (count -1))
                {
                    if ((length - length0) >= Col)
                        dst = src1 + 1;
                    else
                        dst = src1;
                }
                else
                {
                    dst = Row + 1;
                    start = 2 * i;
                    end = start + 1;
                }

                _SetUniformItem(index, 2*i, 2*i, 2*i + 1, 2*i + 1, 0, gcvTRUE, &config, 0x2, &Uinform[*index]);

                /*dp8.u16 r2[6-7], r1, r2, c4_512 :selection for first dp8 pixels 0-1*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x09, 0x2, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(dst, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(start, end, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, src0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, src1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));

                if ((length - length0) >= Col)
                {
                    src0 = src1 + 1;
                    src1 = src0 + 1;
                }
                else
                {
                    src0 = src1;
                    src1 = src0 + 1;
                }

                /* prepare next offset and length*/
                offset0 = ((7 - length0) > Col) ? 0 : ((7 - length0)%Col);
                offset += (2 * Col < 7) ? (2 * Col) : 7;

                if (k == 0 && (Col > 4))
                {
                    offset ++;
                    offset0 ++;
                }
            }
        }

        for (j = 0; j < 1; j++)
        {
            gcVXConfig config = {{0}};

            for(p = 0; p < 16; p++)
                  config.termconfig[p] = VX_ADD;

            config.termconfig[3] = config.termconfig[7] = config.termconfig[11] = config.termconfig[15] = VX_ACCUMULATOR;

            for (p = 0; p < 16; p++)
            {
                config.matrix[p]   = (p%4 < Col) ? ((max - offset - p%4 >= 0)?Matrix_x[max - offset - p%4]:0) : 0;
                config.aselect[p]  = ((p + 1)%4 == 0)?1:0;
            }

            for (p = 0; p < 8; p++)
            {
                config.abin0[p]    = ((p + 1) % 4 == 0)?(p/4):(offset0 + p%4);
                config.abin1[p]    = ((p + 1) % 4 == 0)?(p/4 + 2):(offset0 + p%4);
            }

            _SetUniformItem(index, 4*j + 0, 4*j + 1, 4*j + 2, 4*j + 3, Scale, gcvTRUE, &config, 0x2, &Uinform[*index]);

            /*dp4.u8 r7[0-3], r6, r5, c28_512 :selection for last dp4 pixels 0-3 + r5[6,7];r4[6,7]*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0A, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(Row + 2, gcdVX_ENABLE, Clamp, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(4*j, 4*j + 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, Row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, Row + 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));
        }

        /*img_store.u8, r7[0-7], c1, r0.xy, r7*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, f16_output?0x3:Output, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, Xstep - 1, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, Row + 2, f16_output?gcdVX_SWIZZLE4(0,0,0,0):gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

        for (i = 0; i < items; i++)
        {
            gctUINT32 k = 0;

            src0 = 1;
            src1 = 2;
            dst = Row + 1;
            start = 2;
            end = start + 1;    /*dest start and dest end*/
            offset0 = 0;        /* the offset of src0 and the length of src0*/
            offset = 0;

            for (k = 0; k < count; k++)
            {
                gcVXConfig config = {{0}};
                gctINT32 length0 = Col - offset0;
                gctINT32 length = (k > 0)?7:8;      /*valid length*/

                for (p = 0; p < 16; p++)
                       config.termconfig[p] = VX_ADD;

                /*non-first line, just use 15 bit*/
                if (k != 0)
                    config.termconfig[7] = config.termconfig[15] = VX_ACCUMULATOR;

                for (p = 0; p < 16; p++)
                {
                    config.matrix[p]   = (p%8 < 2 * Col) ? ((max - offset - p%8 >= 0)?Matrix_y[max - offset - p%8]:0) : 0;
                    config.aselect[p]  = (p%8 < length0) ? 0 : ((p%8 < 2 * Col)?1:0);
                }


                for (p = 0; p < 8; p++)
                {
                    config.abin0[p]    = (p < length0) ? (offset0 + p) : ((p < 2 * Col)?((Col < 4)?(p - Col):(p - length0)):0);
                    config.abin1[p]    = config.abin0[p];
                }

                if (k > 0)
                {
                    config.matrix[7] = config.matrix[15] = 0;
                    config.aselect[7] = config.aselect[15] = 0;

                    config.abin0[7] = 2;
                    config.abin1[7] = 3;
                }

                if (k < (count -1))
                {
                    if ((length - length0) >= Col)
                        dst = src1 + 1;
                    else
                        dst = src1;
                }
                else
                {
                    dst = Row + 1;
                    start = 2 * i;
                    end = start + 1;
                }

                _SetUniformItem(index, 2*i, 2*i, 2*i + 1, 2*i + 1, 0, gcvTRUE, &config, 0x2, &Uinform[*index]);

                /*dp8.u16 r2[6-7], r1, r2, c4_512 :selection for first dp8 pixels 0-1*/
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x09, 0x2, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(dst, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(start, end, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, src0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, src1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));

                if ((length - length0) >= Col)
                {
                    src0 = src1 + 1;
                    src1 = src0 + 1;
                }
                else
                {
                    src0 = src1;
                    src1 = src0 + 1;
                }

                /* prepare next offset and length*/
                offset0 = ((7 - length0) > Col) ? 0 : ((7 - length0)%Col);
                offset += (2 * Col < 7) ? (2 * Col) : 7;

                if (k == 0 && (Col > 4))
                {
                    offset ++;
                    offset0 ++;
                }
            }
        }

        for (j = 0; j < 1; j++)
        {
            gcVXConfig config = {{0}};

            for (p = 0; p < 16; p++)
                  config.termconfig[p] = VX_ADD;

            config.termconfig[3] = config.termconfig[7] = config.termconfig[11] = config.termconfig[15] = VX_ACCUMULATOR;

            for (p = 0; p < 16; p++)
            {
                config.matrix[p]   = (p%4 < Col) ? ((max - offset - p%4 >= 0)?Matrix_y[max - offset - p%4]:0) : 0;
                config.aselect[p]  = ((p + 1)%4 == 0)?1:0;
            }

            for (p = 0; p < 8; p++)
            {
                config.abin0[p]    = ((p + 1) % 4 == 0)?(p/4):(offset0 + p%4);
                config.abin1[p]    = ((p + 1) % 4 == 0)?(p/4 + 2):(offset0 + p%4);
            }

            _SetUniformItem(index, 4*j + 0, 4*j + 1, 4*j + 2, 4*j + 3, Scale, gcvTRUE, &config, 0x2, &Uinform[*index]);

            /*dp4.u8 r7[0-3], r6, r5, c28_512 :selection for last dp4 pixels 0-3 + r5[6,7];r4[6,7]*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0A, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(Row + 2, gcdVX_ENABLE, Clamp, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(4*j, 4*j + 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, Row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, Row + 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));
        }

        /*img_store.u8, r7[0-7], c2, r0.xy, r7*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, f16_output?0x3:Output, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, Xstep - 1, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, Row + 2, f16_output?gcdVX_SWIZZLE4(0,0,0,0):gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }

    for (i = 1; i < Row; i ++)
    {
        /*mov ri, ri+1 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(i, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, i+1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }

    /*add.u32 r0.y, r0.y, 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

    /*branch.u32 r0.y, Height, flag0-curr */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, flag-Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, Height, &Instructions->binarys[Instructions->count++]));

     Instructions->regs_count = Row + 3;
OnError:

    gcmFOOTER();
    return status;
}

static gceSTATUS _sgm_cost(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;

    gcoVX_Instructions   *Instructions = Context->instructions;
    gctUINT32 Height = Context->row;
    gctUINT32 Size = Context->clamp;
    gctUINT32 rSize = Context->constant_value;
    gctUINT32 wSize = Context->policy;
    RelOffset minusTri = {{ -3, -3 }};
    RelOffset minusTwo = {{ -3, -2 }};
    RelOffset minusOne = {{ -3, -1 }};
    RelOffset zero = {{ -3, 0 }};
    RelOffset plusOne = {{ -3, 1 }};
    RelOffset plusTwo = {{ -3, 2 }};
    RelOffset plusTri = {{ -3, 3 }};
    gctUINT32 flag[2];
    gctUINT32 i = 0, j = 0;
    gctUINT32 *index = Context->unifor_num;
    gcoVX_Kernel_Context_Uniform *Uinform = Context->uniform;
    gcVXConfig config = {{0}};

    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    /*Get 7x7 left iamge*/
    /*img_load.u8 r1, c1, r0.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, minusTri.raw, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r2, c1, r0.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, minusTwo.raw, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r3, c1, r0.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, minusOne.raw, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r4, c1, r0.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, zero.raw, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r5, c1, r0.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusOne.raw, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r6, c1, r0.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusTwo.raw, &Instructions->binarys[Instructions->count++]));
    flag[0] = Instructions->count;
    /*img_load.u8 r7, c1, r0.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusTri.raw, &Instructions->binarys[Instructions->count++]));

    /*Load right image line1*/
    /*add r8.x, r0.x, -48 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r9, c0, r8.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, minusTri.raw, &Instructions->binarys[Instructions->count++]));
    /*add r8.x, r0.x, -32 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r10, c0, r8.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, minusTri.raw, &Instructions->binarys[Instructions->count++]));
    /*add r8.x, r0.x, -16 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r11, c0, r8.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, minusTri.raw, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r12, c0, r0.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(12, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, minusTri.raw, &Instructions->binarys[Instructions->count++]));

    /*mov r14, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));
    /*mov r15, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

    /* compute cost[j] for this row*/
    /* j = 0*/
    for (i = 0; i < 7; i++)
    {
        /*abs_diff.u8 r13, r1, r12*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x01, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 9, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 12, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
        /*IAdd.u16 r14, r14, r13 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
        /*IAdd.u16 r15, r15, r13 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(8, &Instructions->binarys[Instructions->count++]));
    }
    /*Get cost image address base*/
    /*mul r15.y, r8.y (row number), (width * itemSize * range)  */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, wSize, &Instructions->binarys[Instructions->count++]));
    /* mad r15.y, r8.x(col number), (itemSize * range), r15.y */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, rSize, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    for (i = 0; i < 10; i++)
    {
        /*add r15.z, r15.y, i * rSize */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, i * rSize, &Instructions->binarys[Instructions->count++]));
        /* load r15.w, c2, r15.z */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
        if (i < 8)
        {
            /*IAdd.u32 r15.w, r14, r15.w */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
        }
        else
        {
            /*IAdd.u32 r15.w, r15.x, r15.w */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(i - 8, &Instructions->binarys[Instructions->count++]));
        }
        /* store r5.w, c2, r15.z, r15*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }
    /*To get the shift bit right image data*/
    /* j = 1 ~ j = 16*/
    for (j = 1; j < 17; j++)
    {
        if (j < 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < j)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < 8)
                {
                    config.abin0[i] = i - j;
                    config.aselect[i] = 1;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else if (j == 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 8 + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - 8;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < j)
                {
                    config.abin1[i%8] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        _SetUniformItem(index, 0, 0, 0, 0, 0, gcvTRUE, &config, 0x7, &Uinform[*index]);
        /*dp16.u8 r16, r11, r12, c4_512 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x13, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 11, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 12, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 7; i++)
        {
            /*abs_diff.u8 r13, r1, r16*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x01, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 9, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r14, r14, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r15, r15, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(8, &Instructions->binarys[Instructions->count++]));
        }
        /*Get cost image address base*/
        /*mul r15.y, r8.y (row number), (width * itemSize * range)  */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, wSize, &Instructions->binarys[Instructions->count++]));
        /* mad r15.y, r8.x(col number), (itemSize * range), r15.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, rSize, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 10; i++)
        {
            /*add r15.z, r15.y, i * rSize + j * Size */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, i * rSize + j * Size, &Instructions->binarys[Instructions->count++]));
            /* load r15.w, c2, r15.z */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
            if (i < 8)
            {
                /*IAdd.u32 r15.w, r14, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            }
            else
            {
                /*IAdd.u32 r15.w, r15.x, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i - 8, &Instructions->binarys[Instructions->count++]));
            }
            /* store r5.w, c2, r15.z, r15*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        }
    }
    /* j = 17 ~ j = 32*/
    for (j = 1; j < 17; j++)
    {
        if (j < 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < j)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < 8)
                {
                    config.abin0[i] = i - j;
                    config.aselect[i] = 1;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else if (j == 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 8 + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - 8;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < j)
                {
                    config.abin1[i%8] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        _SetUniformItem(index, 0, 0, 0, 0, 0, gcvTRUE, &config, 0x7, &Uinform[*index]);
        /*dp16.u8 r16, r10, r11, c4_512 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x13, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 11, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 7; i++)
        {
            /*abs_diff.u8 r13, r1, r16*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x01, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 9, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r14, r14, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r15, r15, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(8, &Instructions->binarys[Instructions->count++]));
        }
        /*Get cost image address base*/
        /*mul r15.y, r8.y (row number), (width * itemSize * range)  */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, wSize, &Instructions->binarys[Instructions->count++]));
        /* mad r15.y, r8.x(col number), (itemSize * range), r15.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, rSize, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 10; i++)
        {
            /*add r15.z, r15.y, i * rSize + (j + 16) * Size */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, i * rSize + (j + 16) * Size, &Instructions->binarys[Instructions->count++]));
            /* load r15.w, c2, r15.z */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
            if (i < 8)
            {
                /*IAdd.u32 r15.w, r14, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            }
            else
            {
                /*IAdd.u32 r15.w, r15.x, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i - 8, &Instructions->binarys[Instructions->count++]));
            }
            /* store r5.w, c2, r15.z, r15*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        }
    }

    /* j = 33 ~ j = 47*/
    for (j = 1; j < 16; j++)
    {
        if (j < 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < j)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < 8)
                {
                    config.abin0[i] = i - j;
                    config.aselect[i] = 1;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else if (j == 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 8 + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - 8;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < j)
                {
                    config.abin1[i%8] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        _SetUniformItem(index, 0, 0, 0, 0, 0, gcvTRUE, &config, 0x7, &Uinform[*index]);
        /*dp16.u8 r16, r9, r10, c4_512 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x13, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 7; i++)
        {
            /*abs_diff.u8 r13, r1, r16*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x01, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 9, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r14, r14, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r15, r15, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(8, &Instructions->binarys[Instructions->count++]));
        }
        /*Get cost image address base*/
        /*mul r15.y, r8.y (row number), (width * itemSize * range)  */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, wSize, &Instructions->binarys[Instructions->count++]));
        /* mad r15.y, r8.x(col number), (itemSize * range), r15.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, rSize, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 10; i++)
        {
            /*add r15.z, r15.y, i * rSize + (j + 32) * Size */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, i * rSize + (j + 32) * Size, &Instructions->binarys[Instructions->count++]));
            /* load r15.w, c2, r15.z */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
            if (i < 8)
            {
                /*IAdd.u32 r15.w, r14, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            }
            else
            {
                /*IAdd.u32 r15.w, r15.x, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i - 8, &Instructions->binarys[Instructions->count++]));
            }
            /* store r5.w, c2, r15.z, r15*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        }
    }


    /*Load right image line2*/
    /*add r8.x, r0.x, -48 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r9, c0, r8.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, minusTwo.raw, &Instructions->binarys[Instructions->count++]));
    /*add r8.x, r0.x, -32 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r10, c0, r8.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, minusTwo.raw, &Instructions->binarys[Instructions->count++]));
    /*add r8.x, r0.x, -16 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r11, c0, r8.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, minusTwo.raw, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r12, c0, r0.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(12, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, minusTwo.raw, &Instructions->binarys[Instructions->count++]));

    /* compute cost[j] for this row*/
    /* j = 0*/
    for (i = 0; i < 7; i++)
    {
        /*abs_diff.u8 r13, r2, r12*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x01, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 9, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 12, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
        /*IAdd.u16 r14, r14, r13 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
        /*IAdd.u16 r15, r15, r13 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(8, &Instructions->binarys[Instructions->count++]));
    }
    /*Get cost image address base*/
    /*mul r15.y, r8.y (row number), (width * itemSize * range)  */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, wSize, &Instructions->binarys[Instructions->count++]));
    /* mad r15.y, r8.x(col number), (itemSize * range), r15.y */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, rSize, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    for (i = 0; i < 10; i++)
    {
        /*add r15.z, r15.y, i * rSize */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, i * rSize, &Instructions->binarys[Instructions->count++]));
        /* load r15.w, c2, r15.z */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
        if (i < 8)
        {
            /*IAdd.u32 r15.w, r14, r15.w */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
        }
        else
        {
            /*IAdd.u32 r15.w, r15.x, r15.w */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(i - 8, &Instructions->binarys[Instructions->count++]));
        }
        /* store r5.w, c2, r15.z, r15*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }
    /*To get the shift bit right image data*/
    /* j = 1 ~ j = 16*/
    for (j = 1; j < 17; j++)
    {
        if (j < 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < j)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < 8)
                {
                    config.abin0[i] = i - j;
                    config.aselect[i] = 1;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else if (j == 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 8 + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - 8;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < j)
                {
                    config.abin1[i%8] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        _SetUniformItem(index, 0, 0, 0, 0, 0, gcvTRUE, &config, 0x7, &Uinform[*index]);
        /*dp16.u8 r16, r11, r12, c4_512 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x13, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 11, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 12, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 7; i++)
        {
            /*abs_diff.u8 r13, r2, r16*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x01, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 9, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r14, r14, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r15, r15, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(8, &Instructions->binarys[Instructions->count++]));
        }
        /*Get cost image address base*/
        /*mul r15.y, r8.y (row number), (width * itemSize * range)  */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, wSize, &Instructions->binarys[Instructions->count++]));
        /* mad r15.y, r8.x(col number), (itemSize * range), r15.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, rSize, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 10; i++)
        {
            /*add r15.z, r15.y, i * rSize + j * Size */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, i * rSize + j * Size, &Instructions->binarys[Instructions->count++]));
            /* load r15.w, c2, r15.z */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
            if (i < 8)
            {
                /*IAdd.u32 r15.w, r14, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            }
            else
            {
                /*IAdd.u32 r15.w, r15.x, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i - 8, &Instructions->binarys[Instructions->count++]));
            }
            /* store r5.w, c2, r15.z, r15*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        }
    }
    /* j = 17 ~ j = 32*/
    for (j = 1; j < 17; j++)
    {
        if (j < 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < j)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < 8)
                {
                    config.abin0[i] = i - j;
                    config.aselect[i] = 1;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else if (j == 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 8 + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - 8;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < j)
                {
                    config.abin1[i%8] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        _SetUniformItem(index, 0, 0, 0, 0, 0, gcvTRUE, &config, 0x7, &Uinform[*index]);
        /*dp16.u8 r16, r10, r11, c4_512 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x13, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 11, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 7; i++)
        {
            /*abs_diff.u8 r13, r2, r16*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x01, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 9, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r14, r14, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r15, r15, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(8, &Instructions->binarys[Instructions->count++]));
        }
        /*Get cost image address base*/
        /*mul r15.y, r8.y (row number), (width * itemSize * range)  */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, wSize, &Instructions->binarys[Instructions->count++]));
        /* mad r15.y, r8.x(col number), (itemSize * range), r15.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, rSize, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 10; i++)
        {
            /*add r15.z, r15.y, i * rSize + (j + 16) * Size */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, i * rSize + (j + 16) * Size, &Instructions->binarys[Instructions->count++]));
            /* load r15.w, c2, r15.z */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
            if (i < 8)
            {
                /*IAdd.u32 r15.w, r14, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            }
            else
            {
                /*IAdd.u32 r15.w, r15.x, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i - 8, &Instructions->binarys[Instructions->count++]));
            }
            /* store r5.w, c2, r15.z, r15*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        }
    }

    /* j = 33 ~ j = 47*/
    for (j = 1; j < 16; j++)
    {
        if (j < 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < j)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < 8)
                {
                    config.abin0[i] = i - j;
                    config.aselect[i] = 1;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else if (j == 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 8 + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - 8;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < j)
                {
                    config.abin1[i%8] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        _SetUniformItem(index, 0, 0, 0, 0, 0, gcvTRUE, &config, 0x7, &Uinform[*index]);
        /*dp16.u8 r16, r9, r10, c4_512 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x13, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 7; i++)
        {
            /*abs_diff.u8 r13, r2, r16*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x01, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 9, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r14, r14, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r15, r15, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(8, &Instructions->binarys[Instructions->count++]));
        }
        /*Get cost image address base*/
        /*mul r15.y, r8.y (row number), (width * itemSize * range)  */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, wSize, &Instructions->binarys[Instructions->count++]));
        /* mad r15.y, r8.x(col number), (itemSize * range), r15.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, rSize, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 10; i++)
        {
            /*add r15.z, r15.y, i * rSize + (j + 32) * Size */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, i * rSize + (j + 32) * Size, &Instructions->binarys[Instructions->count++]));
            /* load r15.w, c2, r15.z */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
            if (i < 8)
            {
                /*IAdd.u32 r15.w, r14, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            }
            else
            {
                /*IAdd.u32 r15.w, r15.x, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i - 8, &Instructions->binarys[Instructions->count++]));
            }
            /* store r5.w, c2, r15.z, r15*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        }
    }


    /*Load right image line3*/
    /*add r8.x, r0.x, -48 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r9, c0, r8.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, minusOne.raw, &Instructions->binarys[Instructions->count++]));
    /*add r8.x, r0.x, -32 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r10, c0, r8.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, minusOne.raw, &Instructions->binarys[Instructions->count++]));
    /*add r8.x, r0.x, -16 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r11, c0, r8.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, minusOne.raw, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r12, c0, r0.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(12, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, minusOne.raw, &Instructions->binarys[Instructions->count++]));

    /* compute cost[j] for this row*/
    /* j = 0*/
    for (i = 0; i < 7; i++)
    {
        /*abs_diff.u8 r13, r3, r12*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x01, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 9, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 12, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
        /*IAdd.u16 r14, r14, r13 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
        /*IAdd.u16 r15, r15, r13 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(8, &Instructions->binarys[Instructions->count++]));
    }
    /*Get cost image address base*/
    /*mul r15.y, r8.y (row number), (width * itemSize * range)  */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, wSize, &Instructions->binarys[Instructions->count++]));
    /* mad r15.y, r8.x(col number), (itemSize * range), r15.y */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, rSize, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    for (i = 0; i < 10; i++)
    {
        /*add r15.z, r15.y, i * rSize */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, i * rSize, &Instructions->binarys[Instructions->count++]));
        /* load r15.w, c2, r15.z */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
        if (i < 8)
        {
            /*IAdd.u32 r15.w, r14, r15.w */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
        }
        else
        {
            /*IAdd.u32 r15.w, r15.x, r15.w */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(i - 8, &Instructions->binarys[Instructions->count++]));
        }
        /* store r5.w, c2, r15.z, r15*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }
    /*To get the shift bit right image data*/
    /* j = 1 ~ j = 16*/
    for (j = 1; j < 17; j++)
    {
        if (j < 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < j)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < 8)
                {
                    config.abin0[i] = i - j;
                    config.aselect[i] = 1;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else if (j == 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 8 + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - 8;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < j)
                {
                    config.abin1[i%8] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        _SetUniformItem(index, 0, 0, 0, 0, 0, gcvTRUE, &config, 0x7, &Uinform[*index]);
        /*dp16.u8 r16, r11, r12, c4_512 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x13, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 11, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 12, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 7; i++)
        {
            /*abs_diff.u8 r13, r3, r16*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x01, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 9, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r14, r14, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r15, r15, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(8, &Instructions->binarys[Instructions->count++]));
        }
        /*Get cost image address base*/
        /*mul r15.y, r8.y (row number), (width * itemSize * range)  */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, wSize, &Instructions->binarys[Instructions->count++]));
        /* mad r15.y, r8.x(col number), (itemSize * range), r15.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, rSize, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 10; i++)
        {
            /*add r15.z, r15.y, i * rSize + j * Size */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, i * rSize + j * Size, &Instructions->binarys[Instructions->count++]));
            /* load r15.w, c2, r15.z */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
            if (i < 8)
            {
                /*IAdd.u32 r15.w, r14, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            }
            else
            {
                /*IAdd.u32 r15.w, r15.x, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i - 8, &Instructions->binarys[Instructions->count++]));
            }
            /* store r5.w, c2, r15.z, r15*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        }
    }
    /* j = 17 ~ j = 32*/
    for (j = 1; j < 17; j++)
    {
        if (j < 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < j)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < 8)
                {
                    config.abin0[i] = i - j;
                    config.aselect[i] = 1;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else if (j == 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 8 + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - 8;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < j)
                {
                    config.abin1[i%8] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        _SetUniformItem(index, 0, 0, 0, 0, 0, gcvTRUE, &config, 0x7, &Uinform[*index]);
        /*dp16.u8 r16, r10, r11, c4_512 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x13, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 11, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 7; i++)
        {
            /*abs_diff.u8 r13, r3, r16*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x01, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 9, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r14, r14, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r15, r15, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(8, &Instructions->binarys[Instructions->count++]));
        }
        /*Get cost image address base*/
        /*mul r15.y, r8.y (row number), (width * itemSize * range)  */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, wSize, &Instructions->binarys[Instructions->count++]));
        /* mad r15.y, r8.x(col number), (itemSize * range), r15.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, rSize, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 10; i++)
        {
            /*add r15.z, r15.y, i * rSize + (j + 16) * Size */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, i * rSize + (j + 16) * Size, &Instructions->binarys[Instructions->count++]));
            /* load r15.w, c2, r15.z */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
            if (i < 8)
            {
                /*IAdd.u32 r15.w, r14, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            }
            else
            {
                /*IAdd.u32 r15.w, r15.x, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i - 8, &Instructions->binarys[Instructions->count++]));
            }
            /* store r5.w, c2, r15.z, r15*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        }
    }

    /* j = 33 ~ j = 47*/
    for (j = 1; j < 16; j++)
    {
        if (j < 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < j)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < 8)
                {
                    config.abin0[i] = i - j;
                    config.aselect[i] = 1;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else if (j == 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 8 + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - 8;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < j)
                {
                    config.abin1[i%8] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        _SetUniformItem(index, 0, 0, 0, 0, 0, gcvTRUE, &config, 0x7, &Uinform[*index]);
        /*dp16.u8 r16, r9, r10, c4_512 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x13, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 7; i++)
        {
            /*abs_diff.u8 r13, r3, r16*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x01, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 9, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r14, r14, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r15, r15, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(8, &Instructions->binarys[Instructions->count++]));
        }
        /*Get cost image address base*/
        /*mul r15.y, r8.y (row number), (width * itemSize * range)  */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, wSize, &Instructions->binarys[Instructions->count++]));
        /* mad r15.y, r8.x(col number), (itemSize * range), r15.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, rSize, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 10; i++)
        {
            /*add r15.z, r15.y, i * rSize + (j + 32) * Size */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, i * rSize + (j + 32) * Size, &Instructions->binarys[Instructions->count++]));
            /* load r15.w, c2, r15.z */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
            if (i < 8)
            {
                /*IAdd.u32 r15.w, r14, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            }
            else
            {
                /*IAdd.u32 r15.w, r15.x, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i - 8, &Instructions->binarys[Instructions->count++]));
            }
            /* store r5.w, c2, r15.z, r15*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        }
    }


    /*Load right image line4*/
    /*add r8.x, r0.x, -48 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r9, c0, r8.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, zero.raw, &Instructions->binarys[Instructions->count++]));
    /*add r8.x, r0.x, -32 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r10, c0, r8.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, zero.raw, &Instructions->binarys[Instructions->count++]));
    /*add r8.x, r0.x, -16 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r11, c0, r8.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, zero.raw, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r12, c0, r0.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(12, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, zero.raw, &Instructions->binarys[Instructions->count++]));

    /* compute cost[j] for this row*/
    /* j = 0*/
    for (i = 0; i < 7; i++)
    {
        /*abs_diff.u8 r13, r4, r12*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x01, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 9, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 12, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
        /*IAdd.u16 r14, r14, r13 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
        /*IAdd.u16 r15, r15, r13 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(8, &Instructions->binarys[Instructions->count++]));
    }
    /*Get cost image address base*/
    /*mul r15.y, r8.y (row number), (width * itemSize * range)  */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, wSize, &Instructions->binarys[Instructions->count++]));
    /* mad r15.y, r8.x(col number), (itemSize * range), r15.y */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, rSize, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    for (i = 0; i < 10; i++)
    {
        /*add r15.z, r15.y, i * rSize */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, i * rSize, &Instructions->binarys[Instructions->count++]));
        /* load r15.w, c2, r15.z */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
        if (i < 8)
        {
            /*IAdd.u32 r15.w, r14, r15.w */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
        }
        else
        {
            /*IAdd.u32 r15.w, r15.x, r15.w */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(i - 8, &Instructions->binarys[Instructions->count++]));
        }
        /* store r5.w, c2, r15.z, r15*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }
    /*To get the shift bit right image data*/
    /* j = 1 ~ j = 16*/
    for (j = 1; j < 17; j++)
    {
        if (j < 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < j)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < 8)
                {
                    config.abin0[i] = i - j;
                    config.aselect[i] = 1;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else if (j == 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 8 + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - 8;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < j)
                {
                    config.abin1[i%8] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        _SetUniformItem(index, 0, 0, 0, 0, 0, gcvTRUE, &config, 0x7, &Uinform[*index]);
        /*dp16.u8 r16, r11, r12, c4_512 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x13, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 11, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 12, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 7; i++)
        {
            /*abs_diff.u8 r13, r4, r16*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x01, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 9, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r14, r14, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r15, r15, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(8, &Instructions->binarys[Instructions->count++]));
        }
        /*Get cost image address base*/
        /*mul r15.y, r8.y (row number), (width * itemSize * range)  */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, wSize, &Instructions->binarys[Instructions->count++]));
        /* mad r15.y, r8.x(col number), (itemSize * range), r15.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, rSize, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 10; i++)
        {
            /*add r15.z, r15.y, i * rSize + j * Size */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, i * rSize + j * Size, &Instructions->binarys[Instructions->count++]));
            /* load r15.w, c2, r15.z */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
            if (i < 8)
            {
                /*IAdd.u32 r15.w, r14, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            }
            else
            {
                /*IAdd.u32 r15.w, r15.x, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i - 8, &Instructions->binarys[Instructions->count++]));
            }
            /* store r5.w, c2, r15.z, r15*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        }
    }
    /* j = 17 ~ j = 32*/
    for (j = 1; j < 17; j++)
    {
        if (j < 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < j)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < 8)
                {
                    config.abin0[i] = i - j;
                    config.aselect[i] = 1;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else if (j == 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 8 + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - 8;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < j)
                {
                    config.abin1[i%8] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        _SetUniformItem(index, 0, 0, 0, 0, 0, gcvTRUE, &config, 0x7, &Uinform[*index]);
        /*dp16.u8 r16, r10, r11, c4_512 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x13, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 11, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 7; i++)
        {
            /*abs_diff.u8 r13, r4, r16*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x01, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 9, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r14, r14, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r15, r15, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(8, &Instructions->binarys[Instructions->count++]));
        }
        /*Get cost image address base*/
        /*mul r15.y, r8.y (row number), (width * itemSize * range)  */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, wSize, &Instructions->binarys[Instructions->count++]));
        /* mad r15.y, r8.x(col number), (itemSize * range), r15.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, rSize, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 10; i++)
        {
            /*add r15.z, r15.y, i * rSize + (j + 16) * Size */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, i * rSize + (j + 16) * Size, &Instructions->binarys[Instructions->count++]));
            /* load r15.w, c2, r15.z */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
            if (i < 8)
            {
                /*IAdd.u32 r15.w, r14, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            }
            else
            {
                /*IAdd.u32 r15.w, r15.x, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i - 8, &Instructions->binarys[Instructions->count++]));
            }
            /* store r5.w, c2, r15.z, r15*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        }
    }

    /* j = 33 ~ j = 47*/
    for (j = 1; j < 16; j++)
    {
        if (j < 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < j)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < 8)
                {
                    config.abin0[i] = i - j;
                    config.aselect[i] = 1;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else if (j == 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 8 + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - 8;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < j)
                {
                    config.abin1[i%8] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        _SetUniformItem(index, 0, 0, 0, 0, 0, gcvTRUE, &config, 0x7, &Uinform[*index]);
        /*dp16.u8 r16, r9, r10, c4_512 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x13, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 7; i++)
        {
            /*abs_diff.u8 r13, r4, r16*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x01, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 9, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r14, r14, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r15, r15, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(8, &Instructions->binarys[Instructions->count++]));
        }
        /*Get cost image address base*/
        /*mul r15.y, r8.y (row number), (width * itemSize * range)  */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, wSize, &Instructions->binarys[Instructions->count++]));
        /* mad r15.y, r8.x(col number), (itemSize * range), r15.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, rSize, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 10; i++)
        {
            /*add r15.z, r15.y, i * rSize + (j + 32) * Size */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, i * rSize + (j + 32) * Size, &Instructions->binarys[Instructions->count++]));
            /* load r15.w, c2, r15.z */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
            if (i < 8)
            {
                /*IAdd.u32 r15.w, r14, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            }
            else
            {
                /*IAdd.u32 r15.w, r15.x, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i - 8, &Instructions->binarys[Instructions->count++]));
            }
            /* store r5.w, c2, r15.z, r15*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        }
    }


    /*Load right image line5*/
    /*add r8.x, r0.x, -48 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r9, c0, r8.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusOne.raw, &Instructions->binarys[Instructions->count++]));
    /*add r8.x, r0.x, -32 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r10, c0, r8.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusOne.raw, &Instructions->binarys[Instructions->count++]));
    /*add r8.x, r0.x, -16 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r11, c0, r8.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusOne.raw, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r12, c0, r0.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(12, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusOne.raw, &Instructions->binarys[Instructions->count++]));

    /* compute cost[j] for this row*/
    /* j = 0*/
    for (i = 0; i < 7; i++)
    {
        /*abs_diff.u8 r13, r5, r12*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x01, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 9, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 12, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
        /*IAdd.u16 r14, r14, r13 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
        /*IAdd.u16 r15, r15, r13 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(8, &Instructions->binarys[Instructions->count++]));
    }
    /*Get cost image address base*/
    /*mul r15.y, r8.y (row number), (width * itemSize * range)  */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, wSize, &Instructions->binarys[Instructions->count++]));
    /* mad r15.y, r8.x(col number), (itemSize * range), r15.y */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, rSize, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    for (i = 0; i < 10; i++)
    {
        /*add r15.z, r15.y, i * rSize */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, i * rSize, &Instructions->binarys[Instructions->count++]));
        /* load r15.w, c2, r15.z */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
        if (i < 8)
        {
            /*IAdd.u32 r15.w, r14, r15.w */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
        }
        else
        {
            /*IAdd.u32 r15.w, r15.x, r15.w */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(i - 8, &Instructions->binarys[Instructions->count++]));
        }
        /* store r5.w, c2, r15.z, r15*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }
    /*To get the shift bit right image data*/
    /* j = 1 ~ j = 16*/
    for (j = 1; j < 17; j++)
    {
        if (j < 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < j)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < 8)
                {
                    config.abin0[i] = i - j;
                    config.aselect[i] = 1;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else if (j == 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 8 + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - 8;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < j)
                {
                    config.abin1[i%8] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        _SetUniformItem(index, 0, 0, 0, 0, 0, gcvTRUE, &config, 0x7, &Uinform[*index]);
        /*dp16.u8 r16, r11, r12, c4_512 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x13, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 11, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 12, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 7; i++)
        {
            /*abs_diff.u8 r13, r5, r16*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x01, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 9, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r14, r14, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r15, r15, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(8, &Instructions->binarys[Instructions->count++]));
        }
        /*Get cost image address base*/
        /*mul r15.y, r8.y (row number), (width * itemSize * range)  */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, wSize, &Instructions->binarys[Instructions->count++]));
        /* mad r15.y, r8.x(col number), (itemSize * range), r15.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, rSize, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 10; i++)
        {
            /*add r15.z, r15.y, i * rSize + j * Size */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, i * rSize + j * Size, &Instructions->binarys[Instructions->count++]));
            /* load r15.w, c2, r15.z */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
            if (i < 8)
            {
                /*IAdd.u32 r15.w, r14, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            }
            else
            {
                /*IAdd.u32 r15.w, r15.x, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i - 8, &Instructions->binarys[Instructions->count++]));
            }
            /* store r5.w, c2, r15.z, r15*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        }
    }
    /* j = 17 ~ j = 32*/
    for (j = 1; j < 17; j++)
    {
        if (j < 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < j)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < 8)
                {
                    config.abin0[i] = i - j;
                    config.aselect[i] = 1;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else if (j == 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 8 + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - 8;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < j)
                {
                    config.abin1[i%8] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        _SetUniformItem(index, 0, 0, 0, 0, 0, gcvTRUE, &config, 0x7, &Uinform[*index]);
        /*dp16.u8 r16, r10, r11, c4_512 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x13, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 11, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 7; i++)
        {
            /*abs_diff.u8 r13, r5, r16*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x01, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 9, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r14, r14, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r15, r15, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(8, &Instructions->binarys[Instructions->count++]));
        }
        /*Get cost image address base*/
        /*mul r15.y, r8.y (row number), (width * itemSize * range)  */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, wSize, &Instructions->binarys[Instructions->count++]));
        /* mad r15.y, r8.x(col number), (itemSize * range), r15.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, rSize, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 10; i++)
        {
            /*add r15.z, r15.y, i * rSize + (j + 16) * Size */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, i * rSize + (j + 16) * Size, &Instructions->binarys[Instructions->count++]));
            /* load r15.w, c2, r15.z */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
            if (i < 8)
            {
                /*IAdd.u32 r15.w, r14, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            }
            else
            {
                /*IAdd.u32 r15.w, r15.x, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i - 8, &Instructions->binarys[Instructions->count++]));
            }
            /* store r5.w, c2, r15.z, r15*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        }
    }

    /* j = 33 ~ j = 47*/
    for (j = 1; j < 16; j++)
    {
        if (j < 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < j)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < 8)
                {
                    config.abin0[i] = i - j;
                    config.aselect[i] = 1;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else if (j == 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 8 + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - 8;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < j)
                {
                    config.abin1[i%8] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        _SetUniformItem(index, 0, 0, 0, 0, 0, gcvTRUE, &config, 0x7, &Uinform[*index]);
        /*dp16.u8 r16, r9, r10, c4_512 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x13, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 7; i++)
        {
            /*abs_diff.u8 r13, r5, r16*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x01, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 9, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r14, r14, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r15, r15, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(8, &Instructions->binarys[Instructions->count++]));
        }
        /*Get cost image address base*/
        /*mul r15.y, r8.y (row number), (width * itemSize * range)  */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, wSize, &Instructions->binarys[Instructions->count++]));
        /* mad r15.y, r8.x(col number), (itemSize * range), r15.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, rSize, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 10; i++)
        {
            /*add r15.z, r15.y, i * rSize + (j + 32) * Size */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, i * rSize + (j + 32) * Size, &Instructions->binarys[Instructions->count++]));
            /* load r15.w, c2, r15.z */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
            if (i < 8)
            {
                /*IAdd.u32 r15.w, r14, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            }
            else
            {
                /*IAdd.u32 r15.w, r15.x, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i - 8, &Instructions->binarys[Instructions->count++]));
            }
            /* store r5.w, c2, r15.z, r15*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        }
    }


    /*Load right image line6*/
    /*add r8.x, r0.x, -48 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r9, c0, r8.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusTwo.raw, &Instructions->binarys[Instructions->count++]));
    /*add r8.x, r0.x, -32 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r10, c0, r8.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusTwo.raw, &Instructions->binarys[Instructions->count++]));
    /*add r8.x, r0.x, -16 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r11, c0, r8.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusTwo.raw, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r12, c0, r0.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(12, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusTwo.raw, &Instructions->binarys[Instructions->count++]));

    /* compute cost[j] for this row*/
    /* j = 0*/
    for (i = 0; i < 7; i++)
    {
        /*abs_diff.u8 r13, r6, r12*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x01, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 9, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 12, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
        /*IAdd.u16 r14, r14, r13 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
        /*IAdd.u16 r15, r15, r13 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(8, &Instructions->binarys[Instructions->count++]));
    }
    /*Get cost image address base*/
    /*mul r15.y, r8.y (row number), (width * itemSize * range)  */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, wSize, &Instructions->binarys[Instructions->count++]));
    /* mad r15.y, r8.x(col number), (itemSize * range), r15.y */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, rSize, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    for (i = 0; i < 10; i++)
    {
        /*add r15.z, r15.y, i * rSize */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, i * rSize, &Instructions->binarys[Instructions->count++]));
        /* load r15.w, c2, r15.z */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
        if (i < 8)
        {
            /*IAdd.u32 r15.w, r14, r15.w */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
        }
        else
        {
            /*IAdd.u32 r15.w, r15.x, r15.w */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(i - 8, &Instructions->binarys[Instructions->count++]));
        }
        /* store r5.w, c2, r15.z, r15*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }
    /*To get the shift bit right image data*/
    /* j = 1 ~ j = 16*/
    for (j = 1; j < 17; j++)
    {
        if (j < 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < j)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < 8)
                {
                    config.abin0[i] = i - j;
                    config.aselect[i] = 1;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else if (j == 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 8 + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - 8;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < j)
                {
                    config.abin1[i%8] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        _SetUniformItem(index, 0, 0, 0, 0, 0, gcvTRUE, &config, 0x7, &Uinform[*index]);
        /*dp16.u8 r16, r11, r12, c4_512 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x13, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 11, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 12, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 7; i++)
        {
            /*abs_diff.u8 r13, r6, r16*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x01, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 9, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r14, r14, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r15, r15, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(8, &Instructions->binarys[Instructions->count++]));
        }
        /*Get cost image address base*/
        /*mul r15.y, r8.y (row number), (width * itemSize * range)  */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, wSize, &Instructions->binarys[Instructions->count++]));
        /* mad r15.y, r8.x(col number), (itemSize * range), r15.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, rSize, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 10; i++)
        {
            /*add r15.z, r15.y, i * rSize + j * Size */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, i * rSize + j * Size, &Instructions->binarys[Instructions->count++]));
            /* load r15.w, c2, r15.z */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
            if (i < 8)
            {
                /*IAdd.u32 r15.w, r14, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            }
            else
            {
                /*IAdd.u32 r15.w, r15.x, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i - 8, &Instructions->binarys[Instructions->count++]));
            }
            /* store r5.w, c2, r15.z, r15*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        }
    }
    /* j = 17 ~ j = 32*/
    for (j = 1; j < 17; j++)
    {
        if (j < 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < j)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < 8)
                {
                    config.abin0[i] = i - j;
                    config.aselect[i] = 1;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else if (j == 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 8 + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - 8;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < j)
                {
                    config.abin1[i%8] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        _SetUniformItem(index, 0, 0, 0, 0, 0, gcvTRUE, &config, 0x7, &Uinform[*index]);
        /*dp16.u8 r16, r10, r11, c4_512 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x13, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 11, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 7; i++)
        {
            /*abs_diff.u8 r13, r6, r16*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x01, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 9, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r14, r14, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r15, r15, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(8, &Instructions->binarys[Instructions->count++]));
        }
        /*Get cost image address base*/
        /*mul r15.y, r8.y (row number), (width * itemSize * range)  */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, wSize, &Instructions->binarys[Instructions->count++]));
        /* mad r15.y, r8.x(col number), (itemSize * range), r15.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, rSize, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 10; i++)
        {
            /*add r15.z, r15.y, i * rSize + (j + 16) * Size */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, i * rSize + (j + 16) * Size, &Instructions->binarys[Instructions->count++]));
            /* load r15.w, c2, r15.z */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
            if (i < 8)
            {
                /*IAdd.u32 r15.w, r14, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            }
            else
            {
                /*IAdd.u32 r15.w, r15.x, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i - 8, &Instructions->binarys[Instructions->count++]));
            }
            /* store r5.w, c2, r15.z, r15*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        }
    }

    /* j = 33 ~ j = 47*/
    for (j = 1; j < 16; j++)
    {
        if (j < 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < j)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < 8)
                {
                    config.abin0[i] = i - j;
                    config.aselect[i] = 1;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else if (j == 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 8 + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - 8;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < j)
                {
                    config.abin1[i%8] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        _SetUniformItem(index, 0, 0, 0, 0, 0, gcvTRUE, &config, 0x7, &Uinform[*index]);
        /*dp16.u8 r16, r9, r10, c4_512 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x13, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 7; i++)
        {
            /*abs_diff.u8 r13, r6, r16*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x01, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 9, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r14, r14, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r15, r15, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(8, &Instructions->binarys[Instructions->count++]));
        }
        /*Get cost image address base*/
        /*mul r15.y, r8.y (row number), (width * itemSize * range)  */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, wSize, &Instructions->binarys[Instructions->count++]));
        /* mad r15.y, r8.x(col number), (itemSize * range), r15.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, rSize, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 10; i++)
        {
            /*add r15.z, r15.y, i * rSize + (j + 32) * Size */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, i * rSize + (j + 32) * Size, &Instructions->binarys[Instructions->count++]));
            /* load r15.w, c2, r15.z */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
            if (i < 8)
            {
                /*IAdd.u32 r15.w, r14, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            }
            else
            {
                /*IAdd.u32 r15.w, r15.x, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i - 8, &Instructions->binarys[Instructions->count++]));
            }
            /* store r5.w, c2, r15.z, r15*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        }
    }


    /*Load right image line7*/
    /*add r8.x, r0.x, -48 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r9, c0, r8.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusTri.raw, &Instructions->binarys[Instructions->count++]));
    /*add r8.x, r0.x, -32 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r10, c0, r8.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusTri.raw, &Instructions->binarys[Instructions->count++]));
    /*add r8.x, r0.x, -16 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r11, c0, r8.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusTri.raw, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r12, c0, r0.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(12, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusTri.raw, &Instructions->binarys[Instructions->count++]));

    /* compute cost[j] for this row*/
    /* j = 0*/
    for (i = 0; i < 7; i++)
    {
        /*abs_diff.u8 r13, r7, r12*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x01, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 9, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 12, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
        /*IAdd.u16 r14, r14, r13 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
        /*IAdd.u16 r15, r15, r13 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(8, &Instructions->binarys[Instructions->count++]));
    }
    /*Get cost image address base*/
    /*mul r15.y, r8.y (row number), (width * itemSize * range)  */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, wSize, &Instructions->binarys[Instructions->count++]));
    /* mad r15.y, r8.x(col number), (itemSize * range), r15.y */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, rSize, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    for (i = 0; i < 10; i++)
    {
        /*add r15.z, r15.y, i * rSize */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, i * rSize, &Instructions->binarys[Instructions->count++]));
        /* load r15.w, c2, r15.z */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
        if (i < 8)
        {
            /*IAdd.u32 r15.w, r14, r15.w */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
        }
        else
        {
            /*IAdd.u32 r15.w, r15.x, r15.w */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(i - 8, &Instructions->binarys[Instructions->count++]));
        }
        /* store r5.w, c2, r15.z, r15*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }
    /*To get the shift bit right image data*/
    /* j = 1 ~ j = 16*/
    for (j = 1; j < 17; j++)
    {
        if (j < 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < j)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < 8)
                {
                    config.abin0[i] = i - j;
                    config.aselect[i] = 1;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else if (j == 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 8 + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - 8;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < j)
                {
                    config.abin1[i%8] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        _SetUniformItem(index, 0, 0, 0, 0, 0, gcvTRUE, &config, 0x7, &Uinform[*index]);
        /*dp16.u8 r16, r11, r12, c4_512 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x13, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 11, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 12, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 7; i++)
        {
            /*abs_diff.u8 r13, r7, r16*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x01, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 9, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r14, r14, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r15, r15, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(8, &Instructions->binarys[Instructions->count++]));
        }
        /*Get cost image address base*/
        /*mul r15.y, r8.y (row number), (width * itemSize * range)  */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, wSize, &Instructions->binarys[Instructions->count++]));
        /* mad r15.y, r8.x(col number), (itemSize * range), r15.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, rSize, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 10; i++)
        {
            /*add r15.z, r15.y, i * rSize + j * Size */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, i * rSize + j * Size, &Instructions->binarys[Instructions->count++]));
            /* load r15.w, c2, r15.z */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
            if (i < 8)
            {
                /*IAdd.u32 r15.w, r14, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            }
            else
            {
                /*IAdd.u32 r15.w, r15.x, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i - 8, &Instructions->binarys[Instructions->count++]));
            }
            /* store r5.w, c2, r15.z, r15*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        }
    }
    /* j = 17 ~ j = 32*/
    for (j = 1; j < 17; j++)
    {
        if (j < 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < j)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < 8)
                {
                    config.abin0[i] = i - j;
                    config.aselect[i] = 1;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else if (j == 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 8 + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - 8;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < j)
                {
                    config.abin1[i%8] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        _SetUniformItem(index, 0, 0, 0, 0, 0, gcvTRUE, &config, 0x7, &Uinform[*index]);
        /*dp16.u8 r16, r10, r11, c4_512 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x13, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 11, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 7; i++)
        {
            /*abs_diff.u8 r13, r7, r16*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x01, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 9, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r14, r14, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r15, r15, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(8, &Instructions->binarys[Instructions->count++]));
        }
        /*Get cost image address base*/
        /*mul r15.y, r8.y (row number), (width * itemSize * range)  */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, wSize, &Instructions->binarys[Instructions->count++]));
        /* mad r15.y, r8.x(col number), (itemSize * range), r15.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, rSize, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 10; i++)
        {
            /*add r15.z, r15.y, i * rSize + (j + 16) * Size */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, i * rSize + (j + 16) * Size, &Instructions->binarys[Instructions->count++]));
            /* load r15.w, c2, r15.z */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
            if (i < 8)
            {
                /*IAdd.u32 r15.w, r14, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            }
            else
            {
                /*IAdd.u32 r15.w, r15.x, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i - 8, &Instructions->binarys[Instructions->count++]));
            }
            /* store r5.w, c2, r15.z, r15*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        }
    }

    /* j = 33 ~ j = 47*/
    for (j = 1; j < 16; j++)
    {
        if (j < 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < j)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < 8)
                {
                    config.abin0[i] = i - j;
                    config.aselect[i] = 1;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else if (j == 8)
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 8 + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - 8;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        else
        {
            for (i = 0; i < 15; i++)
            {
                config.termconfig[i] = VX_ADD;
                if (i < 8)
                {
                    config.abin0[i] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else if (i < j)
                {
                    config.abin1[i%8] = 16 - j + i;
                    config.aselect[i] = 0;
                }
                else
                {
                    config.abin1[i%8] = i - j;
                    config.aselect[i] = 1;
                }
                config.matrix[i] = 1;
            }
        }
        _SetUniformItem(index, 0, 0, 0, 0, 0, gcvTRUE, &config, 0x7, &Uinform[*index]);
        /*dp16.u8 r16, r9, r10, c4_512 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x13, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 7; i++)
        {
            /*abs_diff.u8 r13, r7, r16*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x01, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 9, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r14, r14, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            /*IAdd.u16 r15, r15, r13 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(8, &Instructions->binarys[Instructions->count++]));
        }
        /*Get cost image address base*/
        /*mul r15.y, r8.y (row number), (width * itemSize * range)  */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3C, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, wSize, &Instructions->binarys[Instructions->count++]));
        /* mad r15.y, r8.x(col number), (itemSize * range), r15.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, rSize, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 10; i++)
        {
            /*add r15.z, r15.y, i * rSize + (j + 32) * Size */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, i * rSize + (j + 32) * Size, &Instructions->binarys[Instructions->count++]));
            /* load r15.w, c2, r15.z */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));
            if (i < 8)
            {
                /*IAdd.u32 r15.w, r14, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));
            }
            else
            {
                /*IAdd.u32 r15.w, r15.x, r15.w */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(i - 8, &Instructions->binarys[Instructions->count++]));
            }
            /* store r5.w, c2, r15.z, r15*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        }
    }

    for (i = 1; i < 7; i++)
    {
        /*mov r1, r2 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(i, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, i + 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }

    /*add.u32 r0.yz, r0, 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE2(1, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

    /*branch.u32 r0.z, c1.y, flag0-curr */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, flag[0]-Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, Height, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 0x11;
OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _sgm(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
#define SGM_COST    0
#define SGM_PATH90  1
#define SGM_PATH45  2
#define SGM_PATH135 3
#define SGM_PATH0   4

    gceSTATUS status            = gcvSTATUS_OK;
    gcoVX_Hardware_Step steps[] = {
        {0, "cost", SGM_COST, &_sgm_cost},
        {1, "path90", SGM_PATH90, NULL},
        {2, "path45", SGM_PATH45, NULL},
        {3, "path135", SGM_PATH135, NULL},
        {4, "path0", SGM_PATH0, NULL},
    };

    gcmHEADER_ARG("Context=0x%x", Context);
    assert(Context->step < 5);

    gcmONERROR(steps[Context->step].func(Context));

OnError:
    gcmFOOTER();

    return status;
}

static gceSTATUS _laplacian(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gctUINT32 Kernel = Context->kernel;
    gctUINT32 Border = Context->borders;
    gctINT16  *Matrix_x = Context->matrix;
    gctINT32  Col = Context->col;
    gctINT32  Row = Context->row;
    gctUINT32 Output = Context->output_type[0];
    gctUINT32 Scale = (gctUINT32)Context->scale;
    gctUINT32 Clamp = Context->clamp;
    gctUINT32 Xstep = Context->xstep;
    gcoVX_Kernel_Context_Uniform *Uinform = Context->uniform;
    gctUINT32 *index = Context->unifor_num;
    gctUINT32 Height = Context->volume;
    gctUINT32 flag = 0;
    gcoVX_Instructions *Instructions = Context->instructions;

    gctINT32 i = 0, j = 0, p = 0;
    RelOffset offset_index = {{0}};
    gctINT32 max = Col * Row - 1;

    gctUINT32 src0 = 1, src1 = 2, dst = 3;
    gctUINT32 start = 2, end = 3;           /*dest start and dest end*/
    gctINT32 offset0 = 0;                   /* the offset of src0 and the length of src0*/
    gctINT32 offset = 0;
    gctUINT32 count = (gctUINT32)ceil((max - 10)/7.0f) + 1;
    gctINT32 items = ((Row / 2 + 2 + Col) > 8) ? 1 : 2;
    gcmHEADER_ARG("Context=0x%x", Context);

    if(Row == 5 && Col == 5)items = 2;

    if(max < 10) count = 1;

    offset_index.u.x = -(gctINT16)(Col/2);
    offset_index.u.y =  -(gctINT16)(Row/2);

    for (i = 0; i < Row; i ++)
    {
        if (i == Row - 1)
            flag = Instructions->count;
        if ((Border == gcvVX_BORDER_MODE_CONSTANT || Border == gcvVX_BORDER_MODE_UNDEFINED) && Kernel != gcvVX_KERNEL_SCHARR_3x3)
        {
            /*mov r1, c2 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(i + 1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        }


        /*img_load.u8 r(i+1), c0, r0.xy, @-Col,+y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(i + 1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset_index.raw, &Instructions->binarys[Instructions->count++]));

        offset_index.u.y ++;
    }

    for (i = 0; i < items; i++)
    {
        gctUINT32 k = 0;

        src0 = 1;
        src1 = 2;
        dst = Row + 1;
        start = 2;
        end = start + 1;    /*dest start and dest end*/
        offset0 = 0;        /* the offset of src0 and the length of src0*/
        offset = 0;

        for (k = 0; k < count; k++)
        {
            gcVXConfig config = {{0}};
            gctINT32 length0 = Col - offset0;
            gctINT32 length = (k > 0)?7:8;      /*valid length*/

            for (p = 0; p < 16; p++)
                   config.termconfig[p] = VX_ADD;

            /*non-first line, just use 15 bit*/
            if (k != 0)
                config.termconfig[7] = config.termconfig[15] = VX_ACCUMULATOR;

            for (p = 0; p < 16; p++)
            {
                config.matrix[p]   = (p%8 < 2 * Col) ? ((max - offset - p%8 >= 0)?Matrix_x[max - offset - p%8]:0) : 0;
                config.aselect[p]  = (p%8 < length0) ? 0 : ((p%8 < 2 * Col)?1:0);
            }


            for (p = 0; p < 8; p++)
            {
                config.abin0[p]    = (p < length0) ? (offset0 + p) : ((p < 2 * Col)?((Col < 4)?(p - Col):(p - length0)):0);
                config.abin1[p]    = config.abin0[p];
            }

            if (k > 0)
            {
                config.matrix[7] = config.matrix[15] = 0;
                config.aselect[7] = config.aselect[15] = 0;

                config.abin0[7] = 2;
                config.abin1[7] = 3;
            }

            if (k < (count -1))
            {
                if ((length - length0) >= Col)
                    dst = src1 + 1;
                else
                    dst = src1;
            }
            else
            {
                dst = Row + 1;
                start = 2 * i;
                end = start + 1;
            }

            _SetUniformItem(index, 2*i, 2*i, 2*i + 1, 2*i + 1, 0, gcvTRUE, &config, 0x5, &Uinform[*index]);

            /*dp8.u16 r2[6-7], r1, r2, c4_512 :selection for first dp8 pixels 0-1*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x09, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(dst, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(start, end, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, src0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, src1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));

            if ((length - length0) >= Col)
            {
                src0 = src1 + 1;
                src1 = src0 + 1;
            }
            else
            {
                src0 = src1;
                src1 = src0 + 1;
            }

            /* prepare next offset and length*/
            offset0 = ((7 - length0) > Col) ? 0 : ((7 - length0)%Col);
            offset += (2 * Col < 7) ? (2 * Col) : 7;

            if (k == 0 && (Col > 4))
            {
                offset ++;
                offset0 ++;
            }
        }
    }

    for (j = 0; j < 1; j++)
    {
        gcVXConfig config = {{0}};

        for(p = 0; p < 16; p++)
              config.termconfig[p] = VX_ADD;

        config.termconfig[3] = config.termconfig[7] = config.termconfig[11] = config.termconfig[15] = VX_ACCUMULATOR;

        for (p = 0; p < 16; p++)
        {
            config.matrix[p]   = (p%4 < Col) ? ((max - offset - p%4 >= 0)?Matrix_x[max - offset - p%4]:0) : 0;
            config.aselect[p]  = ((p + 1)%4 == 0)?1:0;
        }

        for (p = 0; p < 8; p++)
        {
            config.abin0[p]    = ((p + 1) % 4 == 0)?(p/4):(offset0 + p%4);
            config.abin1[p]    = ((p + 1) % 4 == 0)?(p/4 + 2):(offset0 + p%4);
        }

        _SetUniformItem(index, 4*j + 0, 4*j + 1, 4*j + 2, 4*j + 3, Scale, gcvTRUE, &config, 0x5, &Uinform[*index]);

        /*dp4.u8 r7[0-3], r6, r5, c28_512 :selection for last dp4 pixels 0-3 + r5[6,7];r4[6,7]*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0A, Output, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(Row + 2, gcdVX_ENABLE, Clamp, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(4*j, 4*j + 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, Row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, Row + 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));
    }

    /*img_store.u8, r7[0-7], c1, r0.xy, r7*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, Output, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, Xstep - 1, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, Row + 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    for (i = 1; i < Row; i ++)
    {
        /*mov ri, ri+1 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(i, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, i+1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }

    /*add.u32 r0.y, r0.y, 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

    /*branch.u32 r0.y, Height, flag0-curr */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, flag-Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, Height, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = Row + 3;
OnError:

    gcmFOOTER();
    return status;
}

static gceSTATUS _census3x3(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gctUINT32 flag = 0;
    RelOffset minusOne = {{ -1, -1 }};
    RelOffset zero = {{ -1, 0 }};
    RelOffset plusOne = {{ -1, 1 }};
    gctUINT32 i = 0;
    gcoVX_Instructions *Instructions = Context->instructions;


    gcmHEADER_ARG("Context=0x%x", Context);

    /*mov r0.yz, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE2(1, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));
    /*mov r1, c2.w(255) */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 2, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r1, c0, r0.xy, -1,-1*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(0x7), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, minusOne.raw, &Instructions->binarys[Instructions->count++]));
    /*bitextract.u32 r4, r1.x, c3, 8;  c8 = [0, 0x8, 0x10, 0x18] */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));
    /*bitextract.u32 r7, r1.y, c3, 8;  c8 = [0, 0x8, 0x10, 0x18] */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));

    /*mov r2, c2.w(255) */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 2, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r2, c0, r0.xy, -1,0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(0x7), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, zero.raw, &Instructions->binarys[Instructions->count++]));
    /*bitextract.u32 r5, r2.x, c3, 8;  c8 = [0, 0x8, 0x10, 0x18] */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));
    /*bitextract.u32 r8, r2.y, c3, 8;  c8 = [0, 0x8, 0x10, 0x18] */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));

    /*Set flag count*/
    flag = Instructions->count;
    /*mov r3, c2.w(255) */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 2, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r3, c0, r0.xy, -1,1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(0x7), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusOne.raw, &Instructions->binarys[Instructions->count++]));
    /*bitextract.u32 r6, r3.x, c3, 8;  c8 = [0, 0x8, 0x10, 0x18] */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));
    /*bitextract.u32 r9, r3.y, c3, 8;  c8 = [0, 0x8, 0x10, 0x18] */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));

    /* r4.x   r4.y   r4.z   r4.w   r7.x   r7.y */
    /*      ----------------------------       */
    /* r5.x | r5.y | r5.z | r5.w | r8.x | r8.y */
    /*      ----------------------------       */
    /* r6.x   r6.y   r6.z   r6.w   r9.x   r9.y */

    /*compare with the 1st & 2nd num(r5.yz)*/
    for (i = 0; i < 2; i++)
    {
        /*first row*/
        /*cmp r1, r4, r5.y, c2.y(1);   */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x04, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE1(1 + i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));
        /*lshift r1.x, r1.x, 7 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(0 + i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0 + i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 7U, &Instructions->binarys[Instructions->count++]));
        /*lshift r1.y, r1.y, 6 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(1 + i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(1 + i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 6U, &Instructions->binarys[Instructions->count++]));
        /*lshift r1.z, r1.z, 5 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(2 + i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(2 + i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 5U, &Instructions->binarys[Instructions->count++]));
        /* add r2.x, r1.x, r1.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0 + i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0 + i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(1 + i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /* add r2.x, r2.x, r1.z */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0 + i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0 + i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(2 + i), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /*2nd row*/
        /*cmp r1, r5, r5.y, c2.y(1);   */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x04, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE1(1 + i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));
        /*lshift r1.x, r1.x, 4 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(0 + i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0 + i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 4U, &Instructions->binarys[Instructions->count++]));
        /*lshift r1.y, r1.y, 3 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(1 + i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(1 + i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 3U, &Instructions->binarys[Instructions->count++]));
        /* add r2.x, r2.x, r1.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0 + i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0 + i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(0 + i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /* add r2.x, r2.x, r1.z */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0 + i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0 + i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(2 + i), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* 3rd row*/
        /*cmp r1, r6, r5.y, c2.y(1);   */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x04, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE1(1 + i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));
        /*lshift r1.x, r1.x, 2 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(0 + i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0 + i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 2U, &Instructions->binarys[Instructions->count++]));
        /*lshift r1.y, r1.y, 1 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(1 + i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(1 + i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));
        /* add r2.x, r2.x, r1.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0 + i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0 + i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(0 + i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /* add r2.x, r2.x, r1.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0 + i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0 + i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(1 + i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /* add r2.x, r2.x, r1.z */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0 + i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0 + i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(2 + i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    }

    /*compare with the 3rd num(r5.w)*/
    /*first row*/
    /*mov r1, r4 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    /*mov r1.x, r7.x */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 7, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));
    /*cmp r1, r1, r5.w, c2.y(1);   */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x04, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));
    /*lshift r1.x, r1.x, 5 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 5U, &Instructions->binarys[Instructions->count++]));
    /*lshift r1.z, r1.z, 7 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 7U, &Instructions->binarys[Instructions->count++]));
    /*lshift r1.w, r1.w, 6 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 6U, &Instructions->binarys[Instructions->count++]));
    /* add r2.z, r1.x, r1.z */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /* add r2.z, r2.x, r1.w */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*2nd row*/
    /*mov r1, r5 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    /*mov r1.x, r8.x */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 8, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));
    /*cmp r1, r1, r5.w, c2.y(1);   */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x04, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));
    /*lshift r1.x, r1.x, 3 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 3U, &Instructions->binarys[Instructions->count++]));
    /*lshift r1.z, r1.z, 4 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 4U, &Instructions->binarys[Instructions->count++]));
    /* add r2.z, r2.z, r1.x */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /* add r2.z, r2.z, r1.z */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*3rd row*/
    /*mov r1, r6 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    /*mov r1.x, r9.x */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));
    /*cmp r1, r1, r5.w, c2.y(1);   */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x04, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));
    /*lshift r1.z, r1.z, 2 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 2U, &Instructions->binarys[Instructions->count++]));
    /*lshift r1.w, r1.w, 4 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));
    /* add r2.z, r2.z, r1.x */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /* add r2.z, r2.z, r1.z */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /* add r2.z, r2.z, r1.w */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count++]));


    /*compare with the 3rd num(r8.x)*/
    /*first row*/
    /*mov r1, r7 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    /*mov r1.z, r4.w */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count++]));
    /*cmp r1, r1, r8.x, c2.y(1);   */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x04, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));
    /*lshift r1.x, r1.x, 6 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 6U, &Instructions->binarys[Instructions->count++]));
    /*lshift r1.y, r1.y, 5 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 5U, &Instructions->binarys[Instructions->count++]));
    /*lshift r1.z, r1.z, 7 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 7U, &Instructions->binarys[Instructions->count++]));
    /* add r2.w, r1.x, r1.z */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /* add r2.w, r2.w, r1.y */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*2nd row*/
    /*mov r1, r8 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    /*mov r1.z, r5.w */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count++]));
    /*cmp r1, r1, r8.x, c2.y(1);   */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x04, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));
    /*lshift r1.z, r1.z, 4 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 4U, &Instructions->binarys[Instructions->count++]));
    /*lshift r1.y, r1.y, 3 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 3U, &Instructions->binarys[Instructions->count++]));
    /* add r2.w, r2.w, r1.y */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /* add r2.w, r2.w, r1.z */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*3rd row*/
    /*mov r1, r9 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    /*mov r1.z, r6.w */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count++]));
    /*cmp r1, r1, r8.x, c2.y(1);   */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x04, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));
    /*lshift r1.x, r1.x, 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));
    /*lshift r1.z, r1.z, 2 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 2U, &Instructions->binarys[Instructions->count++]));
    /* add r2.w, r2.w, r1.y */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /* add r2.w, r2.w, r1.z */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /* add r2.w, r2.w, r1.x */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));


    /*img_store.32 r2, c1, r0.xy, r2*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));

    for (i = 0; i < 2; i++)
    {
        /*mov r4, r5 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4 + i, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5 + i, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        /*mov r7, r8 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(7 + i, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 8 + i, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }

    /*add.u32 r0.yz, r0, 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE2(1, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));
    /*branch.u32 r0.z, c2.x, flag-curr */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, flag-Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 10;
OnError:

    gcmFOOTER();
    return status;
}

static gceSTATUS _copy_image(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS                    status = gcvSTATUS_OK;
    gcoVX_Instructions   *Instructions  = Context->instructions;

    gctUINT32 Input = Context->input_type[0];
    gctUINT32 Output = Context->output_type[0];

    gcmHEADER_ARG("Context=0x%x", Context);

    /*img_load.u8 r1, c0, r0.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

    /*img_store.u8 r1, c1, r0.xy, r1*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, Output, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Output), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    Instructions->regs_count = 0x2;

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _mag_halfevis(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gcoVX_Instructions *Instructions = Context->instructions;
    gctUINT32 i = 0;
    gctBOOL f16 = gcvFALSE;

    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    if(Context->policy == VX_DF_IMAGE('F','0','1','6'))
        f16 = gcvTRUE;

    /*img_load.u8 r1, c0, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r2, c1, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
    if (!f16)
    {
        /*mul_shift.u8, r3, r1, r1, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x3 | (0x3 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
        /*mul_shift.u8, r4, r1, r1, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x3 | (0x3 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(4, &Instructions->binarys[Instructions->count++]));
        /*mul_shift.u8, r5, r2, r2, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x3 | (0x3 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
        /*mul_shift.u8, r6, r2, r2, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x3 | (0x3 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(4, &Instructions->binarys[Instructions->count++]));

        /* add r3, r3, r5 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /* add r4, r4, r6 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));

        for (i = 0; i < 4; i++)
        {
            /* sqrt r3.x, r3.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x21, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        }

        for (i = 0; i < 4; i++)
        {
            /* sqrt r3.x, r3.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x21, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        }
        /*conv.s32 r3, r3; float32 -> s16*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x0 | (1 << 4), &Instructions->binarys[Instructions->count++]));
        /*conv.s32 r4, r4; float32 -> s16*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x0 | (1 << 4), &Instructions->binarys[Instructions->count++]));
        /*bitextract.u8 r5, r3, 0, c3;  c3 = [0, 32, 64, 96, 0, 0, 0, 0, 8, 8, 8, 8] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x6 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
        /*bitextract.u8 r6, r4, 0, c3;  c3 = [0, 32, 64, 96, 0, 0, 0, 0, 8, 8, 8, 8] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x6 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
        /*mov r5.z, r6.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mov r5.w, r6.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*img_store.u8 r5, c2, r0.xy, r3*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

        Instructions->regs_count = 0x7;

    }
    else
    {
        /*dp4.fp16 r3, r1, r2, c4   squre r3 = r1*r1 + r2*r2 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0A, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x1 | 0x1 << 3), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4, &Instructions->binarys[Instructions->count++]));
        /*dp4.fp16 r4, r1, r2, c4   squre r4 = r1*r1 + r2*r2(4-7) */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0A, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x1 | 0x1 << 3), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 8, &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 4; i++)
        {
            /* sqrt r3.x, r3.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x21, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
            /* sqrt r4.x, r4.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x21, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        }
        /* add r3, r3, 0.5f */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(2, 0.5f, &Instructions->binarys[Instructions->count++]));
        /* add r4, r4, 0.5f */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(2, 0.5f, &Instructions->binarys[Instructions->count++]));
        /*conv.s32 r3, r3; float32 -> s16*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x0 | (1 << 4), &Instructions->binarys[Instructions->count++]));
        /*conv.s32 r4, r4; float32 -> s16*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x0 | (1 << 4), &Instructions->binarys[Instructions->count++]));
        /*bitextract.u8 r2, r3, 0, c3;  c3 = [0, 32, 64, 96, 0, 0, 0, 0, 8, 8, 8, 8] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x6 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
        /*bitextract.u8 r1, r4, 0, c3;  c3 = [0, 32, 64, 96, 0, 0, 0, 0, 8, 8, 8, 8] */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x6 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        /*mov r2.z, r1.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mov r2.w, r1.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /*img_store.u8 r2, c2, r0.xy, r3*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

        Instructions->regs_count = 0x5;
    }


OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _absdiff_halfevis(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;

    gctUINT32 Input1 = Context->input_type[0];
    gctUINT32 Input2 = Context->input_type[1];
    gctUINT32 Output = Context->output_type[0];
    gctUINT32 i      = 0;
    gcoVX_Instructions           *Instructions = Context->instructions;
    gcVXConfig                    subConfig    = {{0}};
    gctUINT32                    *index        = Context->unifor_num;
    gcoVX_Kernel_Context_Uniform *Uinform      = Context->uniform;


    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    for (i = 0; i < 16; i++)
    {
        subConfig.termconfig[i]   = VX_ADD;
        if(i < 8)
        {
            subConfig.abin0[i]   = (gctUINT)(i/2);
        }
        else
        {
            subConfig.abin1[i%8]   = (gctUINT)(i/2);
        }

        subConfig.aselect[i]   = i%2 ? 1 : 0;
        subConfig.matrix[i]    = i%2 ? -1 : 1;
    }

    /*img_load.u8 r1, c0, r0.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input1), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

    /*img_load.u8 r2, c1, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input2), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

    _SetUniformItem(index, 0, 0, 0, 0, 0, gcvTRUE, &subConfig, Input1, &Uinform[*index]);

    /*dp2x8.u8 r3, r1, r2, c4_512 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0B, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (Input1 | (Input1 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));

    /*abs r3, r3*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x57, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    /*mul_shift.u8, r4, r3, 1, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, Output, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x3 | (0x6 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, (1 | (1 << 16)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    for (i = 0; i < 16; i++)
    {
        if(i < 8)
        {
            subConfig.abin0[i]   = (gctUINT)(i/2) + 8;
        }
        else
        {
            subConfig.abin1[i%8]   = (gctUINT)(i/2) + 8;
        }
    }

    _SetUniformItem(index, 0, 0, 0, 0, 0, gcvTRUE, &subConfig, Input1, &Uinform[*index]);

    /*dp2x8.u8 r3, r1, r2, c4_512 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0B, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (Input1 | (Input1 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));

    /*abs r3, r3*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x57, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    /*mul_shift.u8, r4, r3, 1, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, Output, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(8, 15, (0x3 | (0x6 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, (1 | (1 << 16)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*img_store.u8 r4, c2, r0.xy, r4*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, Output, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Output), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 0x5;
OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _element_wise_norm_halfevis(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS                    status = gcvSTATUS_OK;
    gcoVX_Instructions   *Instructions  = Context->instructions;
    gctUINT32 Input1 = Context->input_type[0];
    gctUINT32 Input2 = Context->input_type[1];
    gctUINT32 Output = Context->output_type[0];

    gcmHEADER_ARG("Context=0x%x", Context);

    /*img_load.u8 r1, c0, r0.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input1), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
    /*abs r1, r1*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x57, 0, Input1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r2, c1, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input2), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
    /*abs r2, r2*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x57, 0, Input2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    /*add r1, r1, r2 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x3B, 0, Output, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    /*img_store.u8 r1, c2, r0.xy, r3*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, Output, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Output), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 0x3;

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _add_sub_halfevis(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gctUINT32 Kernel = Context->kernel;
    gctBOOL Saturate = Context->policy;
    gctUINT32 Input1 = Context->input_type[0];
    gctUINT32 Input2 = Context->input_type[1];
    gctUINT32 Output = Context->output_type[0];
    gctUINT32 i      = 0;
    gcoVX_Instructions        *Instructions = Context->instructions;
    gcVXConfig                    config    = {{0}};
    gctUINT32                    *index     = Context->unifor_num;
    gcoVX_Kernel_Context_Uniform *Uinform   = Context->uniform;

    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    for (i = 0; i < 16; i++)
    {
        config.termconfig[i]   = VX_ADD;
        if(i < 8)
        {
            config.abin0[i]   = (gctUINT)(i/2);
        }
        else
        {
            config.abin1[i%8]   = (gctUINT)(i/2);
        }

        config.aselect[i]   = i%2 ? 1 : 0;
        config.matrix[i]    = (i+1)%2 ? 1 : (Kernel == gcvVX_KERNEL_SUBTRACT) ? -1 : 1;
    }

    /*img_load.u8 r1, c0, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input1), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

    /*img_load.u8 r2, c1, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input2), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

    _SetUniformItem(index, 0, 0, 0, 0, 0, gcvTRUE, &config, Input1, &Uinform[*index]);

    /*dp2x8.u8 r1, r1, r2, c4_512 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0B, Output, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, Saturate, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (Input1 | (Input2 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));

    /*img_store.u8 r1, c2, r0.xy, r1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, Output, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 0x4;

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _accumulate_halfevis(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gcoVX_Instructions *Instructions = Context->instructions;
    gctUINT32 i      = 0;
    gcVXConfig                    config    = {{0}};
    gctUINT32                    *index     = Context->unifor_num;
    gcoVX_Kernel_Context_Uniform *Uinform   = Context->uniform;

    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    for (i = 0; i < 16; i++)
    {
        config.termconfig[i]   = VX_ADD;
        if(i < 8)
        {
            config.abin0[i]   = (gctUINT)(i/2);
        }
        else
        {
            config.abin1[i%8]   = (gctUINT)(i/2);
        }

        config.aselect[i]   = i%2 ? 1 : 0;
        config.matrix[i]    = 1;
    }

    /*img_load.u8 r1, c0, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

    /*img_load.u8 r2, c1, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

    _SetUniformItem(index, 0, 0, 0, 0, 0, gcvTRUE, &config, 0x7, &Uinform[*index]);

    /*dp2x8.u8 r2, r1, r2, c4_512 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0B, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvTRUE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x3 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));

    /*img_store.s16 r2, c1, r0.xy, r2 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 0x3;

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _convertdepth_halfevis(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gctBOOL Saturate = Context->policy;
    gctUINT32 Input = Context->input_type[0];
    gctUINT32 Output = Context->output_type[0];
    gctUINT32 Shift = Context->volume;
    gcoVX_Instructions *Instructions = Context->instructions;

    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    if (Input == 0x7)
    {
        switch (Output)
        {
        case 0x6:
        case 0x3:
            /*img_load.u8 r1, c0, r0.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*mul_shift.u8, r2, r1, 1, 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (Input | (0x6 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, (1 | (1 << 16)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* lshift r2, r2, c2.x(shift) */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));
            /*img_store.u8 r2, c1, r0.xy, r2 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
            break;
        case 0x5:
            /*img_load.u8 r1, c0, r0.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*mul_shift.u8, r2, r1, 1, 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (Input | (0x6 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, (1 | (1 << 16)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* lshift r2, r2, shift */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));
            /*img_store.u8 r2, c1, r0.xy, r2 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
            break;
        default:
            status = gcvSTATUS_INVALID_ARGUMENT;
            break;
        }
    }
    else if (Input == 0x6)
    {
        switch (Output)
        {
        case 0x5:
            /*img_load.u8 r1, c0, r0.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*mul_shift.u8, r2, r1, 1, 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (Input | (0x6 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, (1 | (1 << 16)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* lshift r2, r2, shift */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));
            /*img_store.u8 r2, c1, r0.xy, r2 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
            /*img_store.u8 r2, c1, r0.xy, r2 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
            break;
        case 0x7:
            /*img_load.u8 r1, c0, r0.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
            /*mul_shift.u8, r2, r1, 1, Shift */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, Saturate, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (Input | (0x6 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, Shift, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            /*img_store.u8 r2, c1, r0.xy, r2 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
            break;
        default:
            status = gcvSTATUS_INVALID_ARGUMENT;
            break;
        }
    }
    else if (Input == 0x3)
    {
        switch (Output)
        {
        case 0x2:
            /*img_load.u8 r1, c0, r0.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*mul_shift.u8, r2, r1, 1, 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (Input | (0x6 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, (1 | (1 << 16)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* lshift r2, r2, shift */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));
            break;
        case 0x7:
            /*img_load.u8 r1, c0, r0.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
            /*mul_shift.u8, r2, r1, 1, Shift */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, Saturate, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (Input | (0x6 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, Shift, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
            /*img_store.u8 r2, c1, r0.xy, r2 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, Output, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
            break;
        default:
            status = gcvSTATUS_INVALID_ARGUMENT;
            break;
        }
    }
    else if (Input == 0x5)
    {
        switch (Output)
        {
        case 0x6:
            /*TO DO*/
            status = gcvSTATUS_NOT_SUPPORTED;
            break;
        case 0x7:
            /*TO DO*/
            status = gcvSTATUS_NOT_SUPPORTED;
            break;
        default:
            status = gcvSTATUS_INVALID_ARGUMENT;
            break;
        }
    }
    else if (Input == 0x2)
    {
        switch (Output)
        {
        case 0x3:
            /*TO DO*/
            status = gcvSTATUS_NOT_SUPPORTED;
            break;
        default:
            status = gcvSTATUS_INVALID_ARGUMENT;
            break;
        }
    }
    else if (Input == 0x0)
    {
        switch (Output)
        {
        case 0x7:
            /*TO DO*/
            status = gcvSTATUS_NOT_SUPPORTED;
            break;
        default:
            status = gcvSTATUS_INVALID_ARGUMENT;
            break;
        }
    }
    else
        status = gcvSTATUS_INVALID_ARGUMENT;

    Instructions->regs_count = 0x3;
OnError:
    gcmFOOTER();
    return status;
}


static gceSTATUS _sobel_mxn_halfevis(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gctUINT32 Kernel = Context->kernel;
    gctUINT32 Border = Context->borders;
    gctINT16  *Matrix_x = Context->matrix;
    gctINT16  *Matrix_y = Context->matrix1;
    gctINT32  Col = Context->col;
    gctINT32  Row = Context->row;
    gctUINT32 Output = Context->output_type[0];
    gctUINT32 Scale = (gctUINT32)Context->scale;
    gctUINT32 Clamp = Context->clamp;
    gctUINT32 Xstep = Context->xstep;
    gcoVX_Kernel_Context_Uniform *Uinform = Context->uniform;
    gctUINT32 *index = Context->unifor_num;
    gctUINT32 Height = Context->volume;
    gctUINT32 flag = 0;
    gcoVX_Instructions *Instructions = Context->instructions;

    gctINT32 i = 0, j = 0, p = 0;
    RelOffset offset_index = {{0}};
    gctINT32 max = Col * Row - 1;

    gctUINT32 src0 = 1, src1 = 2, dst = 3;
    gctUINT32 start = 2, end = 3;           /*dest start and dest end*/
    gctINT32 offset0 = 0;                   /* the offset of src0 and the length of src0*/
    gctINT32 offset = 0;
    gctUINT32 count = (gctUINT32)ceil((max - 10)/7.0f) + 1;
    gctINT32 items = ((Row / 2 + 2 + Col) > 8) ? 1 : 2;

    gctUINT32 skipXOutput = Context->optionalOutputs[0];
    gctUINT32 skipYOutput = Context->optionalOutputs[1];

    gctBOOL f16_output = (Context->policy == VX_DF_IMAGE('F','0','1','6'))?gcvTRUE:gcvFALSE;

    gcmHEADER_ARG("Context=0x%x", Context);

    if(Row == 5 && Col == 5)items = 2;

    if(f16_output)
        Output = 0x1;

    if(max < 10) count = 1;

    offset_index.u.x = -(gctINT16)(Col/2);
    offset_index.u.y =  -(gctINT16)(Row/2);

    for (i = 0; i < Row; i ++)
    {
        if (i == Row - 1)
            flag = Instructions->count;
        if ((Border == gcvVX_BORDER_MODE_CONSTANT || Border == gcvVX_BORDER_MODE_UNDEFINED) && Kernel != gcvVX_KERNEL_SCHARR_3x3)
        {
            /*mov r1, c3 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(i + 1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        }


        /*img_load.u8 r(i+1), c0, r0.xy, @-Col,+y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(i + 1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset_index.raw, &Instructions->binarys[Instructions->count++]));

        offset_index.u.y ++;
    }

    if (!skipXOutput)
    {
    for (i = 0; i < items; i++)
    {
        gctUINT32 k = 0;

        src0 = 1;
        src1 = 2;
        dst = Row + 1;
        start = 2;
        end = start + 1;    /*dest start and dest end*/
        offset0 = 0;        /* the offset of src0 and the length of src0*/
        offset = 0;

        for (k = 0; k < count; k++)
        {
            gcVXConfig config = {{0}};
            gctINT32 length0 = Col - offset0;
            gctINT32 length = (k > 0)?7:8;      /*valid length*/

            for (p = 0; p < 16; p++)
                   config.termconfig[p] = VX_ADD;

            /*non-first line, just use 15 bit*/
            if (k != 0)
                config.termconfig[7] = config.termconfig[15] = VX_ACCUMULATOR;

            for (p = 0; p < 16; p++)
            {
                config.matrix[p]   = (p%8 < 2 * Col) ? ((max - offset - p%8 >= 0)?Matrix_x[max - offset - p%8]:0) : 0;
                config.aselect[p]  = (p%8 < length0) ? 0 : ((p%8 < 2 * Col)?1:0);
            }


            for (p = 0; p < 8; p++)
            {
                config.abin0[p]    = (p < length0) ? (offset0 + p) : ((p < 2 * Col)?((Col < 4)?(p - Col):(p - length0)):0);
                config.abin1[p]    = config.abin0[p];
            }

            if (k > 0)
            {
                config.matrix[7] = config.matrix[15] = 0;
                config.aselect[7] = config.aselect[15] = 0;

                config.abin0[7] = 2;
                config.abin1[7] = 3;
            }

            if (k < (count -1))
            {
                if ((length - length0) >= Col)
                    dst = src1 + 1;
                else
                    dst = src1;
            }
            else
            {
                dst = Row + 1;
                start = 2 * i;
                end = start + 1;
            }

            _SetUniformItem(index, 2*i, 2*i, 2*i + 1, 2*i + 1, 0, gcvTRUE, &config, 0x2, &Uinform[*index]);

            /*dp8.u16 r2[6-7], r1, r2, c4_512 :selection for first dp8 pixels 0-1*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x09, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(dst, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(start, end, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, src0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, src1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));

            if ((length - length0) >= Col)
            {
                src0 = src1 + 1;
                src1 = src0 + 1;
            }
            else
            {
                src0 = src1;
                src1 = src0 + 1;
            }

            /* prepare next offset and length*/
            offset0 = ((7 - length0) > Col) ? 0 : ((7 - length0)%Col);
            offset += (2 * Col < 7) ? (2 * Col) : 7;

            if (k == 0 && (Col > 4))
            {
                offset ++;
                offset0 ++;
            }
        }
    }

    for (j = 0; j < 1; j++)
    {
        gcVXConfig config = {{0}};

        for(p = 0; p < 16; p++)
              config.termconfig[p] = VX_ADD;

        config.termconfig[3] = config.termconfig[7] = config.termconfig[11] = config.termconfig[15] = VX_ACCUMULATOR;

        for (p = 0; p < 16; p++)
        {
            config.matrix[p]   = (p%4 < Col) ? ((max - offset - p%4 >= 0)?Matrix_x[max - offset - p%4]:0) : 0;
            config.aselect[p]  = ((p + 1)%4 == 0)?1:0;
        }

        for (p = 0; p < 8; p++)
        {
            config.abin0[p]    = ((p + 1) % 4 == 0)?(p/4):(offset0 + p%4);
            config.abin1[p]    = ((p + 1) % 4 == 0)?(p/4 + 2):(offset0 + p%4);
        }

        _SetUniformItem(index, 4*j + 0, 4*j + 1, 4*j + 2, 4*j + 3, Scale, gcvTRUE, &config, 0x2, &Uinform[*index]);

        /*dp4.u8 r7[0-3], r6, r5, c28_512 :selection for last dp4 pixels 0-3 + r5[6,7];r4[6,7]*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0A, Output, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(Row + 2, gcdVX_ENABLE, Clamp, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(4*j, 4*j + 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, Row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, Row + 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));
    }

    /*img_store.u8, r7[0-7], c1, r0.xy, r7*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, f16_output?0x3:Output, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, Xstep - 1, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, Row + 2, f16_output?gcdVX_SWIZZLE4(0,0,0,0):gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    }

    if (!skipYOutput)
    {
    for (i = 0; i < items; i++)
    {
        gctUINT32 k = 0;

        src0 = 1;
        src1 = 2;
        dst = Row + 1;
        start = 2;
        end = start + 1;    /*dest start and dest end*/
        offset0 = 0;        /* the offset of src0 and the length of src0*/
        offset = 0;

        for (k = 0; k < count; k++)
        {
            gcVXConfig config = {{0}};
            gctINT32 length0 = Col - offset0;
            gctINT32 length = (k > 0)?7:8;      /*valid length*/

            for (p = 0; p < 16; p++)
                   config.termconfig[p] = VX_ADD;

            /*non-first line, just use 15 bit*/
            if (k != 0)
                config.termconfig[7] = config.termconfig[15] = VX_ACCUMULATOR;

            for (p = 0; p < 16; p++)
            {
                config.matrix[p]   = (p%8 < 2 * Col) ? ((max - offset - p%8 >= 0)?Matrix_y[max - offset - p%8]:0) : 0;
                config.aselect[p]  = (p%8 < length0) ? 0 : ((p%8 < 2 * Col)?1:0);
            }


            for (p = 0; p < 8; p++)
            {
                config.abin0[p]    = (p < length0) ? (offset0 + p) : ((p < 2 * Col)?((Col < 4)?(p - Col):(p - length0)):0);
                config.abin1[p]    = config.abin0[p];
            }

            if (k > 0)
            {
                config.matrix[7] = config.matrix[15] = 0;
                config.aselect[7] = config.aselect[15] = 0;

                config.abin0[7] = 2;
                config.abin1[7] = 3;
            }

            if (k < (count -1))
            {
                if ((length - length0) >= Col)
                    dst = src1 + 1;
                else
                    dst = src1;
            }
            else
            {
                dst = Row + 1;
                start = 2 * i;
                end = start + 1;
            }

            _SetUniformItem(index, 2*i, 2*i, 2*i + 1, 2*i + 1, 0, gcvTRUE, &config, 0x2, &Uinform[*index]);

            /*dp8.u16 r2[6-7], r1, r2, c4_512 :selection for first dp8 pixels 0-1*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x09, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(dst, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(start, end, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, src0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, src1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));

            if ((length - length0) >= Col)
            {
                src0 = src1 + 1;
                src1 = src0 + 1;
            }
            else
            {
                src0 = src1;
                src1 = src0 + 1;
            }

            /* prepare next offset and length*/
            offset0 = ((7 - length0) > Col) ? 0 : ((7 - length0)%Col);
            offset += (2 * Col < 7) ? (2 * Col) : 7;

            if (k == 0 && (Col > 4))
            {
                offset ++;
                offset0 ++;
            }
        }
    }

    for (j = 0; j < 1; j++)
    {
        gcVXConfig config = {{0}};

        for (p = 0; p < 16; p++)
              config.termconfig[p] = VX_ADD;

        config.termconfig[3] = config.termconfig[7] = config.termconfig[11] = config.termconfig[15] = VX_ACCUMULATOR;

        for (p = 0; p < 16; p++)
        {
            config.matrix[p]   = (p%4 < Col) ? ((max - offset - p%4 >= 0)?Matrix_y[max - offset - p%4]:0) : 0;
            config.aselect[p]  = ((p + 1)%4 == 0)?1:0;
        }

        for (p = 0; p < 8; p++)
        {
            config.abin0[p]    = ((p + 1) % 4 == 0)?(p/4):(offset0 + p%4);
            config.abin1[p]    = ((p + 1) % 4 == 0)?(p/4 + 2):(offset0 + p%4);
        }

        _SetUniformItem(index, 4*j + 0, 4*j + 1, 4*j + 2, 4*j + 3, Scale, gcvTRUE, &config, 0x2, &Uinform[*index]);

        /*dp4.u8 r7[0-3], r6, r5, c28_512 :selection for last dp4 pixels 0-3 + r5[6,7];r4[6,7]*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0A, Output, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(Row + 2, gcdVX_ENABLE, Clamp, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(4*j, 4*j + 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, Row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, Row + 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));
    }

    /*img_store.u8, r7[0-7], c2, r0.xy, r7*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, f16_output?0x3:Output, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, Xstep - 1, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, Row + 2, f16_output?gcdVX_SWIZZLE4(0,0,0,0):gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }

    for (i = 1; i < Row; i ++)
    {
        /*mov ri, ri+1 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(i, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, i+1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }

    /*add.u32 r0.y, r0.y, 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

    /*branch.u32 r0.y, Height, flag0-curr */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, flag-Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, Height, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = Row + 3;
OnError:

    gcmFOOTER();
    return status;
}

static gceSTATUS _filter_halfevis(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gctUINT32 Border = Context->borders;
    gctINT16  *Matrix = Context->matrix;
    gctINT32  Col = Context->col;
    gctINT32  Row = Context->row;
    gctUINT32 Output = Context->output_type[0];
    gctUINT32 OutputDp4 = 0;
    gctUINT32 Scale = 0;
    gctUINT32 Clamp = Context->clamp;
    gctUINT32 Xstep = Context->xstep;
    gcoVX_Kernel_Context_Uniform *Uinform = Context->uniform;
    gctUINT32 *index = Context->unifor_num;
    gctUINT32 Height = Context->volume;
    gctUINT32 flag = 0;
    gcoVX_Instructions *Instructions = Context->instructions;

    gctINT32 i = 0, j = 0, p = 0;
    RelOffset offset_index = {{0}};
    gctINT32 max = Col * Row - 1;

    gctUINT32 src0 = 1, src1 = 2, dst = 3;
    gctUINT32 start = 2, end = 3;           /*dest start and dest end*/
    gctINT32 offset0 = 0;                   /* the offset of src0 and the length of src0*/
    gctINT32 offset = 0;
    gctUINT32 count = (gctUINT32)ceil((max - 10)/7.0f) + 1;
    gctINT32 items = ((Row / 2 + 2 + Col) > 8) ? 1 : 2;
    gcmHEADER_ARG("Context=0x%x", Context);

    if(max < 10) count = 1;

    Scale = (Context->kernel == gcvVX_KERNEL_BOX_3x3) ? 0 : (gctUINT32)Context->scale;
    OutputDp4 = (Context->kernel == gcvVX_KERNEL_BOX_3x3) ? 0x2 : Output;

    offset_index.u.x = -(gctINT16)(Col/2);
    offset_index.u.y =  -(gctINT16)(Row/2);

    for (i = 0; i < Row; i ++)
    {
        if (i == Row - 1)
            flag = Instructions->count;

        if(Border == gcvVX_BORDER_MODE_CONSTANT || Border == gcvVX_BORDER_MODE_UNDEFINED)
        {
            /*mov r1, c3 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(i + 1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        }

        /*img_load.u8 r(i+1), c0, r0.xy, @-Col,+y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(i + 1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset_index.raw, &Instructions->binarys[Instructions->count++]));

        offset_index.u.y ++;
    }

    for (i = 0; i < items; i++)
    {
        gctUINT32 k = 0;

        src0 = 1;
        src1 = 2;
        dst = Row + 1;
        start = 2;
        end = start + 1;    /*dest start and dest end*/
        offset0 = 0;        /* the offset of src0 and the length of src0*/
        offset = 0;

        for (k = 0; k < count; k++)
        {
            gcVXConfig config = {{0}};
            gctINT32 length0 = Col - offset0;
            gctINT32 length = (k > 0)?7:8;      /*valid length*/

            for (p = 0; p < 16; p++)
                   config.termconfig[p] = VX_ADD;

            /*non-first line, just use 15 bit*/
            if (k != 0)
                config.termconfig[7] = config.termconfig[15] = VX_ACCUMULATOR;

            for (p = 0; p < 16; p++)
            {
                config.matrix[p]   = (p%8 < 2 * Col) ? ((max - offset - p%8 >= 0)?Matrix[max - offset - p%8]:0) : 0;
                config.aselect[p]  = (p%8 < length0) ? 0 : ((p%8 < 2 * Col)?1:0);
            }


            for (p = 0; p < 8; p++)
            {
                config.abin0[p]    = (p < length0) ? (offset0 + p) : ((p < 2 * Col)?((Col < 4)?(p - Col):(p - length0)):0);
                config.abin1[p]    = config.abin0[p];
            }

            if (k > 0)
            {
                config.matrix[7] = config.matrix[15] = 0;
                config.aselect[7] = config.aselect[15] = 0;

                config.abin0[7] = 2;
                config.abin1[7] = 3;
            }

            if (k < (count -1))
            {
                if ((length - length0) >= Col)
                    dst = src1 + 1;
                else
                    dst = src1;
            }
            else
            {
                dst = Row + 1;
                start = 2 * i;
                end = start + 1;
            }

            _SetUniformItem(index, 2*i, 2*i, 2*i + 1, 2*i + 1, 0, gcvTRUE, &config, 0x5, &Uinform[*index]);

            /*dp8.u16 r2[6-7], r1, r2, c4_512 :selection for first dp8 pixels 0-1*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x09, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(dst, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(start, end, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, src0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, src1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));

            if ((length - length0) >= Col)
            {
                src0 = src1 + 1;
                src1 = src0 + 1;
            }
            else
            {
                src0 = src1;
                src1 = src0 + 1;
            }

            /* prepare next offset and length*/
            offset0 = ((7 - length0) > Col) ? 0 : ((7 - length0)%Col);
            offset += (2 * Col < 7) ? (2 * Col) : 7;

            if (k == 0 && (Col > 4))
            {
                offset ++;
                offset0 ++;
            }
        }
    }

    for (j = 0; j < 1; j++)
    {
        gcVXConfig config = {{0}};

        for(p = 0; p < 16; p++)
              config.termconfig[p] = VX_ADD;

        config.termconfig[3] = config.termconfig[7] = config.termconfig[11] = config.termconfig[15] = VX_ACCUMULATOR;

        for (p = 0; p < 16; p++)
        {
            config.matrix[p]   = (p%4 < Col) ? ((max - offset - p%4 >= 0)?Matrix[max - offset - p%4]:0) : 0;
            config.aselect[p]  = ((p + 1)%4 == 0)?1:0;
        }

        for (p = 0; p < 8; p++)
        {
            config.abin0[p]    = ((p + 1) % 4 == 0)?(p/4):(offset0 + p%4);
            config.abin1[p]    = ((p + 1) % 4 == 0)?(p/4 + 2):(offset0 + p%4);
        }

        _SetUniformItem(index, 4*j + 0, 4*j + 1, 4*j + 2, 4*j + 3, Scale, gcvTRUE, &config, 0x5, &Uinform[*index]);

        /*dp4.u8 r7[0-3], r6, r5, c28_512 :selection for last dp4 pixels 0-3 + r5[6,7];r4[6,7]*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0A, OutputDp4, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(Row + 2, gcdVX_ENABLE, Clamp, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(4*j, 4*j + 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, Row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, Row + 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));
    }

    if (Context->kernel == gcvVX_KERNEL_BOX_3x3)
    {
        /*conv.s32 startReg, startReg s32 -> f32*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(Row + 2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, Row + 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x5, &Instructions->binarys[Instructions->count++]));

        /*mul r1, r1, 1.0f/div; r1 = cdfx/div;*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(Row + 2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, Row + 2, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(1, 1.0f/Context->scale, &Instructions->binarys[Instructions->count++]));

        /*conv.s32 startReg, startReg f32 -> u8*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(Row + 2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, Row + 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x0, &Instructions->binarys[Instructions->count++]));

        /*bitextract.u32 r(Row+2), r(Row+2), 0, c4;*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(Row + 2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, Xstep - 1, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, Row + 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
    }

    /*img_store.u8, r7[0-7], c1, r0.xy, r7*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, Output, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, Xstep - 1, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, Row + 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    for (i = 1; i < Row; i ++)
    {
        /*mov ri, ri+1 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(i, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, i+1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }

    /*add.u32 r0.y, r0.y, 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

    /*branch.u32 r0.y, Height, flag0-curr */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, flag-Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, Height, &Instructions->binarys[Instructions->count++]));

     Instructions->regs_count = Row + 3;
OnError:

    gcmFOOTER();
    return status;
}

static gceSTATUS _phase_halfevis(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gcoVX_Instructions *Instructions = Context->instructions;
    gctUINT32 i = 0, j =0;
    gctBOOL f16 = gcvFALSE;

    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    if(Context->policy == VX_DF_IMAGE('F','0','1','6'))
        f16 = gcvTRUE;

    /*img_load.u8 r1, c0, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r2, c1, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

    if (!f16)
    {
        /*mul_shift.u8, r3, r1, r1, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x3 | (0x3 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 1 | 1 << 16, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
        /*mul_shift.u8, r4, r1, r1, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x3 | (0x3 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 1 | 1 << 16, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(4, &Instructions->binarys[Instructions->count++]));
        /*mul_shift.u8, r5, r2, r2, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x3 | (0x3 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 1 | 1 << 16, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
        /*mul_shift.u8, r6, r2, r2, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x3 | (0x3 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 1 | 1 << 16, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(4, &Instructions->binarys[Instructions->count++]));
    }
    else
    {
        /*dp4.fp16 r3, r1, r1, c4  f16->f32*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0A, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x1 | 0x1 << 3), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4, &Instructions->binarys[Instructions->count++]));

        /*dp4.fp16 r4, r1, r1, c8  f16->f32(4-7)*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0A, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x1 | 0x1 << 3), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 8, &Instructions->binarys[Instructions->count++]));

        /*dp4.fp16 r5, r2, r2, c4  f16->f32(0-3)*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0A, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x1 | 0x1 << 3), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4, &Instructions->binarys[Instructions->count++]));

        /*dp4.fp16 r6, r1, r1, c8  f16->f32(4-7)*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0A, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x1 | 0x1 << 3), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 8, &Instructions->binarys[Instructions->count++]));
    }

    for (j = 3; j < 5; j++)
    {
        for (i = 0; i < 4; i++)
        {
            /*branch.ne r3.x, 0, 4 */
            gcmONERROR(gcoHARDWAREVX_Branch(0x06, 4, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, j, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(1, 0.0f, &Instructions->binarys[Instructions->count++]));
            /*branch.ne r5.x, 0, 3 */
            gcmONERROR(gcoHARDWAREVX_Branch(0x06, 3, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, j + 2, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(1, 0.0f, &Instructions->binarys[Instructions->count++]));
            /*mov r8.x, 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(j + 5, gcdVX_ENABLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(2, 0.0f, &Instructions->binarys[Instructions->count++]));
            /* branch.eq r3.x, r3.x, 9; Skip */
            gcmONERROR(gcoHARDWAREVX_Branch(0x05, 9, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, j, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, j, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
            /* arctan2 pre-process r1.xy, r3.x r5.x*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x63, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, j, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, j + 2, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 3 | 1 << 7, &Instructions->binarys[Instructions->count++]));
            /* dp2 r2.x, r1.xy, r1.xy*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x73, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
            /* rsq r2.x, r2.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x0D, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
            /* mul r1.xy, r1.xy, r2.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
            /* arctan2  r7.xy, r1.x r1.y*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x63, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 3, &Instructions->binarys[Instructions->count++]));
            /* mad r8.x, r7.x, r1.y, r7.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(j + 5, gcdVX_ENABLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 7, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
            /*branch.u32 r8.x, 0, 2 */
            gcmONERROR(gcoHARDWAREVX_Branch(0x03, 2, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, j + 5, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(1, 0.0f, &Instructions->binarys[Instructions->count++]));
            /*add.sat r8.x, r8.x, 6.2832 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(j + 5, gcdVX_ENABLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, j + 5, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(2, 6.2832f, &Instructions->binarys[Instructions->count++]));
        }
    }

    /* mul r8, r8, 40.744f */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(1, 40.744f, &Instructions->binarys[Instructions->count++]));
    /*conv.s32 r8, r8; float32 -> u8*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x0 | (1 << 4), &Instructions->binarys[Instructions->count++]));
    /* mul r9, r9, 40.744f */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(1, 40.744f, &Instructions->binarys[Instructions->count++]));
    /*conv.s32 r9, r9; float32 -> u8*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x0 | (1 << 4), &Instructions->binarys[Instructions->count++]));

    /*bitextract.u8 r7, r8, 0, c3;  c3 = [0, 32, 64, 96, 0, 0, 0, 0, 8, 8, 8, 8] */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x5 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
    /*bitextract.u8 r7, r9, 0, c3;  c3 = [0, 32, 64, 96, 0, 0, 0, 0, 8, 8, 8, 8] */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(4, 7, (0x5 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
    /*img_store.u8 r7, c2, r0.xy, r7*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 0xa;

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _fast9corners_load16pixels_halfevis(
    IN OUT gcoVX_Hardware_Context   *Context,
    IN gctUINT32 Index
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gcoVX_Instructions   *Instructions = Context->instructions;
    gctINT32 i;
    gcoVX_Index indexs[]                = {
        /* dst, src, src1,start, end, uniform */
        {   10, 1, 7, 0, 5, 3+4*Index    }, /* 16, 1, 2, 10, 9, 8 */
        {   10, 4, 4, 6, 7, 5+4*Index    }, /* 13,5 */
        {   11, 2, 6, 0, 3, 4+4*Index    }, /* 15,3, 11,7 */
        {   11, 3, 5, 4, 7, 5+4*Index    }, /* 14,4,12,6 */

        /* sort */
        {   8, 10, 11, 0, 7, 40    }, /* 1,2,3,4,5,6,7,8 */
        {   9, 10, 11, 0, 7, 41    }, /* 9,10,11,12,13,14,15,16 */
    };

    gcmHEADER_ARG("Context=0x%x", Context);


    /*
    *       0   1   2   3   4   5   6   7   8   9   a   b   c   d   e   f
    * r1: |   |   | 16| 1 | 2 |   |   |   |   |   |   |   |   |   |   |   |
    * r2: |   | 15|   |   |   | 3 |   |   |   |   |   |   |   |   |   |   |
    * r3: | 14|   |   |   |   |   | 4 |   |   |   |   |   |   |   |   |   |
    * r4: | 13|   |   | p |   |   | 5 |   |   |   |   |   |   |   |   |   |
    * r5: | 12|   |   |   |   |   | 6 |   |   |   |   |   |   |   |   |   |
    * r6: |   | 11|   |   |   | 7 |   |   |   |   |   |   |   |   |   |   |
    * r7: |   |   | 10| 9 | 8 |   |   |   |   |   |   |   |   |   |   |   |
    *
    * r8: |   1   |   2   |   3   |   4   |   5   |   6   |   7   |   8   |     pixel array[0 - 7]
    * r9: |   9   |   a   |   b   |   c   |   d   |   e   |   f   |  16   |     pixel array[8 -15]
    *
    *r10: |   16  |   1   |   2   |   10  |   9   |   8   |   13  |   5   |     temp[0 - 7]
    *r11: |   15  |   3   |   11  |   7   |   14  |   4   |   12  |   6   |     temp[8 -15]
    *
    * ...
    *          x         y        z         w
    *r10: |       p       |       p       |       p       |       p       |
    * ...
    *r14: |    a     a    |    b     b    |    c     c    |    0     0    |
    */
    for(i = 0; i <(gctINT32)(sizeof(indexs)/sizeof(indexs[0])); i ++)
    {
        gcoVX_Index index = indexs[i];
        /*bitextract.type, r(dst)[start, end], r(src), r(src1), c(uniform); p[i + 1]*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(index.dst, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(index.start, index.end, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, index.src, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, index.src1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, index.uniform, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
    }

    /*bitextract.u8, r10, r4.x, r4.y, c(6+4*Index); p load pixel*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 6+4*Index, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*mov r14, c35 ;{a,b,c,0} -> r14*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 35, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));


OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _fast9corners_iscorner_halfevis(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gcoVX_Instructions   *Instructions = Context->instructions;
    gctINT32 i = 0;

    gcmHEADER_ARG("Context=0x%x", Context);

    /*
     *  r8: |  0    1  |  2    3  |  4    5  |  6    7  |
     *  r9: |  8    9  |  10   11 |  12   13 |  14   15 |
     * r10: |    p     |    p     |    p     |    p     |
     * r11: |   p+/-t  |   p+/-t  |   p+/-t  |   p+/-t  |
     * r12: | c+/-[0-7]| c+/-[0-7]| c+/-[0-7]| c+/-[0-7]|
     * r13: |c+/-[0-15]|c+/-[0-15]|c+/-[0-15]|c+/-[0-15]|
     * r14: |  a    a  |  b    b  |  c    c  |  0    0  |
     */

    /*mov r0.zw, c36.zwzw; */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 36, gcdVX_SWIZZLE4(2, 3, 2, 3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    for(i = 0; i < 2; i++)
    {
        gctUINT32 condition[2] = {0x01, 0x02};
        /*add.u32 r11, r10, r14.zzzz; r2 = (p +/- tolerance) */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 14, gcdVX_SWIZZLE4(2, 2, 2, 2), i, &Instructions->binarys[Instructions->count++]));

        /*compare with (p +/- tolerance)*/
        /*cmp r12, r8, r11, c36.xxxx;  (data[0-7] > (p + tolerance))/(data[0-7] < (p - tolerance)) -> 1 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, condition[i], 0x3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(12, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 11, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 36, gcdVX_SWIZZLE4(0, 0, 0, 0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /*cmp r13, r9, r11, c36.xxxx;  (data[8-15] > (p + tolerance))/(data[8-15] < (p - tolerance)) -> 1 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, condition[i], 0x3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 11, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 36, gcdVX_SWIZZLE4(0, 0, 0, 0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /*dp16x1.u8 r12[0, 0], r12, r13, c42 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(12, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x6 | (0x6 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 12, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_Setuniform(2, 42, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        /*mul_shift.u8, r12, r12, 1, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(12, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(1, 1, (0x6 | (0x6 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 12, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 1 | (1 << 16), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
        /*mov r12, r12.x; */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(12, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 12, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /*bitextract.u8, r13, r12, r12, c37; ((r4 >>> (0~7)) & 111111111) */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 12, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 12, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 37, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        /*bitextract.u8, r12, r12, r12, c38; ((r4 >>> (8~15)) & 111111111)*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(12, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 12, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 12, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 38, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        /*cmp r13, r13, c39, r0.wwww; */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x05, 0x3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(13, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 13, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 39, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE4(3, 3, 3, 3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /*cmp r12, r12, c39, r0.wwww; */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x05, 0x3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(12, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 12, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 39, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE4(3, 3, 3, 3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* branch.eq r13, 0, (2+1) */
        gcmONERROR(gcoHARDWAREVX_Branch(0x05, 1 + 1, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 13, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count++]));

        /* add.u8 r0.z, r0.z, 1 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1, &Instructions->binarys[Instructions->count++]));


        /* branch.eq r12, 0, (2+1) */
        gcmONERROR(gcoHARDWAREVX_Branch(0x05, 1 + 1, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 12, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count++]));

        /* add.u8 r0.z, r0.z, 1 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1, &Instructions->binarys[Instructions->count++]));

    }

    gcmONERROR(gcoHARDWAREVX_Ctrl(0x15, Instructions->count, 0, &Instructions->binarys[Instructions->count]));
    Instructions->count++;

OnError:
    gcmFOOTER();
    return status;
}

#define FUNCTION_CORNER_CHECKING 0xa9

static gceSTATUS _fast9corners_score_halfevis(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gcoVX_Instructions   *Instructions = Context->instructions;
    gctUINT32 flag = 0;

    gcmHEADER_ARG("Context=0x%x", Context);

    /*
    * ...
    *r14: |  a   a  |  b   b  |  c   c  |  0   0  |
    *
    *     * * * * * * * * * * * * * * * * * * * * *
    *          if (!vxIsFastCorner(buf, p, tolerance))
    *              return 0;
    *  step1:
    *          c = (a + b)/2;
    *          if (vxIsFastCorner(buf, p, c))
    *              a = c;
    *          else
    *              b = c;
    *
    *          if (b - a > 1)
    *              goto step1;
    *
    *     * * * * * * * * * * * * * * * * * * * * *
    *
    */

    flag = Instructions->count;

    /*(tolerance + addon)/2 -> r14.z, c = (b + a)/2 */
    /*add.u32 r14.z, r14.y, r14.x;  */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x6, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 14, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*rshift r14.z r14.z 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x5A, 0, 0x6, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, (1 | 1 << 16), &Instructions->binarys[Instructions->count++]));

    /* call corner checking function */
    gcmONERROR(gcoHARDWAREVX_Ctrl(0x14, 0, FUNCTION_CORNER_CHECKING, &Instructions->binarys[Instructions->count++]));

    /*mov.ne r14.x, r0.z, 0, r14.z ;if(r0.z != 0)r14.z -> r14.x, a = c*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x06, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 14, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*mov.eq r14.y, r0.z, 0, r14.z ;if(r0.z == 0)r14.z -> r14.y, b = c*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x05, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 14, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*sat.u32 r14.w, r14.y, r14.x;  (b-a > 1)*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x6, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 14, gcdVX_SWIZZLE1(0), gcvTRUE, &Instructions->binarys[Instructions->count++]));

    /*branch.gt r14.w, 1, -8 (b-a > 1)*/
    gcmONERROR(gcoHARDWAREVX_Branch(0x01, flag - Instructions->count, 0x6, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, (1 | 1 << 16), &Instructions->binarys[Instructions->count++]));

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _fast9corners_nonmax_suppression_halfevis(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS                    status = gcvSTATUS_OK;
    gcoVX_Instructions   *Instructions  = Context->instructions;
    gctUINT32                         i = 0;
    gctBOOL                   do_nonmax = Context->col;
    RelOffset                    offset = {{ -1, 0 }};

    gcmHEADER_ARG("Context=0x%x", Context);

    /*
     * r1: |    y-1   |          |          |          |
     * r2: |     y    |          |          |          |
     * r3: |    y+1   |          |          |          |
     * r4: |     p    |          |          |          |
     * r5: | cmp(y-1) | cmp(y+1) |          |          |
     * r6: |   count  |    t/p   |     x    |     y    |
     * r7: |          |          |          |          |
     */

    /*mov r1, 0 ;zero r1 -> count*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));
    /*mov r2, 0 ;zero r2 -> count*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));
    /*mov r3, 0 ;zero r3 -> count*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

    for(i = 1; i < 4; i++)
    {
        offset.u.y = (gctUINT16)(i-2);

        /*img_load.u8 r1-3, c0, r0.xy, -1,i; */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(i, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset.raw, &Instructions->binarys[Instructions->count++]));
    }

    /*bitextract.u8, r4, r2.x, r2.y, c3; p load pixel*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    if(do_nonmax)
    {
        /*bitextract.u8, r1, r2.x, r2.y, c4; load (x-1,y)/r2[0] -> r3[3]*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        /*bitextract.u8, r3, r2.x, r2.y, c5; load (x+1,y)/r2[2] -> r1[3]*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 5, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        /*cmp r5.x, r4.x, r1.x, c6;  p >= r1*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x03, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 6, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /*cmp r5.y, r4.x, r3.x, c6;  p > r3 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x01, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 6, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /*cmp r4.x, r5.x, c6.x, r4.x;   */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x05, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 6, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /*cmp r4.x, r5.y, c6.y, r4.x;   */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x05, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 6, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    }

    /*img_store c1, r0.xy, r4.x; store point array; */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 8;

OnError:
    gcmFOOTER();
    return status;
}

#define SCORE_CHECKING_COUNT 30

static gceSTATUS _fast9corners_strength_halfevis(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status                    = gcvSTATUS_OK;
    gcoVX_Instructions *Instructions    = Context->instructions;
    gctUINT32 k = 0, i = 0;
    gctBOOL do_nonmax = Context->constant_value;
    RelOffset offset                    = {{ -3, 0 }};

    gcmHEADER_ARG("Context=0x%x", Context);

    /* load 1-16 pixel, there are 26 instructions
    *       0   1   2   3   4   5   6   7   8   9   a   b   c   d   e   f
    * r1: |   |   | 16| 1 | 2 |   |   |   |   |   |   |   |   |   |   |   |
    * r2: |   | 15|   |   |   | 3 |   |   |   |   |   |   |   |   |   |   |
    * r3: | 14|   |   |   |   |   | 4 |   |   |   |   |   |   |   |   |   |
    * r4: | 13|   |   | p |   |   | 5 |   |   |   |   |   |   |   |   |   |
    * r5: | 12|   |   |   |   |   | 6 |   |   |   |   |   |   |   |   |   |
    * r6: |   | 11|   |   |   | 7 |   |   |   |   |   |   |   |   |   |   |
    * r7: |   |   | 10| 9 | 8 |   |   |   |   |   |   |   |   |   |   |   |
    *
    * r8: |   1   |   2   |   3   |   4   |   5   |   6   |   7   |   8   |
    * r9: |   9   |   a   |   b   |   c   |   d   |   e   |   f   |  16   |
    * ...
    *          x         y         z         w
    * r10:|       p       |       p       |       p       |       p       |
    * ...
    * r14:|    a     a    |    b     b    |    c     c    |    0     0    |
    */
    for(i = 1; i < 8; i++)
    {
        offset.u.y = (gctUINT16)(i-4);

        /*img_load.u8 r1-7, c0, r0.xy, -3,i*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(i, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, offset.raw, &Instructions->binarys[Instructions->count++]));
    }

    for(k = 0; k < Context->xstep; k++)
    {
        _fast9corners_load16pixels_halfevis(Context, k);

        /* call corner checking function */
        gcoHARDWAREVX_Ctrl(0x14, 0, FUNCTION_CORNER_CHECKING - (do_nonmax?0:(8 * Context->xstep)), &Instructions->binarys[Instructions->count++]);
        /*mov.eq r14.x, r0.z, 0, 0 ;if(r0.z == 0)0 -> r14.x, a = c*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x05, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(14, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));;

        if(do_nonmax)
        {
            /* branch.eq r0.z, 0, 13 */
            gcmONERROR(gcoHARDWAREVX_Branch(0x05, 7 + 1, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count++]));

            /* compute nonmax suppression stength, there are 7 instructions */
            _fast9corners_score_halfevis(Context);
        }

        /*mul_shift.u8, r4, r3, 1, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(k, k, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 14, gcdVX_SWIZZLE4(0, 0, 0, 0), ABSOLUTE_FLAG, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, (1 | (1 << 8)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    }

    /*img_store c1, r0.xy, r15.xy; store strength */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

    for(i = 1; i < 7; i++)
    {
        /*mov ri, r(i+1) ;*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(i, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, i+1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));
    }

    /* add.u32 r0.y, r0.y, 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1, &Instructions->binarys[Instructions->count++]));
    /*branch.lt r0.y, height + 1, loop */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, 6, 0x5, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, Context->volume + 1, &Instructions->binarys[Instructions->count++]));

    /*branch.gt 1, 0, Instructions->count, 30 + 1; exit */
    gcmONERROR(gcoHARDWAREVX_Branch(0x01, SCORE_CHECKING_COUNT + 1, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(0, 1U, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count++]));

    assert(Instructions->count == (FUNCTION_CORNER_CHECKING - (do_nonmax?0:(8 * Context->xstep))));

    /******************************************************************************
     * functions: corner checking
     ******************************************************************************/
    /*
     * checking if is coreners, there are 141 instructions
     *
     *  r8: |  0    1  |  2    3  |  4    5  |  6    7  |
     *  r9: |  8    9  |  10   11 |  12   13 |  14   15 |
     * r10: |    p     |    p     |    p     |    p     |
     * r11: |   p+/-t  |   p+/-t  |   p+/-t  |   p+/-t  |
     * r12: | c+/-[0-7]| c+/-[0-7]| c+/-[0-7]| c+/-[0-7]|
     * r13: |c+/-[0-15]|c+/-[0-15]|c+/-[0-15]|c+/-[0-15]|
     * r14: |  a    a  |  b    b  |  c    c  |  0    0  |
     * ...
     */

    _fast9corners_iscorner_halfevis(Context);

    assert((Instructions->count - FUNCTION_CORNER_CHECKING) == (SCORE_CHECKING_COUNT - (do_nonmax?0:(8 * Context->xstep))));

    Instructions->regs_count = 16;

    assert(Instructions->count < 256);
OnError:
    gcmFOOTER();

    return status;
}


static gceSTATUS _fast9corners_halfevis(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
#define F9C_STRENGTH 0
#define F9C_NONMAX   1

    gceSTATUS status                    = gcvSTATUS_OK;
    gcoVX_Hardware_Step steps[] = {
        {0, "strength", F9C_STRENGTH, &_fast9corners_strength_halfevis},
        {1, "nonmax suppression", F9C_NONMAX, &_fast9corners_nonmax_suppression_halfevis},
    };

    gcmHEADER_ARG("Context=0x%x", Context);
    assert(Context->step < 2);

    gcmONERROR(steps[Context->step].func(Context));

OnError:
    gcmFOOTER();

    return status;
}

static gceSTATUS _minmaxloc_non_filter(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gcoVX_Instructions *Instructions = Context->instructions;
    gceSTATUS                 status = gcvSTATUS_OK;
    gctUINT32                  Input = Context->input_type[0];
    gctUINT32                   flag = 0;
    gctUINT16                      i = 0;
    gcmHEADER_ARG("Context=0x%x", Context);

    /*mov r4.x, c3.y*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));
    /*mov r4.y, c3.z*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));

    flag = Instructions->count;
    /*img_load.u8 r1, c0, r0.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

    /*mul_shift.u8, r2, r1, r1, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (Input | (Input << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
    /*mul_shift.u8, r3, r1, r1, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (Input | (Input << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(4, &Instructions->binarys[Instructions->count++]));

    if (Input == 0x7)
    {
        /*mul_shift.u8, r5, r1, r1, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (Input | (Input << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(8, &Instructions->binarys[Instructions->count++]));
        /*mul_shift.u8, r6, r1, r1, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (Input | (Input << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(12, &Instructions->binarys[Instructions->count++]));
    }

    for (i = 0; i < 4; i++)
    {
        /*mov.lt r4.x, r4.x, r2.x, r2.x ;if(r2.x < r4.x)r2.x -> r4.x*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x01, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mov.lt r4.y, r4.y, r2.x, r2.x ;if(r2.x > r4.y)r2.x -> r4.y*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x02, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /*mov.lt r4.x, r4.x, r3.x, r3.x ;if(r3.x < r1.x)r3.x -> r4.x*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x01, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mov.lt r4.y, r4.y, r3.x, r3.x ;if(r3.x > r4.y)r3.x -> r4.y*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x02, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        if (Input == 0x7)
        {
            /*mov.lt r4.x, r4.x, r5.x, r5.x ;if(r5.x < r4.x)r5.x -> r4.x*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x01, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
            /*mov.lt r4.y, r4.y, r5.x, r5.x ;if(r5.x > r1.y)r5.x -> r4.y*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x02, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));

            /*mov.lt r4.x, r4.x, r6.x, r6.x ;if(r6.x < r4.x)r6.x -> r4.x*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x01, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 6, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
            /*mov.lt r4.y, r4.y, r6.x, r6.x ;if(r6.x > r4.y)r6.x -> r4.y*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x02, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 6, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        }
    }
    /*add.u32 r0.yz, r0, 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE2(1, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

    /*branch.u32 r0.z, c3.w, flag-curr */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, flag-Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 3, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count++]));

    /*atom_min c1, 0, r4.x */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x68, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));
    /*atom_max c2, 0, r4.y */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x69, 0, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));

    if (Input == 0x7)
        Instructions->regs_count = 0x7;
    else
        Instructions->regs_count = 0x5;

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _minmaxloc_halfevis(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
#define MML_FILTER 0
#define MML_LOC   1
#define MML_PACK 2

    gceSTATUS status                    = gcvSTATUS_OK;
    gcoVX_Hardware_Step steps[] = {
        {0, "filter", MML_FILTER, &_minmaxloc_non_filter},
        {1, "location", MML_LOC, &_minmaxloc_loc},
        {1, "pack data", MML_PACK, &_minmaxloc_pack},
    };

    gcmHEADER_ARG("Context=0x%x", Context);
    assert(Context->step < 3);

    gcmONERROR(steps[Context->step].func(Context));

OnError:
    gcmFOOTER();

    return status;
}

static gceSTATUS _morphology_vx2(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gctUINT32 Kernel = Context->kernel;
    gctUINT32 Input = Context->input_type[0];
    gctUINT32 Border = Context->borders;
    gcoVX_Instructions *Instructions = Context->instructions;
    gctUINT32 Opcode[2] = {0};
    RelOffset minusOne = {{ -1, -1 }};
    RelOffset zero = {{ -1, 0 }};
    RelOffset plusOne = {{ -1, 1 }};
    gctUINT32 flag;

    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    switch(Kernel)
    {
    case gcvVX_KERNEL_DILATE_3x3:
        Opcode[0] = 0x19;
        Opcode[1] = 0x1C;
        break;
    case gcvVX_KERNEL_ERODE_3x3:
        Opcode[0] = 0x18;
        Opcode[1] = 0x1B;
        break;
    case gcvVX_KERNEL_MEDIAN_3x3:
        Opcode[0] = 0x1A;
        Opcode[1] = 0x1D;
        break;
    }

    if(Border == gcvVX_BORDER_MODE_CONSTANT || Border == gcvVX_BORDER_MODE_UNDEFINED)
    {
        /*mov r1, c3 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }

    /*img_load.u8 r1, c0, r0.xy, -1,-1*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, minusOne.raw, &Instructions->binarys[Instructions->count++]));

    if(Border == gcvVX_BORDER_MODE_CONSTANT || Border == gcvVX_BORDER_MODE_UNDEFINED)
    {
        /*mov r2, c3 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }

    /*img_load.u8 r2, c0, r0.xy, -1,0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, zero.raw, &Instructions->binarys[Instructions->count++]));

    flag = Instructions->count;

    if(Border == gcvVX_BORDER_MODE_CONSTANT || Border == gcvVX_BORDER_MODE_UNDEFINED)
    {
        /*mov r3, c3 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }

    /*img_load.u8 r3, c0, r0.xy, -1,1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusOne.raw, &Instructions->binarys[Instructions->count++]));

    /*vertMax3.u8, r4, r1, r2, r3 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, Opcode[0], Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input), Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*horzMax3.u8, r4, r4 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, Opcode[1], Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input) - 2, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    if (Kernel == gcvVX_KERNEL_MEDIAN_3x3)
    {
        /*vertMax3.u8, r5, r1, r2, r3 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x19, Input, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input), Input, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
        /*vertMin3.u8, r1, r1, r2, r3 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x18, Input, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input), Input, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        /*horzMax3.u8, r1, r1 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x1C, Input, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input) - 2, Input, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
        /*horzMin3.u8, r5, r5 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x1B, Input, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input) - 2, Input, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        /*vertMed3.u8, r4, r1, r4, r5 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x1A, Input, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input) - 2, Input, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
    }

    /*img_store.u8 c1, r0.xy, r4.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input) - 2, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*mov r1, r2 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*mov r2, r3 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*add.u32 r0.yz, r0, 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE2(1, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

    /*branch.u32 r0.z, c2.x, flag-count */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, flag-Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = (Kernel == gcvVX_KERNEL_MEDIAN_3x3) ? 0x6 : 0x5;
OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _morphology_halfevis(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gctUINT32 Kernel = Context->kernel;
    gctUINT32 Input = Context->input_type[0];
    gctUINT32 Border = Context->borders;
    gcoVX_Instructions *Instructions = Context->instructions;
    gctUINT32 Opcode = 0;
    gctUINT32 Bit = 0;
    RelOffset minusOne = {{ -1, -1 }};
    RelOffset zero = {{ -1, 0 }};
    RelOffset plusOne = {{ -1, 1 }};
    gctUINT32 flag;
    gctUINT32 i = 0;

    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    switch(Kernel)
    {
    case gcvVX_KERNEL_DILATE_3x3:
        Opcode = 0x02;
        Bit = 0;
        break;
    case gcvVX_KERNEL_ERODE_3x3:
        Opcode = 0x01;
        Bit = 255;
        break;
    }
    /*               xstep = 6               */
    /*                src                    */
    /*----------------------------------------
    | r4.x r4.y r4.z r4.w r5.x r5.y r5.z r5.w |
    | r6.x r6.y r6.z r6.w r7.x r7.y r7.z r7.w |
    | r8.x r8.y r8.z r8.w r9.x r9.y r9.z r9.w |
    -----------------------------------------*/
    /*          convert to compare           */
    /*----------------------------------------
    |      r1.x r1.y r1.z r2.x r2.y r2.z      |
    |-----------------------------------------|
    |      r4.x r4.y r4.z r5.x r5.y r5.z      |
    |-----------------------------------------|
    |      r6.x r6.y r6.z r7.x r7.y r7.z      |
    -----------------------------------------*/
    if(Border == gcvVX_BORDER_MODE_CONSTANT || Border == gcvVX_BORDER_MODE_UNDEFINED)
    {
        /*mov r1, c3 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }

    /*img_load.u8 r1, c0, r0.xy, -1,-1*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, minusOne.raw, &Instructions->binarys[Instructions->count++]));

    if(Border == gcvVX_BORDER_MODE_CONSTANT || Border == gcvVX_BORDER_MODE_UNDEFINED)
    {
        /*mov r2, c3 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }

    /*img_load.u8 r2, c0, r0.xy, -1,0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, zero.raw, &Instructions->binarys[Instructions->count++]));

    /*mul_shift.u8, r4, r1, r1, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
    /*mul_shift.u8, r5, r1, r1, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(4, &Instructions->binarys[Instructions->count++]));
    /*mul_shift.u8, r6, r2, 1, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
    /*mul_shift.u8, r7, r2, 1, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(4, &Instructions->binarys[Instructions->count++]));

    /*mov r1, Bit */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, Bit, &Instructions->binarys[Instructions->count++]));
    /*mov r2, Bit */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, Bit, &Instructions->binarys[Instructions->count++]));
    for (i = 0; i < 3; i++)
    {
        /*mov.lt r1.x, r1.x, r4.x-z, r4.x-z ;if(r4.x-z < r1.x)r4.x-z -> r1.x*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, Opcode, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mov.lt r1.y, r1.y, r4.y-w, r4.y-w ;if(r4.y-w < r1.y)r4.y-w -> r1.y*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, Opcode, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE1(i + 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE1(i + 1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mov.lt r2.y, r2.y, r5.x-z, r5.x-z ;if(r5.x-z < r2.y)r5.x-z -> r2.y*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, Opcode, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mov.lt r2.z, r2.z, r5.y-w, r5.y-w ;if(r5.y-w < r2.z)r5.y-w -> r2.z*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, Opcode, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE1(i + 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE1(i + 1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    }
    /* r1.z = min(r4.z, r4.w, r5.x) */
    /*mov.lt r1.z, r1.z, r4.z, r4.z ;if(r4.z < r1.y)r4.z -> r1.z*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, Opcode, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /*mov.lt r1.z, r1.z, r4.w, r4.w ;if(r4.w < r1.y)r4.w -> r1.z*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, Opcode, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /*mov.lt r1.z, r1.z, r5.x, r5.x ;if(r5.x < r1.z)r5.x -> r1.z*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, Opcode, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /* r2.x = min(r4.w, r5.x, r5.y) */
    /*mov.lt r2.x, r2.x, r4.w, r4.w ;if(r4.w < r2.x)r4.w -> r2.x*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, Opcode, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /*mov.lt r2.x, r2.x, r5.x, r5.x ;if(r5.x < r2.x)r5.x -> r2.x*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, Opcode, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /*mov.lt r2.x, r2.x, r5.y, r5.y ;if(r5.y < r2.x)r5.y -> r2.x*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, Opcode, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*mov r4, Bit */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, Bit, &Instructions->binarys[Instructions->count++]));
    /*mov r5, Bit */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, Bit, &Instructions->binarys[Instructions->count++]));
    for (i = 0; i < 3; i++)
    {
        /*mov.lt r4.x, r4.x, r6.x-z, r6.x-z ;if(r6.x-z < r4.x)r6.x-z -> r4.x*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, Opcode, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 6, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mov.lt r4.y, r4.y, r6.y-w, r6.y-w ;if(r6.y-w < r4.y)r6.y-w -> r4.y*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, Opcode, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 6, gcdVX_SWIZZLE1(i + 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE1(i + 1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mov.lt r5.y, r5.y, r7.x-z, r7.x-z ;if(r7.x-z < r5.y)r7.x-z -> r5.y*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, Opcode, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 7, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 7, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mov.lt r5.z, r5.z, r7.y-w, r7.y-w ;if(r7.y-w < r5.z)r7.y-w -> r5.z*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, Opcode, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 7, gcdVX_SWIZZLE1(i + 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 7, gcdVX_SWIZZLE1(i + 1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    }
    /* r4.z = min(r6.z, r6.w, r7.x) */
    /*mov.lt r4.z, r4.z, r6.z, r6.z ;if(r6.z < r4.z)r6.z -> r4.z*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, Opcode, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 6, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /*mov.lt r4.z, r4.z, r6.w, r6.w ;if(r6.w < r4.z)r4.w -> r4.z*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, Opcode, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 6, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /*mov.lt r4.z, r4.z, r7.x, r7.x ;if(r7.x < r4.z)r7.x -> r4.z*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, Opcode, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 7, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 7, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /* r5.x = min(r6.w, r7.x, r7.y) */
    /*mov.lt r5.x, r5.x, r6.w, r6.w ;if(r6.w < r5.x)r6.w -> r5.x*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, Opcode, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 6, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /*mov.lt r5.x, r5.x, r7.x, r7.x ;if(r7.x < r5.x)r7.x -> r5.x*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, Opcode, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 7, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 7, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /*mov.lt r5.x, r5.x, r7.y, r7.y ;if(r7.y < r5.x)r7.y -> r5.x*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, Opcode, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 7, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 7, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    flag = Instructions->count;

    if(Border == gcvVX_BORDER_MODE_CONSTANT || Border == gcvVX_BORDER_MODE_UNDEFINED)
    {
        /*mov r3, c3 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }

    /*img_load.u8 r3, c0, r0.xy, -1,1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Input), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusOne.raw, &Instructions->binarys[Instructions->count++]));

    /*mul_shift.u8, r8, r3, 1, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
    /*mul_shift.u8, r9, r3, 1, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(4, &Instructions->binarys[Instructions->count++]));

    /*mov r6, Bit */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, Bit, &Instructions->binarys[Instructions->count++]));
    /*mov r7, Bit */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, Bit, &Instructions->binarys[Instructions->count++]));
    for (i = 0; i < 3; i++)
    {
        /*mov.lt r6.x, r6.x, r8.x-z, r8.x-z ;if(r8.x-z < r6.x)r8.x-z -> r6.x*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, Opcode, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 8, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mov.lt r6.y, r6.y, r8.y-w, r8.y-w ;if(r8.y-w < r6.y)r8.y-w -> r6.y*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, Opcode, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE1(i + 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 8, gcdVX_SWIZZLE1(i + 1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mov.lt r7.y, r7.y, r9.x-z, r9.x-z ;if(r9.x-z < r7.y)r9.x-z -> r7.y*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, Opcode, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mov.lt r7.z, r7.z, r9.y-w, r9.y-w ;if(r9.y-w < r7.z)r9.y-w -> r7.z*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, Opcode, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(i + 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE1(i + 1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    }
    /* r6.z = min(r8.z, r8.w, r9.x) */
    /*mov.lt r6.z, r6.z, r8.z, r8.z ;if(r8.z < r6.z)r8.z -> r6.z*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, Opcode, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 8, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /*mov.lt r6.z, r6.z, r8.w, r8.w ;if(r8.w < r6.z)r8.w -> r6.z*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, Opcode, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 8, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /*mov.lt r6.z, r6.z, r9.x, r9.x ;if(r9.x < r6.z)r9.x -> r6.z*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, Opcode, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /* r7.x = min(r8.w, r9.x, r9.y) */
    /*mov.lt r7.x, r7.x, r8.w, r8.w ;if(r8.w < r7.x)r8.w -> r7.x*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, Opcode, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 8, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /*mov.lt r7.x, r7.x, r9.x, r9.x ;if(r9.x < r7.x)r9.x -> r7.x*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, Opcode, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /*mov.lt r7.x, r7.x, r9.y, r9.y ;if(r9.y < r7.x)r9.y -> r7.x*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, Opcode, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*mov r8, Bit */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, Bit, &Instructions->binarys[Instructions->count++]));
    /*mov r9, Bit */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, Bit, &Instructions->binarys[Instructions->count++]));
    /*r8 = min(r1, r2, r3); r9 = min(r2, r5, r7)  */
    for (i = 0; i < 3; i++)
    {
        /*mov.lt r8.x, r8.x, r4.x, r4.x ;if(r4.x < r8.x)r4.x -> r8.x*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, Opcode, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mov.lt r8.x, r8.x, r1.x, r1.x ;if(r1.x < r8.x)r1.x -> r8.x*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, Opcode, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mov.lt r8.x, r8.x, r6.x, r6.x ;if(r6.x < r8.x)r6.x -> r8.x*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, Opcode, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 6, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mov.lt r9.x, r9.x, r2.x, r2.x ;if(r2.x < r9.x)r2.x -> r9.x*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, Opcode, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mov.lt r9.x, r9.x, r5.x, r5.x ;if(r5.x < r9.x)r5.x -> r9.x*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, Opcode, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mov.lt r9.x, r9.x, r7.x, r7.x ;if(r7.x < r9.x)r7.x -> r9.x*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, Opcode, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 7, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 7, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    }

    /*bitextract.u8 r3, r8, 0, c3;  c3 = [0, 32, 64, 96, 0, 0, 0, 0, 8, 8, 8, 8] */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 2, (0x5 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
    /*bitextract.u8 r3, r9, 0, c3;  c3 = [0, 32, 64, 96, 0, 0, 0, 0, 8, 8, 8, 8] */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 5, (0x5 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*img_store.u8 c1, r0.xy, r3.xy*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    for (i = 1; i < 3; i++)
    {
        /*mov r1, r4 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(i, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, i + 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        /*mov r4, r6 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(i + 3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, i + 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }

    /*add.u32 r0.yz, r0, 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE2(1, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

    /*branch.u32 r0.z, c2.x, flag-count */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, flag-Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 0xa;
OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _histogram_halfevis(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gcoVX_Instructions *Instructions = Context->instructions;

    gctUINT32 flag, i;

    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    /*mov r0.w, 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

    /*img_load.u8 r1, c0, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

    for(i = 0; i < Context->xstep/4; i++)
    {
        /* mul_shift r3, c3(0x01010101), r1.x/y/z/w, 1, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(i, &Instructions->binarys[Instructions->count++]));

        /*add.u32 r2, r3, -c2.x(offset) */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 2, gcdVX_SWIZZLE1(0), gcvTRUE, &Instructions->binarys[Instructions->count++]));

        /*mad r2, r2, 1.0f/window, 0.00001f;*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(2, 0.00001f, &Instructions->binarys[Instructions->count++]));

        /*conv.s32 r2 r2 f32 -> s32;*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (1 << 0), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x0, &Instructions->binarys[Instructions->count++]));

        /*lshift r2, r2, 2 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x59, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 2U, &Instructions->binarys[Instructions->count++]));

        for(flag = 0; flag < 4; flag++)
        {
            /*branch.u32 r3.x/y/z/w, offset, c2.x(offset);  if(r2.x/y/z/w < offset) => jump next*/
            gcmONERROR(gcoHARDWAREVX_Branch(0x02, 3, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(flag), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

            /*branch.u32 r3.x/y/z/w, offset, c2.y(offset+ rang);  if(r2.x/y/z/w >= (offset + rang)) => jump next*/
            gcmONERROR(gcoHARDWAREVX_Branch(0x03, 2, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(flag), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

            /*atom_add c1, r2.x/y/z/w, r0.w */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x65, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE1(flag), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count++]));
        }
    }

    Instructions->regs_count = 0x4;

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _edge_trace_non_filter_hysteresis(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS                    status = gcvSTATUS_OK;
    gcoVX_Instructions   *Instructions  = Context->instructions;
    RelOffset minusOne = {{ -1, -1 }};
    RelOffset zero = {{ -1, 0 }};
    RelOffset plusOne = {{ -1, 1 }};
    gctUINT32 flag[2], i, j;
    gctUINT32 *index = Context->unifor_num;
    gcoVX_Kernel_Context_Uniform *Uinform = Context->uniform;
    gcVXConfig config = {{0}};
    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    for (i = 0; i < 8; i++)
    {
        config.termconfig[i] = VX_ACCUMULATOR;
        config.abin0[i] = i + 1;
        config.aselect[i] = 0;
    }

    _SetUniformItem(index, 0, 0, 0, 0, 0, gcvTRUE, &config, 0x7, &Uinform[*index]);

    /*mov r0.yz, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE2(1, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r1, c0, r0.xy, -1,-1*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(0x7), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, minusOne.raw, &Instructions->binarys[Instructions->count++]));
    /*img_load.u8 r2, c0, r0.xy, -1,0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(0x7), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, zero.raw, &Instructions->binarys[Instructions->count++]));
    flag[0] = Instructions->count;

    /*img_load.u8 r3, c0, r0.xy, -1,1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(0x7), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusOne.raw, &Instructions->binarys[Instructions->count++]));

    for(j = 1; j < 4; j += 2)
    {
        /*mul_shift.u8, r9, r1, r1, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, j, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
        /*mul_shift.u8, r10, r1, r1, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, j, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(4, &Instructions->binarys[Instructions->count++]));
        /*mul_shift.u8, r11, r1, r1, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, j, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(8, &Instructions->binarys[Instructions->count++]));
        /*mov r12, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(j + 11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));
        /*mov r13, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(j + 12, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 3; i++)
        {
            /*mov.lt r12.x, r12.x, r9.x-z, r9.x-z ;if(r9.x-z > r1.x)r9.x-z -> r12.x*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(j + 11, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, j + 11, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
            /*mov.lt r12.y, r12.y, r9.y-w, r9.y-w ;if(r9.y-w > r12.y)r9.y-w -> r12.y*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(j + 11, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, j + 11, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(i + 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE1(i + 1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
            /*mov.lt r13.x, r13.x, r10.x-z, r10.x-z ;if(r10.x-z > r13.x)r10.x-z -> r13.x*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(j + 12, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, j + 12, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 10, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
            /*mov.lt r13.y, r13.y, r10.y-w, r10.y-w ;if(r10.y-w > r13.y)r10.y-w -> r13.y*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(j + 12, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, j + 12, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10, gcdVX_SWIZZLE1(i + 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 10, gcdVX_SWIZZLE1(i + 1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        }
        for (i = 0; i < 2; i++)
        {
            /*mov.lt r13.w, r13.w, r11.x-y, r11.x-y ;if(r11.x-y > r13.2)r11.x-y -> r13.w*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(j + 12, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, j + 12, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 11, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 11, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
            /*mov.lt r13.z, r13.z, r10.z-w, r10.z-w ;if(r10.z-w > r13.z)r10.z-w -> r13.z*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(j + 12, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, j + 12, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10, gcdVX_SWIZZLE1(i + 2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 10, gcdVX_SWIZZLE1(i + 2), gcvFALSE, &Instructions->binarys[Instructions->count++]));
            /*mov.lt r12.z, r12.z, r9.z-w, r9.z-w ;if(r9.z-w > r1.x)r9.z-w -> r12.z*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(j + 11, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, j + 11, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(i + 2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE1(i + 2), gcvFALSE, &Instructions->binarys[Instructions->count++]));
            /*mov.lt r12.w, r12.w, r10.x-y, r10.x-y ;if(r10.x-y > r12.w)r10.x-y -> r12.w*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(j + 11, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, j + 11, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 10, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        }
        /*mov.lt r12.z, r12.z, r10.x, r10.x ;if(r10.x > r1.x)r10.x -> r12.z*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(j + 11, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, j + 11, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 10, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mov.lt r12.w, r12.w, r9.w, r9.w ;if(r9.w > r12.w)r9.w -> r12.w*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(j + 11, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, j + 11, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mov.lt r13.z, rr13.z, r11.x, rr11.x ;if(r11.x > r13.z)r11.x -> r13.z*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(j + 12, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, j + 12, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 11, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 11, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mov.lt r13.w, r13.w, r10.w, r10.w ;if(r10.w > r13.2)r10.w -> r13.w*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(j + 12, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, j + 12, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 10, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    }

    /*mov r8, r2 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    flag[1] = Instructions->count;

    /*mul_shift.u8, r9, r2, r2, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
    /*mul_shift.u8, r10, r2, r2, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(4, &Instructions->binarys[Instructions->count++]));
    /*mul_shift.u8, r11, r2, r2, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 3, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(8, &Instructions->binarys[Instructions->count++]));
    /*mov r16, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));
    /*mov r17, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(17, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));
    for (i = 0; i < 3; i++)
    {
        /*mov.lt r16.x, r16.x, r9.x-z, r9.x-z ;if(r9.x-z > r1.x)r9.x-z -> r12.x*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mov.lt r16.y, r16.y, r9.y-w, r9.y-w ;if(r9.y-w > r12.y)r9.y-w -> r12.y*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(i + 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE1(i + 1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mov.lt r17.x, r17.x, r10.x-z, r10.x-z ;if(r10.x-z > r14.x)r10.x-z -> r14.x*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(17, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 17, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 10, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mov.lt r17.y, r17.y, r10.y-w, r10.y-w ;if(r10.y-w > r14.y)r10.y-w -> r14.y*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(17, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 17, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10, gcdVX_SWIZZLE1(i + 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 10, gcdVX_SWIZZLE1(i + 1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    }
    for (i = 0; i < 2; i++)
    {
        /*mov.lt r17.w, r17.w, r11.x-y, r11.x-y ;if(r11.x-y > r14.2)r11.x-y -> r14.w*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(17, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 17, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 11, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 11, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mov.lt r17.z, r17.z, r10.z-w, r10.z-w ;if(r10.z-w > r14.z)r10.z-w -> r14.z*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(17, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 17, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10, gcdVX_SWIZZLE1(i + 2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 10, gcdVX_SWIZZLE1(i + 2), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mov.lt r16.z, r16.z, r9.z-w, r9.z-w ;if(r9.z-w > r1.x)r9.z-w -> r12.z*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(i + 2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE1(i + 2), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mov.lt r16.w, r16.w, r10.x-y, r10.x-y ;if(r10.x-y > r12.w)r10.x-y -> r12.w*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 10, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    }
    /*mov.lt r16.z, r16.z, r10.x, r10.x ;if(r10.x > r1.x)r10.x -> r12.z*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 10, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /*mov.lt r16.w, r16.w, r9.w, r9.w ;if(r9.w > r12.w)r9.w -> r12.w*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /*mov.lt r17.z, r17.z, r11.x, rr11.x ;if(r11.x > r14.z)r11.x -> r14.z*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(17, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 17, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 11, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 11, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /*mov.lt r17.w, r17.w, r10.w, r10.w ;if(r10.w > r14.2)r10.w -> r14.w*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(17, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 17, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 10, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*mov r1, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));
    /*mov r5, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));
    for (i = 0; i < 4; i++)
    {
        /*mov.lt r1.x, r1.x, r12.x, r12.x ;if(r9.x-z > r1.x)r9.x-z -> r12.x*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 12, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 12, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mov.lt r1.x, r1.x, r14.x, r14.x ;if(r9.x-z > r1.x)r9.x-z -> r1.x*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 14, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 14, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mov.lt r1.x, r1.x, r16.x, r16.x ;if(r9.x-z > r1.x)r9.x-z -> r12.x*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 16, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mov.lt r5.x, r5.x, r13.x, r13.x ;if(r9.x-z > r1.x)r9.x-z -> r12.x*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 13, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 13, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mov.lt r5.x, r5.x, r15.x, r15.x ;if(r9.x-z > r1.x)r9.x-z -> r12.x*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mov.lt r5.x, r5.x, r17.x, r17.x ;if(r9.x-z > r1.x)r9.x-z -> r12.x*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0x02, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 17, gcdVX_SWIZZLE1(i), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 17, gcdVX_SWIZZLE1(i), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    }
    /*bitextract.u8 r4, r1, 0, c3;  c3 = [0, 32, 64, 96, 0, 0, 0, 0, 8, 8, 8, 8] */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(1, 4, (0x5 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
    /*bitextract.u8 r4, r5, 0, c3;  c3 = [0, 32, 64, 96, 0, 0, 0, 0, 8, 8, 8, 8] */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(5, 7, (0x5 | (0x5 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
    /*mov r4.z, r5.w */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count++]));

    /*mov r5, r2 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    /*mul_shift.u8, r2, r2, r4, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvTRUE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(1, 8, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(1, &Instructions->binarys[Instructions->count++]));
    /*add.u32 r6, r2, -r5 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 5, gcdVX_SWIZZLE, NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));
    /*dp8.u16 r7, r6, 1, c4_512 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x09, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (++*index), &Instructions->binarys[Instructions->count++]));
    /*branch.u32 r7.x, 0, flag1-curr */
    gcmONERROR(gcoHARDWAREVX_Branch(0x01, flag[1]-Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count++]));
    /*add.u32 r6, r2, -r8 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 8, gcdVX_SWIZZLE, NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));
    /*dp8.u16 r7, r6, 1, c4_512 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x09, 0x2, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_Setuniform(2, 4 * (*index), &Instructions->binarys[Instructions->count++]));

    /*atom_max c1, 0, r7.x */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x69, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 7, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

    /*img_store r2, c0, r0.xy, r2 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(1, 8, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*mov r1, r2 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*mov r2, r3 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*add.u32 r0.yz, r0, 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE2(1, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));

    /*branch.u32 r0.z, c2.y, flag0-curr */
    gcmONERROR(gcoHARDWAREVX_Branch(0x02, flag[0]-Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));

    /*barrier */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x2A, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    Context->hasBarrier = gcvTRUE;

    /*add.u32 r0.w, r0.w, 1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));
    /*branch.u32 r0.w, 11, 2*/
    gcmONERROR(gcoHARDWAREVX_Branch(0x01, 2, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 11, &Instructions->binarys[Instructions->count++]));

    /*branch.u32 c1.x, 0, 0-curr */
    gcmONERROR(gcoHARDWAREVX_Branch(0x01, 0-Instructions->count, 0x5, Instructions->count, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0, &Instructions->binarys[Instructions->count++]));
    /*mov r0.w, 0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(0, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 0x12;
    Context->hasAtomic = gcvTRUE;

    OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _edge_trace_vx2(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
#define ET_THRESHOLD 0
#define ET_HYST   1
#define ET_CLAMP   2

    gceSTATUS status                    = gcvSTATUS_OK;
    gcoVX_Hardware_Step steps[] = {
        {0, "threshold", ET_THRESHOLD, &_edge_trace_threshold},
        {1, "hysteresis", ET_HYST, &_edge_trace_hysteresis_vx2},
        {2, "clamp", ET_CLAMP, &_edge_trace_clamp},
    };

    gcmHEADER_ARG("Context=0x%x", Context);
    assert(Context->step < 3);

    gcmONERROR(steps[Context->step].func(Context));

OnError:
    gcmFOOTER();

    return status;
}

static gceSTATUS _edge_trace_halfevis(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
#define ET_THRESHOLD 0
#define ET_HYST   1
#define ET_CLAMP   2

    gceSTATUS status                    = gcvSTATUS_OK;
    gcoVX_Hardware_Step steps[] = {
        {0, "threshold", ET_THRESHOLD, &_edge_trace_threshold},
        {1, "hysteresis", ET_HYST, &_edge_trace_non_filter_hysteresis},
        {2, "clamp", ET_CLAMP, &_edge_trace_clamp},
    };

    gcmHEADER_ARG("Context=0x%x", Context);
    assert(Context->step < 3);

    gcmONERROR(steps[Context->step].func(Context));

OnError:
    gcmFOOTER();

    return status;
}

static gceSTATUS _accumulateweighted_halfevis(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gcoVX_Instructions *Instructions = Context->instructions;
    gctFLOAT alpha = (gctFLOAT)Context->policy / 1000;

    gcmHEADER_ARG("Instructions=0x%x", Instructions);
    /*img_load.u8 r1, c0, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[0]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

    /*img_load.s16 r2, c1, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x4, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

    /*lerp.u8[7-0] r2, r1, r2, m_Alpha */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 6, 0x7 | (0x7 << 3) | (1 << 6), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(2, alpha, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

    /*img_store.s16 r2, c1, r0.xy, r2 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x4, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 6, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 0x3;

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _threshold_halfevis(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    /*gctBOOL Binary = Context->policy;*/
    gcoVX_Instructions *Instructions = Context->instructions;

    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    /*img_load.u8 r1, c0, r0.xy */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

    /*clamp.u8 r1, r1, c2.x, c2.y */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0C, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (1 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
    /*clamp.u8 r1, r1, c2.x, c2.y */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x0C, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(8, 15, (0x7 | (1 << 3)), &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(1, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 2, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetSourceBin(8, &Instructions->binarys[Instructions->count++]));

    /*mov r4, c3 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*cmp r2, r1, r4, c5;*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x05, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 5, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*mov r5, c4 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*cmp r3, r1, r5, c6;*/
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x31, 0x05, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 6, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /* add r1, r2, r3 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));

    /*img_store, c1, r0.xy, r1 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 0x6;

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _remap_no_bilinear(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gctUINT32 Border = Context->borders;
    gctUINT32 Policy = Context->policy;
    gctUINT32 i;
    gcoVX_Instructions *Instructions = Context->instructions;

    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    if(Policy == gcvVX_INTERPOLATION_TYPE_NEAREST_NEIGHBOR)
    {
        if(Border == gcvVX_BORDER_MODE_CONSTANT || Border == gcvVX_BORDER_MODE_UNDEFINED)
        {
            /*mov r2, c4 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        }
        /*mov r3, r0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 8; i++)
        {
            /*img_load.32 r1, c1, r3.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
            /*conv.s32 r1, r1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x0, &Instructions->binarys[Instructions->count++]));

            /*img_load.u32 r2.x, c0, r1.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(i * 2, i * 2, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
            /*img_load.u32 r2.y, c0, r1.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(i * 2 + 1, i * 2 + 1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));

            /*add.u32 r3.x, r3.x, 2 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 2U, &Instructions->binarys[Instructions->count++]));
        }
        /*img_store r2, c2, r0.xy, r2 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        Instructions->regs_count = 0x4;
    }
    else if(Policy == gcvVX_INTERPOLATION_TYPE_BILINEAR)
    {
        /* uniform input_descriptor := c0, s0
         * uniform remap_descriptor := c1
         * uniform output_descriptor := c2
         */
        const static RelOffset plusOne = {{0, 1}};

        if(Border == gcvVX_BORDER_MODE_CONSTANT || Border == gcvVX_BORDER_MODE_UNDEFINED)
        {
            /*mov r4, c4 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        }
        /*mov r3, r0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));
        for (i = 0; i < 8; i++)
        {
            /*img_load.32 r1, c1, r3.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /*floor.f32 r2, r1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x25, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

            /*conv.s32 r2, r2 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x0, &Instructions->binarys[Instructions->count++]));

            if(Border == gcvVX_BORDER_MODE_CONSTANT || Border == gcvVX_BORDER_MODE_UNDEFINED)
            {
                /*mov r4, c4 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
            }

            /*img_load.u8 r4[0-1], c0, r2.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
            /*img_load.u8 r4[8-9], c0, r2.xy, +0,1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(8, 9, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusOne.raw, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[7-0] r5[0-1], r4.x, r4.z, r1.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 0x7 | (0x7 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r5, r5.x, c5, 8;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[7-0] r6[0], r5.x, r5.y, r1.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(i * 2, i * 2, 0x7 | (0x7 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            if(Border == gcvVX_BORDER_MODE_CONSTANT || Border == gcvVX_BORDER_MODE_UNDEFINED)
            {
                /*mov r4, c4 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
            }

            /*img_load.u8 r4[0-1], c0, r2.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));
            /*img_load.u8 r4[8-9], c0, r2.zw, +0,1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(8, 9, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusOne.raw, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[7-0] r5[0-1], r4.x, r4.z, r1.w */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 0x7 | (0x7 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r5, r5.x, c5, 8;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[7-0] r6[1], r5.x, r5.y, r1.z */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(i * 2 + 1, i * 2 + 1, 0x7 | (0x7 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*add.u32 r3.x, r3.x, 2 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 2U, &Instructions->binarys[Instructions->count++]));
        }

        /*img_store r6, c2, r0.xy, r6 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

        Instructions->regs_count = 0x7;
    }

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _warpperspective_no_bilinear(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gcoVX_Instructions   *Instructions = Context->instructions;
    gctUINT32 i = 0;

    gcmHEADER_ARG("Context=0x%x", Context);

    /* matrix         x  y  z  w
     * r1/c8(float) : m0 m1 m2 0
     * r2/c9(float) : m3 m4 m5 0
     * r3/c10(float): m6 m7 m8 0
     *
     * z    = (r0.x * m[2] + r0.y * m[5] + m[8]);
     *
     * r4.y = (r0.x * m[1] + r0.y * m[4] + m[7]) / z;
     * r4.x = (r0.x * m[0] + r0.y * m[3] + m[6]) / z;
     */

    /*mov r1, c8 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*mov r2, c9 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 9, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*mov r9, c10 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 10, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*mov r8, r0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /*mov r8.w, r8.y */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 8, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    if (Context->borders == gcvVX_BORDER_MODE_CONSTANT || Context->borders == gcvVX_BORDER_MODE_UNDEFINED)
    {
        /*mov r4, c4 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }

    for (i = 0; i < 8; i++)
    {
        /*add.u32 r8.z, r8.x, 1 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));
        /*conv.s32 r7, r8; u32 -> float*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x2 | (0 << 4), &Instructions->binarys[Instructions->count++]));

        /*mad r6 r7.yyww r2.xyxy r9.xyxy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE4(1, 1, 3, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE4(0, 1, 0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE4(0, 1, 0, 1), 0, &Instructions->binarys[Instructions->count++]));
        /*mad r3 r7.xxzz r1.xyxy r6 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE4(0, 0, 2, 2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE4(0, 1, 0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        /*mad r10.zw r7.yw r2.zz r9.zz */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE2(1, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE2(2, 2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE2(2, 2), 0, &Instructions->binarys[Instructions->count++]));
        /*mad r10.xy r7.yw r2.zz r9.zz */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE2(0, 2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 10, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));
        /* r3.xy = r3.xy/r10.x */
        /* r3.zw = r3.zw/r10.y */
        /*rcp r10.x r10.x; Get the reciprocal of r10.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x0C, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 10, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*rcp r10.y r10.y; Get the reciprocal of r10.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x0C, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(10, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 10, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        /*mul r3 r3 r10.xxyy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10, gcdVX_SWIZZLE4(0, 0, 1, 1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        if (Context->policy == gcvVX_INTERPOLATION_TYPE_NEAREST_NEIGHBOR
            || Context->policy == gcvVX_INTERPOLATION_TYPE_AREA)
        {
            /*conv.s32 r3, r3 float -> s32*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x0 | (0 << 4), &Instructions->binarys[Instructions->count++]));
            /*img_load.u32 r4(0), c0, r3.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(i * 2, i * 2, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
            /*img_load.u32 r4(1), c0, r3.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(i * 2 + 1, i * 2 + 1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));
        }
        else if (Context->policy == gcvVX_INTERPOLATION_TYPE_BILINEAR)
        {
            const static RelOffset plusOne = {{0, 1}};
            /*
             * uniform input_descriptor := c0
             * uniform output_descriptor := c1
            */
            /*mov r6, r3 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));
            /*branch r3.x, 0.0, 2 */
            gcmONERROR(gcoHARDWAREVX_Branch(0x03, 2, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(1, 0.0f, &Instructions->binarys[Instructions->count++]));
            /*add r3.x, r3.x, -1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(2, -1.0f, &Instructions->binarys[Instructions->count++]));
            /*branch r3.y, 0.0f, 2 */
            gcmONERROR(gcoHARDWAREVX_Branch(0x03, 2, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(1, 0.0f, &Instructions->binarys[Instructions->count++]));
            /*add r3.y, r3.y, -1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(2, -1.0f, &Instructions->binarys[Instructions->count++]));
            /*branch r3.z, 0.0, 2 */
            gcmONERROR(gcoHARDWAREVX_Branch(0x03, 2, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(1, 0.0f, &Instructions->binarys[Instructions->count++]));
            /*add r3.z, r3.z, -1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(2, -1.0f, &Instructions->binarys[Instructions->count++]));
            /*branch r3.w, 0.0f, 2 */
            gcmONERROR(gcoHARDWAREVX_Branch(0x03, 2, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(1, 0.0f, &Instructions->binarys[Instructions->count++]));
            /*add r3.w, r3.w, -1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(2, -1.0f, &Instructions->binarys[Instructions->count++]));
            /* ======== checking if the pixel on border end ======== */
            /*conv.s32 r3, r3 float -> s32*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestinationExt(3, gcdVX_ENABLE, gcvFALSE, gcvTRUE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x0 | (0 << 4), &Instructions->binarys[Instructions->count++]));
            if (Context->borders == gcvVX_BORDER_MODE_CONSTANT || Context->borders == gcvVX_BORDER_MODE_UNDEFINED)
            {
                /*mov r5, c4 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
            }
            /*img_load.u8 r5[0-1], c0, r3.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
            /*img_load.u8 r5[8-9], c0, r3.xy, +0,1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(8, 9, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusOne.raw, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[7-0] r11[0-1], r5.x, r5.z, r6.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 0x7 | (0x7 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r11, r11.x, c9, 8;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 11, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, 12, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[7-0] r4[0], r11.x, r11.y, r6.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(i * 2, i * 2, 0x7 | (0x7 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 11, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 11, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

             /*img_load.u8 r5[0-1], c0, r3.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));
            /*img_load.u8 r5[8-9], c0, r3.zw, +0,1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(8, 9, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusOne.raw, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[7-0] r11[0-1], r5.x, r5.z, r6.w */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 0x7 | (0x7 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r11, r11.x, c9, 8;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 11, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, 12, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[7-0] r4[1], r11.x, r11.y, r6.z */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(i * 2 + 1, i * 2 + 1, 0x7 | (0x7 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 11, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 11, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
        }
        /*add.u32 r8.x, r8.x, 2 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 2U, &Instructions->binarys[Instructions->count++]));
    }
    /*img_store r4, c1, r0.xy, r4 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 0xc;
OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _warpaffine_no_bilinear(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gcoVX_Instructions   *Instructions = Context->instructions;
    gctUINT32 i = 0;

    gcmHEADER_ARG("Context=0x%x", Context);

    /* matrix
     * r1/c8(float): m0 m1 m2 m3
     * r2/c9(float): m4 m5 m6 m7
     *
     * r5.x(float)/src_x = r0.x * m[0] + r0.y * m[2] + m[4];
     * r5.y(float)/src_y = r0.x * m[1] + r0.y * m[3] + m[5];
     */

    /*mov r1, c8 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    /*mov r2, c9 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 9, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    /*mov r8, r0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /*mov r8.w, r8.y */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 8, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));
    if (Context->borders == gcvVX_BORDER_MODE_CONSTANT || Context->borders == gcvVX_BORDER_MODE_UNDEFINED)
    {
        /*mov r4, c4 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }

    for (i = 0; i < 8; i++)
    {
        /*add.u32 r8.z, r8.x, 1 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));
        /*conv.s32 r7, r8; u32 -> float*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x2 | (1 << 4), &Instructions->binarys[Instructions->count++]));

        /*mad r6 r7.yyww r1.zwzw r2.xyxy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE4(1, 1, 3, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE4(2, 3, 2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE4(0, 1, 0, 1), 0, &Instructions->binarys[Instructions->count++]));
        /*mad r3 r7.xxzz r1.xyxy r6 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE4(0, 0, 2, 2), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE4(0, 1, 0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        if (Context->policy == gcvVX_INTERPOLATION_TYPE_NEAREST_NEIGHBOR
            || Context->policy == gcvVX_INTERPOLATION_TYPE_AREA)
        {
            /*conv.s32 r3, r3 float -> s32*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x0 | (0 << 4), &Instructions->binarys[Instructions->count++]));
            /*img_load.u32 r4(0), c0, r3.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(i * 2, i * 2, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
            /*img_load.u32 r4(1), c0, r3.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(i * 2 + 1, i * 2 + 1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));
        }
        else if (Context->policy == gcvVX_INTERPOLATION_TYPE_BILINEAR)
        {
            const static RelOffset plusOne = {{0, 1}};
            /*
             * uniform input_descriptor := c0
             * uniform output_descriptor := c1
            */
            /*mov r6, r3 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));
            /*conv.s32 r3, r3 float -> s32*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestinationExt(3, gcdVX_ENABLE, gcvFALSE, gcvTRUE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x0 | (0 << 4), &Instructions->binarys[Instructions->count++]));
            if (Context->borders == gcvVX_BORDER_MODE_CONSTANT || Context->borders == gcvVX_BORDER_MODE_UNDEFINED)
            {
                /*mov r5, c4 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
            }
            /*img_load.u8 r5[0-1], c0, r3.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
            /*img_load.u8 r5[8-9], c0, r3.xy, +0,1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(8, 9, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusOne.raw, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[7-0] r9[0-1], r5.x, r5.z, r6.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 0x7 | (0x7 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r9, r9.x, c12, 8;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, 12, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[7-0] r4[0], r9.x, r9.y, r6.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(i * 2, i * 2, 0x7 | (0x7 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

             /*img_load.u8 r5[0-1], c0, r3.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));
            /*img_load.u8 r5[8-9], c0, r3.zw, +0,1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(8, 9, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusOne.raw, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[7-0] r9[0-1], r5.x, r5.z, r6.w */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 0x7 | (0x7 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 5, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r9, r9.x, c12, 8;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x60, 0, 0x5, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, 12, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8U, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[7-0] r4[1], r9.x, r9.y, r6.z */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(i * 2 + 1, i * 2 + 1, 0x7 | (0x7 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));
        }
        /*add.u32 r8.x, r8.x, 2 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x5, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 2U, &Instructions->binarys[Instructions->count++]));
    }
    /*img_store r4, c1, r0.xy, r4 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, 0x7, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 15, 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 0xa;
OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _optLKTracker_no_bilinear(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;

    gctUINT8 isUseInitialEstimate = Context->isUseInitialEstimate;
    gctINT32 maxLevel = Context->maxLevel;
    gctINT32 winSize = 5; /*Context->winSize;*/

    RelOffset CoordOffset = {{-2, -2}}; /*{{-1, -1}};*/
    gctINT32 row = 0, level = 0, startIteration1 = 0, startIteration2 = 0, startIteration3 = 0;
    gctINT32 OPT_INS_COUNT[10];

    gcoVX_Instructions *Instructions = Context->instructions;
    gcmHEADER_ARG("Instructions=0x%x", Instructions);

    if(1==maxLevel)
    {
        if(isUseInitialEstimate) OPT_INS_COUNT[0] = 119 - 7 + 5;
        else OPT_INS_COUNT[0] = 118 - 7 + 5;
    }
    else
    {
        if(isUseInitialEstimate) OPT_INS_COUNT[1] = 124 + maxLevel - 7 + 5 + 5;
        else OPT_INS_COUNT[1] = 122 + maxLevel - 7 + 5 + 5;

        /*add increased inst's number because of replacing bilinear with lerp(one bilinear replaced by three insts)*/
        OPT_INS_COUNT[1] += 2 + (winSize-2)*2 + 2 + 2 + (winSize-2)*2 + 2 + 2 + (winSize-2)*2 + 2 + 2 + (winSize-2)*2 + 2;

        for(level=2; level<maxLevel; level++)
        {
            OPT_INS_COUNT[level] = 121 - 7 + 5 + 5;
            /*add increased inst's number because of replacing bilinear with lerp(one bilinear replaced by three insts)*/
            OPT_INS_COUNT[level] += 2 + (winSize-2)*2 + 2 + 2 + (winSize-2)*2 + 2 + 2 + (winSize-2)*2 + 2 + 2 + (winSize-2)*2 + 2;
        }

        OPT_INS_COUNT[0] = 119 - 7 + 5;
        /*add increased inst's number because of replacing bilinear with lerp(one bilinear replaced by three insts)*/
        OPT_INS_COUNT[0] += 2 + (winSize-2)*2 + 2;

        /* accumulate */
        for(level=2; level<maxLevel; level++)
        {
            OPT_INS_COUNT[level] = OPT_INS_COUNT[level] + OPT_INS_COUNT[level-1];
        }
        OPT_INS_COUNT[0] += OPT_INS_COUNT[maxLevel-1];
    }

    /*
        prevPts - index = 0
        nextPts - index = 1
        estimatedPts - index = 2
        prevImg[] - index = 3 ~ 3+maxLevel-1
        nextImg[] - index = 3+maxLevel ~ 3+maxLevel*2-1
        prevDerivIx[] - index = 3+maxLevel*2 ~ 3+maxLevel*3-1
        prevDerivIy[] - index = 3+maxLevel*3 ~ 3+maxLevel*4-1
        DP8 - index = 3+maxLevel*4 ~ 3+maxLevel*4+3
        epsilon, numIterations, minEig(104.8576f), D(109951.1627776f) - index = 3+maxLevel*4+4
        prevDelta(0.01), 1/pyramidScale, iteration step, pyramidScale - index = 3+maxLevel*4+5
        bounding box--winSize/2, max width&height - index = 3+maxLevel*4+6 ~ 3+maxLevel*5+6-1
        L shift - index = 3+maxLevel*5+6
        minEigWin, 0.5f, 4.0f, 1 - index = 3+maxLevel*5+7
        bilinear uniform1 - index = 3+maxLevel*5+8
        bilinear uniform2 - index = 3+maxLevel*5+9
        DP4x8 - index = 3+maxLevel*5+10~3+maxLevel*5+10+3
        DP4x8 - index = 3+maxLevel*5+14~3+maxLevel*5+14+3
        DP16x1 - index = 3 + maxLevel * 5 + 18 ~ 3 + maxLevel * 5 + 18 +3
        DP16x1 - index = 3 + maxLevel * 5 + 22 ~ 3 + maxLevel * 5 + 22 +3
    */

    if(maxLevel>=2)
    {
        /* mov r2, c(3+maxLevel*4+5) */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, (3+maxLevel*4+5), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

        for(level=2; level<maxLevel; level++)
        {
            /* mul r2.w, r2.w, c(3+maxLevel*4+5).w */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+5), gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count++]));
        }

        /* prevPts - load r1.xy, c0, r0.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* I2F r1.xy, r1.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x2D, 0, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* mul r1.xy, r1.xy, r2.ww */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE2(3, 3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* assign nextPts */
        if(isUseInitialEstimate)
        {
            /* estimatedPts - load r16.xy, c2, r0.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /* I2F r16.xy, r16.xy  */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x2D, 0, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /* mul r16.xy, r16.xy, r2.ww */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE2(3, 3), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        }
        else
        {
            /* mov r16, r1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
        }

        /* F2I r1.zw, r1.xy  */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x2E, 0, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE4(0, 1, 0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* branchAny.LT (OPT_INS_COUNT[1]-1), r1.zw, c(3+maxLevel*4+6).xy */
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x02, (OPT_INS_COUNT[1]-1)-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+6), gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* branchAny.GE (OPT_INS_COUNT[1]-1), r1.zw, c(3+maxLevel*4+6).zw  */
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x03, (OPT_INS_COUNT[1]-1)-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+6), gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));

    /*-------------------------------------- pre_arr x, y ---------------------------------------*/

        CoordOffset.u.y = (gctUINT16)0x1e; /* (gctUINT16)0x1f; */

        /* grad_x - img_load.s16 r2[11:0], c(3+maxLevel*2), r1.zw */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*2), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

        row = 0;
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* grad_x - img_load.s16 r3/2[11:0], c(3+maxLevel*2), r1.zw, */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*2), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[3-0] r18[0-5], r2/3[11:0], r3/2[11:0], r1.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(18, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r19, r18, 0, c26;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(19, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 4, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3 + maxLevel * 5 + 26, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[4-0] r4[0-4], r19, r20, r1.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 19, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r5[15:12], r4[9:0], r4[9:0], c(3+maxLevel*5+22)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+22), &Instructions->binarys[Instructions->count++]));
        }

        for(row=1; row<winSize-1; row++)
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* grad_x - img_load.s16 r3/2[11:0], c(3+maxLevel*2), r1.zw, */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*2), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[3-0] r18[0-5], r2/3[11:0], r3/2[11:0], r1.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(18, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r19, r18, 0, c26;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(19, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 4, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3 + maxLevel * 5 + 26, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[4-0] r4[0-4], r18, r19, r1.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 19, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r6-8/6[15:12], r5-7/5[9:0,15:12], r5-7/5[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        row = winSize - 1;
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* grad_x - img_load.s16 r3/2[11:0], c(3+maxLevel*2), r1.zw, */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*2), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[3-0] r18[0-5], r2/3[11:0], r3/2[11:0], r1.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(18, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r19, r18, 0, c26;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(19, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 4, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3 + maxLevel * 5 + 26, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[4-0] r4[0-4], r18, r19, r1.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 19, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.f32 r9[3:0], r8/6[9:0,15:12], r8/6[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        CoordOffset.u.y = (gctUINT16)0x1e; /* (gctUINT16)0x1f; */

        /* grad_y - img_load.s16 r2[11:0], c(3+maxLevel*3), r1.zw */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*3), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

        row = 0;
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row;*/

            /* grad_y - img_load.s16 r3/2[11:0], c(3+maxLevel*3), r1.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*3), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[3-0] r18[0-5], r2/3[11:0], r3/2[11:0], r1.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(18, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r19, r18, 0, c26;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(19, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 4, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3 + maxLevel * 5 + 26, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[4-0] r4[0-4], r18, r19, r1.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(10+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 19, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r5[15:12], r4[9:0], r10[9:0], c(3+maxLevel*5+22)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+22), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r11[15:12], r10[9:0], r10[9:0], c(3+maxLevel*5+22)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+22), &Instructions->binarys[Instructions->count++]));
        }

        for(row=1; row<winSize-1; row++)
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row;*/

            /* grad_y - img_load.s16 r3/2[11:0], c(3+maxLevel*3), r1.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*3), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[3-0] r18[0-5], r2/3[11:0], r3/2[11:0], r1.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(18, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r19, r18, 0, c26;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(19, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 4, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3 + maxLevel * 5 + 26, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[4-0] r4[0-4], r18, r19, r1.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(10+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 19, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r6-8/6[15:12], r5-7/5[9:0,15:12], r11-13/11[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));

             /* dp16x1.s32 r12-14/6[15:12], r11-13/11[9:0,15:12], r11-13/11[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        row = winSize - 1;
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row;*/

            /* grad_y - img_load.s16 r3/2[11:0], c(3+maxLevel*3), r1.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*3), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[3-0] r18[0-5], r2/3[11:0], r3/2[11:0], r1.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(18, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r19, r18, 0, c26;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(19, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 4, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3 + maxLevel * 5 + 26, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[4-0] r4[0-4], r18, r19, r1.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(10+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 19, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.f32 r9[8:4], r8/6[9:0,15:12], r14/12[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(1, 1, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.f32 r9[12:9], r14/12[9:0,15:12], r14/12[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(2, 2, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        /* mul r9.w, r9.y, -r9.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(1), NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));

        /* mad r9.w, r9.x, r9.z, r9.w */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* add r2.x, r9.x, -r9.z */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE1(2), NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));

        /* mul r2.x, r2.x, r2.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* mul r2.y, r9.y, c(3+maxLevel*5+7).z */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+7), gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));

        /* mad r2.x, r2.y, r9.y, r2.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* sqrt r2.x, r2.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x21, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* add r2.x, r9.x, -r2.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));

        /* add r2.x, r9.z, r2.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* branchAny.LT (OPT_INS_COUNT[1]-1), r2.x, c(3+maxLevel*4+4).z*/
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x02, (OPT_INS_COUNT[1]-1)-Instructions->count, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+4), gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));

        /* branchAny.LT (OPT_INS_COUNT[1]-1), r9.w, c(3+maxLevel*4+4).w */
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x02, (OPT_INS_COUNT[1]-1)-Instructions->count, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+4), gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count++]));

        /* rcp r9.w r9.w */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x0C, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* --------------------------------------  D ---------------------------------------  */

        CoordOffset.u.y = (gctUINT16)0x1e; /* (gctUINT16)0x1f; */

        /* pre_img - img_load.u8 r2[5:0], c3, r1.zw */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

        /* mul_shift r2[11:0], r2[5:0], c(3+maxLevel*5+6), 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        row = 0;
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* pre_img - img_load.u8, r3/2[5:0], c3, r1.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* mul_shift r3/2[11:0], r3/2[5:0], c(3+maxLevel*5+6), 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[3-0] r18[0-5], r2/3[11:0], r3/2[11:0], r1.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(18, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r19, r18, 0, c26;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(19, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 4, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3 + maxLevel * 5 + 26, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[4-0] r4[0-4], r18, r19, r1.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2+row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 19, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r5[15:12], r4[9:0], r2/3[9:0], c(3+maxLevel*5+22)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+22), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r11[12:15], r10[0:9], r2/3[9:0], c(3+maxLevel*5+22)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+22), &Instructions->binarys[Instructions->count++]));
        }

        for (row=1; row<winSize-1; row++)
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* pre_img - img_load.u8 r3/2[5:0], c3, r1.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* mul_shift r3/2[11:0], r3/2[5:0], c(3+maxLevel*5+6), 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[3-0] r18[0-5], r2/3[11:0], r3/2[11:0], r1.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(18, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r19, r18, 0, c26;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(19, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 4, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3 + maxLevel * 5 + 26, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[4-0] r4[0-4], r18, r19, r1.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2+row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 19, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r6-r8[12:15], r5-7[9:0, 15:12], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r12-r14[12:15], r11-13[0:9,12:15], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        row = winSize-1;
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* pre_img - img_load.u8, r3/2[5:0], c3, r1.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* mul_shift r3/2[11:0], r3/2[5:0], c(3+maxLevel*5+6), 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[3-0] r18[0-5], r2/3[11:0], r3/2[11:0], r1.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(18, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r19, r18, 0, c26;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(19, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 4, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3 + maxLevel * 5 + 26, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[4-0] r4[0-4], r18, r19, r1.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2+row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 19, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.f32 r15[3:0], r8/6[9:0, 15:12], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.f32 r15[7:4], r14/12[0:9,12:15], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(1, 1, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        /* mul r2.xy, r9.yy, -r15.yx */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE2(1, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE2(1, 0), NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));

        /* mad r15.xy, r9.zx, r15.xy, r2.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE2(2, 0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* --------------------------------------  deltaXN, deltaYN --------------------------------------- */

        /* mov r17.x, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(17, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

        startIteration1 = Instructions->count;

        /* F2I r16.zw, r16.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x2E, 0, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE4(0, 1, 0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* branchAny.LT (OPT_INS_COUNT[1]-1), r16.zw, c(3+maxLevel*4+6).xy */
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x02, (OPT_INS_COUNT[1]-1)-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+6), gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* branchAny.GE (OPT_INS_COUNT[1]-1), r16.zw, c(3+maxLevel*4+6).zw */
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x03, (OPT_INS_COUNT[1]-1)-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+6), gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));

        /*--------------------------------------  cur_arr x, y ---------------------------------------*/

        CoordOffset.u.y = (gctUINT16)0x1e; /* (gctUINT16)0x1f; */

        /* nextImg - img_load.u8 r2[5:0], c(3+maxLevel), r16.zw */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

        /* mul_shift r2[11:0], r2[5:0], c(3+maxLevel*5+6), 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        row = 0;
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* nextImg - img_load.u8 r3/2[5:0], c(3+maxLevel), r16.zw, */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* mul_shift r3/2[11:0], r3/2[5:0], c(3+maxLevel*5+6), 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[3-0] r18[0-5], r2/3[11:0], r3/2[11:0], r16.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(18, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 16, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r19, r18, 0, c26;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(19, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 4, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3 + maxLevel * 5 + 26, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[4-0] r4[0-4], r18, r19, r16.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2+row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 19, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 16, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r5[12:15], r4[9:0], r2[9:0], c(3+maxLevel*5+22)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+22), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r11[12:15], r10[9:0], r2[9:0], c(3+maxLevel*5+22)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+22), &Instructions->binarys[Instructions->count++]));
        }

        for (row=1; row<winSize-1; row++)
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* nextImg - img_load.u8 r3/2[5:0], c(3+maxLevel), r16.zw, */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* mul_shift r3/2[11:0], r3/2[5:0], c(3+maxLevel*5+6), 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[3-0] r18[0-5], r2/3[11:0], r3/2[11:0], r16.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(18, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 16, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r19, r18, 0, c26;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(19, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 4, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3 + maxLevel * 5 + 26, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[4-0] r4[0-4], r18, r19, r16.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2+row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 19, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 16, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r6-8[12:15], r5-7[0:9,12:15], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r12-r14[12:15], r11-13[0:9,12:15], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        row = winSize-1;
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* nextImg - img_load.u8 r3/2[5:0], c(3+maxLevel), r16.zw, */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* mul_shift r3/2[11:0], r3/2[5:0], c(3+maxLevel*5+6), 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[3-0] r18[0-5], r2/3[11:0], r3/2[11:0], r16.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(18, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 16, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r19, r18, 0, c26;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(19, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 4, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3 + maxLevel * 5 + 26, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[4-0] r4[0-4], r18, r19, r16.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2+row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 19, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 16, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.f32 r15[11:8], r8/6[0:9,12:15], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(2, 2, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.f32 r15[15:12], r14/12[0:9,12:15], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        /* mul r2.xy, r9.zx, -r15.zw*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE2(2, 0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE2(2, 3), NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));

        /* mad r15.zw, r9.yy, r15.wz, r2.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE4(1, 1, 1, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE4(3, 2, 3, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE4(0, 1, 0, 1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* add.f32 r15.zw, r15.zw, r15.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE4(2, 3, 2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE4(0, 1, 0, 1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* mul.f32 r15.zw, r15.zw, r9.ww */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE4(2, 3, 2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE4(3, 3, 3, 3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /*-----------------------  delta_x, delta_y ------------------*/

        /* add.f32 r16.xy, r16.xy, r15.zw*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* dp2 r2.x, r15.zw, r15.zw*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x73, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));

        /* add r17.x, r17.x, c(3+maxLevel*4+5).z*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(17, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 17, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, (3+maxLevel*4+5), gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));

        /* mov r2.y, r17.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 17, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

        /* branch.f32 startIteration1, r2.xy, c(3+maxLevel*4+4).xy */
        gcmONERROR(gcoHARDWAREVX_Branch(0x01, (startIteration1-Instructions->count), 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+4), gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* NOP -- (OPT_INS_COUNT[1]-1)==Instructions->count*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x00, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_DisableDestination(&Instructions->binarys[Instructions->count++]));
    }

    /*------------------------------  maxLevel>=2 ------------------------------------*/

    if(maxLevel>=3)
    {
    for(level=2; level<maxLevel; level++)
    {
        /* mul r1.xy, r1.xy, c(3+maxLevel*4+5).yy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+5), gcdVX_SWIZZLE2(1, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* mul r16.xy, r16.xy, c(3+maxLevel*4+5).yy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+5), gcdVX_SWIZZLE2(1, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* F2I r1.zw, r1.xy    */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x2E, 0, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE4(0, 1, 0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* branchAny.LT (OPT_INS_COUNT[level]-1), r1.zw, c(3+maxLevel*4+6+level-1).xy */
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x02, (OPT_INS_COUNT[level]-1)-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+6+level-1), gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* branchAny.GE (OPT_INS_COUNT[level]-1), r1.zw, c(3+maxLevel*4+6+level-1).zw */
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x03, (OPT_INS_COUNT[level]-1)-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+6+level-1), gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));

    /*-------------------------------------- pre_arr x, y ---------------------------------------*/

        CoordOffset.u.y = (gctUINT16)0x1e; /* (gctUINT16)0x1f; */

        /* grad_x - img_load.s16 r2[11:0], c(3+maxLevel*2+level-1), r1.zw */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*2+level-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

        row = 0;
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* grad_x - img_load.s16 r3/2[11:0], c(3+maxLevel*2+level-1), r1.zw, */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*2+level-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[3-0] r18[0-5], r2/3[11:0], r3/2[11:0], r1.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(18, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r19, r18, 0, c26;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(19, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 4, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3 + maxLevel * 5 + 26, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[4-0] r4[0-4], r18, r19, r1.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 19, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r5[15:12], r4[9:0], r4[9:0], c(3+maxLevel*5+22)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+22), &Instructions->binarys[Instructions->count++]));
        }

        for(row=1; row<winSize-1; row++)
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* grad_x - img_load.s16 r3/2[11:0], c(3+maxLevel*2+level-1), r1.zw, */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*2+level-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[3-0] r18[0-5], r2/3[11:0], r3/2[11:0], r1.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(18, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r19, r18, 0, c26;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(19, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 4, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3 + maxLevel * 5 + 26, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[4-0] r4[0-4], r18, r19, r1.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 19, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r6-8/6[15:12], r5-7/5[9:0,15:12], r5-7/5[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        row = winSize - 1;
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* grad_x - img_load.s16 r3/2[11:0], c(3+maxLevel*2+level-1), r1.zw, */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*2+level-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[3-0] r18[0-5], r2/3[11:0], r3/2[11:0], r1.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(18, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r19, r18, 0, c26;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(19, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 4, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3 + maxLevel * 5 + 26, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[4-0] r4[0-4], r18, r19, r1.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 19, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.f32 r9[3:0], r8/6[9:0,15:12], r8/6[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        CoordOffset.u.y = (gctUINT16)0x1e; /* (gctUINT16)0x1f; */

        /* grad_y - img_load.s16 r2[11:0], c(3+maxLevel*3+level-1), r1.zw */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*3+level-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

        row = 0;
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* grad_y - img_load.s16 r3/2[11:0], c(3+maxLevel*3+level-1), r1.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*3+level-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[3-0] r18[0-5], r2/3[11:0], r3/2[11:0], r1.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(18, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r19, r18, 0, c26;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(19, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 4, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3 + maxLevel * 5 + 26, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[4-0] r4[0-4], r18, r19, r1.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(10+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 19, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r5[15:12], r4[9:0], r10[9:0], c(3+maxLevel*5+22)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+22), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r11[15:12], r10[9:0], r10[9:0], c(3+maxLevel*5+22)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+22), &Instructions->binarys[Instructions->count++]));
        }

        for(row=1; row<winSize-1; row++)
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row;*/

            /* grad_y - img_load.s16 r3/2[11:0], c(3+maxLevel*3+level-1), r1.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*3+level-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[3-0] r18[0-5], r2/3[11:0], r3/2[11:0], r1.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(18, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r19, r18, 0, c26;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(19, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 4, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3 + maxLevel * 5 + 26, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[4-0] r4[0-4], r18, r19, r1.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(10+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 19, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r6-8/6[15:12], r5-7/5[9:0,15:12], r11-13/11[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));

             /* dp16x1.s32 r12-14/6[15:12], r11-13/11[9:0,15:12], r11-13/11[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        row = winSize - 1;
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row;*/

            /* grad_y - img_load.s16 r3/2[11:0], c(3+maxLevel*3+level-1), r1.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*3+level-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[3-0] r18[0-5], r2/3[11:0], r3/2[11:0], r1.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(18, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r19, r18, 0, c26;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(19, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 4, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3 + maxLevel * 5 + 26, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[4-0] r4[0-4], r18, r19, r1.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(10+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 19, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.f32 r9[8:4], r8/6[9:0,15:12], r14/12[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(1, 1, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.f32 r9[12:9], r14/12[9:0,15:12], r14/12[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(2, 2, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        /* mul r9.w, r9.y, -r9.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(1), NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));

        /* mad r9.w, r9.x, r9.z, r9.w */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* add r2.x, r9.x, -r9.z */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE1(2), NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));

        /* mul r2.x, r2.x, r2.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* mul r2.y, r9.y, c(3+maxLevel*5+7).z */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+7), gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));

        /* mad r2.x, r2.y, r9.y, r2.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* sqrt r2.x, r2.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x21, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* add r2.x, r9.x, -r2.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));

        /* add r2.x, r9.z, r2.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* branchAny.LT (OPT_INS_COUNT[level]-1), r2.x, c(3+maxLevel*4+4).z*/
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x02, (OPT_INS_COUNT[level]-1)-Instructions->count, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+4), gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));

        /* branchAny.LT (OPT_INS_COUNT[level]-1), r9.w, c(3+maxLevel*4+4).w */
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x02, (OPT_INS_COUNT[level]-1)-Instructions->count, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+4), gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count++]));

        /* rcp r9.w r9.w */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x0C, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* --------------------------------------  D ---------------------------------------  */

        CoordOffset.u.y = (gctUINT16)0x1e; /* (gctUINT16)0x1f; */

        /* prevImg - img_load.u8 r2[5:0], c(3+level-1), r1.zw */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+level-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

        /* mul_shift r2[11:0], r2[5:0], c(3+maxLevel*5+6), 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        row = 0;
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* prevImg - img_load.u8 r3/2[5:0], c(3+level-1), r1.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+level-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* mul_shift r3/2[11:0], r3/2[5:0], c(3+maxLevel*5+6), 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[3-0] r18[0-5], r2/3[11:0], r3/2[11:0], r1.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(18, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r19, r18, 0, c26;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(19, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 4, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3 + maxLevel * 5 + 26, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[4-0] r4[0-4], r18, r19, r1.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2+row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 19, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r5[12:15], r4[0:9], r2[0:9], c(3+maxLevel*5+22)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+22), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r11[12:15], r10[0:9], r2[0:9], c(3+maxLevel*5+22)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+22), &Instructions->binarys[Instructions->count++]));
        }

        for (row=1; row<winSize-1; row++)
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* prevImg - img_load.u8 r3/2[5:0], c(3+level-1), r1.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+level-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* mul_shift r3/2[11:0], r3/2[5:0], c(3+maxLevel*5+6), 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[3-0] r18[0-5], r2/3[11:0], r3/2[11:0], r1.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(18, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r19, r18, 0, c26;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(19, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 4, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3 + maxLevel * 5 + 26, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[4-0] r4[0-4], r18, r19, r1.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2+row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 19, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r6-8[12:15], r5-7[0:9,12:15], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r12-r14[12:15], r11-12[0:9,12:15], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        row = winSize-1;
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* prevImg - img_load.u8 r3/2[5:0], c(3+level-1), r1.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+level-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* mul_shift r3/2[11:0], r3/2[5:0], c(3+maxLevel*5+6), 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[3-0] r18[0-5], r2/3[11:0], r3/2[11:0], r1.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(18, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r19, r18, 0, c26;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(19, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 4, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3 + maxLevel * 5 + 26, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[4-0] r4[0-4], r18, r19, r1.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2+row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 19, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 1, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.f32 r15[3:0], r8/6[0:9,12:15], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.f32 r15[7:4], r14/12[0:9,12:15], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(1, 1, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        /* mul r2.xy, r9.yy, -r15.yx  */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE2(1, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE2(1, 0), NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));

        /* mad r15.xy, r9.zx, r15.xy, r2.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE2(2, 0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* --------------------------------------  deltaXN, deltaYN --------------------------------------- */

        /* mov r17.x, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(17, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

        startIteration2 = Instructions->count;

        /* F2I r16.zw, r16.xy   */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x2E, 0, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE4(0, 1, 0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* branchAny.LT (OPT_INS_COUNT[level]-1), r16.zw, c(3+maxLevel*4+6+level-1).xy */
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x02, (OPT_INS_COUNT[level]-1)-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+6+level-1), gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* branchAny.GE (OPT_INS_COUNT[level]-1), r16.zw, c(3+maxLevel*4+6+level-1).zw */
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x03, (OPT_INS_COUNT[level]-1)-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+6+level-1), gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));

        /*--------------------------------------  cur_arr x, y ---------------------------------------*/

        CoordOffset.u.y = (gctUINT16)0x1e; /* (gctUINT16)0x1f; */

        /* nextImg - img_load.u8 r2[5:0], c(3+maxLevel+level-1), r16.zw */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel+level-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

        /* mul_shift r2[11:0], r2[5:0], c(3+maxLevel*5+6), 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        row = 0;
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* nextImg - img_load.u8 r3/2[5:0], c(3+maxLevel+level-1), r16.zw, */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel+level-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* mul_shift r3/2[11:0], r3/2[5:0], c(3+maxLevel*5+6), 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[3-0] r18[0-5], r2/3[11:0], r3/2[11:0], r16.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(18, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 16, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r19, r18, 0, c26;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(19, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 4, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3 + maxLevel * 5 + 26, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[4-0] r4[0-4], r18, r19, r1.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2+row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 19, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 16, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r5[12:15], r4[0:9], r2[0:9], c(3+maxLevel*5+22)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+22), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r11[12:15], r10[0:9], r2[0:9], c(3+maxLevel*5+22)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+22), &Instructions->binarys[Instructions->count++]));
        }

        for (row=1; row<winSize-1; row++)
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* nextImg - img_load.u8 r3/2[5:0], c(3+maxLevel+level-1), r16.zw, */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel+level-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* mul_shift r3/2[11:0], r3/2[5:0], c(3+maxLevel*5+6), 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[3-0] r18[0-5], r2/3[11:0], r3/2[11:0], r16.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(18, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 16, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r19, r18, 0, c26;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(19, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 4, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3 + maxLevel * 5 + 26, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[4-0] r4[0-4], r18, r19, r16.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2+row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 19, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 16, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r6-8[12:15], r5-7[0:9], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r12-r14[12:15], r11-13[0:9,12:15], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        row = winSize-1;
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* nextImg - img_load.u8 r3/2[5:0], c(3+maxLevel+level-1), r16.zw, */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel+level-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* mul_shift r3/2[11:0], r3/2[5:0], c(3+maxLevel*5+6), 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[3-0] r18[0-5], r2/3[11:0], r3/2[11:0], r16.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(18, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 16, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r19, r18, 0, c26;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(19, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 4, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3 + maxLevel * 5 + 26, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[4-0] r4[0-4], r18, r19, r16.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2+row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 19, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 16, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.f32 r15[11:8], r8/6[0:9,12:15], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(2, 2, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.f32 r15[15:12], r14/12[0:9,12:15], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        /* mul r2.xy, r9.zx, -r15.zw */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE2(2, 0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE2(2, 3), NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));

        /* mad r15.zw, r9.yy, r15.wz, r2.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE4(1, 1, 1, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE4(3, 2, 3, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE4(0, 1, 0, 1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* add.f32 r15.zw, r15.zw, r15.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE4(2, 3, 2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE4(0, 1, 0, 1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* mul.f32 r15.zw, r15.zw, r9.ww */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE4(2, 3, 2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE4(3, 3, 3, 3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /*-----------------------  delta_x, delta_y ------------------*/

        /* add.f32 r16.xy, r16.xy, r15.zw */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* dp2 r2.x, r15.zw, r15.zw */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x73, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));

        /* add r17.x, r17.x, c(3+maxLevel*4+5).z */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(17, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 17, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, (3+maxLevel*4+5), gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));

        /* mov r2.y, r17.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 17, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

        /* branch.f32 startIteration2, r2.xy, c(3+maxLevel*4+4).xy */
        gcmONERROR(gcoHARDWAREVX_Branch(0x01, (startIteration2-Instructions->count), 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+4), gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* NOP -- (OPT_INS_COUNT[level]-1)==Instructions->count */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x00, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_DisableDestination(&Instructions->binarys[Instructions->count++]));
    }
    }

    /*------------------------------  maxLevel>=3 ------------------------------------*/

    if(maxLevel>=1)
    {
        if(1==maxLevel)
        {
            /* prevPts - load r1.zw, c0, r0.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

            /* assign nextPts */
            if(isUseInitialEstimate)
            {
                /* estimatedPts - load r16.xy, c2, r0.xy */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x32, 0, 0x2, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

                /* I2F r16.xy, r16.xy  */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x2D, 0, 0x2, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
            }
            else
            {
                /* I2F r16.xy, r1.zw  */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x2D, 0, 0x2, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));
            }
        }
        else
        {
            /* mul r1.xy, r1.xy, c(3+maxLevel*4+5).yy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+5), gcdVX_SWIZZLE2(1, 1), 0, &Instructions->binarys[Instructions->count++]));

            /* mul r16.xy, r16.xy, c(3+maxLevel*4+5).yy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+5), gcdVX_SWIZZLE2(1, 1), 0, &Instructions->binarys[Instructions->count++]));

            /* F2I r1.zw, r1.xy   */ /* IN_ROUND */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x2E, 0, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE4(0, 1, 0, 1), 0, &Instructions->binarys[Instructions->count++]));
        }

        /* branchAny.LT r1.zw, c(3+maxLevel*5+6-1).xy, (OPT_INS_COUNT[0]-3) */
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x02, (OPT_INS_COUNT[0]-3)-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6-1), gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* branchAny.GE r1.zw, c(3+maxLevel*5+6-1).zw, (OPT_INS_COUNT[0]-3)  */
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x03, (OPT_INS_COUNT[0]-3)-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6-1), gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));

        /*-------------------------------------- pre_arr x, y ---------------------------------------*/

        /* mov r9, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

        for (row=0; row<winSize; row++)
        {
            CoordOffset.u.y = (gctUINT16)(row - 2); /* (gctUINT16)(row - 1); */

            /* grad_x - img_load.s16 r4-8, c(3+maxLevel*3-1), r1.zw, */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*3-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* grad_y - img_load.s16 r10-14, c(3+maxLevel*4-1), r1.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(10+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*4-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* dp8.f32 r2.x, r4-8, r4-8, c(3+maxLevel*4)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x09, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*4), &Instructions->binarys[Instructions->count++]));

            /* dp8.f32 r2.y, r4-8, r10-14, c(3+maxLevel*4)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x09, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(1, 1, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*4), &Instructions->binarys[Instructions->count++]));

            /* dp8.f32 r2.z, r10-14, r10-14, c(3+maxLevel*4)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x09, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(2, 2, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*4), &Instructions->binarys[Instructions->count++]));

            /* add r9.xyz, r9.xyz, r2.xyz */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE3(0, 1, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE4(0, 1, 2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE4(0, 1, 2, 3), gcvFALSE, &Instructions->binarys[Instructions->count++]));
        }

        /* mul r9.w, r9.y, -r9.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(1), NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));

        /* mad r9.w, r9.x, r9.z, r9.w */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* add r2.x, r9.x, -r9.z */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE1(2), NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));

        /* mul r2.x, r2.x, r2.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* mul r2.y, r9.y, c(3+maxLevel*5+7).z */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+7), gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));

        /* mad r2.x, r2.y, r9.y, r2.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* sqrt r2.x, r2.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x21, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* add r2.x, r9.x, -r2.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));

        /* add r2.x, r9.z, r2.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* branchAny.LT (OPT_INS_COUNT[0]-3), r2.x, c(3+maxLevel*4+4).z */
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x02, (OPT_INS_COUNT[0]-3)-Instructions->count, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+4), gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));

        /* branchAny.LT (OPT_INS_COUNT[0]-3), r9.w, c(3+maxLevel*4+4).w */
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x02, (OPT_INS_COUNT[0]-3)-Instructions->count, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+4), gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count++]));

        /* rcp r9.w r9.w */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x0C, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 9, gcdVX_SWIZZLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* --------------------------------------  D ---------------------------------------  */

        row = 0;
        {
            CoordOffset.u.y = (gctUINT16)(row - 2); /* (gctUINT16)(row - 1); */

            /* pre_img - img_load.u8, r2[4:0], c(3+maxLevel-1), r1.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* mul_shift r2[9:0], r2[4:0], c(3+maxLevel*5+6), 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r2[15:12], r2[9:0], r4[9:0], c(3+maxLevel*5+22)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+22), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r11[15:12], r2[9:0], r10[9:0], c(3+maxLevel*5+22)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+22), &Instructions->binarys[Instructions->count++]));
        }

        for(row=1; row<winSize-1; row++)
        {
            CoordOffset.u.y = (gctUINT16)(row - 2); /* (gctUINT16)(row - 1); */

            /* pre_img - img_load.u8, r2[4:0], c(3+maxLevel-1), r1.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* mul_shift r2[9:0], r2[4:0], c(3+maxLevel*5+6), 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r2[12:15], r2[0:9,12:15], r5-7[0:9], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r12-r14[12:15], r11-13[0:9,12:15], r2[0:9], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        row = winSize - 1;
        {
            CoordOffset.u.y = (gctUINT16)(row - 2); /* (gctUINT16)(row - 1); */

            /* pre_img - img_load.u8, r2[4:0], c(3+maxLevel-1), r1.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 1, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* mul_shift r2[9:0], r2[4:0], c(3+maxLevel*5+6), 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.f32 r15[3:0], r2[0:9,12:15], r8/6[0:9], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.f32 r15[7:4], r14/12[0:9,12:15], r2[0:9], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(1, 1, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
       }

        /* mul r2.xy, r9.yy, -r15.yx */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE2(1, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE2(1, 0), NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));

        /* mad r15.xy, r9.zx, r15.xy, r2.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE2(2, 0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /*--------------------------------------  deltaXN, deltaYN ---------------------------------------*/

        /* mov r17.x, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(17, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

        startIteration3 = Instructions->count;

        /* F2I r16.zw, r16.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x2E, 0, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE4(0, 1, 0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* branchAny.LT r16.zw, c(3+maxLevel*5+6-1).xy, (OPT_INS_COUNT[0]-3) */
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x02, (OPT_INS_COUNT[0]-3)-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6-1), gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* branchAny.GE r16.zw, c(3+maxLevel*5+6-1).zw, (OPT_INS_COUNT[0]-3) */
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x03, (OPT_INS_COUNT[0]-3)-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6-1), gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));

        /*--------------------------------------  cur_arr x, y ---------------------------------------*/

        CoordOffset.u.y = (gctUINT16)0x1e; /* (gctUINT16)0x1f; */

        /* nextImg - img_load.u8 r2[5:0], c(3+maxLevel*2-1), r16.zw */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*2-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

        /* mul_shift r2[11:0], r2[5:0], c(3+maxLevel*5+6), 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        row = 0;
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* nextImg - img_load.u8 r3/2[5:0], c(3+maxLevel*2-1), r16.zw, */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*2-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* mul_shift r3/2[11:0], r3/2[5:0], c(3+maxLevel*5+6), 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[3-0] r18[0-5], r2/3[11:0], r3/2[11:0], r16.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(18, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 16, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r19, r18, 0, c26;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(19, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 4, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3 + maxLevel * 5 + 26, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[4-0] r4[0-4], r18, r19, r16.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2+row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 19, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 16, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r5[12:15], r4[0:9], r2[0:9], c(3+maxLevel*5+22)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+22), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r11[12:15], r10[0:9], r2[0:9], c(3+maxLevel*5+22)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+22), &Instructions->binarys[Instructions->count++]));
        }

        for (row=1; row<winSize-1; row++)
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* nextImg - img_load.u8 r3/2[5:0], c(3+maxLevel*2-1), r16.zw, */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*2-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* mul_shift r3/2[11:0], r3/2[5:0], c(3+maxLevel*5+6), 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[3-0] r18[0-5], r2/3[11:0], r3/2[11:0], r16.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(18, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 16, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r19, r18, 0, c26;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(19, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 4, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3 + maxLevel * 5 + 26, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[4-0] r4[0-4], r18, r19, r16.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2+row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 19, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 16, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r6-8[12:15], r5-7[0:9,12:15], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.s32 r12-r14[12:15], r11-13[0:9,12:15], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(11+row, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        row = winSize-1;
        {
            CoordOffset.u.y = (gctUINT16)(row-1); /* (gctUINT16)row; */

            /* nextImg - img_load.u8 r3/2[5:0], c(3+maxLevel*2-1), r16.zw, */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, (3+maxLevel*2-1), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, CoordOffset.raw, &Instructions->binarys[Instructions->count++]));

            /* mul_shift r3/2[11:0], r3/2[5:0], c(3+maxLevel*5+6), 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3-row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize, (0x7|(0x7<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+6), gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[3-0] r18[0-5], r2/3[11:0], r3/2[11:0], r16.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(18, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 5, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3-row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 16, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r19, r18, 0, c26;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(19, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 4, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 3 + maxLevel * 5 + 26, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[4-0] r4[0-4], r18, r19, r16.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x3, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(2+row%2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, winSize-1, 0x3 | (0x3 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 18, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 19, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 16, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /* dp16x1.f32 r15[11:8], r8/6[0:9,12:15], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(2, 2, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 4+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));

            /* dp16x1.f32 r15[15:12], r14/12[0:9,12:15], r2/3[9:0], c(3+maxLevel*5+18)_512 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x08, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(3, 3, (0x3|(0x3<<3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 10+row, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2+row%2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_Setuniform(2, (3+maxLevel*5+18), &Instructions->binarys[Instructions->count++]));
        }

        /* mul r2.xy, r9.zx, -r15.zw */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE2(2, 0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE2(2, 3), NEGATE_FLAG, &Instructions->binarys[Instructions->count++]));

        /* mad r15.zw, r9.yy, r15.wz, r2.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE4(1, 1, 1, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE4(3, 2, 3, 2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 2, gcdVX_SWIZZLE4(0, 1, 0, 1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* add.f32 r15.zw, r15.zw, r15.xy */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE4(2, 3, 2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE4(0, 1, 0, 1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* mul.f32 r15.zw, r15.zw, r9.ww */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x03, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(15, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE4(2, 3, 2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE4(3, 3, 3, 3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /*-----------------------  delta_x, delta_y ------------------*/

        /* add.f32 r16.xy, r16.xy, r15.zw */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 15, gcdVX_SWIZZLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count++]));

        /* dp2 r2.x, r15.zw, r15.zw */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x73, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 15, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 15, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));

        /* add r17.x, r17.x, c(3+maxLevel*4+5).z */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(17, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 17, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, (3+maxLevel*4+5), gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count++]));

        /* mov r2.y, r17.x */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 17, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count++]));

        /* branch.f32 startIteration3, r2.xy, c(3+maxLevel*4+4).xy */
        gcmONERROR(gcoHARDWAREVX_Branch(0x01, (startIteration3-Instructions->count), 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*4+4), gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /*--------------------------  store ------------------------------*/

        /* F2I r16.zw, r16.xy --(OPT_INS_COUNT[0]-2)==Instructions->count */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x2E, 0, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE2(2, 3), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 16, gcdVX_SWIZZLE4(0, 1, 0, 1), 0, &Instructions->binarys[Instructions->count++]));

        /* store c1, r0.xy, r16.zw */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(16, gcdVX_ENABLE2(0, 1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 16, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));

        /* mov r17.y, c(3+maxLevel*5+7).w */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(17, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, (3+maxLevel*5+7), gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count++]));

        /* branchAny.EQ, r17.y, c(3+maxLevel*5+7).w, (OPT_INS_COUNT[0]-2) */
        gcmONERROR(gcoHARDWAREVX_BranchAny(0x05, (OPT_INS_COUNT[0]-2)-Instructions->count, 0x2, Instructions->count, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 17, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(1, (3+maxLevel*5+7), gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count++]));

        /* mov r17.y, 0 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(17, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 0, &Instructions->binarys[Instructions->count++]));

        /* add r2.x, r0.x, 20 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 0, gcdVX_SWIZZLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 20, &Instructions->binarys[Instructions->count++]));

        /* store c1, r2.x, r17.y */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x33, 0, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(17, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 17, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count++]));
    }

    /*------------------------------  maxLevel>=1 ------------------------------------*/

    Instructions->regs_count = 20;  /*lixia*//* take attention */

OnError:
    gcmFOOTER();
    return status;
}

static gceSTATUS _scaleimage_no_bilinear(
    IN OUT gcoVX_Hardware_Context   *Context
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gcoVX_Instructions   *Instructions = Context->instructions;
    gctUINT32 i = 0;
    gctUINT32 Input = Context->input_type[0];
    gctUINT32 Output = Context->output_type[0];
    gctUINT32 end = 0;

    gcmHEADER_ARG("Context=0x%x", Context);

    /* matrix         x  y  z  w
     * r1/c8(float) : wr hr 0  0
     *
     * x_src = ((vx_float32)r0.x + 0.5f) * wr - 0.5f;
     * y_src = ((vx_float32)r0.y + 0.5f) * hr - 0.5f;
     */

    /*mov r1, c8 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(1, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(2, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    /*mov r2, r0 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));
    /*mov r2.w, r2.y */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 0, gcdVX_SWIZZLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count++]));

    if (Context->borders == gcvVX_BORDER_MODE_CONSTANT || Context->borders == gcvVX_BORDER_MODE_UNDEFINED)
    {
        /*mov r4, c4 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
    }

    end = (Input == 0x7) ? 8 : 4;

    for (i = 0; i < end; i++)
    {
        /*add.u32 r2.z, r2.x, 1 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 1U, &Instructions->binarys[Instructions->count++]));
        /*conv.s32 r7, r2; u32 -> float*/
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x2 | (0 << 4), &Instructions->binarys[Instructions->count++]));
        /*add r7, r7, 0.5f */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(7, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(2, 0.5f, &Instructions->binarys[Instructions->count++]));
        /*mad r3 r1 r7 -0.5f */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x02, 0, 0x0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 7, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(2, -0.5f, &Instructions->binarys[Instructions->count++]));

        if (Context->policy == gcvVX_INTERPOLATION_TYPE_NEAREST_NEIGHBOR
            || Context->policy == gcvVX_INTERPOLATION_TYPE_AREA)
        {
            /*conv.s32 r3, r3 float -> s32*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x0 | (1 << 4), &Instructions->binarys[Instructions->count++]));
            /*img_load.u32 r4(0), c0, r3.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(i * 2, i * 2, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
            /*img_load.u32 r4(1), c0, r3.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, Input, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(i * 2 + 1, i * 2 + 1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));
        }
        else if (Context->policy == gcvVX_INTERPOLATION_TYPE_BILINEAR)
        {
            const static RelOffset plusOne = {{0, 1}};
            /*
             * uniform input_descriptor := c0
             * uniform output_descriptor := c1
            */
            /* ======== checking if the pixel on border start ======== */
            /*mov r6, r3 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(6, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 3, gcdVX_SWIZZLE, gcvFALSE, &Instructions->binarys[Instructions->count++]));
            /*branch r3.x, 0.0, 2 */
            gcmONERROR(gcoHARDWAREVX_Branch(0x03, 2, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(1, 0.0f, &Instructions->binarys[Instructions->count++]));
            /*add r3.x, r3.x, -1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(2, -1.0f, &Instructions->binarys[Instructions->count++]));
            /*branch r3.y, 0.0f, 2 */
            gcmONERROR(gcoHARDWAREVX_Branch(0x03, 2, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(1, 0.0f, &Instructions->binarys[Instructions->count++]));
            /*add r3.y, r3.y, -1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(1), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(2, -1.0f, &Instructions->binarys[Instructions->count++]));
            /*branch r3.z, 0.0, 2 */
            gcmONERROR(gcoHARDWAREVX_Branch(0x03, 2, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(1, 0.0f, &Instructions->binarys[Instructions->count++]));
            /*add r3.z, r3.z, -1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(2), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(2, -1.0f, &Instructions->binarys[Instructions->count++]));
            /*branch r3.w, 0.0f, 2 */
            gcmONERROR(gcoHARDWAREVX_Branch(0x03, 2, 0x0, Instructions->count, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(1, 0.0f, &Instructions->binarys[Instructions->count++]));
            /*add r3.w, r3.w, -1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(3, gcdVX_ENABLE1(3), gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(2, -1.0f, &Instructions->binarys[Instructions->count++]));
            /* ======== checking if the pixel on border end ======== */

            /*conv.s32 r3, r3 float -> s32*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x72, 0, 0x2, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestinationExt(3, gcdVX_ENABLE, gcvFALSE, gcvTRUE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 3, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0x0 | (0 << 4), &Instructions->binarys[Instructions->count++]));
            if (Context->borders == gcvVX_BORDER_MODE_CONSTANT || Context->borders == gcvVX_BORDER_MODE_UNDEFINED)
            {
                /*mov r5, c4 */
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x09, 0, GCREG_SH_INSTRUCTION_TYPE_INVALID, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
                gcmONERROR(gcoHARDWAREVX_SetUniform(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));
            }
            /*img_load.u8 r5[0-1], c0, r3.xy */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count++]));
            /*img_load.u8 r5[8-9], c0, r3.xy, +0,1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(8, 9, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusOne.raw, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r9, r5, 0, c12;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 12, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));


            /*lerp.u8[7-0] r8[0-1], r9.x, r9.y, r6.y */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 0x6 | (0x6 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r8, r8, 0, c13;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[7-0] r8[0], r8.x, r8.y, r6.x */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, 0x6 | (0x6 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lixia*/
            /*mul_shift.u8, r4[0], r8.x, 1, 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(i * 2, i * 2, (0x6 | (0x6 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, (1 | (1 << 16)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

             /*img_load.u8 r5[4-5], c0, r3.zw */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(4, 5, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count++]));
            /*img_load.u8 r5[12-13], c0, r3.zw, +0,1 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x79, 0, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(5, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(12, 13, 1, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(0, 0, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 3, gcdVX_SWIZZLE2(2, 3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, plusOne.raw, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r9, r5, 0, c14;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(9, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x7 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 5, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 14, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[7-0] r8[0-1], r9.x, r9.y, r6.w */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 1, 0x6 | (0x6 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 9, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 9, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE1(3), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*bitextract.u32 r8, r8, 0, c13;*/
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x10, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 7, (0x6 | (0x7 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, 0U, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetUniform(2, 13, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lerp.u8[7-0] r8[0], r8.x, r8.y, r6.z */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x04, 0x6, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(8, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(0, 0, 0x6 | (0x6 << 3), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 8, gcdVX_SWIZZLE1(1), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 6, gcdVX_SWIZZLE1(2), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

            /*lixia*/
            /*mul_shift.u8, r4[1], r8.x, 1, 0 */
            gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, 0x07, 0x7, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetDestination(4, gcdVX_ENABLE, gcvFALSE, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetEVIS(i * 2 + 1, i * 2 + 1, (0x6 | (0x6 << 3)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 8, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(1, (1 | (1 << 16)), &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 8, &Instructions->binarys[Instructions->count]));
            gcmONERROR(gcoHARDWAREVX_SetSourceBin(0, &Instructions->binarys[Instructions->count++]));

        }
        /*add.u32 r2.x, r2.x, 2 */
        gcmONERROR(gcoHARDWAREVX_AddOpcode(0x01, 0, 0x2, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetDestination(2, gcdVX_ENABLE1(0), gcvFALSE, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetTempReg(0, 2, gcdVX_SWIZZLE1(0), 0, &Instructions->binarys[Instructions->count]));
        gcmONERROR(gcoHARDWAREVX_SetImmediateValue(2, 2U, &Instructions->binarys[Instructions->count++]));
    }

    /*img_store r4, c1, r0.xy, r4 */
    gcmONERROR(gcoHARDWAREVX_AddOpcode(0x7A, 0, Output, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetEVIS(0, gcoHardwareVX_GetPixel(Output), 1, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetUniform(0, 1, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(1, 0, gcdVX_SWIZZLE2(0, 1), 0, &Instructions->binarys[Instructions->count]));
    gcmONERROR(gcoHARDWAREVX_SetTempReg(2, 4, gcdVX_SWIZZLE, 0, &Instructions->binarys[Instructions->count++]));

    Instructions->regs_count = 0xb;

OnError:
    gcmFOOTER();
    return status;
}

gcoVX_Hardware_Kernel kernelTables[] =
{
    {0, "color convert", gcvVX_KERNEL_COLOR_CONVERT, &_convertcolor},
    {1, "channel extract", gcvVX_KERNEL_CHANNEL_EXTRACT, &_channelextract},
    {2, "channel combine", gcvVX_KERNEL_CHANNEL_COMBINE, &_channelcombine},
    {3, "sobel 3x3 filter", gcvVX_KERNEL_SOBEL_3x3, &_sobel3x3},
    {4, "magnitude", gcvVX_KERNEL_MAGNITUDE, &_magphase},
    {5, "phase", gcvVX_KERNEL_PHASE, &_magphase},
    {6, "scale image", gcvVX_KERNEL_SCALE_IMAGE, &_scaleimage},
    {7, "lookup table", gcvVX_KERNEL_TABLE_LOOKUP, &_lut},
    {8, "histogram", gcvVX_KERNEL_HISTOGRAM, &_histogram},
    {9, "equalize histogram", gcvVX_KERNEL_EQUALIZE_HISTOGRAM, &_equalizehistogram},
    {10, "abs diff", gcvVX_KERNEL_ABSDIFF, &_absdiff},
    {11, "mean & std dev", gcvVX_KERNEL_MEAN_STDDEV, &_meanstddev},
    {12, "threshold", gcvVX_KERNEL_THRESHOLD, &_threshold},
    {13, "integal", gcvVX_KERNEL_INTEGRAL_IMAGE, &_integralimage},
    {14, "dilate 3x3 filter", gcvVX_KERNEL_DILATE_3x3, &_filter},
    {15, "erode 3x3 filter", gcvVX_KERNEL_ERODE_3x3, &_filter},
    {16, "median 3x3 filter", gcvVX_KERNEL_MEDIAN_3x3, &_filter},
    {17, "box 3x3 filter", gcvVX_KERNEL_BOX_3x3, &_filter},
    {18, "gaussian 3x3 filter", gcvVX_KERNEL_GAUSSIAN_3x3, &_filter},
    {19, "custom convolution", gcvVX_KERNEL_CUSTOM_CONVOLUTION,&_convolution},
    {20, "guassian pyramid", gcvVX_KERNEL_GAUSSIAN_PYRAMID, gcvNULL},
    {21, "accumulate", gcvVX_KERNEL_ACCUMULATE, &_accumulate},
    {22, "accumulate weighted", gcvVX_KERNEL_ACCUMULATE_WEIGHTED, &_accumulateweighted},
    {23, "accumulate square", gcvVX_KERNEL_ACCUMULATE_SQUARE, &_accumulatesquare},
    {24, "min and max location", gcvVX_KERNEL_MINMAXLOC, &_minmaxloc},
    {25, "convert depth", gcvVX_KERNEL_CONVERTDEPTH, &_convertdepth},
    {26, "canny edge detector", gcvVX_KERNEL_CANNY_EDGE_DETECTOR, gcvNULL},
    {27, "bitwise and", gcvVX_KERNEL_AND, &_bitwise},
    {28, "bitwise or", gcvVX_KERNEL_OR, &_bitwise},
    {29, "bitwise xor", gcvVX_KERNEL_XOR, &_bitwise},
    {30, "bitwise not", gcvVX_KERNEL_NOT, &_not},
    {31, "multiply", gcvVX_KERNEL_MULTIPLY, &_multiply},
    {32, "add", gcvVX_KERNEL_ADD, &_add_sub},
    {33, "sub", gcvVX_KERNEL_SUBTRACT, &_add_sub},
    {34, "warp affine", gcvVX_KERNEL_WARP_AFFINE, &_warpaffine},
    {35, "warp perspective", gcvVX_KERNEL_WARP_PERSPECTIVE, &_warpperspective},
    {36, "harris corners", gcvVX_KERNEL_HARRIS_CORNERS, &_harriscorners},
    {37, "fast corners", gcvVX_KERNEL_FAST_CORNERS, &_fast9corners},
    {38, "optical flow pyramid",gcvVX_KERNEL_OPTICAL_FLOW_PYR_LK, &_optLKTracker},
    {39, "remap", gcvVX_KERNEL_REMAP, &_remap},
    {40, "half scale guassian", gcvVX_KERNEL_HALFSCALE_GAUSSIAN,gcvNULL},
    {41, "Scharr_x gradients", gcvVX_KERNEL_SCHARR_3x3, &_scharr3x3},
    {42, "element wise norm", gcvVX_KERNEL_ELEMENTWISE_NORM, &_element_wise_norm},
    {43, "nonmax supperession", gcvVX_KERNEL_NONMAXSUPPRESSION_CANNY, &_canny_nonmax_suppression},
    {44, "euclidean nonmax supperession", gcvVX_KERNEL_EUCLIDEAN_NONMAXSUPPRESSION, &_euclidean_nonmax_suppression},
    {45, "edge tracing", gcvVX_KERNEL_EDGE_TRACE, &_edge_trace},
    {46, "image lister", gcvVX_KERNEL_IMAGE_LISTER, &_img_lister},
    {47, "sobel mxn", gcvVX_KERNEL_SOBEL_MxN, &_sobel_mxn},
    {48, "semi global matching",gcvVX_KERNEL_SGM, &_sgm},
    {49, "nonlinear min", gcvVX_KERNEL_NONLINEAR_FILTER_MIN, &_nonlinearfilter},
    {50, "nonlinear max", gcvVX_KERNEL_NONLINEAR_FILTER_MAX, &_nonlinearfilter},
    {51, "nonlinear median", gcvVX_KERNEL_NONLINEAR_FILTER_MEDIAN, &_nonlinearfilter},
    {52, "laplacian 3x3", gcvVX_KERNEL_LAPLACIAN_3x3, &_laplacian},
    {53, "census 3x3", gcvVX_KERNEL_CENSUS_3x3, &_census3x3},
    {54, "copy image", gcvVX_KERNEL_COPY_IMAGE, &_copy_image},
    {55, "maxpool", gcvVX_KERNEL_MAXPOOL, &_max_pooling},
    {56, "lrn", gcvVX_KERNEL_LRN, &_lrn},
    {57, "euclidean nonmax supperession non max", gcvVX_KERNEL_EUCLIDEAN_NONMAXSUPPRESSION_MAX, &_euclidean_nonmax_suppression_max},
    {58, "euclidean nonmax supperession non max", gcvVX_KERNEL_EUCLIDEAN_NONMAXSUPPRESSION_SORT, &_euclidean_nonmax_suppression_sort},
    {59, "euclidean nonmax supperession non max", gcvVX_KERNEL_EUCLIDEAN_NONMAXSUPPRESSION_NONMAX, &_euclidean_nonmax_suppression_nonmax},
};

gceSTATUS
gcoHARDWAREVX_KenrelConstruct(
    IN OUT gcoVX_Hardware_Context   *Context
)
{
    gceSTATUS status = gcvSTATUS_OK;
    gcoVX_Hardware_Kernel kernel = kernelTables[Context->kernel];

    gcmHEADER_ARG("Context=0x%x", Context);
    assert(kernel.index == kernel.kernel);
    assert(kernel.func != gcvNULL);

    switch (kernel.kernel)
    {
    case gcvVX_KERNEL_NONLINEAR_FILTER_MIN:
    case gcvVX_KERNEL_NONLINEAR_FILTER_MAX:
    case gcvVX_KERNEL_NONLINEAR_FILTER_MEDIAN:
        kernel.func = Context->evisNoInst.isVX2 ? _nonlinearfilter_vx2 : kernel.func;
        break;

    case gcvVX_KERNEL_SOBEL_3x3:
    case gcvVX_KERNEL_SOBEL_MxN:
        kernel.func = (Context->evisNoInst.isVX2 || Context->evisNoInst.noFilter) ? &_sobel_mxn_halfevis : kernel.func;
        break;

    case gcvVX_KERNEL_MAGNITUDE:
        kernel.func = (Context->evisNoInst.isVX2 || Context->evisNoInst.noMagPhase) ? &_mag_halfevis : kernel.func;
        break;

    case gcvVX_KERNEL_PHASE:
        kernel.func = (Context->evisNoInst.isVX2 || Context->evisNoInst.noMagPhase) ? &_phase_halfevis : kernel.func;
        break;

    case gcvVX_KERNEL_HISTOGRAM:
        kernel.func = Context->evisNoInst.isVX2 ? _histogram_vx2 : Context->evisNoInst.noSelectAdd ? &_histogram_halfevis : kernel.func;
        break;

    case gcvVX_KERNEL_ABSDIFF:
        kernel.func = Context->evisNoInst.noAbsDiff ? &_absdiff_halfevis : kernel.func;
        break;

    case gcvVX_KERNEL_THRESHOLD:
        kernel.func = Context->evisNoInst.clamp8Output ? &_threshold_halfevis : kernel.func;
        break;

    case gcvVX_KERNEL_DILATE_3x3:
    case gcvVX_KERNEL_ERODE_3x3:
        kernel.func = Context->evisNoInst.isVX2 ? &_morphology_vx2 : Context->evisNoInst.noFilter ? &_morphology_halfevis : kernel.func;
        break;

    case gcvVX_KERNEL_MEDIAN_3x3:
        kernel.func = Context->evisNoInst.isVX2 ? &_morphology_vx2 : kernel.func;
        break;

    case gcvVX_KERNEL_BOX_3x3:
        kernel.func = (Context->evisNoInst.isVX2 || Context->evisNoInst.noBoxFilter) ? &_filter_halfevis : kernel.func;
        break;

    case gcvVX_KERNEL_GAUSSIAN_3x3:
        kernel.func = (Context->evisNoInst.isVX2 || Context->evisNoInst.noFilter) ? &_filter_halfevis : kernel.func;
        break;

    case gcvVX_KERNEL_ACCUMULATE:
        kernel.func = (Context->evisNoInst.isVX2 || Context->evisNoInst.noIAdd) ? &_accumulate_halfevis : kernel.func;
        break;

    case gcvVX_KERNEL_ACCUMULATE_WEIGHTED:
        kernel.func = (Context->evisNoInst.isVX2 || Context->evisNoInst.lerp7Output) ? &_accumulateweighted_halfevis : kernel.func;
        break;

    case gcvVX_KERNEL_MINMAXLOC:
        kernel.func = Context->evisNoInst.isVX2 ? &_minmaxloc_vx2 : Context->evisNoInst.noFilter ? &_minmaxloc_halfevis : kernel.func;
        break;

    case gcvVX_KERNEL_CONVERTDEPTH:
        kernel.func = (Context->evisNoInst.isVX2 || Context->evisNoInst.noIAdd) ? &_convertdepth_halfevis : kernel.func;
        break;

    case gcvVX_KERNEL_ADD:
    case gcvVX_KERNEL_SUBTRACT:
        kernel.func = _add_sub_halfevis;
        break;

    case gcvVX_KERNEL_FAST_CORNERS:
        kernel.func = (Context->evisNoInst.isVX2 || Context->evisNoInst.noIAdd || Context->evisNoInst.noFilter ||
                       Context->evisNoInst.noAbsDiff) ? _fast9corners_halfevis : kernel.func;
        break;

    case gcvVX_KERNEL_SCHARR_3x3:
        kernel.func = (Context->evisNoInst.isVX2 || Context->evisNoInst.noIAdd || Context->evisNoInst.noFilter) ? &_sobel_mxn_halfevis : kernel.func;
        break;

    case gcvVX_KERNEL_ELEMENTWISE_NORM:
        kernel.func = Context->evisNoInst.noAbsDiff ? &_element_wise_norm_halfevis : kernel.func;
        break;

    case gcvVX_KERNEL_EDGE_TRACE:
        kernel.func = Context->evisNoInst.isVX2 ? &_edge_trace_vx2 : (Context->evisNoInst.clamp8Output || Context->evisNoInst.noFilter ||
                       Context->evisNoInst.noIAdd) ? &_edge_trace_halfevis : kernel.func;
        break;

    case gcvVX_KERNEL_REMAP:
        kernel.func = (Context->evisNoInst.isVX2 || Context->evisNoInst.noBilinear) ? &_remap_no_bilinear : kernel.func;
        break;

    case gcvVX_KERNEL_WARP_PERSPECTIVE:
        kernel.func = (Context->evisNoInst.isVX2 || Context->evisNoInst.noBilinear) ? &_warpperspective_no_bilinear : kernel.func;
        break;

    case gcvVX_KERNEL_WARP_AFFINE:
        kernel.func = (Context->evisNoInst.isVX2 || Context->evisNoInst.noBilinear) ? &_warpaffine_no_bilinear : kernel.func;
        break;

    case gcvVX_KERNEL_OPTICAL_FLOW_PYR_LK:
        kernel.func = (Context->evisNoInst.isVX2 || Context->evisNoInst.noBilinear) ? &_optLKTracker_no_bilinear : kernel.func;
        break;

    case gcvVX_KERNEL_SCALE_IMAGE:
        kernel.func = (Context->evisNoInst.isVX2 || Context->evisNoInst.noBilinear) ? &_scaleimage_no_bilinear : kernel.func;
        break;
    case gcvVX_KERNEL_MAXPOOL:
        kernel.func = (Context->evisNoInst.isVX2 || Context->evisNoInst.noBilinear) ? &_max_pooling : kernel.func;
        break;
    case gcvVX_KERNEL_LRN:
        kernel.func = (Context->evisNoInst.isVX2 || Context->evisNoInst.noBilinear) ? &_lrn : kernel.func;
        break;

    default:
        break;
    }

    gcmONERROR(kernel.func(Context));

OnError:
    gcmFOOTER();
    return status;
}

gceSTATUS
gcoHARDWAREVX_LoadKernel(
    IN gcoHARDWARE                          Hardware,
    IN gctUINT32                            Address,
    IN gctUINT32                            Size,
    IN gctUINT32                            TempRegCount,
    OUT gctUINT32_PTR                       ValueOrder
    )
{
    gceSTATUS status;
    gctPOINTER *cmdBuffer = gcvNULL;

     /* Define state buffer variables. */
    gcmDEFINESTATEBUFFER_NEW(reserve, stateDelta, memory);

    gcmHEADER_ARG("Hardware=0x%x", Hardware);

    gcmGETHARDWARE(Hardware);

    gcmBEGINSTATEBUFFER_NEW(Hardware, reserve, stateDelta, memory, cmdBuffer);

    /* Clean programState if has ran vxc case before */
    if (Hardware->SHStates != gcvNULL)
    {
        Hardware->SHStates->programState.hints = gcvNULL;
        Hardware->SHStates->programState.stateBuffer = gcvNULL;
        Hardware->SHStates->programState.stateBufferSize = 0;
    }

    *ValueOrder = 0x2;
    /* Program pixel shader states.*/
    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1  <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1 ) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x021F) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};


    gcmSETSTATEDATA_NEW(
        stateDelta, reserve, memory, gcvFALSE, 0x021F,
         ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 19:0) - (0 ?
 19:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 19:0) - (0 ?
 19:0) + 1))))))) << (0 ?
 19:0))) | (((gctUINT32) ((gctUINT32) (0) & ((gctUINT32) ((((1 ?
 19:0) - (0 ?
 19:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 19:0) - (0 ? 19:0) + 1))))))) << (0 ? 19:0)))
        );

    gcmENDSTATEBATCH_NEW(
        reserve, memory
        );

    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1  <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1 ) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x0424) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};


    gcmSETSTATEDATA_NEW(
        stateDelta, reserve, memory, gcvFALSE, 0x0424,
          ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 20:0) - (0 ?
 20:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 20:0) - (0 ?
 20:0) + 1))))))) << (0 ?
 20:0))) | (((gctUINT32) ((gctUINT32) (Size) & ((gctUINT32) ((((1 ?
 20:0) - (0 ?
 20:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 20:0) - (0 ? 20:0) + 1))))))) << (0 ? 20:0)))
        );

    gcmENDSTATEBATCH_NEW(
        reserve, memory
        );

    {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x0425) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETSTATEDATA_NEW(stateDelta, reserve, memory, gcvFALSE, 0x0425, ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 19:0) - (0 ?
 19:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 19:0) - (0 ?
 19:0) + 1))))))) << (0 ?
 19:0))) | (((gctUINT32) ((gctUINT32) (Size - 1) & ((gctUINT32) ((((1 ?
 19:0) - (0 ?
 19:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 19:0) - (0 ? 19:0) + 1))))))) << (0 ? 19:0))) );    gcmENDSTATEBATCH_NEW(reserve, memory);
};


    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)3  <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (3 ) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x0402) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};


    gcmSETSTATEDATA_NEW(
        stateDelta, reserve, memory, gcvFALSE, 0x0402,
         ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 5:0) - (0 ?
 5:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 5:0) - (0 ?
 5:0) + 1))))))) << (0 ?
 5:0))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 5:0) - (0 ?
 5:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 5:0) - (0 ? 5:0) + 1))))))) << (0 ? 5:0)))
        );

    gcmSETSTATEDATA_NEW(
        stateDelta, reserve, memory, gcvFALSE, 0x0403,
          ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 6:0) - (0 ?
 6:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 6:0) - (0 ?
 6:0) + 1))))))) << (0 ?
 6:0))) | (((gctUINT32) ((gctUINT32) (TempRegCount) & ((gctUINT32) ((((1 ?
 6:0) - (0 ?
 6:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 6:0) - (0 ? 6:0) + 1))))))) << (0 ? 6:0)))
        );

    gcmSETSTATEDATA_NEW(
        stateDelta, reserve, memory, gcvFALSE, 0x0404,
          ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 0:0) - (0 ?
 0:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 0:0) - (0 ?
 0:0) + 1))))))) << (0 ?
 0:0))) | (((gctUINT32) ((gctUINT32) (0) & ((gctUINT32) ((((1 ?
 0:0) - (0 ?
 0:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 0:0) - (0 ? 0:0) + 1))))))) << (0 ? 0:0)))
        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 12:12) - (0 ?
 12:12) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 12:12) - (0 ?
 12:12) + 1))))))) << (0 ?
 12:12))) | (((gctUINT32) ((gctUINT32) (0) & ((gctUINT32) ((((1 ?
 12:12) - (0 ?
 12:12) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 12:12) - (0 ? 12:12) + 1))))))) << (0 ? 12:12)))
        );

    gcmENDSTATEBATCH_NEW(
        reserve, memory
        );

#if gcdVX_OPTIMIZER < 2
    /* Force to invalidate shader cache. */
    {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x022C) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x022C, ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 0:0) - (0 ?
 0:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 0:0) - (0 ?
 0:0) + 1))))))) << (0 ?
 0:0))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 0:0) - (0 ?
 0:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 0:0) - (0 ?
 0:0) + 1))))))) << (0 ?
 0:0))) | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 1:1) - (0 ?
 1:1) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 1:1) - (0 ?
 1:1) + 1))))))) << (0 ?
 1:1))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 1:1) - (0 ?
 1:1) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 1:1) - (0 ?
 1:1) + 1))))))) << (0 ?
 1:1))) | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 2:2) - (0 ?
 2:2) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 2:2) - (0 ?
 2:2) + 1))))))) << (0 ?
 2:2))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 2:2) - (0 ?
 2:2) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 2:2) - (0 ?
 2:2) + 1))))))) << (0 ?
 2:2))) | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 3:3) - (0 ?
 3:3) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 3:3) - (0 ?
 3:3) + 1))))))) << (0 ?
 3:3))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 3:3) - (0 ?
 3:3) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 3:3) - (0 ?
 3:3) + 1))))))) << (0 ?
 3:3))) | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 4:4) - (0 ?
 4:4) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 4:4) - (0 ?
 4:4) + 1))))))) << (0 ?
 4:4))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 4:4) - (0 ?
 4:4) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 4:4) - (0 ? 4:4) + 1))))))) << (0 ? 4:4))) );    gcmENDSTATEBATCH_NEW(reserve, memory);
};

#endif

    {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x040A) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETSTATEDATA_NEW(stateDelta, reserve, memory, gcvFALSE, 0x040A, (gctUINT32)(Address) );
    gcmENDSTATEBATCH_NEW(reserve, memory);
};


    /* Set uniform base address.*/
    {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x0409) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETSTATEDATA_NEW(stateDelta, reserve, memory, gcvFALSE, 0x0409, ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 9:0) - (0 ?
 9:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 9:0) - (0 ?
 9:0) + 1))))))) << (0 ?
 9:0))) | (((gctUINT32) ((gctUINT32) (0) & ((gctUINT32) ((((1 ?
 9:0) - (0 ?
 9:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 9:0) - (0 ? 9:0) + 1))))))) << (0 ? 9:0))) );    gcmENDSTATEBATCH_NEW(reserve, memory);
};


    {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x021A) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETSTATEDATA_NEW(stateDelta, reserve, memory, gcvFALSE, 0x021A, ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 0:0) - (0 ?
 0:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 0:0) - (0 ?
 0:0) + 1))))))) << (0 ?
 0:0))) | (((gctUINT32) (0x1 & ((gctUINT32) ((((1 ?
 0:0) - (0 ?
 0:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 0:0) - (0 ? 0:0) + 1))))))) << (0 ? 0:0))) );    gcmENDSTATEBATCH_NEW(reserve, memory);
};


    /* Validate the state buffer. */
    gcmENDSTATEBUFFER_NEW(Hardware, reserve, memory, cmdBuffer);


#if gcdVX_OPTIMIZER < 2
    /* Flush the Shader L1 cache. */
    gcmONERROR(gcoHARDWARE_LoadCtrlState(
        Hardware,
        0x0380C,
            ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 5:5) - (0 ?
 5:5) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 5:5) - (0 ?
 5:5) + 1))))))) << (0 ?
 5:5))) | (((gctUINT32) (0x1 & ((gctUINT32) ((((1 ?
 5:5) - (0 ?
 5:5) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 5:5) - (0 ? 5:5) + 1))))))) << (0 ? 5:5)))
        ));

    if (Hardware->features[gcvFEATURE_MCFE])
    {
        gcmONERROR(gcoHARDWARE_McfeSubmitJob(Hardware, gcvNULL));
    }

    /* Add FE - PE samaphore stall to prevent unwanted SHL1_CACHE flush. */
    gcmONERROR(gcoHARDWARE_Semaphore(
        Hardware, gcvWHERE_COMMAND, gcvWHERE_PIXEL, gcvHOW_SEMAPHORE_STALL, gcvNULL));
#endif
    /* Success. */
    status = gcvSTATUS_OK;

OnError:
    /* Return the status. */
    gcmFOOTER();
    return status;
}

/* Add VX specific initialization states here */
gceSTATUS
gcoHARDWAREVX_InitVX(
    IN gcoHARDWARE  Hardware
    )
{
    gceSTATUS status = gcvSTATUS_OK;

    gctBOOL programUSC = gcvFALSE;

    gctUINT32 uscConfig = 0;

     /* Define state buffer variables. */
    gcmDEFINESTATEBUFFER_NEW(reserve, stateDelta, memory);

    gcmHEADER_ARG("Hardware=0x%x", Hardware);

    gcmGETHARDWARE(Hardware);

    if (!Hardware->features[gcvFEATURE_COMPUTE_ONLY] &&
        !Hardware->features[gcvFEATURE_PSCS_THROTTLE])
    {
        gctUINT l1Cache = Hardware->features[gcvFEATURE_USC_FULLCACHE_FIX] ?
            0x0 : 0x6;
        uscConfig = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 2:0) - (0 ?
 2:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 2:0) - (0 ?
 2:0) + 1))))))) << (0 ?
 2:0))) | (((gctUINT32) ((gctUINT32) (l1Cache) & ((gctUINT32) ((((1 ?
 2:0) - (0 ?
 2:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 2:0) - (0 ? 2:0) + 1))))))) << (0 ? 2:0)))
                  | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 20:16) - (0 ?
 20:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 20:16) - (0 ?
 20:16) + 1))))))) << (0 ?
 20:16))) | (((gctUINT32) ((gctUINT32) (2) & ((gctUINT32) ((((1 ?
 20:16) - (0 ?
 20:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 20:16) - (0 ? 20:16) + 1))))))) << (0 ? 20:16)));
        programUSC = gcvTRUE;
    }


    if (!Hardware->features[gcvFEATURE_NN_ASYNC_COPY_MERGE_FIX])
    {
        if (programUSC)
        {
            uscConfig  |= ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 21:21) - (0 ?
 21:21) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 21:21) - (0 ?
 21:21) + 1))))))) << (0 ?
 21:21))) | (((gctUINT32) (0x1 & ((gctUINT32) ((((1 ?
 21:21) - (0 ?
 21:21) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 21:21) - (0 ? 21:21) + 1))))))) << (0 ? 21:21)));
        }
        else
        {
            uscConfig = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 2:0) - (0 ?
 2:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 2:0) - (0 ?
 2:0) + 1))))))) << (0 ?
 2:0))) | (((gctUINT32) ((gctUINT32) (Hardware->options.uscL1CacheRatio) & ((gctUINT32) ((((1 ?
 2:0) - (0 ?
 2:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 2:0) - (0 ? 2:0) + 1))))))) << (0 ? 2:0)))
                      | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 20:16) - (0 ?
 20:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 20:16) - (0 ?
 20:16) + 1))))))) << (0 ?
 20:16))) | (((gctUINT32) ((gctUINT32) (2) & ((gctUINT32) ((((1 ?
 20:16) - (0 ?
 20:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 20:16) - (0 ? 20:16) + 1))))))) << (0 ? 20:16)))
                      | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 21:21) - (0 ?
 21:21) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 21:21) - (0 ?
 21:21) + 1))))))) << (0 ?
 21:21))) | (((gctUINT32) (0x1 & ((gctUINT32) ((((1 ?
 21:21) - (0 ?
 21:21) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 21:21) - (0 ? 21:21) + 1))))))) << (0 ? 21:21)));
            programUSC = gcvTRUE;
        }
    }

    if (programUSC)
    {
        gctPOINTER *cmdBuffer = gcvNULL;
        gcmBEGINSTATEBUFFER_NEW(Hardware, reserve, stateDelta, memory, cmdBuffer);
        {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x0E21) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETSTATEDATA_NEW(stateDelta, reserve, memory, gcvFALSE, 0x0E21, uscConfig);
    gcmENDSTATEBATCH_NEW(reserve, memory);
};

        gcmENDSTATEBUFFER_NEW(Hardware, reserve, memory, cmdBuffer);
        stateDelta = stateDelta;
    }

#if gcdDUMP && !gcdDUMP_IN_KERNEL
    /* Dump current context buffer. */
    gcmDUMP_BUFFER(gcvNULL,
        gcvDUMP_BUFFER_CONTEXT,
        Hardware->context,
        Hardware->contextLogical[Hardware->currentContext],
        0,
        Hardware->contextBytes);
#endif

OnError:
    /* Return the status. */
    gcmFOOTER();
    return status;
}

gceSTATUS
gcoHARDWAREVX_TriggerAccelerator(
    IN gcoHARDWARE              Hardware,
    IN gctUINT32                CmdAddress,
    IN gceVX_ACCELERATOR_TYPE   Type,
    IN gctUINT32                EventId,
    IN gctBOOL                  waitEvent,
    IN gctUINT32                gpuId,
    IN gctBOOL                  sync,
    IN gctUINT32                syncEventID
)
{
    gceSTATUS status = gcvSTATUS_OK;
    gctPOINTER *cmdBuffer = gcvNULL;
    gctUINT gpuCount;

     /* Define state buffer variables. */
    gcmDEFINESTATEBUFFER_NEW(reserve, stateDelta, memory);

    gcmHEADER_ARG("Hardware=0x%x CmdAddress=0x%x Type=0x%x EventId=0x%x",
        Hardware, CmdAddress, Type, EventId);

    gcmGETHARDWARE(Hardware);

    gcmBEGINSTATEBUFFER_NEW(Hardware, reserve, stateDelta, memory, cmdBuffer);

    stateDelta = stateDelta; /* Keep the compiler happy. */
    gpuCount = Hardware->config->gpuCoreCount;

    if (gpuCount > 1)
    {
        { if (Hardware->config->gpuCoreCount > 1) { *memory++ = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x0D & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ? 31:27))) | gcvCORE_3D_0_MASK << gcmTO_CHIP_ID(gpuId); memory++;
  gcmDUMP(gcvNULL, "#[chip.enable 0x%04X]", gcvCORE_3D_0_MASK << gcmTO_CHIP_ID(gpuId));
 } };

    }

    if (gcvVX_ACCELERATOR_NN == Type)
    {
        gctBOOL enableZDP3, enableZDP6, enableNNStride;
        gctUINT disableZDPN, disableSWTiling, smallBatch, ddrBurstSize;

        gctUINT NNconfig = 0;

        enableZDP3 = Hardware->features[gcvFEATURE_NN_ZDP3] && gcoHAL_GetOption(gcvNULL, gcvOPTION_OVX_ENABLE_NN_ZDP3);
        enableZDP6 = Hardware->features[gcvFEATURE_NN_ZDP6] && gcoHAL_GetOption(gcvNULL, gcvOPTION_OVX_ENABLE_NN_ZDP6);
        disableZDPN = (enableZDP3 || enableZDP6) ? 0 : 1;

        enableNNStride = Hardware->features[gcvFEATURE_NN_STRIDE_SUPPORT] &&
                         gcoHAL_GetOption(gcvNULL, gcvOPTION_OVX_ENABLE_NN_STRIDE);
        disableSWTiling = enableNNStride ? 0 : 1;

        if (!Hardware->config->parallelNoFix)
        {
            smallBatch = Hardware->features[gcvFEATURE_NN_SMALLBATCH_PHASE1] ? 0x0 : 0x1;
        }
        else
        {
            smallBatch = 0x0;
        }

        ddrBurstSize = gcoHAL_GetOption(gcvNULL, gcvOPTION_OVX_ENABLE_NN_DDR_BURST_SIZE_256B) ? 0x2 :
                                                                                                0x0;

        NNconfig |= ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 2:2) - (0 ?
 2:2) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 2:2) - (0 ?
 2:2) + 1))))))) << (0 ?
 2:2))) | (((gctUINT32) ((gctUINT32) (disableZDPN) & ((gctUINT32) ((((1 ?
 2:2) - (0 ?
 2:2) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 2:2) - (0 ? 2:2) + 1))))))) << (0 ? 2:2)))
                 |  ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 3:3) - (0 ?
 3:3) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 3:3) - (0 ?
 3:3) + 1))))))) << (0 ?
 3:3))) | (((gctUINT32) ((gctUINT32) (disableSWTiling) & ((gctUINT32) ((((1 ?
 3:3) - (0 ?
 3:3) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 3:3) - (0 ? 3:3) + 1))))))) << (0 ? 3:3)))
                 |  ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 4:4) - (0 ?
 4:4) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 4:4) - (0 ?
 4:4) + 1))))))) << (0 ?
 4:4))) | (((gctUINT32) ((gctUINT32) (smallBatch) & ((gctUINT32) ((((1 ?
 4:4) - (0 ?
 4:4) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 4:4) - (0 ? 4:4) + 1))))))) << (0 ? 4:4)))
                 |  ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 6:5) - (0 ?
 6:5) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 6:5) - (0 ?
 6:5) + 1))))))) << (0 ?
 6:5))) | (((gctUINT32) ((gctUINT32) (ddrBurstSize) & ((gctUINT32) ((((1 ?
 6:5) - (0 ?
 6:5) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 6:5) - (0 ? 6:5) + 1))))))) << (0 ? 6:5)))
                 |  ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 12:12) - (0 ?
 12:12) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 12:12) - (0 ?
 12:12) + 1))))))) << (0 ?
 12:12))) | (((gctUINT32) ((gctUINT32) (0x0) & ((gctUINT32) ((((1 ?
 12:12) - (0 ?
 12:12) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 12:12) - (0 ? 12:12) + 1))))))) << (0 ? 12:12)));

        {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x0E4C) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x0E4C, NNconfig);
    gcmENDSTATEBATCH_NEW(reserve, memory);
};


    }

    if (Type == gcvVX_ACCELERATOR_TP)
    {
        gctUINT TPconfig = 0;

        if (Hardware->config->nnConfig.fixedFeature.tpliteCoreCount > 0 && (EventId & 0x80000000))
        {
            TPconfig = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 1:1) - (0 ?
 1:1) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 1:1) - (0 ?
 1:1) + 1))))))) << (0 ?
 1:1))) | (((gctUINT32) (0x1 & ((gctUINT32) ((((1 ?
 1:1) - (0 ?
 1:1) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 1:1) - (0 ? 1:1) + 1))))))) << (0 ? 1:1)));
        }
        else
        {
            TPconfig = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 1:1) - (0 ?
 1:1) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 1:1) - (0 ?
 1:1) + 1))))))) << (0 ?
 1:1))) | (((gctUINT32) (0x0 & ((gctUINT32) ((((1 ?
 1:1) - (0 ?
 1:1) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 1:1) - (0 ? 1:1) + 1))))))) << (0 ? 1:1)));
        }

        {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x0E53) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x0E53, TPconfig);
    gcmENDSTATEBATCH_NEW(reserve, memory);
};


        EventId &= 0x1;
    }

    if (Hardware->features[gcvFEATURE_TP_SMALLBATCH_PHASE1])
    {
        if (Type == gcvVX_ACCELERATOR_NN)
        {
            if (EventId == 0)
            {
                {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x0E54) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x0E54, ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 0:0) - (0 ?
 0:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 0:0) - (0 ?
 0:0) + 1))))))) << (0 ?
 0:0))) | (((gctUINT32) ((gctUINT32) (0) & ((gctUINT32) ((((1 ?
 0:0) - (0 ?
 0:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 0:0) - (0 ?
 0:0) + 1))))))) << (0 ?
 0:0))) | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 1:1) - (0 ?
 1:1) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 1:1) - (0 ?
 1:1) + 1))))))) << (0 ?
 1:1))) | (((gctUINT32) ((gctUINT32) (0) & ((gctUINT32) ((((1 ?
 1:1) - (0 ?
 1:1) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 1:1) - (0 ? 1:1) + 1))))))) << (0 ? 1:1))));    gcmENDSTATEBATCH_NEW(reserve, memory);
};

            }
            else
            {
                {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x0E54) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x0E54, ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 0:0) - (0 ?
 0:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 0:0) - (0 ?
 0:0) + 1))))))) << (0 ?
 0:0))) | (((gctUINT32) ((gctUINT32) (0) & ((gctUINT32) ((((1 ?
 0:0) - (0 ?
 0:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 0:0) - (0 ?
 0:0) + 1))))))) << (0 ?
 0:0))) | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 1:1) - (0 ?
 1:1) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 1:1) - (0 ?
 1:1) + 1))))))) << (0 ?
 1:1))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 1:1) - (0 ?
 1:1) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 1:1) - (0 ? 1:1) + 1))))))) << (0 ? 1:1))));    gcmENDSTATEBATCH_NEW(reserve, memory);
};

            }
        }
        else if (Type == gcvVX_ACCELERATOR_TP)
        {
            if (EventId == 0)
            {
                {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x0E54) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x0E54, ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 2:2) - (0 ?
 2:2) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 2:2) - (0 ?
 2:2) + 1))))))) << (0 ?
 2:2))) | (((gctUINT32) ((gctUINT32) (0) & ((gctUINT32) ((((1 ?
 2:2) - (0 ?
 2:2) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 2:2) - (0 ?
 2:2) + 1))))))) << (0 ?
 2:2))) | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 3:3) - (0 ?
 3:3) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 3:3) - (0 ?
 3:3) + 1))))))) << (0 ?
 3:3))) | (((gctUINT32) ((gctUINT32) (0) & ((gctUINT32) ((((1 ?
 3:3) - (0 ?
 3:3) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 3:3) - (0 ? 3:3) + 1))))))) << (0 ? 3:3))));    gcmENDSTATEBATCH_NEW(reserve, memory);
};


            }
            else
            {
                {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x0E54) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x0E54, ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 2:2) - (0 ?
 2:2) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 2:2) - (0 ?
 2:2) + 1))))))) << (0 ?
 2:2))) | (((gctUINT32) ((gctUINT32) (0) & ((gctUINT32) ((((1 ?
 2:2) - (0 ?
 2:2) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 2:2) - (0 ?
 2:2) + 1))))))) << (0 ?
 2:2))) | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 3:3) - (0 ?
 3:3) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 3:3) - (0 ?
 3:3) + 1))))))) << (0 ?
 3:3))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 3:3) - (0 ?
 3:3) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 3:3) - (0 ? 3:3) + 1))))))) << (0 ? 3:3))));    gcmENDSTATEBATCH_NEW(reserve, memory);
};

            }
        }
    }

    if (!Hardware->features[gcvFEATURE_MCFE])
    {
        static const gctUINT32 triggerRegAddr[] =
        {
            0x0428,
            0x042E,
            0x042F
        };
#if gcdFRAMEINFO_STATISTIC
        {
            gctUINT32 drawID;

            gcoHAL_FrameInfoOps(gcvNULL,
                                gcvFRAMEINFO_COMPUTE_NUM,
                                gcvFRAMEINFO_OP_GET,
                                &drawID);

            {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x0E27) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x0E27, drawID);
    gcmENDSTATEBATCH_NEW(reserve, memory);
};

        }
#endif

        if (syncEventID != 0)
        {
            {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (triggerRegAddr[Type]) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, triggerRegAddr[Type], ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:6) - (0 ?
 31:6) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:6) - (0 ?
 31:6) + 1))))))) << (0 ?
 31:6))) | (((gctUINT32) ((gctUINT32) ((CmdAddress >> 6)) & ((gctUINT32) ((((1 ?
 31:6) - (0 ?
 31:6) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:6) - (0 ?
 31:6) + 1))))))) << (0 ?
 31:6))) | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 4:0) - (0 ?
 4:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 4:0) - (0 ?
 4:0) + 1))))))) << (0 ?
 4:0))) | (((gctUINT32) ((gctUINT32) (syncEventID) & ((gctUINT32) ((((1 ?
 4:0) - (0 ?
 4:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 4:0) - (0 ? 4:0) + 1))))))) << (0 ? 4:0))));    gcmENDSTATEBATCH_NEW(reserve, memory);
};

        }
        else
        {
            {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (triggerRegAddr[Type]) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, triggerRegAddr[Type], ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:6) - (0 ?
 31:6) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:6) - (0 ?
 31:6) + 1))))))) << (0 ?
 31:6))) | (((gctUINT32) ((gctUINT32) ((CmdAddress >> 6)) & ((gctUINT32) ((((1 ?
 31:6) - (0 ?
 31:6) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:6) - (0 ?
 31:6) + 1))))))) << (0 ?
 31:6))) | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 4:0) - (0 ?
 4:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 4:0) - (0 ?
 4:0) + 1))))))) << (0 ?
 4:0))) | (((gctUINT32) ((gctUINT32) (EventId) & ((gctUINT32) ((((1 ?
 4:0) - (0 ?
 4:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 4:0) - (0 ? 4:0) + 1))))))) << (0 ? 4:0))));    gcmENDSTATEBATCH_NEW(reserve, memory);
};


            if (EventId == 0 || waitEvent)
            {
                {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x0429) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x0429, EventId);
    gcmENDSTATEBATCH_NEW(reserve, memory);
};

            }
        }
    }
    else
    {
        static const gctUINT32 triggerRegAddr[] =
        {
            0x0E43,
            0x0E4D
        };

        {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (triggerRegAddr[Type]) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, triggerRegAddr[Type], ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:0) - (0 ?
 25:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:0) - (0 ?
 25:0) + 1))))))) << (0 ?
 25:0))) | (((gctUINT32) ((gctUINT32) ((CmdAddress >> 6)) & ((gctUINT32) ((((1 ?
 25:0) - (0 ?
 25:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 25:0) - (0 ? 25:0) + 1))))))) << (0 ? 25:0))));    gcmENDSTATEBATCH_NEW(reserve, memory);
};




        /* SubmitJob. */
        *memory++ = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x16 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 31:27) - (0 ? 31:27) + 1))))))) << (0 ? 31:27)))
                    | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) (0x001 & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 25:16) - (0 ? 25:16) + 1))))))) << (0 ? 25:16)));

        *memory++ = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x03 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 31:27) - (0 ? 31:27) + 1))))))) << (0 ? 31:27)));


    }

    if (gpuCount > 1)
    {
        { if (Hardware->config->gpuCoreCount > 1) { *memory++ = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x0D & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ? 31:27) + 1))))))) << (0 ? 31:27))) | gcvCORE_3D_ALL_MASK; memory++;
  gcmDUMP(gcvNULL, "#[chip.enable 0x%04X]", gcvCORE_3D_ALL_MASK);
 } };

        if (sync)
        {
            gcoHARDWARE_MultiGPUSync(Hardware, &memory);
        }
    }

    /* Validate the state buffer. */
    gcmENDSTATEBUFFER_NEW(Hardware, reserve, memory, cmdBuffer);

OnError:
    /* Return the status. */
    gcmFOOTER();
    return status;

}

gceSTATUS
gcoHARDWAREVX_ProgrammeNNEngine(
    IN gcoHARDWARE Hardware,
    IN gctPOINTER Info,
    IN gctPOINTER Options,
    IN OUT gctUINT32_PTR *Instruction
    )
{
    struct _vx_nn_general_cmd_info *info = (struct _vx_nn_general_cmd_info*) Info;

    gctUINT32 layerType, kernelXYSize;

    gceSTATUS status;

    gcmGETHARDWARE(Hardware);

    if (gcoHAL_IsFeatureAvailable(gcvNULL, gcvFEATURE_NN_XYDP0))
    {
        /*V8 support MxN*/
        layerType = 0;
        kernelXYSize = info->kernelXSize;
    }
    else if (info->kernelXSize == info->kernelYSize)
    {
        layerType = 0;
        kernelXYSize = info->kernelXSize;
    }
    else
    {
        layerType = 1;
        kernelXYSize = info->kernelYSize;
    }

    *(*Instruction)++ =  ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 0:0) - (0 ?
 0:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 0:0) - (0 ?
 0:0) + 1))))))) << (0 ?
 0:0))) | (((gctUINT32) ((gctUINT32) (layerType) & ((gctUINT32) ((((1 ?
 0:0) - (0 ?
 0:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 0:0) - (0 ? 0:0) + 1))))))) << (0 ? 0:0)))
                         | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 1:1) - (0 ?
 1:1) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 1:1) - (0 ?
 1:1) + 1))))))) << (0 ?
 1:1))) | (((gctUINT32) ((gctUINT32) (info->noZOffset) & ((gctUINT32) ((((1 ?
 1:1) - (0 ?
 1:1) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 1:1) - (0 ? 1:1) + 1))))))) << (0 ? 1:1)))
                         | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 5:2) - (0 ?
 5:2) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 5:2) - (0 ?
 5:2) + 1))))))) << (0 ?
 5:2))) | (((gctUINT32) ((gctUINT32) (kernelXYSize) & ((gctUINT32) ((((1 ?
 5:2) - (0 ?
 5:2) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 5:2) - (0 ? 5:2) + 1))))))) << (0 ? 5:2)))
                         | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 19:6) - (0 ?
 19:6) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 19:6) - (0 ?
 19:6) + 1))))))) << (0 ?
 19:6))) | (((gctUINT32) ((gctUINT32) ((info->kernelZSize & 0x3FFF)) & ((gctUINT32) ((((1 ?
 19:6) - (0 ?
 19:6) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 19:6) - (0 ? 19:6) + 1))))))) << (0 ? 19:6)))
                         | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:20) - (0 ?
 26:20) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:20) - (0 ?
 26:20) + 1))))))) << (0 ?
 26:20))) | (((gctUINT32) ((gctUINT32) (info->kernelsPerCore) & ((gctUINT32) ((((1 ?
 26:20) - (0 ?
 26:20) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 26:20) - (0 ? 26:20) + 1))))))) << (0 ? 26:20)))
                         | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 28:27) - (0 ?
 28:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 28:27) - (0 ?
 28:27) + 1))))))) << (0 ?
 28:27))) | (((gctUINT32) ((gctUINT32) (info->pooling) & ((gctUINT32) ((((1 ?
 28:27) - (0 ?
 28:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 28:27) - (0 ? 28:27) + 1))))))) << (0 ? 28:27)))
                         | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 29:29) - (0 ?
 29:29) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 29:29) - (0 ?
 29:29) + 1))))))) << (0 ?
 29:29))) | (((gctUINT32) ((gctUINT32) (info->poolingXYSize) & ((gctUINT32) ((((1 ?
 29:29) - (0 ?
 29:29) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 29:29) - (0 ? 29:29) + 1))))))) << (0 ? 29:29)))
                         | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 30:30) - (0 ?
 30:30) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 30:30) - (0 ?
 30:30) + 1))))))) << (0 ?
 30:30))) | (((gctUINT32) ((gctUINT32) (info->pRelu) & ((gctUINT32) ((((1 ?
 30:30) - (0 ?
 30:30) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 30:30) - (0 ? 30:30) + 1))))))) << (0 ? 30:30)))
                         | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:31) - (0 ?
 31:31) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:31) - (0 ?
 31:31) + 1))))))) << (0 ?
 31:31))) | (((gctUINT32) ((gctUINT32) (info->nn_layer_flush) & ((gctUINT32) ((((1 ?
 31:31) - (0 ?
 31:31) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 31:31) - (0 ? 31:31) + 1))))))) << (0 ? 31:31)));

    *(*Instruction)++ = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 0:0) - (0 ?
 0:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 0:0) - (0 ?
 0:0) + 1))))))) << (0 ?
 0:0))) | (((gctUINT32) ((gctUINT32) (info->kernelDataType & 0x1) & ((gctUINT32) ((((1 ?
 0:0) - (0 ?
 0:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 0:0) - (0 ? 0:0) + 1))))))) << (0 ? 0:0)))
                    | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 1:1) - (0 ?
 1:1) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 1:1) - (0 ?
 1:1) + 1))))))) << (0 ?
 1:1))) | (((gctUINT32) ((gctUINT32) (info->kernelDataType >> 1) & ((gctUINT32) ((((1 ?
 1:1) - (0 ?
 1:1) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 1:1) - (0 ? 1:1) + 1))))))) << (0 ? 1:1)))
                    | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 2:2) - (0 ?
 2:2) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 2:2) - (0 ?
 2:2) + 1))))))) << (0 ?
 2:2))) | (((gctUINT32) ((gctUINT32) (info->inImageDataType & 0x1) & ((gctUINT32) ((((1 ?
 2:2) - (0 ?
 2:2) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 2:2) - (0 ? 2:2) + 1))))))) << (0 ? 2:2)))
                    | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 3:3) - (0 ?
 3:3) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 3:3) - (0 ?
 3:3) + 1))))))) << (0 ?
 3:3))) | (((gctUINT32) ((gctUINT32) (info->inImageDataType >> 1) & ((gctUINT32) ((((1 ?
 3:3) - (0 ?
 3:3) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 3:3) - (0 ? 3:3) + 1))))))) << (0 ? 3:3)))
                    | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 4:4) - (0 ?
 4:4) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 4:4) - (0 ?
 4:4) + 1))))))) << (0 ?
 4:4))) | (((gctUINT32) ((gctUINT32) (info->outImageDataType & 0x1) & ((gctUINT32) ((((1 ?
 4:4) - (0 ?
 4:4) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 4:4) - (0 ? 4:4) + 1))))))) << (0 ? 4:4)))
                    | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 5:5) - (0 ?
 5:5) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 5:5) - (0 ?
 5:5) + 1))))))) << (0 ?
 5:5))) | (((gctUINT32) ((gctUINT32) (info->outImageDataType >> 1) & ((gctUINT32) ((((1 ?
 5:5) - (0 ?
 5:5) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 5:5) - (0 ? 5:5) + 1))))))) << (0 ? 5:5)))
                    | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 18:6) - (0 ?
 18:6) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 18:6) - (0 ?
 18:6) + 1))))))) << (0 ?
 18:6))) | (((gctUINT32) ((gctUINT32) (info->inImageXSize) & ((gctUINT32) ((((1 ?
 18:6) - (0 ?
 18:6) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 18:6) - (0 ? 18:6) + 1))))))) << (0 ? 18:6)))
                    | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:19) - (0 ?
 31:19) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:19) - (0 ?
 31:19) + 1))))))) << (0 ?
 31:19))) | (((gctUINT32) ((gctUINT32) (info->inImageYSize) & ((gctUINT32) ((((1 ?
 31:19) - (0 ?
 31:19) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 31:19) - (0 ? 31:19) + 1))))))) << (0 ? 31:19)));

    *(*Instruction)++ = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 24:24) - (0 ?
 24:24) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 24:24) - (0 ?
 24:24) + 1))))))) << (0 ?
 24:24))) | (((gctUINT32) ((gctUINT32) (info->relu ?
 1 : 0) & ((gctUINT32) ((((1 ?
 24:24) - (0 ?
 24:24) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 24:24) - (0 ? 24:24) + 1))))))) << (0 ? 24:24)))
                    | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:25) - (0 ?
 25:25) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:25) - (0 ?
 25:25) + 1))))))) << (0 ?
 25:25))) | (((gctUINT32) ((gctUINT32) (0) & ((gctUINT32) ((((1 ?
 25:25) - (0 ?
 25:25) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 25:25) - (0 ? 25:25) + 1))))))) << (0 ? 25:25)))
                    | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 2:0) - (0 ?
 2:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 2:0) - (0 ?
 2:0) + 1))))))) << (0 ?
 2:0))) | (((gctUINT32) ((gctUINT32) (info->inImageXOffset) & ((gctUINT32) ((((1 ?
 2:0) - (0 ?
 2:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 2:0) - (0 ? 2:0) + 1))))))) << (0 ? 2:0)))
                    | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 5:3) - (0 ?
 5:3) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 5:3) - (0 ?
 5:3) + 1))))))) << (0 ?
 5:3))) | (((gctUINT32) ((gctUINT32) (info->inImageYOffset) & ((gctUINT32) ((((1 ?
 5:3) - (0 ?
 5:3) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 5:3) - (0 ? 5:3) + 1))))))) << (0 ? 5:3)))
                    | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (info->postMultiplier) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 26:26) - (0 ? 26:26) + 1))))))) << (0 ? 26:26)))
                    | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 7:7) - (0 ?
 7:7) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 7:7) - (0 ?
 7:7) + 1))))))) << (0 ?
 7:7))) | (((gctUINT32) ((gctUINT32) (info->brickMode) & ((gctUINT32) ((((1 ?
 7:7) - (0 ?
 7:7) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 7:7) - (0 ? 7:7) + 1))))))) << (0 ? 7:7)))
                    | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 23:8) - (0 ?
 23:8) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 23:8) - (0 ?
 23:8) + 1))))))) << (0 ?
 23:8))) | (((gctUINT32) ((gctUINT32) (info->brickDistance) & ((gctUINT32) ((((1 ?
 23:8) - (0 ?
 23:8) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 23:8) - (0 ? 23:8) + 1))))))) << (0 ? 23:8)))
                    | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) ((gctUINT32) (info->postShift) & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 31:27) - (0 ? 31:27) + 1))))))) << (0 ? 31:27)));

     *(*Instruction)++ = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 18:6) - (0 ?
 18:6) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 18:6) - (0 ?
 18:6) + 1))))))) << (0 ?
 18:6))) | (((gctUINT32) ((gctUINT32) (info->outImageXSize) & ((gctUINT32) ((((1 ?
 18:6) - (0 ?
 18:6) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 18:6) - (0 ? 18:6) + 1))))))) << (0 ? 18:6)))
                         | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:19) - (0 ?
 31:19) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:19) - (0 ?
 31:19) + 1))))))) << (0 ?
 31:19))) | (((gctUINT32) ((gctUINT32) (info->outImageYSize) & ((gctUINT32) ((((1 ?
 31:19) - (0 ?
 31:19) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 31:19) - (0 ? 31:19) + 1))))))) << (0 ? 31:19)))
                         | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 3:3) - (0 ?
 3:3) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 3:3) - (0 ?
 3:3) + 1))))))) << (0 ?
 3:3))) | (((gctUINT32) ((gctUINT32) (info->noFlush) & ((gctUINT32) ((((1 ?
 3:3) - (0 ?
 3:3) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 3:3) - (0 ? 3:3) + 1))))))) << (0 ? 3:3)));


    *(*Instruction)++ = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 13:0) - (0 ?
 13:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 13:0) - (0 ?
 13:0) + 1))))))) << (0 ?
 13:0))) | (((gctUINT32) ((gctUINT32) (info->outImageZSize) & ((gctUINT32) ((((1 ?
 13:0) - (0 ?
 13:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 13:0) - (0 ? 13:0) + 1))))))) << (0 ? 13:0)))
                    | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:14) - (0 ?
 15:14) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:14) - (0 ?
 15:14) + 1))))))) << (0 ?
 15:14))) | (((gctUINT32) ((gctUINT32) (info->roundingMode) & ((gctUINT32) ((((1 ?
 15:14) - (0 ?
 15:14) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:14) - (0 ? 15:14) + 1))))))) << (0 ? 15:14)))
                    | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 24:18) - (0 ?
 24:18) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 24:18) - (0 ?
 24:18) + 1))))))) << (0 ?
 24:18))) | (((gctUINT32) ((gctUINT32) (info->outImageTileXSize) & ((gctUINT32) ((((1 ?
 24:18) - (0 ?
 24:18) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 24:18) - (0 ? 24:18) + 1))))))) << (0 ? 24:18)))
                    | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:25) - (0 ?
 31:25) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:25) - (0 ?
 31:25) + 1))))))) << (0 ?
 31:25))) | (((gctUINT32) ((gctUINT32) (info->outImageTileYSize) & ((gctUINT32) ((((1 ?
 31:25) - (0 ?
 31:25) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 31:25) - (0 ? 31:25) + 1))))))) << (0 ? 31:25)))
                    | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 16:16) - (0 ?
 16:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 16:16) - (0 ?
 16:16) + 1))))))) << (0 ?
 16:16))) | (((gctUINT32) ((gctUINT32) ((info->inImageXOffset >> 3) & 0x1) & ((gctUINT32) ((((1 ?
 16:16) - (0 ?
 16:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 16:16) - (0 ? 16:16) + 1))))))) << (0 ? 16:16)))
                    | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 17:17) - (0 ?
 17:17) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 17:17) - (0 ?
 17:17) + 1))))))) << (0 ?
 17:17))) | (((gctUINT32) ((gctUINT32) ((info->inImageYOffset >> 3) & 0x1) & ((gctUINT32) ((((1 ?
 17:17) - (0 ?
 17:17) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 17:17) - (0 ? 17:17) + 1))))))) << (0 ? 17:17)));


     *(*Instruction)++ = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:26) - (0 ?
 31:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:26) - (0 ?
 31:26) + 1))))))) << (0 ?
 31:26))) | (((gctUINT32) ((gctUINT32) (((info->kernelZSize >> 14) & 0x3F)) & ((gctUINT32) ((((1 ?
 31:26) - (0 ?
 31:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 31:26) - (0 ? 31:26) + 1))))))) << (0 ? 31:26)))
                        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:0) - (0 ?
 25:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:0) - (0 ?
 25:0) + 1))))))) << (0 ?
 25:0))) | (((gctUINT32) ((gctUINT32) ((info->kernelAddress >> 6)) & ((gctUINT32) ((((1 ?
 25:0) - (0 ?
 25:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 25:0) - (0 ? 25:0) + 1))))))) << (0 ? 25:0)));

    /* gcregNNInstWord6 */
    *(*Instruction)++ = info->inImageAddress;
    /* gcregNNInstWord7 */
    *(*Instruction)++ = info->outImageAddress;

    *(*Instruction)++ =  ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 1:0) - (0 ?
 1:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 1:0) - (0 ?
 1:0) + 1))))))) << (0 ?
 1:0))) | (((gctUINT32) ((gctUINT32) (info->imageCachingMode) & ((gctUINT32) ((((1 ?
 1:0) - (0 ?
 1:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 1:0) - (0 ? 1:0) + 1))))))) << (0 ? 1:0)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 3:2) - (0 ?
 3:2) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 3:2) - (0 ?
 3:2) + 1))))))) << (0 ?
 3:2))) | (((gctUINT32) ((gctUINT32) (info->kernelCachingMode) & ((gctUINT32) ((((1 ?
 3:2) - (0 ?
 3:2) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 3:2) - (0 ? 3:2) + 1))))))) << (0 ? 3:2)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 5:4) - (0 ?
 5:4) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 5:4) - (0 ?
 5:4) + 1))))))) << (0 ?
 5:4))) | (((gctUINT32) ((gctUINT32) (info->partialCacheDataUnit) & ((gctUINT32) ((((1 ?
 5:4) - (0 ?
 5:4) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 5:4) - (0 ? 5:4) + 1))))))) << (0 ? 5:4)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 11:6) - (0 ?
 11:6) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 11:6) - (0 ?
 11:6) + 1))))))) << (0 ?
 11:6))) | (((gctUINT32) ((gctUINT32) (info->kernelPatternMsb) & ((gctUINT32) ((((1 ?
 11:6) - (0 ?
 11:6) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 11:6) - (0 ? 11:6) + 1))))))) << (0 ? 11:6)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:12) - (0 ?
 15:12) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:12) - (0 ?
 15:12) + 1))))))) << (0 ?
 15:12))) | (((gctUINT32) ((gctUINT32) (info->kernelYSize) & ((gctUINT32) ((((1 ?
 15:12) - (0 ?
 15:12) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:12) - (0 ? 15:12) + 1))))))) << (0 ? 15:12)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:16) - (0 ?
 31:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:16) - (0 ?
 31:16) + 1))))))) << (0 ?
 31:16))) | (((gctUINT32) ((gctUINT32) (info->outImageYstride) & ((gctUINT32) ((((1 ?
 31:16) - (0 ?
 31:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 31:16) - (0 ? 31:16) + 1))))))) << (0 ? 31:16)));

    /* 31:0 */
    *(*Instruction)++ =  info->kernelPatternLow32Bits;

    /* 31:0 */
    *(*Instruction)++ =  info->kernelPatternHigh32Bits;

    /* 31:0 */
    *(*Instruction)++ =  info->kernelCacheStartAddress;

    /* CREG_NN_INST_WORD12_KERNEL_CACHE_END_ADDRESS */
    *(*Instruction)++ =  info->kernelCacheEndAddress;

    /* 31:0 */
    *(*Instruction)++ =  info->imageStartAddress;

    /* GCREG_NN_INST_WORD14, IMAGE_END_ADDRESS */
    *(*Instruction)++ =  info->imageEndAddress;


    /*1:0*/

    *(*Instruction)++ =  ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 1:0) - (0 ?
 1:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 1:0) - (0 ?
 1:0) + 1))))))) << (0 ?
 1:0))) | (((gctUINT32) ((gctUINT32) (info->inImageBorderMode) & ((gctUINT32) ((((1 ?
 1:0) - (0 ?
 1:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 1:0) - (0 ? 1:0) + 1))))))) << (0 ? 1:0)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 17:2) - (0 ?
 17:2) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 17:2) - (0 ?
 17:2) + 1))))))) << (0 ?
 17:2))) | (((gctUINT32) ((gctUINT32) (info->inImageBorderConst) & ((gctUINT32) ((((1 ?
 17:2) - (0 ?
 17:2) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 17:2) - (0 ? 17:2) + 1))))))) << (0 ? 17:2)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 19:19) - (0 ?
 19:19) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 19:19) - (0 ?
 19:19) + 1))))))) << (0 ?
 19:19))) | (((gctUINT32) ((gctUINT32) (info->kernelDataTypeMsb) & ((gctUINT32) ((((1 ?
 19:19) - (0 ?
 19:19) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 19:19) - (0 ? 19:19) + 1))))))) << (0 ? 19:19)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 20:20) - (0 ?
 20:20) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 20:20) - (0 ?
 20:20) + 1))))))) << (0 ?
 20:20))) | (((gctUINT32) ((gctUINT32) (info->inImageDataTypeMsb) & ((gctUINT32) ((((1 ?
 20:20) - (0 ?
 20:20) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 20:20) - (0 ? 20:20) + 1))))))) << (0 ? 20:20)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 21:21) - (0 ?
 21:21) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 21:21) - (0 ?
 21:21) + 1))))))) << (0 ?
 21:21))) | (((gctUINT32) ((gctUINT32) (info->outImageDataTypeMsb) & ((gctUINT32) ((((1 ?
 21:21) - (0 ?
 21:21) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 21:21) - (0 ? 21:21) + 1))))))) << (0 ? 21:21)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 27:22) - (0 ?
 27:22) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 27:22) - (0 ?
 27:22) + 1))))))) << (0 ?
 27:22))) | (((gctUINT32) ((gctUINT32) (info->postMultiplierBit6to1) & ((gctUINT32) ((((1 ?
 27:22) - (0 ?
 27:22) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 27:22) - (0 ? 27:22) + 1))))))) << (0 ? 27:22)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 29:28) - (0 ?
 29:28) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 29:28) - (0 ?
 29:28) + 1))))))) << (0 ?
 29:28))) | (((gctUINT32) ((gctUINT32) (info->postShiftBit6to5) & ((gctUINT32) ((((1 ?
 29:28) - (0 ?
 29:28) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 29:28) - (0 ? 29:28) + 1))))))) << (0 ? 29:28)));

    /*GCREG_NN_INST_WORD16*/
    *(*Instruction)++ =  ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (info->inImageXstride) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:16) - (0 ?
 31:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:16) - (0 ?
 31:16) + 1))))))) << (0 ?
 31:16))) | (((gctUINT32) ((gctUINT32) (info->inImageYstride) & ((gctUINT32) ((((1 ?
 31:16) - (0 ?
 31:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 31:16) - (0 ? 31:16) + 1))))))) << (0 ? 31:16)));

    /*GCREG_NN_INST_WORD17*/
    *(*Instruction)++ = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (info->outImageXstride) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:24) - (0 ?
 31:24) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:24) - (0 ?
 31:24) + 1))))))) << (0 ?
 31:24))) | (((gctUINT32) ((gctUINT32) (info->postMultiplierBit14to7) & ((gctUINT32) ((((1 ?
 31:24) - (0 ?
 31:24) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 31:24) - (0 ? 31:24) + 1))))))) << (0 ? 31:24)));


    /*GCREG_NN_INST_WORD18*/
    *(*Instruction)++ = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:0) - (0 ?
 25:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:0) - (0 ?
 25:0) + 1))))))) << (0 ?
 25:0))) | (((gctUINT32) ((gctUINT32) (info->outImageCircularBufSize >> 6) & ((gctUINT32) ((((1 ?
 25:0) - (0 ?
 25:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 25:0) - (0 ? 25:0) + 1))))))) << (0 ? 25:0)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (info->perChannelPostMul) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 26:26) - (0 ? 26:26) + 1))))))) << (0 ? 26:26)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 29:29) - (0 ?
 29:29) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 29:29) - (0 ?
 29:29) + 1))))))) << (0 ?
 29:29))) | (((gctUINT32) ((gctUINT32) ((info->inImageXOffset >> 4) & 0x1) & ((gctUINT32) ((((1 ?
 29:29) - (0 ?
 29:29) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 29:29) - (0 ? 29:29) + 1))))))) << (0 ? 29:29)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 30:30) - (0 ?
 30:30) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 30:30) - (0 ?
 30:30) + 1))))))) << (0 ?
 30:30))) | (((gctUINT32) ((gctUINT32) ((info->inImageYOffset >> 4) & 0x1) & ((gctUINT32) ((((1 ?
 30:30) - (0 ?
 30:30) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 30:30) - (0 ? 30:30) + 1))))))) << (0 ? 30:30)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 28:28) - (0 ?
 28:28) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 28:28) - (0 ?
 28:28) + 1))))))) << (0 ?
 28:28))) | (((gctUINT32) ((gctUINT32) (info->slowOutput) & ((gctUINT32) ((((1 ?
 28:28) - (0 ?
 28:28) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 28:28) - (0 ? 28:28) + 1))))))) << (0 ? 28:28)));

    /*25:0*/

     *(*Instruction)++ = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:0) - (0 ?
 25:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:0) - (0 ?
 25:0) + 1))))))) << (0 ?
 25:0))) | (((gctUINT32) ((gctUINT32) (info->outImageCircularBufEndAddrPlus1 >> 6) & ((gctUINT32) ((((1 ?
 25:0) - (0 ?
 25:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 25:0) - (0 ? 25:0) + 1))))))) << (0 ? 25:0)))
                         | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 30:30) - (0 ?
 30:30) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 30:30) - (0 ?
 30:30) + 1))))))) << (0 ?
 30:30))) | (((gctUINT32) ((gctUINT32) (info->bFloat16Mode) & ((gctUINT32) ((((1 ?
 30:30) - (0 ?
 30:30) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 30:30) - (0 ? 30:30) + 1))))))) << (0 ? 30:30)));


    /*GCREG_NN_INST_WORD20*/
    *(*Instruction)++ = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:0) - (0 ?
 25:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:0) - (0 ?
 25:0) + 1))))))) << (0 ?
 25:0))) | (((gctUINT32) ((gctUINT32) (info->inImageCircularBufSize >> 6) & ((gctUINT32) ((((1 ?
 25:0) - (0 ?
 25:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 25:0) - (0 ? 25:0) + 1))))))) << (0 ? 25:0)));

    /*25:0*/
    *(*Instruction)++ = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:0) - (0 ?
 25:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:0) - (0 ?
 25:0) + 1))))))) << (0 ?
 25:0))) | (((gctUINT32) ((gctUINT32) (info->inImageCircularBufEndAddrPlus1 >> 6) & ((gctUINT32) ((((1 ?
 25:0) - (0 ?
 25:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 25:0) - (0 ? 25:0) + 1))))))) << (0 ? 25:0)));

    /*GCREG_NN_INST_WORD22*/
    *(*Instruction)++ = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 7:0) - (0 ?
 7:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 7:0) - (0 ?
 7:0) + 1))))))) << (0 ?
 7:0))) | (((gctUINT32) ((gctUINT32) (info->coefZP) & ((gctUINT32) ((((1 ?
 7:0) - (0 ?
 7:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 7:0) - (0 ? 7:0) + 1))))))) << (0 ? 7:0)))
                        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:8) - (0 ?
 15:8) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:8) - (0 ?
 15:8) + 1))))))) << (0 ?
 15:8))) | (((gctUINT32) ((gctUINT32) (info->outputZP) & ((gctUINT32) ((((1 ?
 15:8) - (0 ?
 15:8) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:8) - (0 ? 15:8) + 1))))))) << (0 ? 15:8)))
                        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 16:16) - (0 ?
 16:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 16:16) - (0 ?
 16:16) + 1))))))) << (0 ?
 16:16))) | (((gctUINT32) ((gctUINT32) (info->kernelDirectStreamFromVipSram) & ((gctUINT32) ((((1 ?
 16:16) - (0 ?
 16:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 16:16) - (0 ? 16:16) + 1))))))) << (0 ? 16:16)))
                        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 17:17) - (0 ?
 17:17) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 17:17) - (0 ?
 17:17) + 1))))))) << (0 ?
 17:17))) | (((gctUINT32) ((gctUINT32) (info->hwDepthWise) & ((gctUINT32) ((((1 ?
 17:17) - (0 ?
 17:17) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 17:17) - (0 ? 17:17) + 1))))))) << (0 ? 17:17)))
                        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:18) - (0 ?
 25:18) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:18) - (0 ?
 25:18) + 1))))))) << (0 ?
 25:18))) | (((gctUINT32) ((gctUINT32) (info->postMultiplierBit22to15) & ((gctUINT32) ((((1 ?
 25:18) - (0 ?
 25:18) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 25:18) - (0 ? 25:18) + 1))))))) << (0 ? 25:18)));

    /*GCREG_NN_INST_WORD23*/
    *(*Instruction)++ = 0;

    /*GCREG_NN_INST_WORD24*/
    *(*Instruction)++ = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 3:0) - (0 ?
 3:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 3:0) - (0 ?
 3:0) + 1))))))) << (0 ?
 3:0))) | (((gctUINT32) ((gctUINT32) (info->inImageTransposeChMinusOne) & ((gctUINT32) ((((1 ?
 3:0) - (0 ?
 3:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 3:0) - (0 ? 3:0) + 1))))))) << (0 ? 3:0)))
                        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:4) - (0 ?
 31:4) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:4) - (0 ?
 31:4) + 1))))))) << (0 ?
 31:4))) | (((gctUINT32) ((gctUINT32) (info->outImageTransposeBufStartAddr >> 4) & ((gctUINT32) ((((1 ?
 31:4) - (0 ?
 31:4) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 31:4) - (0 ? 31:4) + 1))))))) << (0 ? 31:4)));

    /*GCREG_NN_INST_WORD25*/
    *(*Instruction)++ = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 3:0) - (0 ?
 3:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 3:0) - (0 ?
 3:0) + 1))))))) << (0 ?
 3:0))) | (((gctUINT32) ((gctUINT32) (info->outImageTransposeChMinusOne) & ((gctUINT32) ((((1 ?
 3:0) - (0 ?
 3:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 3:0) - (0 ? 3:0) + 1))))))) << (0 ? 3:0)))
                        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:4) - (0 ?
 31:4) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:4) - (0 ?
 31:4) + 1))))))) << (0 ?
 31:4))) | (((gctUINT32) ((gctUINT32) (info->outImageTransposeBufEndAddr >> 4) & ((gctUINT32) ((((1 ?
 31:4) - (0 ?
 31:4) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 31:4) - (0 ? 31:4) + 1))))))) << (0 ? 31:4)));

     return gcvSTATUS_OK;

OnError:
    /* Return the status. */
    return status;
}

gceSTATUS
gcoHARDWAREVX_ProgrammeTPEngine(
    IN gcoHARDWARE Hardware,
    IN gctPOINTER Info,
    IN OUT gctUINT32_PTR *Instruction
    )
{
    struct _vx_nn_tp_cmd_info *info = (struct _vx_nn_tp_cmd_info*) Info;

    {
        *(*Instruction)++ =   ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (info->inImageXSize) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));

        *(*Instruction)++ =   ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (info->inImageYSize) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:16) - (0 ?
 31:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:16) - (0 ?
 31:16) + 1))))))) << (0 ?
 31:16))) | (((gctUINT32) ((gctUINT32) (info->inImageZSize) & ((gctUINT32) ((((1 ?
 31:16) - (0 ?
 31:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 31:16) - (0 ? 31:16) + 1))))))) << (0 ? 31:16)));

        *(*Instruction)++ =   ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (info->inImageStride) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));

        *(*Instruction)++ =   info->inImageSlice;

        *(*Instruction)++ =   ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (info->inWindowXStart) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:16) - (0 ?
 31:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:16) - (0 ?
 31:16) + 1))))))) << (0 ?
 31:16))) | (((gctUINT32) ((gctUINT32) (info->inWindowYStart) & ((gctUINT32) ((((1 ?
 31:16) - (0 ?
 31:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 31:16) - (0 ? 31:16) + 1))))))) << (0 ? 31:16)));

        *(*Instruction)++ =   ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (info->inWindowXEnd) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:16) - (0 ?
 31:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:16) - (0 ?
 31:16) + 1))))))) << (0 ?
 31:16))) | (((gctUINT32) ((gctUINT32) (info->inWindowYEnd) & ((gctUINT32) ((((1 ?
 31:16) - (0 ?
 31:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 31:16) - (0 ? 31:16) + 1))))))) << (0 ? 31:16)));

        if (gcoHAL_IsFeatureAvailable(gcvNULL, gcvFEATURE_NN_INT16_ALU))
        {
            *(*Instruction)++ =   ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 1:0) - (0 ?
 1:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 1:0) - (0 ?
 1:0) + 1))))))) << (0 ?
 1:0))) | (((gctUINT32) ((gctUINT32) (info->inTileSequence) & ((gctUINT32) ((((1 ?
 1:0) - (0 ?
 1:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 1:0) - (0 ? 1:0) + 1))))))) << (0 ? 1:0)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 2:2) - (0 ?
 2:2) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 2:2) - (0 ?
 2:2) + 1))))))) << (0 ?
 2:2))) | (((gctUINT32) ((gctUINT32) (info->inTileListGlobalMem) & ((gctUINT32) ((((1 ?
 2:2) - (0 ?
 2:2) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 2:2) - (0 ? 2:2) + 1))))))) << (0 ? 2:2)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 3:3) - (0 ?
 3:3) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 3:3) - (0 ?
 3:3) + 1))))))) << (0 ?
 3:3))) | (((gctUINT32) ((gctUINT32) (info->inImageGlobalMem) & ((gctUINT32) ((((1 ?
 3:3) - (0 ?
 3:3) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 3:3) - (0 ? 3:3) + 1))))))) << (0 ? 3:3)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 4:4) - (0 ?
 4:4) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 4:4) - (0 ?
 4:4) + 1))))))) << (0 ?
 4:4))) | (((gctUINT32) ((gctUINT32) (info->aluI2FEnable) & ((gctUINT32) ((((1 ?
 4:4) - (0 ?
 4:4) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 4:4) - (0 ? 4:4) + 1))))))) << (0 ? 4:4)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 5:5) - (0 ?
 5:5) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 5:5) - (0 ?
 5:5) + 1))))))) << (0 ?
 5:5))) | (((gctUINT32) ((gctUINT32) (info->aluSquareEnable) & ((gctUINT32) ((((1 ?
 5:5) - (0 ?
 5:5) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 5:5) - (0 ? 5:5) + 1))))))) << (0 ? 5:5)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 7:6) - (0 ?
 7:6) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 7:6) - (0 ?
 7:6) + 1))))))) << (0 ?
 7:6))) | (((gctUINT32) ((gctUINT32) (info->aluHorzProcessing & 0x3) & ((gctUINT32) ((((1 ?
 7:6) - (0 ?
 7:6) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 7:6) - (0 ? 7:6) + 1))))))) << (0 ? 7:6)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 8:8) - (0 ?
 8:8) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 8:8) - (0 ?
 8:8) + 1))))))) << (0 ?
 8:8))) | (((gctUINT32) ((gctUINT32) (info->aluHorzProcessing >> 2) & ((gctUINT32) ((((1 ?
 8:8) - (0 ?
 8:8) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 8:8) - (0 ? 8:8) + 1))))))) << (0 ? 8:8)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 14:9) - (0 ?
 14:9) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 14:9) - (0 ?
 14:9) + 1))))))) << (0 ?
 14:9))) | (((gctUINT32) ((gctUINT32) (info->aluHorzProcCount) & ((gctUINT32) ((((1 ?
 14:9) - (0 ?
 14:9) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 14:9) - (0 ? 14:9) + 1))))))) << (0 ? 14:9)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:15) - (0 ?
 15:15) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:15) - (0 ?
 15:15) + 1))))))) << (0 ?
 15:15))) | (((gctUINT32) ((gctUINT32) (info->aluHorzProcStride) & ((gctUINT32) ((((1 ?
 15:15) - (0 ?
 15:15) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:15) - (0 ? 15:15) + 1))))))) << (0 ? 15:15)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 17:16) - (0 ?
 17:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 17:16) - (0 ?
 17:16) + 1))))))) << (0 ?
 17:16))) | (((gctUINT32) ((gctUINT32) (info->aluVertProcessing) & ((gctUINT32) ((((1 ?
 17:16) - (0 ?
 17:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 17:16) - (0 ? 17:16) + 1))))))) << (0 ? 17:16)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 24:19) - (0 ?
 24:19) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 24:19) - (0 ?
 24:19) + 1))))))) << (0 ?
 24:19))) | (((gctUINT32) ((gctUINT32) (info->aluVertProcCount) & ((gctUINT32) ((((1 ?
 24:19) - (0 ?
 24:19) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 24:19) - (0 ? 24:19) + 1))))))) << (0 ? 24:19)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:25) - (0 ?
 25:25) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:25) - (0 ?
 25:25) + 1))))))) << (0 ?
 25:25))) | (((gctUINT32) ((gctUINT32) (info->aluVertProcStride) & ((gctUINT32) ((((1 ?
 25:25) - (0 ?
 25:25) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 25:25) - (0 ? 25:25) + 1))))))) << (0 ? 25:25)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (info->aluNmsEnable) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 26:26) - (0 ? 26:26) + 1))))))) << (0 ? 26:26)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 27:27) - (0 ?
 27:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 27:27) - (0 ?
 27:27) + 1))))))) << (0 ?
 27:27))) | (((gctUINT32) ((gctUINT32) (info->aluPwlEnable) & ((gctUINT32) ((((1 ?
 27:27) - (0 ?
 27:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 27:27) - (0 ? 27:27) + 1))))))) << (0 ? 27:27)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 28:28) - (0 ?
 28:28) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 28:28) - (0 ?
 28:28) + 1))))))) << (0 ?
 28:28))) | (((gctUINT32) ((gctUINT32) (info->aluMultEnable) & ((gctUINT32) ((((1 ?
 28:28) - (0 ?
 28:28) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 28:28) - (0 ? 28:28) + 1))))))) << (0 ? 28:28)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 29:29) - (0 ?
 29:29) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 29:29) - (0 ?
 29:29) + 1))))))) << (0 ?
 29:29))) | (((gctUINT32) ((gctUINT32) (info->aluF2IEnable) & ((gctUINT32) ((((1 ?
 29:29) - (0 ?
 29:29) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 29:29) - (0 ? 29:29) + 1))))))) << (0 ? 29:29)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 30:30) - (0 ?
 30:30) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 30:30) - (0 ?
 30:30) + 1))))))) << (0 ?
 30:30))) | (((gctUINT32) ((gctUINT32) (info->aluLoadPwlLUT) & ((gctUINT32) ((((1 ?
 30:30) - (0 ?
 30:30) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 30:30) - (0 ? 30:30) + 1))))))) << (0 ? 30:30)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:31) - (0 ?
 31:31) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:31) - (0 ?
 31:31) + 1))))))) << (0 ?
 31:31))) | (((gctUINT32) ((gctUINT32) (info->aluLoadPwlLUTGlobalMem) & ((gctUINT32) ((((1 ?
 31:31) - (0 ?
 31:31) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 31:31) - (0 ? 31:31) + 1))))))) << (0 ? 31:31)));
        }
        else
        {
            *(*Instruction)++ =   ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 1:0) - (0 ?
 1:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 1:0) - (0 ?
 1:0) + 1))))))) << (0 ?
 1:0))) | (((gctUINT32) ((gctUINT32) (info->inTileSequence) & ((gctUINT32) ((((1 ?
 1:0) - (0 ?
 1:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 1:0) - (0 ? 1:0) + 1))))))) << (0 ? 1:0)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 2:2) - (0 ?
 2:2) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 2:2) - (0 ?
 2:2) + 1))))))) << (0 ?
 2:2))) | (((gctUINT32) ((gctUINT32) (info->inTileListGlobalMem) & ((gctUINT32) ((((1 ?
 2:2) - (0 ?
 2:2) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 2:2) - (0 ? 2:2) + 1))))))) << (0 ? 2:2)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 3:3) - (0 ?
 3:3) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 3:3) - (0 ?
 3:3) + 1))))))) << (0 ?
 3:3))) | (((gctUINT32) ((gctUINT32) (info->inImageGlobalMem) & ((gctUINT32) ((((1 ?
 3:3) - (0 ?
 3:3) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 3:3) - (0 ? 3:3) + 1))))))) << (0 ? 3:3)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 4:4) - (0 ?
 4:4) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 4:4) - (0 ?
 4:4) + 1))))))) << (0 ?
 4:4))) | (((gctUINT32) ((gctUINT32) (info->aluI2FEnable) & ((gctUINT32) ((((1 ?
 4:4) - (0 ?
 4:4) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 4:4) - (0 ? 4:4) + 1))))))) << (0 ? 4:4)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 5:5) - (0 ?
 5:5) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 5:5) - (0 ?
 5:5) + 1))))))) << (0 ?
 5:5))) | (((gctUINT32) ((gctUINT32) (info->aluSquareEnable) & ((gctUINT32) ((((1 ?
 5:5) - (0 ?
 5:5) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 5:5) - (0 ? 5:5) + 1))))))) << (0 ? 5:5)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 7:6) - (0 ?
 7:6) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 7:6) - (0 ?
 7:6) + 1))))))) << (0 ?
 7:6))) | (((gctUINT32) ((gctUINT32) (info->aluHorzProcessing) & ((gctUINT32) ((((1 ?
 7:6) - (0 ?
 7:6) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 7:6) - (0 ? 7:6) + 1))))))) << (0 ? 7:6)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 14:9) - (0 ?
 14:9) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 14:9) - (0 ?
 14:9) + 1))))))) << (0 ?
 14:9))) | (((gctUINT32) ((gctUINT32) (info->aluHorzProcCount) & ((gctUINT32) ((((1 ?
 14:9) - (0 ?
 14:9) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 14:9) - (0 ? 14:9) + 1))))))) << (0 ? 14:9)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:15) - (0 ?
 15:15) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:15) - (0 ?
 15:15) + 1))))))) << (0 ?
 15:15))) | (((gctUINT32) ((gctUINT32) (info->aluHorzProcStride) & ((gctUINT32) ((((1 ?
 15:15) - (0 ?
 15:15) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:15) - (0 ? 15:15) + 1))))))) << (0 ? 15:15)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 17:16) - (0 ?
 17:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 17:16) - (0 ?
 17:16) + 1))))))) << (0 ?
 17:16))) | (((gctUINT32) ((gctUINT32) (info->aluVertProcessing) & ((gctUINT32) ((((1 ?
 17:16) - (0 ?
 17:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 17:16) - (0 ? 17:16) + 1))))))) << (0 ? 17:16)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 24:19) - (0 ?
 24:19) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 24:19) - (0 ?
 24:19) + 1))))))) << (0 ?
 24:19))) | (((gctUINT32) ((gctUINT32) (info->aluVertProcCount) & ((gctUINT32) ((((1 ?
 24:19) - (0 ?
 24:19) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 24:19) - (0 ? 24:19) + 1))))))) << (0 ? 24:19)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:25) - (0 ?
 25:25) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:25) - (0 ?
 25:25) + 1))))))) << (0 ?
 25:25))) | (((gctUINT32) ((gctUINT32) (info->aluVertProcStride) & ((gctUINT32) ((((1 ?
 25:25) - (0 ?
 25:25) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 25:25) - (0 ? 25:25) + 1))))))) << (0 ? 25:25)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (info->aluNmsEnable) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 26:26) - (0 ? 26:26) + 1))))))) << (0 ? 26:26)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 27:27) - (0 ?
 27:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 27:27) - (0 ?
 27:27) + 1))))))) << (0 ?
 27:27))) | (((gctUINT32) ((gctUINT32) (info->aluPwlEnable) & ((gctUINT32) ((((1 ?
 27:27) - (0 ?
 27:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 27:27) - (0 ? 27:27) + 1))))))) << (0 ? 27:27)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 28:28) - (0 ?
 28:28) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 28:28) - (0 ?
 28:28) + 1))))))) << (0 ?
 28:28))) | (((gctUINT32) ((gctUINT32) (info->aluMultEnable) & ((gctUINT32) ((((1 ?
 28:28) - (0 ?
 28:28) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 28:28) - (0 ? 28:28) + 1))))))) << (0 ? 28:28)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 29:29) - (0 ?
 29:29) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 29:29) - (0 ?
 29:29) + 1))))))) << (0 ?
 29:29))) | (((gctUINT32) ((gctUINT32) (info->aluF2IEnable) & ((gctUINT32) ((((1 ?
 29:29) - (0 ?
 29:29) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 29:29) - (0 ? 29:29) + 1))))))) << (0 ? 29:29)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 30:30) - (0 ?
 30:30) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 30:30) - (0 ?
 30:30) + 1))))))) << (0 ?
 30:30))) | (((gctUINT32) ((gctUINT32) (info->aluLoadPwlLUT) & ((gctUINT32) ((((1 ?
 30:30) - (0 ?
 30:30) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 30:30) - (0 ? 30:30) + 1))))))) << (0 ? 30:30)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:31) - (0 ?
 31:31) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:31) - (0 ?
 31:31) + 1))))))) << (0 ?
 31:31))) | (((gctUINT32) ((gctUINT32) (info->aluLoadPwlLUTGlobalMem) & ((gctUINT32) ((((1 ?
 31:31) - (0 ?
 31:31) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 31:31) - (0 ? 31:31) + 1))))))) << (0 ? 31:31)));
        }

        *(*Instruction)++ =   info->inTileListAddress;

        *(*Instruction)++ =   ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (info->inTileXSize) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:16) - (0 ?
 31:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:16) - (0 ?
 31:16) + 1))))))) << (0 ?
 31:16))) | (((gctUINT32) ((gctUINT32) (info->inTileYSize) & ((gctUINT32) ((((1 ?
 31:16) - (0 ?
 31:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 31:16) - (0 ? 31:16) + 1))))))) << (0 ? 31:16)));

        *(*Instruction)++ =   ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (info->inTileXInc) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:16) - (0 ?
 31:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:16) - (0 ?
 31:16) + 1))))))) << (0 ?
 31:16))) | (((gctUINT32) ((gctUINT32) (info->inTileYInc) & ((gctUINT32) ((((1 ?
 31:16) - (0 ?
 31:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 31:16) - (0 ? 31:16) + 1))))))) << (0 ? 31:16)));

        *(*Instruction)++ =   info->inImageBaseAddress;

        *(*Instruction)++ =   info->aluLoadPwlLUTAddress;

        *(*Instruction)++ =   ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 0:0) - (0 ?
 0:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 0:0) - (0 ?
 0:0) + 1))))))) << (0 ?
 0:0))) | (((gctUINT32) ((gctUINT32) (info->outTileSkipAtborder) & ((gctUINT32) ((((1 ?
 0:0) - (0 ?
 0:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 0:0) - (0 ? 0:0) + 1))))))) << (0 ? 0:0)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 1:1) - (0 ?
 1:1) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 1:1) - (0 ?
 1:1) + 1))))))) << (0 ?
 1:1))) | (((gctUINT32) ((gctUINT32) (info->outGlobalMem) & ((gctUINT32) ((((1 ?
 1:1) - (0 ?
 1:1) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 1:1) - (0 ? 1:1) + 1))))))) << (0 ? 1:1)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 2:2) - (0 ?
 2:2) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 2:2) - (0 ?
 2:2) + 1))))))) << (0 ?
 2:2))) | (((gctUINT32) ((gctUINT32) (info->outLoop1Reset) & ((gctUINT32) ((((1 ?
 2:2) - (0 ?
 2:2) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 2:2) - (0 ? 2:2) + 1))))))) << (0 ? 2:2)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 3:3) - (0 ?
 3:3) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 3:3) - (0 ?
 3:3) + 1))))))) << (0 ?
 3:3))) | (((gctUINT32) ((gctUINT32) (info->outLoop2Reset) & ((gctUINT32) ((((1 ?
 3:3) - (0 ?
 3:3) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 3:3) - (0 ? 3:3) + 1))))))) << (0 ? 3:3)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 4:4) - (0 ?
 4:4) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 4:4) - (0 ?
 4:4) + 1))))))) << (0 ?
 4:4))) | (((gctUINT32) ((gctUINT32) (info->outLoop3Reset) & ((gctUINT32) ((((1 ?
 4:4) - (0 ?
 4:4) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 4:4) - (0 ? 4:4) + 1))))))) << (0 ? 4:4)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 5:5) - (0 ?
 5:5) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 5:5) - (0 ?
 5:5) + 1))))))) << (0 ?
 5:5))) | (((gctUINT32) ((gctUINT32) (info->outBrickMode) & ((gctUINT32) ((((1 ?
 5:5) - (0 ?
 5:5) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 5:5) - (0 ? 5:5) + 1))))))) << (0 ? 5:5)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 6:6) - (0 ?
 6:6) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 6:6) - (0 ?
 6:6) + 1))))))) << (0 ?
 6:6))) | (((gctUINT32) ((gctUINT32) (info->aluZFilterMode) & ((gctUINT32) ((((1 ?
 6:6) - (0 ?
 6:6) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 6:6) - (0 ? 6:6) + 1))))))) << (0 ? 6:6)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 9:8) - (0 ?
 9:8) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 9:8) - (0 ?
 9:8) + 1))))))) << (0 ?
 9:8))) | (((gctUINT32) ((gctUINT32) (info->inWindowZStartOverfetch) & ((gctUINT32) ((((1 ?
 9:8) - (0 ?
 9:8) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 9:8) - (0 ? 9:8) + 1))))))) << (0 ? 9:8)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 12:11) - (0 ?
 12:11) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 12:11) - (0 ?
 12:11) + 1))))))) << (0 ?
 12:11))) | (((gctUINT32) ((gctUINT32) (info->inWindowZEndOverfetch) & ((gctUINT32) ((((1 ?
 12:11) - (0 ?
 12:11) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 12:11) - (0 ? 12:11) + 1))))))) << (0 ? 12:11)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 17:14) - (0 ?
 17:14) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 17:14) - (0 ?
 17:14) + 1))))))) << (0 ?
 17:14))) | (((gctUINT32) ((gctUINT32) (info->aluSquarePreshift) & ((gctUINT32) ((((1 ?
 17:14) - (0 ?
 17:14) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 17:14) - (0 ? 17:14) + 1))))))) << (0 ? 17:14)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 20:18) - (0 ?
 20:18) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 20:18) - (0 ?
 20:18) + 1))))))) << (0 ?
 20:18))) | (((gctUINT32) ((gctUINT32) (info->inImageDataType) & ((gctUINT32) ((((1 ?
 20:18) - (0 ?
 20:18) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 20:18) - (0 ? 20:18) + 1))))))) << (0 ? 20:18)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 23:21) - (0 ?
 23:21) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 23:21) - (0 ?
 23:21) + 1))))))) << (0 ?
 23:21))) | (((gctUINT32) ((gctUINT32) (info->outImageDataType) & ((gctUINT32) ((((1 ?
 23:21) - (0 ?
 23:21) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 23:21) - (0 ? 23:21) + 1))))))) << (0 ? 23:21)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 28:28) - (0 ?
 28:28) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 28:28) - (0 ?
 28:28) + 1))))))) << (0 ?
 28:28))) | (((gctUINT32) ((gctUINT32) (info->aluPwlSignSupport) & ((gctUINT32) ((((1 ?
 28:28) - (0 ?
 28:28) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 28:28) - (0 ? 28:28) + 1))))))) << (0 ? 28:28)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 29:29) - (0 ?
 29:29) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 29:29) - (0 ?
 29:29) + 1))))))) << (0 ?
 29:29))) | (((gctUINT32) ((gctUINT32) (info->aluReluEnable) & ((gctUINT32) ((((1 ?
 29:29) - (0 ?
 29:29) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 29:29) - (0 ? 29:29) + 1))))))) << (0 ? 29:29)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 30:30) - (0 ?
 30:30) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 30:30) - (0 ?
 30:30) + 1))))))) << (0 ?
 30:30))) | (((gctUINT32) ((gctUINT32) (info->noFlush) & ((gctUINT32) ((((1 ?
 30:30) - (0 ?
 30:30) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 30:30) - (0 ? 30:30) + 1))))))) << (0 ? 30:30)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:31) - (0 ?
 31:31) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:31) - (0 ?
 31:31) + 1))))))) << (0 ?
 31:31))) | (((gctUINT32) ((gctUINT32) (info->last) & ((gctUINT32) ((((1 ?
 31:31) - (0 ?
 31:31) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 31:31) - (0 ? 31:31) + 1))))))) << (0 ? 31:31)));

        *(*Instruction)++ =   info->outBaseAddress;

        *(*Instruction)++ =   info->outLoop0Inc;

        *(*Instruction)++ =   info->outLoop1Inc;

        *(*Instruction)++ =   ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (info->outLoop0Count) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:16) - (0 ?
 31:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:16) - (0 ?
 31:16) + 1))))))) << (0 ?
 31:16))) | (((gctUINT32) ((gctUINT32) (info->outLoop1Count) & ((gctUINT32) ((((1 ?
 31:16) - (0 ?
 31:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 31:16) - (0 ? 31:16) + 1))))))) << (0 ? 31:16)));

        *(*Instruction)++ =   info->outLoop2Inc;

        *(*Instruction)++ =   info->outLoop3Inc;

        *(*Instruction)++ =   ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (info->outLoop2Count) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:16) - (0 ?
 31:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:16) - (0 ?
 31:16) + 1))))))) << (0 ?
 31:16))) | (((gctUINT32) ((gctUINT32) (info->outLoop3Count) & ((gctUINT32) ((((1 ?
 31:16) - (0 ?
 31:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 31:16) - (0 ? 31:16) + 1))))))) << (0 ? 31:16)));

        *(*Instruction)++ =   info->outLoop4Inc;

        *(*Instruction)++ =   info->outLoop5Inc;

        *(*Instruction)++ =   ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (info->outLoop4Count) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)))
                            | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:16) - (0 ?
 31:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:16) - (0 ?
 31:16) + 1))))))) << (0 ?
 31:16))) | (((gctUINT32) ((gctUINT32) (info->outLoop5Count) & ((gctUINT32) ((((1 ?
 31:16) - (0 ?
 31:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 31:16) - (0 ? 31:16) + 1))))))) << (0 ? 31:16)));

        *(*Instruction)++ =   info->outLoop6Inc;

        if (gcoHAL_IsFeatureAvailable(gcvNULL, gcvFEATURE_TF_QUANTIZATION) || gcoHAL_IsFeatureAvailable(gcvNULL, gcvFEATURE_NN_INT16_ALU))
        {
            *(*Instruction)++ =   ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 0:0) - (0 ?
 0:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 0:0) - (0 ?
 0:0) + 1))))))) << (0 ?
 0:0))) | (((gctUINT32) ((gctUINT32) (info->aluFilterPwlSwap) & ((gctUINT32) ((((1 ?
 0:0) - (0 ?
 0:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 0:0) - (0 ? 0:0) + 1))))))) << (0 ? 0:0)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 2:1) - (0 ?
 2:1) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 2:1) - (0 ?
 2:1) + 1))))))) << (0 ?
 2:1))) | (((gctUINT32) ((gctUINT32) (info->floatRoundingMode) & ((gctUINT32) ((((1 ?
 2:1) - (0 ?
 2:1) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 2:1) - (0 ? 2:1) + 1))))))) << (0 ? 2:1)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 4:3) - (0 ?
 4:3) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 4:3) - (0 ?
 4:3) + 1))))))) << (0 ?
 4:3))) | (((gctUINT32) ((gctUINT32) (info->integeroundingMode) & ((gctUINT32) ((((1 ?
 4:3) - (0 ?
 4:3) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 4:3) - (0 ? 4:3) + 1))))))) << (0 ? 4:3)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 18:15) - (0 ?
 18:15) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 18:15) - (0 ?
 18:15) + 1))))))) << (0 ?
 18:15))) | (((gctUINT32) ((gctUINT32) (info->aluReorderBitsUsed) & ((gctUINT32) ((((1 ?
 18:15) - (0 ?
 18:15) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 18:15) - (0 ? 18:15) + 1))))))) << (0 ? 18:15)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 19:19) - (0 ?
 19:19) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 19:19) - (0 ?
 19:19) + 1))))))) << (0 ?
 19:19))) | (((gctUINT32) ((gctUINT32) (info->aluReorderLoop2Mode) & ((gctUINT32) ((((1 ?
 19:19) - (0 ?
 19:19) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 19:19) - (0 ? 19:19) + 1))))))) << (0 ? 19:19)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:24) - (0 ?
 25:24) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:24) - (0 ?
 25:24) + 1))))))) << (0 ?
 25:24))) | (((gctUINT32) ((gctUINT32) (info->inImageBorderMode) & ((gctUINT32) ((((1 ?
 25:24) - (0 ?
 25:24) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 25:24) - (0 ? 25:24) + 1))))))) << (0 ? 25:24)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 27:26) - (0 ?
 27:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 27:26) - (0 ?
 27:26) + 1))))))) << (0 ?
 27:26))) | (((gctUINT32) ((gctUINT32) (info->aluOutputPostshiftBit6to5) & ((gctUINT32) ((((1 ?
 27:26) - (0 ?
 27:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 27:26) - (0 ? 27:26) + 1))))))) << (0 ? 27:26)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 9:5) - (0 ?
 9:5) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 9:5) - (0 ?
 9:5) + 1))))))) << (0 ?
 9:5))) | (((gctUINT32) ((gctUINT32) (info->aluInputPreshift) & ((gctUINT32) ((((1 ?
 9:5) - (0 ?
 9:5) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 9:5) - (0 ? 9:5) + 1))))))) << (0 ? 9:5)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 14:10) - (0 ?
 14:10) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 14:10) - (0 ?
 14:10) + 1))))))) << (0 ?
 14:10))) | (((gctUINT32) ((gctUINT32) (info->aluOutputPostshift) & ((gctUINT32) ((((1 ?
 14:10) - (0 ?
 14:10) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 14:10) - (0 ? 14:10) + 1))))))) << (0 ? 14:10)));
        }
        else
        {
            *(*Instruction)++ =   ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 0:0) - (0 ?
 0:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 0:0) - (0 ?
 0:0) + 1))))))) << (0 ?
 0:0))) | (((gctUINT32) ((gctUINT32) (info->aluFilterPwlSwap) & ((gctUINT32) ((((1 ?
 0:0) - (0 ?
 0:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 0:0) - (0 ? 0:0) + 1))))))) << (0 ? 0:0)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 2:1) - (0 ?
 2:1) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 2:1) - (0 ?
 2:1) + 1))))))) << (0 ?
 2:1))) | (((gctUINT32) ((gctUINT32) (info->floatRoundingMode) & ((gctUINT32) ((((1 ?
 2:1) - (0 ?
 2:1) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 2:1) - (0 ? 2:1) + 1))))))) << (0 ? 2:1)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 4:3) - (0 ?
 4:3) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 4:3) - (0 ?
 4:3) + 1))))))) << (0 ?
 4:3))) | (((gctUINT32) ((gctUINT32) (info->integeroundingMode) & ((gctUINT32) ((((1 ?
 4:3) - (0 ?
 4:3) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 4:3) - (0 ? 4:3) + 1))))))) << (0 ? 4:3)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 18:15) - (0 ?
 18:15) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 18:15) - (0 ?
 18:15) + 1))))))) << (0 ?
 18:15))) | (((gctUINT32) ((gctUINT32) (info->aluReorderBitsUsed) & ((gctUINT32) ((((1 ?
 18:15) - (0 ?
 18:15) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 18:15) - (0 ? 18:15) + 1))))))) << (0 ? 18:15)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 19:19) - (0 ?
 19:19) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 19:19) - (0 ?
 19:19) + 1))))))) << (0 ?
 19:19))) | (((gctUINT32) ((gctUINT32) (info->aluReorderLoop2Mode) & ((gctUINT32) ((((1 ?
 19:19) - (0 ?
 19:19) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 19:19) - (0 ? 19:19) + 1))))))) << (0 ? 19:19)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:24) - (0 ?
 25:24) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:24) - (0 ?
 25:24) + 1))))))) << (0 ?
 25:24))) | (((gctUINT32) ((gctUINT32) (info->inImageBorderMode) & ((gctUINT32) ((((1 ?
 25:24) - (0 ?
 25:24) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 25:24) - (0 ? 25:24) + 1))))))) << (0 ? 25:24)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 9:5) - (0 ?
 9:5) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 9:5) - (0 ?
 9:5) + 1))))))) << (0 ?
 9:5))) | (((gctUINT32) ((gctUINT32) (info->aluInputPreshift) & ((gctUINT32) ((((1 ?
 9:5) - (0 ?
 9:5) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 9:5) - (0 ? 9:5) + 1))))))) << (0 ? 9:5)))
                                | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 14:10) - (0 ?
 14:10) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 14:10) - (0 ?
 14:10) + 1))))))) << (0 ?
 14:10))) | (((gctUINT32) ((gctUINT32) (info->aluOutputPostshift) & ((gctUINT32) ((((1 ?
 14:10) - (0 ?
 14:10) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 14:10) - (0 ? 14:10) + 1))))))) << (0 ? 14:10)));
        }

        /*word25*/
        *(*Instruction)++ =   ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:0) - (0 ?
 25:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:0) - (0 ?
 25:0) + 1))))))) << (0 ?
 25:0))) | (((gctUINT32) ((gctUINT32) (info->inImageCircularBufSize >> 6) & ((gctUINT32) ((((1 ?
 25:0) - (0 ?
 25:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 25:0) - (0 ? 25:0) + 1))))))) << (0 ? 25:0)));
        /*word26*/
        *(*Instruction)++ =   ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:0) - (0 ?
 25:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:0) - (0 ?
 25:0) + 1))))))) << (0 ?
 25:0))) | (((gctUINT32) ((gctUINT32) (info->inImageCircularBufEndAddrPlus1 >> 6) & ((gctUINT32) ((((1 ?
 25:0) - (0 ?
 25:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 25:0) - (0 ? 25:0) + 1))))))) << (0 ? 25:0)));
        /*word27*/
        *(*Instruction)++ =   ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:0) - (0 ?
 25:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:0) - (0 ?
 25:0) + 1))))))) << (0 ?
 25:0))) | (((gctUINT32) ((gctUINT32) (info->outImageCircularBufSize >> 6) & ((gctUINT32) ((((1 ?
 25:0) - (0 ?
 25:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 25:0) - (0 ? 25:0) + 1))))))) << (0 ? 25:0)));
        /*word28*/
        *(*Instruction)++ =   ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:0) - (0 ?
 25:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:0) - (0 ?
 25:0) + 1))))))) << (0 ?
 25:0))) | (((gctUINT32) ((gctUINT32) (info->outImageCircularBufEndAddrPlus1 >> 6) & ((gctUINT32) ((((1 ?
 25:0) - (0 ?
 25:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 25:0) - (0 ? 25:0) + 1))))))) << (0 ? 25:0)));

        /*word29*/
        *(*Instruction)++ =   ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (info->inImageBorderConst) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)))
                              | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 23:16) - (0 ?
 23:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 23:16) - (0 ?
 23:16) + 1))))))) << (0 ?
 23:16))) | (((gctUINT32) ((gctUINT32) (info->coefZP) & ((gctUINT32) ((((1 ?
 23:16) - (0 ?
 23:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 23:16) - (0 ? 23:16) + 1))))))) << (0 ? 23:16)))
                              | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:24) - (0 ?
 31:24) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:24) - (0 ?
 31:24) + 1))))))) << (0 ?
 31:24))) | (((gctUINT32) ((gctUINT32) (info->inputZP) & ((gctUINT32) ((((1 ?
 31:24) - (0 ?
 31:24) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 31:24) - (0 ? 31:24) + 1))))))) << (0 ? 31:24)));
        /*word30*/
         *(*Instruction)++ =   ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 7:0) - (0 ?
 7:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 7:0) - (0 ?
 7:0) + 1))))))) << (0 ?
 7:0))) | (((gctUINT32) ((gctUINT32) (info->outputZP) & ((gctUINT32) ((((1 ?
 7:0) - (0 ?
 7:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 7:0) - (0 ? 7:0) + 1))))))) << (0 ? 7:0)))
                              | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 22:8) - (0 ?
 22:8) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 22:8) - (0 ?
 22:8) + 1))))))) << (0 ?
 22:8))) | (((gctUINT32) ((gctUINT32) (info->aluOutputPostMultiplier) & ((gctUINT32) ((((1 ?
 22:8) - (0 ?
 22:8) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 22:8) - (0 ? 22:8) + 1))))))) << (0 ? 22:8)))
                              | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 30:23) - (0 ?
 30:23) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 30:23) - (0 ?
 30:23) + 1))))))) << (0 ?
 30:23))) | (((gctUINT32) ((gctUINT32) (info->aluOutputPostMultiplierBit22to15) & ((gctUINT32) ((((1 ?
 30:23) - (0 ?
 30:23) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 30:23) - (0 ? 30:23) + 1))))))) << (0 ? 30:23)));
    }

    return gcvSTATUS_OK;
}

gceSTATUS
gcoHARDWAREVX_SetNNImage(
    IN gcoHARDWARE Hardware,
    IN gctPOINTER Info,
    IN OUT gctUINT32_PTR *Instruction
)
{
    gctUINT32 shImage;
    struct _vx_nn_image_cmd_info *info = (struct _vx_nn_image_cmd_info*) Info;

    /* 16 bits per pixel.*/
    shImage = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 2:0) - (0 ?
 2:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 2:0) - (0 ?
 2:0) + 1))))))) << (0 ?
 2:0))) | (((gctUINT32) ((gctUINT32) (info->shift) & ((gctUINT32) ((((1 ?
 2:0) - (0 ?
 2:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 2:0) - (0 ? 2:0) + 1))))))) << (0 ? 2:0)))
              | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 3:3) - (0 ?
 3:3) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 3:3) - (0 ?
 3:3) + 1))))))) << (0 ?
 3:3))) | (((gctUINT32) ((gctUINT32) (0x0) & ((gctUINT32) ((((1 ?
 3:3) - (0 ?
 3:3) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 3:3) - (0 ? 3:3) + 1))))))) << (0 ? 3:3)))
              | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 5:4) - (0 ?
 5:4) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 5:4) - (0 ?
 5:4) + 1))))))) << (0 ?
 5:4))) | (((gctUINT32) ((gctUINT32) (0x0) & ((gctUINT32) ((((1 ?
 5:4) - (0 ?
 5:4) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 5:4) - (0 ? 5:4) + 1))))))) << (0 ? 5:4)))
              | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 9:6) - (0 ?
 9:6) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 9:6) - (0 ?
 9:6) + 1))))))) << (0 ?
 9:6))) | (((gctUINT32) ((gctUINT32) ((info->shift == 2)?
0x0:0x6) & ((gctUINT32) ((((1 ?
 9:6) - (0 ?
 9:6) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 9:6) - (0 ? 9:6) + 1))))))) << (0 ? 9:6)))
              | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 11:10) - (0 ?
 11:10) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 11:10) - (0 ?
 11:10) + 1))))))) << (0 ?
 11:10))) | (((gctUINT32) (0x0 & ((gctUINT32) ((((1 ?
 11:10) - (0 ?
 11:10) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 11:10) - (0 ? 11:10) + 1))))))) << (0 ? 11:10)))
              | ((info->height <= 1) ?
 ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 12:12) - (0 ?
 12:12) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 12:12) - (0 ?
 12:12) + 1))))))) << (0 ?
 12:12))) | (((gctUINT32) (0x0 & ((gctUINT32) ((((1 ?
 12:12) - (0 ?
 12:12) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 12:12) - (0 ?
 12:12) + 1))))))) << (0 ?
 12:12))) : ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 12:12) - (0 ?
 12:12) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 12:12) - (0 ?
 12:12) + 1))))))) << (0 ?
 12:12))) | (((gctUINT32) (0x1 & ((gctUINT32) ((((1 ?
 12:12) - (0 ?
 12:12) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 12:12) - (0 ? 12:12) + 1))))))) << (0 ? 12:12))))
              | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:14) - (0 ?
 15:14) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:14) - (0 ?
 15:14) + 1))))))) << (0 ?
 15:14))) | (((gctUINT32) ((gctUINT32) ((info->shift == 2)?
0x0:0x1) & ((gctUINT32) ((((1 ?
 15:14) - (0 ?
 15:14) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:14) - (0 ? 15:14) + 1))))))) << (0 ? 15:14)))
              | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 18:16) - (0 ?
 18:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 18:16) - (0 ?
 18:16) + 1))))))) << (0 ?
 18:16))) | (((gctUINT32) ((gctUINT32) (0x0) & ((gctUINT32) ((((1 ?
 18:16) - (0 ?
 18:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 18:16) - (0 ? 18:16) + 1))))))) << (0 ? 18:16)))
              | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 22:20) - (0 ?
 22:20) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 22:20) - (0 ?
 22:20) + 1))))))) << (0 ?
 22:20))) | (((gctUINT32) ((gctUINT32) (0x4) & ((gctUINT32) ((((1 ?
 22:20) - (0 ?
 22:20) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 22:20) - (0 ? 22:20) + 1))))))) << (0 ? 22:20)))
              | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:24) - (0 ?
 26:24) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:24) - (0 ?
 26:24) + 1))))))) << (0 ?
 26:24))) | (((gctUINT32) ((gctUINT32) (0x4) & ((gctUINT32) ((((1 ?
 26:24) - (0 ?
 26:24) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 26:24) - (0 ? 26:24) + 1))))))) << (0 ? 26:24)))
              | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 30:28) - (0 ?
 30:28) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 30:28) - (0 ?
 30:28) + 1))))))) << (0 ?
 30:28))) | (((gctUINT32) ((gctUINT32) (0x4) & ((gctUINT32) ((((1 ?
 30:28) - (0 ?
 30:28) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 30:28) - (0 ? 30:28) + 1))))))) << (0 ? 30:28)));

    *(*Instruction)++ = info->physical;
    *(*Instruction)++ = info->width * info->shift * 2;
    *(*Instruction)++ = info->width | (info->height << 16);
    *(*Instruction)++ = shImage;

    return gcvSTATUS_OK;
}

gceSTATUS
gcoHARDWAREVX_WaitNNEvent(
    IN gcoHARDWARE Hardware,
    IN gctUINT32   EventId
)
{
    gceSTATUS status = gcvSTATUS_OK;
    gctPOINTER *cmdBuffer = gcvNULL;

     /* Define state buffer variables. */
    gcmDEFINESTATEBUFFER_NEW(reserve, stateDelta, memory);

    gcmHEADER_ARG("Hardware=0x%x  EventId=0x%x",
        Hardware, EventId);

    gcmGETHARDWARE(Hardware);

    gcmBEGINSTATEBUFFER_NEW(Hardware, reserve, stateDelta, memory, cmdBuffer);

    stateDelta = stateDelta; /* Keep the compiler happy. */

    {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x0429) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x0429, EventId);
    gcmENDSTATEBATCH_NEW(reserve, memory);
};


    /* Validate the state buffer. */
    gcmENDSTATEBUFFER_NEW(Hardware, reserve, memory, cmdBuffer);

OnError:
    /* Return the status. */
    gcmFOOTER();
    return status;

}

gceSTATUS
gcoHARDWAREVX_SetRemapAddress(
    IN gcoHARDWARE Hardware,
    IN gctUINT32 remapStart,
    IN gctUINT32 remapEnd,
    IN gceVX_REMAP_TYPE remapType
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gctPOINTER *cmdBuffer = gcvNULL;

     /* Define state buffer variables. */
    gcmDEFINESTATEBUFFER_NEW(reserve, stateDelta, memory);

    gcmHEADER_ARG("Hardware=0x%x", Hardware);

    gcmGETHARDWARE(Hardware);

    gcmBEGINSTATEBUFFER_NEW(Hardware, reserve, stateDelta, memory, cmdBuffer);

    stateDelta = stateDelta; /* Keep the compiler happy. */

    switch (remapType)
    {
    case gcvVX_OCB_REMAP:

        {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x0E4F) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x0E4F, remapStart);
    gcmENDSTATEBATCH_NEW(reserve, memory);
};


        {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x0E50) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x0E50, remapEnd);
    gcmENDSTATEBATCH_NEW(reserve, memory);
};


        break;

    case gcvVX_SRAM_REMAP:

        {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x0E4E) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x0E4E, remapStart);
    gcmENDSTATEBATCH_NEW(reserve, memory);
};


        break;

    default:
        gcmASSERT(0);
        break;
    }

    /* Validate the state buffer. */
    gcmENDSTATEBUFFER_NEW(Hardware, reserve, memory, cmdBuffer);

OnError:
    /* Return the status. */
    gcmFOOTER();
    return status;

}

gceSTATUS
gcoHARDWAREVX_YUV2RGBScale(
    IN gcoHARDWARE Hardware,
    IN gctPOINTER Info,
    IN gctUINT32  gpuId,
    IN gctBOOL    mGpuSync
    )
{
    gceSTATUS status = gcvSTATUS_OK;
    gctUINT gpuCount = 0;
    gctPOINTER *cmdBuffer = gcvNULL;
    struct _vx_yuv2rgb_scaler_cmd_info *info = (struct _vx_yuv2rgb_scaler_cmd_info*) Info;

     /* Define state buffer variables. */
    gcmDEFINESTATEBUFFER_NEW(reserve, stateDelta, memory);

    gcmHEADER_ARG("Hardware=0x%x Info=0x%x", Hardware, Info);

    gcmGETHARDWARE(Hardware);

    gcmBEGINSTATEBUFFER_NEW(Hardware, reserve, stateDelta, memory, cmdBuffer);

    stateDelta = stateDelta; /* Keep the compiler happy. */

    gpuCount = Hardware->config->gpuCoreCount;
    if (gpuCount > 1)
    {
        { if (Hardware->config->gpuCoreCount > 1) { *memory++ = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x0D & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ? 31:27))) | gcvCORE_3D_0_MASK << gcmTO_CHIP_ID(gpuId); memory++;
  gcmDUMP(gcvNULL, "#[chip.enable 0x%04X]", gcvCORE_3D_0_MASK << gcmTO_CHIP_ID(gpuId));
 } };

    }

    {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x5F90) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x5F90, info->inImageBaseY);
    gcmENDSTATEBATCH_NEW(reserve, memory);
};


    {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x5F91) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x5F91, info->inImageBaseU);
    gcmENDSTATEBATCH_NEW(reserve, memory);
};


    {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x5F92) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x5F92, info->inImageBaseV);
    gcmENDSTATEBATCH_NEW(reserve, memory);
};


    {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x5FA3) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x5FA3, ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (info->inImageWidth) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:16) - (0 ?
 31:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:16) - (0 ?
 31:16) + 1))))))) << (0 ?
 31:16))) | (((gctUINT32) ((gctUINT32) (info->inImageHeight) & ((gctUINT32) ((((1 ?
 31:16) - (0 ?
 31:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 31:16) - (0 ? 31:16) + 1))))))) << (0 ? 31:16))));    gcmENDSTATEBATCH_NEW(reserve, memory);
};


    {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x5F93) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x5F93, ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (info->inRectWidth) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:16) - (0 ?
 31:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:16) - (0 ?
 31:16) + 1))))))) << (0 ?
 31:16))) | (((gctUINT32) ((gctUINT32) (info->inRectHeight) & ((gctUINT32) ((((1 ?
 31:16) - (0 ?
 31:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 31:16) - (0 ? 31:16) + 1))))))) << (0 ? 31:16))));    gcmENDSTATEBATCH_NEW(reserve, memory);
};


    {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x5FA4) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x5FA4, ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (info->inRectX) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:16) - (0 ?
 31:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:16) - (0 ?
 31:16) + 1))))))) << (0 ?
 31:16))) | (((gctUINT32) ((gctUINT32) (info->inRectY) & ((gctUINT32) ((((1 ?
 31:16) - (0 ?
 31:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 31:16) - (0 ? 31:16) + 1))))))) << (0 ? 31:16))));    gcmENDSTATEBATCH_NEW(reserve, memory);
};


    {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x5F94) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x5F94, info->outImageBaseR);
    gcmENDSTATEBATCH_NEW(reserve, memory);
};


    {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x5F95) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x5F95, info->outImageBaseG);
    gcmENDSTATEBATCH_NEW(reserve, memory);
};


    {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x5F96) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x5F96, info->outImageBaseB);
    gcmENDSTATEBATCH_NEW(reserve, memory);
};


    {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x5F97) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x5F97, ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (info->outImageWidth) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:16) - (0 ?
 31:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:16) - (0 ?
 31:16) + 1))))))) << (0 ?
 31:16))) | (((gctUINT32) ((gctUINT32) (info->outImageHeight) & ((gctUINT32) ((((1 ?
 31:16) - (0 ?
 31:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 31:16) - (0 ? 31:16) + 1))))))) << (0 ? 31:16))));    gcmENDSTATEBATCH_NEW(reserve, memory);
};


    {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x5F98) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x5F98, info->scaleX);
    gcmENDSTATEBATCH_NEW(reserve, memory);
};


    {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x5F99) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x5F99, info->scaleY);
    gcmENDSTATEBATCH_NEW(reserve, memory);
};


    {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x5F9A) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x5F9A, ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 14:0) - (0 ?
 14:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 14:0) - (0 ?
 14:0) + 1))))))) << (0 ?
 14:0))) | (((gctUINT32) ((gctUINT32) (info->inImageInitErrX) & ((gctUINT32) ((((1 ?
 14:0) - (0 ?
 14:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 14:0) - (0 ?
 14:0) + 1))))))) << (0 ?
 14:0))) | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 29:15) - (0 ?
 29:15) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 29:15) - (0 ?
 29:15) + 1))))))) << (0 ?
 29:15))) | (((gctUINT32) ((gctUINT32) (info->inImageInitErrY) & ((gctUINT32) ((((1 ?
 29:15) - (0 ?
 29:15) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 29:15) - (0 ? 29:15) + 1))))))) << (0 ? 29:15))));    gcmENDSTATEBATCH_NEW(reserve, memory);
};


    {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x5FA5) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x5FA5, ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 7:0) - (0 ?
 7:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 7:0) - (0 ?
 7:0) + 1))))))) << (0 ?
 7:0))) | (((gctUINT32) ((gctUINT32) (info->inImageInitIntErrX) & ((gctUINT32) ((((1 ?
 7:0) - (0 ?
 7:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 7:0) - (0 ?
 7:0) + 1))))))) << (0 ?
 7:0))) | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:8) - (0 ?
 15:8) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:8) - (0 ?
 15:8) + 1))))))) << (0 ?
 15:8))) | (((gctUINT32) ((gctUINT32) (info->inImageInitIntErrY) & ((gctUINT32) ((((1 ?
 15:8) - (0 ?
 15:8) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:8) - (0 ? 15:8) + 1))))))) << (0 ? 15:8))));    gcmENDSTATEBATCH_NEW(reserve, memory);
};


    {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x5FA2) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x5FA2, ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (info->inImageStrideY) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:16) - (0 ?
 31:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:16) - (0 ?
 31:16) + 1))))))) << (0 ?
 31:16))) | (((gctUINT32) ((gctUINT32) (info->outImageStride) & ((gctUINT32) ((((1 ?
 31:16) - (0 ?
 31:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 31:16) - (0 ? 31:16) + 1))))))) << (0 ? 31:16))));    gcmENDSTATEBATCH_NEW(reserve, memory);
};


    {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x5F9D) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x5F9D, ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 9:0) - (0 ?
 9:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 9:0) - (0 ?
 9:0) + 1))))))) << (0 ?
 9:0))) | (((gctUINT32) ((gctUINT32) (info->c0) & ((gctUINT32) ((((1 ?
 9:0) - (0 ?
 9:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 9:0) - (0 ?
 9:0) + 1))))))) << (0 ?
 9:0))) | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 19:10) - (0 ?
 19:10) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 19:10) - (0 ?
 19:10) + 1))))))) << (0 ?
 19:10))) | (((gctUINT32) ((gctUINT32) (info->c1) & ((gctUINT32) ((((1 ?
 19:10) - (0 ?
 19:10) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 19:10) - (0 ?
 19:10) + 1))))))) << (0 ?
 19:10))) | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 29:20) - (0 ?
 29:20) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 29:20) - (0 ?
 29:20) + 1))))))) << (0 ?
 29:20))) | (((gctUINT32) ((gctUINT32) (info->c2) & ((gctUINT32) ((((1 ?
 29:20) - (0 ?
 29:20) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 29:20) - (0 ? 29:20) + 1))))))) << (0 ? 29:20))));    gcmENDSTATEBATCH_NEW(reserve, memory);
};


    {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x5F9E) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x5F9E, ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 9:0) - (0 ?
 9:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 9:0) - (0 ?
 9:0) + 1))))))) << (0 ?
 9:0))) | (((gctUINT32) ((gctUINT32) (info->c3) & ((gctUINT32) ((((1 ?
 9:0) - (0 ?
 9:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 9:0) - (0 ?
 9:0) + 1))))))) << (0 ?
 9:0))) | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 19:10) - (0 ?
 19:10) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 19:10) - (0 ?
 19:10) + 1))))))) << (0 ?
 19:10))) | (((gctUINT32) ((gctUINT32) (info->c4) & ((gctUINT32) ((((1 ?
 19:10) - (0 ?
 19:10) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 19:10) - (0 ? 19:10) + 1))))))) << (0 ? 19:10))));    gcmENDSTATEBATCH_NEW(reserve, memory);
};


    {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x5F9F) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x5F9F, ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 18:0) - (0 ?
 18:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 18:0) - (0 ?
 18:0) + 1))))))) << (0 ?
 18:0))) | (((gctUINT32) ((gctUINT32) (info->c5) & ((gctUINT32) ((((1 ?
 18:0) - (0 ?
 18:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 18:0) - (0 ? 18:0) + 1))))))) << (0 ? 18:0))));    gcmENDSTATEBATCH_NEW(reserve, memory);
};


    {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x5FA0) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x5FA0, ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 18:0) - (0 ?
 18:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 18:0) - (0 ?
 18:0) + 1))))))) << (0 ?
 18:0))) | (((gctUINT32) ((gctUINT32) (info->c6) & ((gctUINT32) ((((1 ?
 18:0) - (0 ?
 18:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 18:0) - (0 ? 18:0) + 1))))))) << (0 ? 18:0))));    gcmENDSTATEBATCH_NEW(reserve, memory);
};


    {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x5FA1) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x5FA1, ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 18:0) - (0 ?
 18:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 18:0) - (0 ?
 18:0) + 1))))))) << (0 ?
 18:0))) | (((gctUINT32) ((gctUINT32) (info->c7) & ((gctUINT32) ((((1 ?
 18:0) - (0 ?
 18:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 18:0) - (0 ? 18:0) + 1))))))) << (0 ? 18:0))));    gcmENDSTATEBATCH_NEW(reserve, memory);
};


    {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x5FA6) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x5FA6, ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (info->minRClamp) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:16) - (0 ?
 31:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:16) - (0 ?
 31:16) + 1))))))) << (0 ?
 31:16))) | (((gctUINT32) ((gctUINT32) (info->maxRClamp) & ((gctUINT32) ((((1 ?
 31:16) - (0 ?
 31:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 31:16) - (0 ? 31:16) + 1))))))) << (0 ? 31:16))));    gcmENDSTATEBATCH_NEW(reserve, memory);
};


    {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x5FA7) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x5FA7, ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (info->minGClamp) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:16) - (0 ?
 31:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:16) - (0 ?
 31:16) + 1))))))) << (0 ?
 31:16))) | (((gctUINT32) ((gctUINT32) (info->maxGClamp) & ((gctUINT32) ((((1 ?
 31:16) - (0 ?
 31:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 31:16) - (0 ? 31:16) + 1))))))) << (0 ? 31:16))));    gcmENDSTATEBATCH_NEW(reserve, memory);
};


    {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x5FA8) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x5FA8, ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (info->minBClamp) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:16) - (0 ?
 31:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:16) - (0 ?
 31:16) + 1))))))) << (0 ?
 31:16))) | (((gctUINT32) ((gctUINT32) (info->maxBClamp) & ((gctUINT32) ((((1 ?
 31:16) - (0 ?
 31:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 31:16) - (0 ? 31:16) + 1))))))) << (0 ? 31:16))));    gcmENDSTATEBATCH_NEW(reserve, memory);
};


    {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x5F9C) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x5F9C, info->outRequestCount);
    gcmENDSTATEBATCH_NEW(reserve, memory);
};


    {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x5F9B) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x5F9B, ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 0:0) - (0 ?
 0:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 0:0) - (0 ?
 0:0) + 1))))))) << (0 ?
 0:0))) | (((gctUINT32) (0x1 & ((gctUINT32) ((((1 ?
 0:0) - (0 ?
 0:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 0:0) - (0 ?
 0:0) + 1))))))) << (0 ?
 0:0))) | (info->yOnly ?
 ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 1:1) - (0 ?
 1:1) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 1:1) - (0 ?
 1:1) + 1))))))) << (0 ?
 1:1))) | (((gctUINT32) (0x1 & ((gctUINT32) ((((1 ?
 1:1) - (0 ?
 1:1) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 1:1) - (0 ?
 1:1) + 1))))))) << (0 ?
 1:1))) : ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 1:1) - (0 ?
 1:1) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 1:1) - (0 ?
 1:1) + 1))))))) << (0 ?
 1:1))) | (((gctUINT32) (0x0 & ((gctUINT32) ((((1 ?
 1:1) - (0 ?
 1:1) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 1:1) - (0 ?
 1:1) + 1))))))) << (0 ?
 1:1)))) | (info->outImageBitsSize == 16 ?
 ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 2:2) - (0 ?
 2:2) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 2:2) - (0 ?
 2:2) + 1))))))) << (0 ?
 2:2))) | (((gctUINT32) (0x1 & ((gctUINT32) ((((1 ?
 2:2) - (0 ?
 2:2) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 2:2) - (0 ?
 2:2) + 1))))))) << (0 ?
 2:2))) : ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 2:2) - (0 ?
 2:2) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 2:2) - (0 ?
 2:2) + 1))))))) << (0 ?
 2:2))) | (((gctUINT32) (0x0 & ((gctUINT32) ((((1 ?
 2:2) - (0 ?
 2:2) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 2:2) - (0 ?
 2:2) + 1))))))) << (0 ?
 2:2)))) | (info->outSigned ?
 ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 3:3) - (0 ?
 3:3) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 3:3) - (0 ?
 3:3) + 1))))))) << (0 ?
 3:3))) | (((gctUINT32) (0x1 & ((gctUINT32) ((((1 ?
 3:3) - (0 ?
 3:3) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 3:3) - (0 ?
 3:3) + 1))))))) << (0 ?
 3:3))) : ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 3:3) - (0 ?
 3:3) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 3:3) - (0 ?
 3:3) + 1))))))) << (0 ?
 3:3))) | (((gctUINT32) (0x0 & ((gctUINT32) ((((1 ?
 3:3) - (0 ?
 3:3) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 3:3) - (0 ?
 3:3) + 1))))))) << (0 ?
 3:3)))) | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 7:4) - (0 ?
 7:4) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 7:4) - (0 ?
 7:4) + 1))))))) << (0 ?
 7:4))) | (((gctUINT32) ((gctUINT32) (info->postShift) & ((gctUINT32) ((((1 ?
 7:4) - (0 ?
 7:4) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 7:4) - (0 ? 7:4) + 1))))))) << (0 ? 7:4))) );    gcmENDSTATEBATCH_NEW(reserve, memory);
};


     if (gpuCount > 1)
     {
         { if (Hardware->config->gpuCoreCount > 1) { *memory++ = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x0D & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ? 31:27) + 1))))))) << (0 ? 31:27))) | gcvCORE_3D_ALL_MASK; memory++;
  gcmDUMP(gcvNULL, "#[chip.enable 0x%04X]", gcvCORE_3D_ALL_MASK);
 } };

         if (mGpuSync)
         {
             gcoHARDWARE_MultiGPUSync(Hardware, &memory);
         }
     }

    /* Validate the state buffer. */
    gcmENDSTATEBUFFER_NEW(Hardware, reserve, memory, cmdBuffer);

    if (gpuCount == 1)
    {
        /* Add FE - PE samaphore stall to sync with next operation. */
        gcmONERROR(gcoHARDWARE_Semaphore(
            Hardware, gcvWHERE_COMMAND, gcvWHERE_PIXEL, gcvHOW_SEMAPHORE_STALL, gcvNULL));
    }

OnError:
    /* Return the status. */
    gcmFOOTER();
    return status;
}

#if GC_VX_ASM

typedef struct _gctVX_AsmIndexTable
{
    char *name;
    int index;
}
gctVX_AsmIndexTable;

typedef struct _gctVX_AsmInstr
{
    gctCHAR source[128];
    gctCHAR *item[10];
    gctINT32 itemcount;
}
gctVX_AsmInstr;

typedef struct _gctVX_AsmInstrItem
{
    gctINT32 type;
    gctINT32 index;
    gctINT32 swizzle;
    gctINT32 neg;
    gctINT32 format;
    gctINT32 enabled;
    gctFLOAT immf;
}
gctVX_AsmInstrItem;

typedef struct _gctVX_AsmInstruction
{
    gctINT32 opcode;
    gctINT32 format;
    gctINT32 evis;
    gctINT32 rounding;
    gctINT32 clamp;
    gctINT32 startbin;
    gctINT32 endbin;
    gctINT32 sourcebin;
    gctVX_AsmInstrItem dst;
    gctVX_AsmInstrItem src[3];
}
gctVX_AsmInstruction;

typedef struct _gctVX_AsmSource
{
    gctCHAR source[1024];
    gctVX_AsmInstr instructions[1024];
    gctINT32 instr_count;
    gctVX_AsmInstruction _instructions[1024];
}
gctVX_AsmSource;

enum
{
    GC_VX_ITEM_TYPE_REG = 0,
    GC_VX_ITEM_TYPE_UNIFORM,
    GC_VX_ITEM_TYPE_UNIFORM512,
    GC_VX_ITEM_TYPE_IMM,
    GC_VX_ITEM_TYPE_IMMF,
}
gceVX_AssamblerItemType;

gctVX_AsmIndexTable opcodetables[] = {
    {"nop", 0x00},
    {"add", 0x01},
    {"mul", 0x02},
    {"dst", 0x03},
    {"dst", 0x04},
    {"dp3", 0x05},
    {"dp4", 0x06},
    {"dsx", 0x07},
    {"dsy", 0x08},
    {"mov", 0x09},
    {"movar", 0x0A},
    {"movaf", 0x0B},
    {"rcp", 0x0C},
    {"rsq", 0x0D},
    {"litp", 0x0E},
    {"select", 0x0F},
    {"set", 0x10},
    {"exp", 0x11},
    {"log", 0x12},
    {"frc", 0x13},
    {"call", 0x14},
    {"ret", 0x15},
    {"branch", 0x16},
    {"texkill", 0x17},
    {"texld", 0x18},
    {"texld_b_pcf", 0x18},
    {"texldb", 0x19},
    {"texldd", 0x1A},
    {"texldg", 0x1A},
    {"texldl", 0x1B},
    {"texldp", 0x1C},
    {"texldpcf", 0x1C},
    {"rep", 0x1D},
    {"endrep", 0x1E},
    {"loop", 0x1F},
    {"endloop", 0x20},
    {"sqrt", 0x21},
    {"sinxhpi", 0x22},
    {"cosxhpi", 0x23},
    {"branch_any", 0x24},
    {"floor", 0x25},
    {"ceil", 0x26},
    {"sign", 0x27},
    {"addlo", 0x28},
    {"mullo", 0x29},
    {"barrier", 0x2A},
    {"swizzle", 0x2B},
    {"i2i", 0x2C},
    {"i2f", 0x2D},
    {"f2i", 0x2E},
    {"f2irnd", 0x2F},
    {"fma", 0x30},
    {"cmp", 0x31},
    {"load", 0x32},
    {"store", 0x33},
    {"img_load_3d", 0x34},
    {"img_store_3d", 0x35},
    {"max", 0x36},
    {"img_addr", 0x37},
    {"img_addr_3d", 0x38},
    {"loadp", 0x39},
    {"stroep", 0x3A},
    {"iaddsat", 0x3B},
    {"imullo0", 0x3C},
    {"imullo1", 0x3D},
    {"imullosat0", 0x3E},
    {"imullosat1", 0x3F},
    {"imulhi0", 0x40},
    {"imulhi1", 0x41},
    {"store_attr", 0x42},
    {"select_map", 0x43},
    {"idiv0", 0x44},
    {"evis", 0x45},
    {"img_atom", 0x46},
    {"imod0", 0x48},
    {"texld_u_s_l", 0x49},
    {"texld_u_u_l", 0x4A},
    {"texld_u_f_l", 0x4B},
    {"imadlo0", 0x4C},
    {"imadlo1", 0x4D},
    {"imadlosat0", 0x4E},
    {"imadlosat1", 0x4F},
    {"imadhi0", 0x50},
    {"imadhi1", 0x51},
    {"imadhisat0", 0x52},
    {"imadhisat1", 0x53},
    {"bit_insert1", 0x54},
    {"bit_insert2", 0x55},
    {"moveai", 0x56},
    {"iabs", 0x57},
    {"leadzero", 0x58},
    {"lshift", 0x59},
    {"rshift", 0x5A},
    {"rotate", 0x5B},
    {"or", 0x5C},
    {"and", 0x5D},
    {"xor", 0x5E},
    {"not", 0x5F},
    {"bit_extract", 0x60},
    {"popcount", 0x61},
    {"arctrig", 0x63},
    {"div", 0x64},
    {"atom_add", 0x65},
    {"atom_xchg", 0x66},
    {"atom_cmp_xchg", 0x67},
    {"atom_min", 0x68},
    {"atom_max", 0x69},
    {"atom_or", 0x6A},
    {"atom_and", 0x6B},
    {"atom_xor", 0x6C},
    {"bit_reversal", 0x6D},
    {"byte_reversal", 0x6E},
    {"texld_l_pcf", 0x6F},
    {"texld_g_pcf", 0x70},
    {"pack", 0x71},
    {"conv", 0x72},
    {"dp2", 0x73},
    {"norm_dp2", 0x74},
    {"norm_dp3", 0x75},
    {"norm_dp4", 0x76},
    {"norm_mul", 0x77},
    {"load_attr", 0x78},
    {"img_load", 0x79},
    {"img_store", 0x7A},
    {"texld_u", 0x7B},
    {"texd_u_f_b", 0x7B},
    {"lodq_g", 0x7C},
    {"texld_gather", 0x7D},
    {"async_copy_or_wait", AQ_INST_OP_CODE_ASYNC_COPY_OR_WAIT},
    {"extended", 0x7F},

    /* EVIS */
    {"abs_diff", 0x01},
    {"iadd", 0x02},
    {"iacc_sq", 0x03},
    {"lerp", 0x04},
    {"filter", 0x05},
    {"mag_phase", 0x06},
    {"mul_shift", 0x07},
    {"dp16x1", 0x08},
    {"dp8x2", 0x09},
    {"dp4x4", 0x0A},
    {"dp2x8", 0x0B},
    {"clamp", 0x0C},
    {"bin_linear", 0x0D},
    {"select_add", 0x0E},
    {"atomic_add", 0x0F},
    {"bit_extract", 0x10},
    {"bit_replace", 0x11},
    {"dp32x1", 0x12},
    {"dp16x2", 0x13},
    {"dp8x4", 0x14},
    {"dp4x8", 0x15},
    {"dp2x16", 0x16},
    {"index_add", 0x17},
    {"vert_min3", 0x18},
    {"vert_max3", 0x19},
    {"vert_med3", 0x1A},
    {"horz_min3", 0x1B},
    {"horz_max3", 0x1C},
    {"horz_med3", 0x1D},
};

gctVX_AsmIndexTable formattables[] = {
    {"f32", 0},
    {"f16", 1},
    {"s32", 2},
    {"s16", 3},
    {"s8", 4},
    {"u32", 5},
    {"u16", 6},
    {"u8", 7},
};

gctVX_AsmIndexTable attributetables[] = {
    {"rtn", 1},
    {"clamp", 1},
    {"evis", 1},
};

static void _strsplit(char* src, char** list, int *count, char* key)
{
    char * pp;
    char temp[1024] = {0};

    gcoOS_StrCopySafe(temp, strlen(src)+1, src);

    list[(*count)++] = strtok_s(temp, key, &pp);
    while(list[(*count) -1] != NULL)
    {
        list[(*count)++] = strtok_s(NULL, key, &pp);
    }

    (*count)--;
}

static int _getIndex(char* opname, gctVX_AsmIndexTable* table, int count)
{
    int i = 0, opcode = -1;
    for(i = 0; i < count; i++)
    {
        if(strcmp(opname, table[i].name) == 0)
        {
            opcode = table[i].index;
            break;
        }
    }
    return opcode;
}

static int _parseSwizzle(char* source, int dest)
{
    int i = 0, j = 0, length = strlen(source), swizzle = 0, current = 0;
    char table[4] = {'x', 'y', 'z', 'w'};

    for(i = 0; i < length; i++)
    {
        for(j = 0; j < (int)strlen(table); j++)
        {
            if(strncmp(&table[j], (source + i), 1) == 0)
            {
                current = j;
            }
        }

        if(dest)
            swizzle |= (1 << current);
        else
            swizzle |= (current << (2 * i));

    }

    if(length < 4)
    {
        for(j = length; j < 4; j++)
        {
            swizzle |= (current << (2 * j));
        }
    }

    return swizzle;
}

static void _parseItem(gctVX_AsmInstrItem* item, char* source, int dest)
{
    char* regname, *p1;
    char source_back[256] = {0};

    gcoOS_StrCopySafe(source_back, strlen(source)+1, source);

    /* float imm */
    if(strcmp(source_back + strlen(source_back) -1, "f") == 0)
    {
        item->enabled   = 1;
        item->type      = GC_VX_ITEM_TYPE_IMMF;
        item->immf      = (gctFLOAT)atof(source_back);
        item->swizzle   = (dest)?0xf:0xe4;
    }
    else
    {
        regname = strtok_s(source_back, ".", &p1);
        if(regname != NULL)
        {
            item->swizzle = (dest)?0xf:0xe4;
            item->enabled   = 1;
            if(strncmp("r", regname, 1) == 0)
            {
                item->type  = GC_VX_ITEM_TYPE_REG;
                item->index = atoi(regname+1);

                regname = strtok_s(NULL, ".", &p1);
                while(regname != NULL)
                {
                    if(strcmp(regname, "neg") == 0)
                    {
                        item->neg = 1;
                    }
                    if((strncmp(regname, "u", 1) == 0) || (strncmp(regname, "s", 1) == 0) || (strncmp(regname, "f", 1) == 0))
                    {
                        item->format = _getIndex(regname, formattables, sizeof(formattables)/sizeof(formattables[0]));
                    }
                    else
                    {
                        item->swizzle = _parseSwizzle(regname, dest);
                    }
                    regname = strtok_s(NULL, ".", &p1);
                }

            }
            else if(strncmp("c", regname, 1) == 0)
            {
                item->type  = GC_VX_ITEM_TYPE_UNIFORM;
                item->index = atoi(regname+1);

                regname = strtok_s(NULL, ".", &p1);
                while(regname != NULL)
                {
                    if(strcmp(regname, "neg") == 0)
                    {
                        item->neg = 1;
                    }
                    if((strncmp(regname, "u", 1) == 0) || (strncmp(regname, "s", 1) == 0) || (strncmp(regname, "f", 1) == 0))
                    {
                        item->format = _getIndex(regname, formattables, sizeof(formattables)/sizeof(formattables[0]));
                    }
                    else
                    {
                        item->swizzle = _parseSwizzle(regname, dest);
                    }
                    regname = strtok_s(NULL, ".", &p1);
                }

            }
            else if(strncmp("C", regname, 1) == 0)
            {
                item->type  = GC_VX_ITEM_TYPE_UNIFORM512;
                item->index = atoi(regname+1);

                regname = strtok_s(NULL, ".", &p1);
                while(regname != NULL)
                {
                    if(strcmp(regname, "neg") == 0)
                    {
                        item->neg = 1;
                    }
                    if((strncmp(regname, "u", 1) == 0) || (strncmp(regname, "s", 1) == 0) || (strncmp(regname, "f", 1) == 0))
                    {
                        item->format = _getIndex(regname, formattables, sizeof(formattables)/sizeof(formattables[0]));
                    }
                    else
                    {
                        item->swizzle = _parseSwizzle(regname, dest);
                    }
                    regname = strtok_s(NULL, ".", &p1);
                }

            }
            else
            {
                item->type  = GC_VX_ITEM_TYPE_IMM;
                item->index = atoi(regname);
                item->swizzle = (dest)?0xf:0xe4;
            }
        }
    }
}

static void _parseInstruction(gctVX_AsmSource *instr_source, int index)
{
    int i = 0;
    char temp[1024] = {0};
    char * opname, *rtnmode, *p;
    gctVX_AsmInstr* instr = &instr_source->instructions[index];
    gctVX_AsmInstruction* instruction = &instr_source->_instructions[index];

    gcmPRINT("%s\n", instr->source);

    _strsplit(instr->source, instr->item, &(instr->itemcount), " ");

    /*opcode*/
    gcoOS_MemFill(temp, 0, 1024);
    gcoOS_StrCopySafe(temp, strlen(instr->item[0])+1, instr->item[0]);
    opname = strtok_s(temp, ".", &p);
    if(opname != NULL)
    {
        instruction->opcode = _getIndex(opname, opcodetables, sizeof(opcodetables)/sizeof(opcodetables[0]));
    }

    rtnmode = strtok_s(NULL, ".", &p);
    while(rtnmode != NULL)
    {
        /* rounding mode */
        if(strcmp(rtnmode, attributetables[0].name) == 0)
        {
            instruction->rounding = attributetables[0].index;
        }
        /* clamp mode */
        else if(strcmp(rtnmode, attributetables[1].name) == 0)
        {
            instruction->clamp = attributetables[1].index;
        }
        /* evis mode */
        else if(strcmp(rtnmode, attributetables[2].name) == 0)
        {
            instruction->evis = attributetables[2].index;
        }
        /* startbin, endbin */
        else if(strncmp(rtnmode, "{", 1) == 0)
        {
            if(sscanf_s(rtnmode, "{%d,%d}", &instruction->startbin, &instruction->endbin) < 2);
                sscanf_s(rtnmode, "{%d, %d}", &instruction->startbin, &instruction->endbin);

        }
        /* dst format */
        else
        {
            instruction->format     =
            instruction->dst.format = _getIndex(rtnmode, formattables, sizeof(formattables)/sizeof(formattables[0]));
        }

        rtnmode = strtok_s(NULL, ".", &p);
    }

    /*dst register*/
    gcoOS_MemFill(temp, 0, 1024);
    gcoOS_StrCopySafe(temp, strlen(instr->item[1])+1, instr->item[1]);
    _parseItem(&instruction->dst, temp, 1);

    for(i = 0; i < 3; i++)
    {
        /*src0/1/2 register*/
        if(instr->item[2 + i] != NULL)
        {
            gcoOS_MemFill(temp, 0, 1024);
            gcoOS_StrCopySafe(temp, strlen(instr->item[2 + i])+1, instr->item[2 + i]);
            _parseItem(&instruction->src[i], temp, 0);
        }
    }

    switch(instruction->opcode)
    {
    case 0x03:
        assert(instruction->src[0].format == instruction->src[1].format);
        instruction->evis = instruction->src[0].format;
        break;
    case 0x02:
        instruction->evis = instruction->src[0].format | (instruction->src[1].format << 3);
        break;
    case 0x04:
        instruction->evis = instruction->src[0].format | (instruction->src[1].format << 3) | (instruction->rounding << 6);
        break;
    }
}

static void _splitSource(char* source, gctVX_AsmSource* item)
{
    char*p, *t;
    char temp[4096] = {0};

    gcoOS_StrCopySafe(temp, strlen(source)+1, source);
    gcoOS_StrCopySafe(item->source, strlen(source)+1, source);

    t = strtok_s(temp, "\n", &p);
    while(t != NULL)
    {
        /*gcmPRINT("%s\n", t);*/
        gcoOS_StrCopySafe(item->instructions[item->instr_count++].source, strlen(t)+1, t);

        t = strtok_s(NULL, "\n", &p);
    }
}

void gcmVxAssambler(char* source, gctVX_AsmSource* instr_source)
{
    int i = 0 ;
    _splitSource(source, instr_source);
    gcmPRINT("count = %d \n", instr_source->instr_count);

    for(i = 0; i < instr_source->instr_count; i++)
    {
        _parseInstruction(instr_source, i);
    }
}

#define GC_VX_INSTRUCTION_ASM_DEBUG 0

#if GC_VX_INSTRUCTION_ASM_DEBUG

static void _generateSwizzle(int swizzle, int dest)
{
    int i = 0, index = 0;
    char table[4] = {'x', 'y', 'z', 'w'};

    for(i = 0; i < 4; i++)
    {
        if(dest)
        {
            if((swizzle >> i) & 1)gcmPRINT("%c", table[i]);
        }
        else
        {
            index = (swizzle >> (2*i)) & 0x3;
            gcmPRINT("%c", table[index]);
        }
    }
}
static void _generateItem(gctVX_AsmInstrItem item, int dest)
{
    if(item.enabled)
    {
        switch(item.type)
        {
        case GC_VX_ITEM_TYPE_REG:
            gcmPRINT("r%d", item.index);
            break;
        case GC_VX_ITEM_TYPE_UNIFORM:
            gcmPRINT("c%d", item.index);
            break;
        case GC_VX_ITEM_TYPE_UNIFORM512:
            gcmPRINT("C%d", item.index);
            break;
        case GC_VX_ITEM_TYPE_IMM:
            gcmPRINT("%d", item.index);
            break;
        case GC_VX_ITEM_TYPE_IMMF:
            gcmPRINT("%ff", item.immf);
            break;
        }

        if(item.neg != 0)
            gcmPRINT(".neg");

        if((dest && item.swizzle != 0xf) || (!dest && item.swizzle != 0xe4))
        {
            gcmPRINT(".");
            _generateSwizzle(item.swizzle, dest);
        }

        gcmPRINT(" ");
    }
}

static void _printInstruction(gctVX_AsmSource instr_source)
{
    int i = 0;
    gcmPRINT("\n ********** generate ********** \n\n");

    for(i = 0; i < instr_source.instr_count; i++)
    {
        int j = 0;
        for(j = 0; j < sizeof(opcodetables)/sizeof(opcodetables[0]); j++)
        {
            if(instr_source._instructions[i].opcode == opcodetables[j].index)
            {
                if((instr_source._instructions[i].opcode != 0x79 && instr_source._instructions[i].opcode != 0x7A)
                    && instr_source._instructions[i].evis && (j <= 0x7F))continue;
                gcmPRINT("%s", opcodetables[j].name);
                break;
            }
        }

        if (instr_source._instructions[i].evis == 1)
            gcmPRINT(".evis");
        else  if(instr_source._instructions[i].evis != 1)
            gcmPRINT(".evis_%d", instr_source._instructions[i].evis);

        gcmPRINT(".%s", formattables[instr_source._instructions[i].format].name);

        if(instr_source._instructions[i].rounding != 0)
            gcmPRINT(".rtn");

        if(instr_source._instructions[i].clamp != 0)
            gcmPRINT(".clamp");

        if(instr_source._instructions[i].evis != 0)
            gcmPRINT(".{%d, %d}", instr_source._instructions[i].startbin, instr_source._instructions[i].endbin);

        gcmPRINT(" ");

        _generateItem(instr_source._instructions[i].dst, 1);

        _generateItem(instr_source._instructions[i].src[0], 0);

        _generateItem(instr_source._instructions[i].src[1], 0);

        _generateItem(instr_source._instructions[i].src[2], 0);

        gcmPRINT("\n");
    }
}

#endif

gceSTATUS
gcoHARDWAREVX_GenerateItemMC(
    IN gctVX_AsmInstrItem InstrSourceItem,
    IN gctUINT32 Index,
    OUT gcoVX_Instruction* instrction
)
{
    gceSTATUS status = gcvSTATUS_OK;

    gcmHEADER_ARG("InstrSourceItem=0x%x Index=%d", InstrSourceItem, Index);

    if(InstrSourceItem.enabled)
    {
        switch(InstrSourceItem.type)
        {
        case GC_VX_ITEM_TYPE_REG:
            gcmONERROR(gcoHARDWAREVX_SetTempReg(Index, InstrSourceItem.index, InstrSourceItem.swizzle, InstrSourceItem.neg, instrction));
            break;
        case GC_VX_ITEM_TYPE_UNIFORM:
            gcmONERROR(gcoHARDWAREVX_SetUniform(Index, InstrSourceItem.index, InstrSourceItem.swizzle, InstrSourceItem.neg, instrction));
            break;
        case GC_VX_ITEM_TYPE_UNIFORM512:
            gcmONERROR(gcoHARDWAREVX_Setuniform(Index, InstrSourceItem.index, instrction));
            break;
        case GC_VX_ITEM_TYPE_IMM:
            gcmONERROR(gcoHARDWAREVX_SetImmediateValue(Index, InstrSourceItem.index, instrction));
            break;
        case GC_VX_ITEM_TYPE_IMMF:
            gcmONERROR(gcoHARDWAREVX_SetImmediateValueF(Index, InstrSourceItem.immf, instrction));
            break;
        }
    }
OnError:
    /* Return the status. */
    gcmFOOTER();
    return status;
}

gceSTATUS
gcoHARDWAREVX_GenerateMC(
    IN OUT gcoVX_Hardware_Context   *Context
)
{
    gceSTATUS status = gcvSTATUS_OK;
    gcoVX_Instructions   *Instructions  = Context->instructions;
    gctVX_AsmSource instr_source = {0};
    gctINT32 i = 0;

    gcmHEADER_ARG("Context=0x%x", Context);

    if(Context->instructions->source != gcvNULL)
    {
        gcmVxAssambler(Context->instructions->source, &instr_source);

        Instructions->count = 0;

#if GC_VX_INSTRUCTION_ASM_DEBUG
        _printInstruction(instr_source);
#endif

        for(i = 0; i < instr_source.instr_count; i++)
        {
            gctVX_AsmInstruction *inst_item = &instr_source._instructions[i];
            gcoVX_Instruction *instruction = &Instructions->binarys[Instructions->count];

            if (inst_item->evis && (inst_item->opcode != 0x79 && inst_item->opcode != 0x7A))
            {
                gcmONERROR(gcoHARDWAREVX_AddOpcode(0x45, inst_item->opcode, inst_item->format, instruction));
            }
            else
                gcmONERROR(gcoHARDWAREVX_AddOpcode(inst_item->opcode, 0, inst_item->format, instruction));

            if(inst_item->dst.enabled && (inst_item->opcode != 0x7A))
                gcmONERROR(gcoHARDWAREVX_SetDestination(inst_item->dst.index, inst_item->dst.swizzle, inst_item->clamp, instruction));

            if (inst_item->evis)
            {
                gcmONERROR(gcoHARDWAREVX_SetEVIS(inst_item->startbin, inst_item->endbin, inst_item->evis, instruction));
            }

            gcmONERROR(gcoHARDWAREVX_GenerateItemMC(inst_item->src[0], 0, instruction));

            gcmONERROR(gcoHARDWAREVX_GenerateItemMC(inst_item->src[1], 1, instruction));

            gcmONERROR(gcoHARDWAREVX_GenerateItemMC(inst_item->src[2], 2, instruction));

            if (inst_item->evis && (inst_item->opcode != 0x79 && inst_item->opcode != 0x7A))
                gcmONERROR(gcoHARDWAREVX_SetSourceBin(inst_item->sourcebin, instruction));

            Instructions->count++;
        }
    }
OnError:
    /* Return the status. */
    gcmFOOTER();
    return status;
}

#endif /* GC_VX_ASM */

/*
** Flush shader cache.
*/
gceSTATUS
gcoHARDWAREVX_FlushCache(
    IN gcoHARDWARE          Hardware,
    IN gctBOOL              InvalidateICache,
    IN gctBOOL              FlushPSSHL1Cache,
    IN gctBOOL              FlushNNL1Cache,
    IN gctBOOL              FlushTPL1Cache,
    IN gctBOOL              FlushSHL1Cache
    )
{
    gceSTATUS status = gcvSTATUS_OK;

    gcmHEADER_ARG("Hardware=0x%x", Hardware);

    gcmGETHARDWARE(Hardware);

    if (InvalidateICache)
    {
        gctPOINTER *cmdBuffer = gcvNULL;

         /* Define state buffer variables. */
        gcmDEFINESTATEBUFFER_NEW(reserve, stateDelta, memory);

        gcmBEGINSTATEBUFFER_NEW(Hardware, reserve, stateDelta, memory, cmdBuffer);

        stateDelta = stateDelta; /* Keep the compiler happy. */

        /* Invalidate shader ICache. */
        {    {    gcmVERIFYLOADSTATEALIGNED(reserve, memory);
    gcmASSERT((gctUINT32)1 <= 1024);
    *memory++        = ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27))) | (((gctUINT32) (0x01 & ((gctUINT32) ((((1 ?
 31:27) - (0 ?
 31:27) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 31:27) - (0 ?
 31:27) + 1))))))) << (0 ?
 31:27)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26))) | (((gctUINT32) ((gctUINT32) (gcvFALSE) & ((gctUINT32) ((((1 ?
 26:26) - (0 ?
 26:26) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 26:26) - (0 ?
 26:26) + 1))))))) << (0 ?
 26:26)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 25:16) - (0 ?
 25:16) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 25:16) - (0 ?
 25:16) + 1))))))) << (0 ?
 25:16)))        | ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 15:0) - (0 ?
 15:0) + 1))))))) << (0 ?
 15:0))) | (((gctUINT32) ((gctUINT32) (0x022C) & ((gctUINT32) ((((1 ?
 15:0) - (0 ?
 15:0) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 15:0) - (0 ? 15:0) + 1))))))) << (0 ? 15:0)));};
    gcmSETCTRLSTATE_NEW(stateDelta, reserve, memory, 0x022C, ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 4:4) - (0 ?
 4:4) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 4:4) - (0 ?
 4:4) + 1))))))) << (0 ?
 4:4))) | (((gctUINT32) ((gctUINT32) (1) & ((gctUINT32) ((((1 ?
 4:4) - (0 ?
 4:4) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 4:4) - (0 ? 4:4) + 1))))))) << (0 ? 4:4))) );    gcmENDSTATEBATCH_NEW(reserve, memory);
};


        /* Validate the state buffer. */
        gcmENDSTATEBUFFER_NEW(Hardware, reserve, memory, cmdBuffer);
    }

    if (FlushPSSHL1Cache)
    {
        gcmONERROR(
           gcoHARDWARE_LoadCtrlState(Hardware, 0x0380C,
               ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 11:11) - (0 ?
 11:11) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 11:11) - (0 ?
 11:11) + 1))))))) << (0 ?
 11:11))) | (((gctUINT32) (0x1 & ((gctUINT32) ((((1 ?
 11:11) - (0 ?
 11:11) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 11:11) - (0 ? 11:11) + 1))))))) << (0 ? 11:11)))));

        if (Hardware->features[gcvFEATURE_MCFE])
        {
            gcmONERROR(gcoHARDWARE_McfeSubmitJob(Hardware, gcvNULL));
        }
    }

    if (FlushSHL1Cache)
    {
        gcmONERROR(gcoHARDWARE_LoadCtrlState(
            Hardware,
            0x0380C,
                ((((gctUINT32) (0)) & ~(((gctUINT32) (((gctUINT32) ((((1 ?
 5:5) - (0 ?
 5:5) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ?
 5:5) - (0 ?
 5:5) + 1))))))) << (0 ?
 5:5))) | (((gctUINT32) (0x1 & ((gctUINT32) ((((1 ?
 5:5) - (0 ?
 5:5) + 1) == 32) ?
 ~0U : (~(~0U << ((1 ? 5:5) - (0 ? 5:5) + 1))))))) << (0 ? 5:5)))
            ));
    }


OnError:
    /* Return the status */
    gcmFOOTER();
    return status;
}

gceSTATUS
gcoHARDWAREVX_CaptureState(
    IN gcoHARDWARE  Hardware,
    IN OUT gctUINT8 *CaptureBuffer,
    IN gctUINT32 InputSizeInByte,
    IN OUT gctUINT32 *pOutputSizeInByte,
    IN gctBOOL Enabled,
    IN gctBOOL dropCommandEnabled
    )
{
    gceSTATUS status = gcvSTATUS_OK;

    gcmHEADER_ARG("Hardware=0x%x", Hardware);

    gcmGETHARDWARE(Hardware);

    gcmONERROR(gcoBUFFER_Capture(Hardware->engine[gcvENGINE_RENDER].buffer,
                                 CaptureBuffer,
                                 InputSizeInByte,
                                 pOutputSizeInByte,
                                 Enabled,
                                 dropCommandEnabled));

OnError:
    gcmFOOTER();
    return status;

}

gceSTATUS
gcoHARDWAREVX_CaptureInitState(
    IN gcoHARDWARE  Hardware,
    IN OUT gctPOINTER CaptureBuffer,
    IN gctUINT32 InputSizeInByte,
    IN OUT gctUINT32 *OutputSizeInByte
    )
{
    gceSTATUS status = gcvSTATUS_OK;

    gcmHEADER_ARG("Hardware=0x%x", Hardware);
    if (Hardware == gcvNULL)
    {
        gcmONERROR(gcvSTATUS_INVALID_ADDRESS);
    }

    gcmONERROR(gcoBUFFER_CaptureInitState(Hardware->engine[gcvENGINE_RENDER].buffer,
                                CaptureBuffer, InputSizeInByte, OutputSizeInByte));

OnError:
    gcmFOOTER();
    return status;
}

#endif /*gcdUSE_VX*/


